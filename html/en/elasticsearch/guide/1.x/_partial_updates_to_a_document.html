<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Partial Updates to a Document
        | Elasticsearch: The Definitive Guide [1.x]
      | Elastic
    </title><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide [1.x]" /><link rel="up" href="distributed-docs.html" title="Distributed Document Store" /><link rel="prev" href="distrib-read.html" title="Retrieving a Document" /><link rel="next" href="distrib-multi-doc.html" title="Multidocument Patterns" /><meta name="DC.type" content="Learn/Docs/Legacy/Elasticsearch/Definitive Guide/1.x" /><meta name="DC.subject" content="Elasticsearch" /><meta name="DC.identifier" content="1.x" /><meta name="robots" content="noindex,nofollow" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">This information applies to version 1.x of Elasticsearch. For the
most up to date information, see the current version of the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">
Elasticsearch Reference</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide
      [1.x]
    </a></span> » <span class="breadcrumb-link"><a href="getting-started.html">Getting Started</a></span> » <span class="breadcrumb-link"><a href="distributed-docs.html">Distributed Document Store</a></span> » <span class="breadcrumb-node">Partial Updates to a Document</span></div><div class="navheader"><span class="prev"><a href="distrib-read.html">
              « 
              Retrieving a Document</a>
           
        </span><span class="next">
           
          <a href="distrib-multi-doc.html">Multidocument Patterns
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_partial_updates_to_a_document"></a>Partial Updates to a Document<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/1.x/040_Distributed_CRUD/25_Partial_updates.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The <code class="literal">update</code> API , as shown in <a class="xref" href="_partial_updates_to_a_document.html#img-distrib-update" title="Figure 11. Partial updates to a document">Figure 11, “Partial updates to a document”</a>, combines the read and<a id="id-1.4.6.9.2.3" class="indexterm"></a>
<a id="id-1.4.6.9.2.4" class="indexterm"></a><a id="id-1.4.6.9.2.5" class="indexterm"></a>
<a id="id-1.4.6.9.2.6" class="indexterm"></a> write patterns explained previously.</p><div class="figure"><a id="img-distrib-update"></a><p class="title"><strong>Figure 11. Partial updates to a document</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/elas_0404.png" alt="Partial updates to a document" /></div></div></div><p>Here is the sequence of steps used to perform a partial update on  a
document:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
The client sends an update request to <code class="literal">Node 1</code>.
</li><li class="listitem">
It forwards the request to <code class="literal">Node 3</code>, where the primary shard is allocated.
</li><li class="listitem">
<code class="literal">Node 3</code> retrieves the document from the primary shard, changes the JSON
   in the <code class="literal">_source</code> field, and tries to reindex the document on the primary
   shard. If the document has already been changed by another process, it
   retries step 3 up to <code class="literal">retry_on_conflict</code> times, before giving up.
</li><li class="listitem">
If <code class="literal">Node 3</code> has managed to update the document successfully, it forwards
   the new version of the document in parallel to the replica shards on <code class="literal">Node 1</code>
   and <code class="literal">Node 2</code> to be reindexed. Once all replica shards report success,
   <code class="literal">Node 3</code> reports success to the coordinating node,  which reports success to
   the client.
</li></ol></div><p>The <code class="literal">update</code> API also accepts the <code class="literal">routing</code>, <code class="literal">replication</code>, <code class="literal">consistency</code>, and
<code class="literal">timeout</code> parameters that are explained in <a class="xref" href="distrib-write.html" title="Creating, Indexing, and Deleting a Document">Creating, Indexing, and Deleting a Document</a>.</p><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Document-Based Replication</strong></p></div></div></div><p>When a primary shard forwards changes to its replica shards,<a id="id-1.4.6.9.7.2.1" class="indexterm"></a>
<a id="id-1.4.6.9.7.2.2" class="indexterm"></a> it doesn’t
forward the update request. Instead it forwards the new version of the full
document. Remember that these changes are forwarded to the replica shards
asynchronously, and there is no guarantee that they will arrive in the same
order that they were sent. If Elasticsearch forwarded just the change, it is
possible that changes would be applied in the wrong order, resulting in a
corrupt document.</p></div></div><div class="navfooter"><span class="prev"><a href="distrib-read.html">
              « 
              Retrieving a Document</a>
           
        </span><span class="next">
           
          <a href="distrib-multi-doc.html">Multidocument Patterns
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
