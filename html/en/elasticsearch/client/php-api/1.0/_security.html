<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Security
        | Elasticsearch-PHP [1.0]
      | Elastic
    </title><link rel="home" href="index.html" title="Elasticsearch-PHP [1.0]" /><link rel="up" href="index.html" title="Elasticsearch-PHP [1.0]" /><link rel="prev" href="_php_version_requirement.html" title="PHP Version Requirement" /><meta name="DC.type" content="Learn/Docs/Clients/PHP/1.0" /><meta name="DC.subject" content="Clients" /><meta name="DC.identifier" content="1.0" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch-PHP
      [1.0]
    </a></span> » <span class="breadcrumb-node">Security</span></div><div class="navheader"><span class="prev"><a href="_php_version_requirement.html">
              « 
              PHP Version Requirement</a>
           
        </span><span class="next">
           
          </span></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="_security"></a>Security<a href="https://github.com/elastic/elasticsearch-php/edit/1.0/docs/security.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_http_authentication"></a>HTTP Authentication<a href="https://github.com/elastic/elasticsearch-php/edit/1.0/docs/security.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>If your Elasticsearch server is protected by HTTP Authentication, you need to provide the credentials to ES-PHP so that requests can be authenticated server-side.  There are two ways to enable HTTP Authentication: inline with the host, or via <code class="literal">auth</code> parameters:</p><p><strong>Inline Authentication. </strong>
</p><div class="pre_wrapper lang-php"><pre class="programlisting prettyprint lang-php">$params = array();
$params['hosts'] = array (
    'http://user:pass@localhost:9200',  // HTTP Basic Auth
);

$client = new Elasticsearch\Client($params);</pre></div><p>
</p><p>Only HTTP Basic Auth is supported via the inline syntax.  Inline syntax allows different credentials for each host.
Alternatively, you can use the <code class="literal">auth</code> connection parameter:</p><p><strong>Auth Connection Parameter. </strong>
</p><div class="pre_wrapper lang-php"><pre class="programlisting prettyprint lang-php">$params = array();
$params['connectionParams']['auth'] = array(
    'user',
    'pass',
    'Basic' <a id="CO8-1"></a><i class="conum" data-value="1"></i>
);
$client = new Elasticsearch\Client($params);</pre></div><p>
</p><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO8-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>Accepts four different options: <code class="literal">Basic</code>, <code class="literal">Digests</code>, <code class="literal">NTLM</code>, <code class="literal">Any</code></p></td></tr></table></div><p>The <code class="literal">auth</code> syntax allows all four types of HTTP authentication, although <code class="literal">Basic</code> is the most often used variety.  Unlike the inline syntax,
the <code class="literal">auth</code> syntax applies to all connections.  This is useful if all servers share the same authentication credentials</p><p>After being initialized with authentication credentials, all outgoing requests will automatically include the appropriate HTTP auth headers.  Authentication setup is identical regardless of the ConnectionClass you are using (e.g. GuzzleConnection or CurlMultiConnection)</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_ssl_configuration"></a>SSL Configuration<a href="https://github.com/elastic/elasticsearch-php/edit/1.0/docs/security.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Configuring SSL is a little more complex.  First you need to identify if your certificate has been signed by a public Certificate Authority (CA), or if it is a self-signed certificate.  Then you need to identify which ConnectionClass you are using, since they have slightly different syntax to enable SSL.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><h3>A note on libcurl version</h3><p>If you believe the client is configured to correctly use SSL, but it simply is not working, check your libcurl version.  On certain platforms, various features may or may not be available depending on version number of libcurl.  For example, the <code class="literal">--cacert</code> option was not added to the OSX version of libcurl until version 7.37.1.  The <code class="literal">--cacert</code> option is equivalent to PHP’s <code class="literal">CURLOPT_CAINFO</code> constant, meaning that custom certificate paths will not work on lower versions.</p><p>If you are encountering problems, update your libcurl version and/or check the <a class="ulink" href="http://curl.haxx.se/changes.html" target="_top">curl changelog</a>.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_guzzleconnection_public_ca_cert"></a>GuzzleConnection + Public CA Cert<a href="https://github.com/elastic/elasticsearch-php/edit/1.0/docs/security.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>If your certificate has been signed by a public Certificate Authority and your server has up-to-date root certificates, you only need to use <code class="literal">https</code> in the host path.  Guzzle will automatically verify SSL certificates:</p><div class="pre_wrapper lang-php"><pre class="programlisting prettyprint lang-php">$params = array();
$params['hosts'] = array (
    'https://localhost:9200' <a id="CO9-1"></a><i class="conum" data-value="1"></i>
);

$client = new Elasticsearch\Client($params);</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO9-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>Note that <code class="literal">https</code> is used, not <code class="literal">http</code></p></td></tr></table></div><p>If your server has out-dated root certificates, you may need to use a certificate bundle.  For PHP clients, the best way is to use <a class="ulink" href="https://github.com/Kdyby/CurlCaBundle" target="_top">Kdyby/CurlCaBundle</a>.  Once installed, you would use inject it into the client:</p><div class="pre_wrapper lang-php"><pre class="programlisting prettyprint lang-php">$params = array();
$params['hosts'] = array (
    'https://localhost:9200'
);

$params['guzzleOptions'] = array(
    \Guzzle\Http\Client::SSL_CERT_AUTHORITY =&gt; 'system', <a id="CO10-1"></a><i class="conum" data-value="1"></i>
    \Guzzle\Http\Client::CURL_OPTIONS =&gt; [
        CURLOPT_SSL_VERIFYPEER =&gt; true, <a id="CO10-2"></a><i class="conum" data-value="2"></i>
        CURLOPT_SSL_VERIFYHOST =&gt; 2, <a id="CO10-3"></a><i class="conum" data-value="3"></i>
        CURLOPT_CAINFO =&gt; \Kdyby\CurlCaBundle\CertificateHelper::getCaInfoFile() <a id="CO10-4"></a><i class="conum" data-value="4"></i>
    ]
);
$client = new Elasticsearch\Client($params);</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO10-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>Tell Guzzle that we are providing our own root certificates</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO10-2"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>Verify that the certificate has been signed by a CA and can be trusted</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO10-3"><i class="conum" data-value="3"></i></a> </p></td><td valign="top" align="left"><p>Verify that the host you are talking to is the host in the certificate. Note that cURL needs the value of <code class="literal">2</code>, not <code class="literal">true</code> or <code class="literal">1</code> (due to an internal cURL depreciation)</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO10-4"><i class="conum" data-value="4"></i></a> </p></td><td valign="top" align="left"><p>Tell cURL where the certificate bundle is located</p></td></tr></table></div><p>Note: Guzzle’s <code class="literal">CURL_OPTIONS</code> parameter will accept any PHP <a class="ulink" href="http://php.net/manual/en/function.curl-setopt.php" target="_top">curl_opt</a> constant for configuring.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_guzzleconnection_self_signed_certificate"></a>GuzzleConnection + Self-Signed Certificate<a href="https://github.com/elastic/elasticsearch-php/edit/1.0/docs/security.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Self-signed certificates are certs that have not been signed by a public CA.  They are signed by your own organization.  Self-signed certificates are often used for internal purposes, when you can securely spread the root certificate yourself.  It should not be used when being exposed to public consumers, since this leaves the client vulnerable to man-in-the-middle attacks.</p><p>If you are using a self-signed certificate, you need to provide the certificate to the client:</p><div class="pre_wrapper lang-php"><pre class="programlisting prettyprint lang-php">$params = array();
$params['hosts'] = array (
    'https://localhost:9200'
);

$params['guzzleOptions'] = array(
    \Guzzle\Http\Client::SSL_CERT_AUTHORITY =&gt; 'system',
    \Guzzle\Http\Client::CURL_OPTIONS =&gt; [
        CURLOPT_SSL_VERIFYPEER =&gt; true,
        CURLOPT_SSL_VERIFYHOST =&gt; 2,
        CURLOPT_CAINFO =&gt; 'cacert.pem', <a id="CO11-1"></a><i class="conum" data-value="1"></i>
        CURLOPT_SSLCERTTYPE =&gt; 'PEM', <a id="CO11-2"></a><i class="conum" data-value="2"></i>
    ]
);
$client = new Elasticsearch\Client($params);</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO11-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>CAInfo is used to specify the path to the self-signed certificate</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO11-2"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>Finally, the certificate type is specified.  PEM is default, so you can omit this if you are using .pem certs</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_curlmulticonnection_public_ca_cert"></a>CurlMultiConnection + Public CA Cert<a href="https://github.com/elastic/elasticsearch-php/edit/1.0/docs/security.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Similar to Guzzle, CurlMultiConnection will work seamlessly with publicly signed certs.  You just need to specify the ConnectionClass and use <code class="literal">https</code> in the URI:</p><div class="pre_wrapper lang-php"><pre class="programlisting prettyprint lang-php">$params = array();
$params['connectionClass'] = '\Elasticsearch\Connections\CurlMultiConnection';

$params['hosts'] = array (
    'https://localhost:9200' <a id="CO12-1"></a><i class="conum" data-value="1"></i>
);

$client = new Elasticsearch\Client($params);</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO12-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>Note that <code class="literal">https</code> is used, not <code class="literal">http</code></p></td></tr></table></div><p>If your server does not have up-to-date root certificates, you can also use <a class="ulink" href="https://github.com/Kdyby/CurlCaBundle" target="_top">Kdyby/CurlCaBundle</a> with
CurlMultiConnection:</p><div class="pre_wrapper lang-php"><pre class="programlisting prettyprint lang-php">$params = array();
$params['connectionClass'] = '\Elasticsearch\Connections\CurlMultiConnection';

$params['hosts'] = array (
    'https://localhost:9200'
);

$params['connectionParams']['curlOpts'] = array(
    CURLOPT_CAINFO =&gt; \Kdyby\CurlCaBundle\CertificateHelper::getCaInfoFile()
);
$client = new Elasticsearch\Client($params);</pre></div><p>Note that the syntax for specifying curl options is different from Guzzle.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_curlmulticonnection_self_signed_certificates"></a>CurlMultiConnection + Self-Signed Certificates<a href="https://github.com/elastic/elasticsearch-php/edit/1.0/docs/security.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>To use self-signed certificates, you need to provide the certificate, just like Guzzle, albeit with slightly different syntax:</p><div class="pre_wrapper lang-php"><pre class="programlisting prettyprint lang-php">$params = array();
$params['connectionClass'] = '\Elasticsearch\Connections\CurlMultiConnection';

$params['hosts'] = array (
    'https://localhost:9200'
);

$params['connectionParams']['curlOpts'] = array(
    CURLOPT_SSL_VERIFYPEER =&gt; true,
    CURLOPT_SSL_VERIFYHOST =&gt; 2,
    CURLOPT_CAINFO =&gt; 'cacert.pem',
    CURLOPT_SSLCERTTYPE =&gt; 'PEM'
);
$client = new Elasticsearch\Client($params);</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_using_authentication_with_ssl"></a>Using Authentication with SSL<a href="https://github.com/elastic/elasticsearch-php/edit/1.0/docs/security.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>It is possible to use HTTP authentication with SSL.  Simply specify <code class="literal">https</code> in the URI, configure SSL settings as required and provide authentication credentials.  For example, this snippet will authenticate using Basic HTTP auth and a self-signed certificate:</p><div class="pre_wrapper lang-php"><pre class="programlisting prettyprint lang-php">$params = array();
$params['hosts'] = array (
    'https://localhost:9200'
);

$params['connectionParams']['auth'] = array('user', 'pass', 'Basic');

$params['guzzleOptions'] = array(
    \Guzzle\Http\Client::SSL_CERT_AUTHORITY =&gt; 'system',
    \Guzzle\Http\Client::CURL_OPTIONS =&gt; [
        CURLOPT_SSL_VERIFYPEER =&gt; true,
        CURLOPT_SSL_VERIFYHOST =&gt; 2,
        CURLOPT_CAINFO =&gt; 'cacert.pem',
        CURLOPT_SSLCERTTYPE =&gt; 'PEM',
    ]
);
$client = new Elasticsearch\Client($params);</pre></div></div></div><div class="navfooter"><span class="prev"><a href="_php_version_requirement.html">
              « 
              PHP Version Requirement</a>
           
        </span><span class="next">
           
          </span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
