<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Get Rollup Index Capabilities API
        | Java REST Client [6.6]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Java REST Client [6.6]" /><link rel="up" href="_rollup_apis.html" title="Rollup APIs" /><link rel="prev" href="java-rest-high-rollup-x-pack-rollup-get-rollup-caps.html" title="Get Rollup Capabilities API" /><link rel="next" href="_security_apis.html" title="Security APIs" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Clients/JavaREST/6.6" /><meta name="DC.subject" content="Clients" /><meta name="DC.identifier" content="6.6" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Java REST Client
      [6.6]
    </a></span> » <span class="breadcrumb-link"><a href="java-rest-high.html">Java High Level REST Client</a></span> » <span class="breadcrumb-link"><a href="_rollup_apis.html">Rollup APIs</a></span> » <span class="breadcrumb-node">Get Rollup Index Capabilities API</span></div><div class="navheader"><span class="prev"><a href="java-rest-high-rollup-x-pack-rollup-get-rollup-caps.html">
              « 
              Get Rollup Capabilities API</a>
           
        </span><span class="next">
           
          <a href="_security_apis.html">Security APIs
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="java-rest-high-rollup-x-pack-rollup-get-rollup-index-caps"></a>Get Rollup Index Capabilities API<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/java-rest/high-level/rollup/get_rollup_index_caps.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The Get Rollup Index Capabilities API allows the user to determine if a concrete index or index pattern contains
stored rollup jobs and data.  If it contains data stored from rollup jobs, the capabilities of those jobs
are returned. The API accepts a <code class="literal">GetRollupIndexCapsRequest</code> object as a request and returns a <code class="literal">GetRollupIndexCapsResponse</code>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="java-rest-high-rollup-x-pack-rollup-get-rollup-index-caps-request"></a>Get Rollup Index Capabilities Request<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/java-rest/high-level/rollup/get_rollup_index_caps.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>A <code class="literal">GetRollupIndexCapsRequest</code> requires a single parameter: the target index or index pattern (e.g. <code class="literal">rollup-foo</code>):</p><div class="pre_wrapper lang-java"><pre class="programlisting prettyprint lang-java">GetRollupIndexCapsRequest getRollupIndexCapsRequest = new GetRollupIndexCapsRequest("rollup");</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="java-rest-high-rollup-x-pack-rollup-get-rollup-index-caps-execution"></a>Execution<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/java-rest/high-level/rollup/get_rollup_index_caps.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The Get Rollup Index Capabilities API can be executed through a <code class="literal">RollupClient</code>
instance. Such instance can be retrieved from a <code class="literal">RestHighLevelClient</code>
using the <code class="literal">rollup()</code> method:</p><div class="pre_wrapper lang-java"><pre class="programlisting prettyprint lang-java">GetRollupIndexCapsResponse capsResponse = client.rollup()
    .getRollupIndexCapabilities(getRollupIndexCapsRequest, RequestOptions.DEFAULT);</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="java-rest-high-rollup-x-pack-rollup-get-rollup-index-caps-response"></a>Response<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/java-rest/high-level/rollup/get_rollup_index_caps.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The returned <code class="literal">GetRollupIndexCapsResponse</code> holds lists and maps of values which correspond to the capabilities
of the rollup index/index pattern (what jobs are stored in the index, their capabilities, what
aggregations are available, etc).  Because multiple jobs can be stored in one index, the
response may include several jobs with different configurations.</p><p>The capabilities are essentially the same as the original job configuration, just presented in a different
manner. For example, if we had created a job with the following config:</p><div class="pre_wrapper lang-java"><pre class="programlisting prettyprint lang-java">final String indexPattern = "docs";
final String rollupIndexName = "rollup";
final String cron = "*/1 * * * * ?";
final int pageSize = 100;
final TimeValue timeout = null;

String id = "job_1";
RollupJobConfig config = new RollupJobConfig(id, indexPattern, rollupIndexName, cron,
    pageSize, groups, metrics, timeout);

PutRollupJobRequest request = new PutRollupJobRequest(config);
AcknowledgedResponse response = client.rollup().putRollupJob(request, RequestOptions.DEFAULT);

boolean acknowledged = response.isAcknowledged();</pre></div><p>The <code class="literal">GetRollupIndexCapsResponse</code> object would contain the same information, laid out in a slightly different manner:</p><div class="pre_wrapper lang-java"><pre class="programlisting prettyprint lang-java">Map&lt;String, RollableIndexCaps&gt; rolledPatterns = capsResponse.getJobs();

RollableIndexCaps docsPattern = rolledPatterns.get("rollup");

// indexName will be "rollup", the target index we requested
String indexName = docsPattern.getIndexName();

// Each index pattern can have multiple jobs that rolled it up, so <code class="literal">getJobCaps()</code>
// returns a list of jobs that rolled up the pattern
List&lt;RollupJobCaps&gt; rollupJobs = docsPattern.getJobCaps();
RollupJobCaps jobCaps = rollupJobs.get(0);

// jobID is the identifier we used when we created the job (e.g. <code class="literal">job1</code>)
String jobID = jobCaps.getJobID();

// rollupIndex is the location that the job stored it's rollup docs (e.g. <code class="literal">rollup</code>)
String rollupIndex = jobCaps.getRollupIndex();

// Finally, fieldCaps are the capabilities of individual fields in the config
// The key is the field name, and the value is a RollupFieldCaps object which
// provides more info.
Map&lt;String, RollupJobCaps.RollupFieldCaps&gt; fieldCaps = jobCaps.getFieldCaps();

// If we retrieve the "timestamp" field, it returns a list of maps.  Each list
// item represents a different aggregation that can be run against the "timestamp"
// field, and any additional details specific to that agg (interval, etc)
List&lt;Map&lt;String, Object&gt;&gt; timestampCaps = fieldCaps.get("timestamp").getAggs();
assert timestampCaps.get(0).toString().equals("{agg=date_histogram, delay=7d, interval=1h, time_zone=UTC}");

// In contrast to the timestamp field, the temperature field has multiple aggs configured
List&lt;Map&lt;String, Object&gt;&gt; temperatureCaps = fieldCaps.get("temperature").getAggs();
assert temperatureCaps.toString().equals("[{agg=min}, {agg=max}, {agg=sum}]");</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="java-rest-high-rollup-x-pack-rollup-get-rollup-index-caps-async"></a>Asynchronous Execution<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/java-rest/high-level/rollup/get_rollup_index_caps.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>This request can be executed asynchronously:</p><div class="pre_wrapper lang-java"><pre class="programlisting prettyprint lang-java">client.rollup().getRollupIndexCapabilitiesAsync(getRollupIndexCapsRequest, RequestOptions.DEFAULT, listener); <a id="CO954-1"></a><i class="conum" data-value="1"></i></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO954-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>The <code class="literal">GetRollupIndexCapsRequest</code> to execute and the <code class="literal">ActionListener</code> to use when
the execution completes</p></td></tr></table></div><p>The asynchronous method does not block and returns immediately. Once it is
completed the <code class="literal">ActionListener</code> is called back using the <code class="literal">onResponse</code> method
if the execution successfully completed or using the <code class="literal">onFailure</code> method if
it failed.</p><p>A typical listener for <code class="literal">GetRollupIndexCapsResponse</code> looks like:</p><div class="pre_wrapper lang-java"><pre class="programlisting prettyprint lang-java">ActionListener&lt;GetRollupIndexCapsResponse&gt; listener = new ActionListener&lt;GetRollupIndexCapsResponse&gt;() {
    @Override
    public void onResponse(GetRollupIndexCapsResponse response) {

        <a id="CO955-1"></a><i class="conum" data-value="1"></i>
    }

    @Override
    public void onFailure(Exception e) {
        <a id="CO955-2"></a><i class="conum" data-value="2"></i>
    }
};</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO955-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>Called when the execution is successfully completed. The response is
provided as an argument</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO955-2"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>Called in case of failure. The raised exception is provided as an argument</p></td></tr></table></div></div></div><div class="navfooter"><span class="prev"><a href="java-rest-high-rollup-x-pack-rollup-get-rollup-caps.html">
              « 
              Get Rollup Capabilities API</a>
           
        </span><span class="next">
           
          <a href="_security_apis.html">Security APIs
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
window.initial_state = {}</script>
  </body>
</html>
