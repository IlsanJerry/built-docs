<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tribe Nodes and Security
        | Elasticsearch Reference [6.8]
      | Elastic
    </title><link rel="home" href="index.html" title="Elasticsearch Reference [6.8]" /><link rel="up" href="ccs-tribe-clients-integrations.html" title="Cross cluster search, tribe, clients, and integrations" /><link rel="prev" href="cross-cluster-configuring.html" title="Cross cluster search and security" /><link rel="next" href="java-clients.html" title="Java Client and security" /><meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.8" /><meta name="DC.subject" content="Elasticsearch" /><meta name="DC.identifier" content="6.8" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [6.8]
    </a></span> » <span class="breadcrumb-link"><a href="secure-cluster.html">Secure a cluster</a></span> » <span class="breadcrumb-link"><a href="ccs-tribe-clients-integrations.html">Cross cluster search, tribe, clients, and integrations</a></span> » <span class="breadcrumb-node">Tribe Nodes and Security</span></div><div class="navheader"><span class="prev"><a href="cross-cluster-configuring.html">
              « 
              Cross cluster search and security</a>
           
        </span><span class="next">
           
          <a href="java-clients.html">Java Client and security
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="tribe-node-configuring"></a>Tribe Nodes and Security<a href="https://github.com/elastic/elasticsearch/edit/6.8/x-pack/docs/en/security/tribe-clients-integrations/tribe.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p><a class="ulink" href="/guide/en/elasticsearch/reference/6.8/modules-tribe.html" target="_top">Tribe nodes</a> act as a federated client across multiple
clusters. When using tribe nodes with secured clusters, all clusters must have
X-Pack security enabled and share the same security configuration (users, roles,
user-role mappings, SSL/TLS CA). The tribe node itself also must be configured
to grant access to actions and indices on all of the connected clusters, as
security checks on incoming requests are primarily done on the tribe node
itself.</p><div class="important admon"><div class="icon"></div><div class="admon_content"><p>Support for tribe nodes in Kibana was added in v5.2.</p></div></div><p>To use a tribe node with secured clusters:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Install X-Pack on the tribe node and every node in each connected cluster.</li><li class="listitem"><p class="simpara">Enable encryption globally. To encrypt communications, you must enable
<a class="link" href="ssl-tls.html" title="Setting Up TLS on a cluster">enable SSL/TLS</a> on every node.</p><div class="tip admon"><div class="icon"></div><div class="admon_content"><p>To simplify SSL/TLS configuration, use the same certificate authority to
      generate certificates for all connected clusters.</p></div></div></li><li class="listitem"><p class="simpara">Configure the tribe in the tribe node’s <code class="literal">elasticsearch.yml</code> file. You must
specify each cluster that is a part of the tribe and configure discovery and
encryption settings per cluster. For example, the following configuration adds
two clusters to the tribe:</p><div class="pre_wrapper lang-yml"><pre class="programlisting prettyprint lang-yml">tribe:
  on_conflict: prefer_cluster1 <a id="CO569-2"></a><i class="conum" data-value="1"></i>
  c1: <a id="CO569-3"></a><i class="conum" data-value="2"></i>
    cluster.name: cluster1
    discovery.zen.ping.unicast.hosts: [ "cluster1-node1:9300", "cluster1-node2:9300"]
    xpack.ssl.key: /home/es/config/x-pack/es-tribe-01.key
    xpack.ssl.certificate: /home/es/config/x-pack/es-tribe-01.crt
    xpack.ssl.certificate_authorities: [ "/home/es/config/x-pack/ca.crt" ]
    xpack.security.transport.ssl.enabled: true
    xpack.security.http.ssl.enabled: true
  c2:
    cluster.name: cluster2
    discovery.zen.ping.unicast.hosts: [ "cluster2-node1:9300", "cluster2-node2:9300"]
    xpack.ssl.key: /home/es/config/x-pack/es-tribe-01.key
    xpack.ssl.certificate: /home/es/config/x-pack/es-tribe-01.crt
    xpack.ssl.certificate_authorities: [ "/home/es/config/x-pack/ca.crt" ]
    xpack.security.transport.ssl.enabled: true
    xpack.security.http.ssl.enabled: true</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO569-1"><i class="conum" data-value="1"></i></a> <a href="#CO569-2"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>Results are returned from the preferred cluster if the named index exists
in multiple clusters. A preference is <span class="strong strong"><strong>required</strong></span> when using X-Pack security on
a tribe node.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO569-3"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>An arbitrary name that represents the connection to the cluster.</p></td></tr></table></div></li><li class="listitem"><p class="simpara">Configure the same index privileges for your users on all nodes, including the
tribe node. The nodes in each cluster must grant access to indices in other
connected clusters as well as their own.</p><p class="simpara">For example, let’s assume <code class="literal">cluster1</code> and <code class="literal">cluster2</code> each have a indices <code class="literal">index1</code>
and <code class="literal">index2</code>. To enable a user to submit a request through the tribe node to
search both clusters:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">On the tribe node and both clusters, <a class="link" href="defining-roles.html" title="Defining roles">define a <code class="literal">tribe_user</code> role</a>
that has read access to <code class="literal">index1</code> and <code class="literal">index2</code>:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">tribe_user:
  indices:
    'index*': search</pre></div></li><li class="listitem"><p class="simpara">Assign the <code class="literal">tribe_user</code> role to a user on the tribe node and both clusters.
For example, run the following command on each node to create <code class="literal">my_tribe_user</code>
and assign the <code class="literal">tribe_user</code> role:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">./bin/shield/users useradd my_tribe_user -p password -r tribe_user</pre></div><div class="note admon"><div class="icon"></div><div class="admon_content"><p>Each cluster needs to have its own users with admin privileges.
      You cannot perform administration tasks such as create index through
      the tribe node, you must send the request directly to the appropriate
      cluster.</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">To enable selected users to retrieve merged cluster state information
for the tribe from the tribe node, grant them the cluster
<a class="link" href="security-privileges.html#privileges-list-cluster" title="Cluster privileges"><code class="literal">monitor</code> privilege</a> on the tribe node. For example,
you could create a <code class="literal">tribe_monitor</code> role that assigns the <code class="literal">monitor</code> privilege:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">tribe_monitor:
  cluster: monitor</pre></div></li><li class="listitem">Start the tribe node. If you’ve made configuration changes to the nodes in the
connected clusters, they also need to be restarted.</li></ol></div></div><div class="navfooter"><span class="prev"><a href="cross-cluster-configuring.html">
              « 
              Cross cluster search and security</a>
           
        </span><span class="next">
           
          <a href="java-clients.html">Java Client and security
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/cloud/elasticsearch-service/signup?baymax=default&elektra=docs&storm=top-video">Elasticsearch Service: Free Trial</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
