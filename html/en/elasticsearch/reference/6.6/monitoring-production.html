<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Monitoring in a production environment
        | Elasticsearch Reference [6.6]
      | Elastic
    </title><link rel="home" href="index.html" title="Elasticsearch Reference [6.6]" /><link rel="up" href="monitor-elasticsearch-cluster.html" title="Monitor a cluster" /><link rel="prev" href="how-monitoring-works.html" title="How monitoring works" /><link rel="next" href="collecting-monitoring-data.html" title="Collecting monitoring data" /><meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.6" /><meta name="DC.subject" content="Elasticsearch" /><meta name="DC.identifier" content="6.6" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [6.6]
    </a></span> » <span class="breadcrumb-link"><a href="monitor-elasticsearch-cluster.html">Monitor a cluster</a></span> » <span class="breadcrumb-node">Monitoring in a production environment</span></div><div class="navheader"><span class="prev"><a href="how-monitoring-works.html">
              « 
              How monitoring works</a>
           
        </span><span class="next">
           
          <a href="collecting-monitoring-data.html">Collecting monitoring data
               »
            </a></span></div><div class="xpack chapter"><div class="titlepage"><div><div><h2 class="title"><a id="monitoring-production"></a>Monitoring in a production environment<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/monitoring/production.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><p>In production, you should send monitoring data to a separate <span class="emphasis"><em>monitoring cluster</em></span>
so that historical data is available even when the nodes you are monitoring are
not. For example, you can use Metricbeat to ship monitoring data about Kibana
and Elasticsearch to the monitoring cluster.</p><p>If you have the appropriate license, using a dedicated monitoring cluster also
enables you to monitor multiple clusters from a central location.</p><p>To store monitoring data in a separate cluster:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Set up the Elasticsearch cluster you want to use as the monitoring cluster.
For example, you might set up a two host cluster with the nodes <code class="literal">es-mon-1</code> and
<code class="literal">es-mon-2</code>.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">To monitor an Elasticsearch 6.x cluster, you must run Elasticsearch
6.x on the monitoring cluster.</li><li class="listitem">There must be at least one <a class="link" href="ingest.html" title="Ingest Node">ingest node</a> in the monitoring
cluster; it does not need to be a dedicated ingest node.</li></ul></div></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">(Optional) Verify that the collection of monitoring data is disabled on the
monitoring cluster. By default, the <code class="literal">xpack.monitoring.collection.enabled</code> setting
is <code class="literal">false</code>.</p><p class="simpara">For example, you can use the following APIs to review and change this setting:</p><div class="pre_wrapper lang-console"><pre class="programlisting prettyprint lang-console">GET _cluster/settings

PUT _cluster/settings
{
  "persistent": {
    "xpack.monitoring.collection.enabled": false
  }
}</pre></div><div class="console_widget" data-snippet="snippets/1430.console"></div></li><li class="listitem"><p class="simpara">If the Elasticsearch security features are enabled on the monitoring cluster, create
users that can send and retrieve monitoring data.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>If you plan to use Kibana to view monitoring data, username and password
credentials must be valid on both the Kibana server and the monitoring cluster.</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><span class="Admonishment Admonishment--beta">
      [<span class="Admonishment-title u-mono">beta</span>]
      <span class="Admonishment-detail">This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</span></span>
 If you plan to use Metricbeat to collect data about Elasticsearch or Kibana,
create a user that has the <code class="literal">remote_monitoring_collector</code> built-in role and a
user that has the <code class="literal">remote_monitoring_agent</code>
<a class="ulink" href="/guide/en/elastic-stack-overview/6.6/built-in-roles.html#built-in-roles-remote-monitoring-agent" target="_top">built-in role</a>.
Alternatively, use the <code class="literal">remote_monitoring_user</code>
<a class="ulink" href="/guide/en/elastic-stack-overview/6.6/built-in-users.html" target="_top">built-in user</a>.</li><li class="listitem"><p class="simpara">If you plan to use HTTP exporters to route data through your production
cluster, create a user that has the <code class="literal">remote_monitoring_agent</code>
<a class="ulink" href="/guide/en/elastic-stack-overview/6.6/built-in-roles.html#built-in-roles-remote-monitoring-agent" target="_top">built-in role</a>.</p><p class="simpara">For example, the
following request creates a <code class="literal">remote_monitor</code> user that has the
<code class="literal">remote_monitoring_agent</code> role:</p><div class="pre_wrapper lang-console"><pre class="programlisting prettyprint lang-console">POST /_xpack/security/user/remote_monitor
{
  "password" : "changeme",
  "roles" : [ "remote_monitoring_agent"],
  "full_name" : "Internal Agent For Remote Monitoring"
}</pre></div><div class="console_widget" data-snippet="snippets/1431.console"></div><p class="simpara">Alternatively, use the <code class="literal">remote_monitoring_user</code>
<a class="ulink" href="/guide/en/elastic-stack-overview/6.6/built-in-users.html" target="_top">built-in user</a>.</p></li></ul></div></li></ol></div></li><li class="listitem"><p class="simpara">Configure your production cluster to collect data and send it to the
monitoring cluster.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><span class="Admonishment Admonishment--beta">
      [<span class="Admonishment-title u-mono">beta</span>]
      <span class="Admonishment-detail">This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</span></span>
 <a class="link" href="configuring-metricbeat.html" title="Collecting Elasticsearch monitoring data with Metricbeat">Use Metricbeat</a>. This option
is available in 6.5 and later versions.</li><li class="listitem"><a class="link" href="configuring-monitoring.html" title="Configuring monitoring in Elasticsearch">Use HTTP exporters</a>.</li></ul></div></li><li class="listitem"><p class="simpara">(Optional)
<a class="ulink" href="http://www.elastic.co/guide/en/logstash/6.6/configuring-logstash.html" target="_top">Configure Logstash to collect data and send it to the monitoring cluster</a>.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>You must configure HTTP exporters in the production cluster to route this
data to the monitoring cluster. It cannot be accomplished by using Metricbeat.</p></div></div></li><li class="listitem"><p class="simpara">(Optional) Configure Kibana to collect data and send it to the monitoring cluster:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><span class="Admonishment Admonishment--beta">
      [<span class="Admonishment-title u-mono">beta</span>]
      <span class="Admonishment-detail">This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</span></span>
 <a class="ulink" href="/guide/en/kibana/6.6/monitoring-metricbeat.html" target="_top">Use Metricbeat</a>. This
option is available in 6.4 and later versions.</li><li class="listitem"><a class="ulink" href="/guide/en/kibana/6.6/monitoring-kibana.html" target="_top">Use HTTP exporters</a>.</li></ul></div></li><li class="listitem"><p class="simpara">(Optional) Create a dedicated Kibana instance for monitoring, rather than using
a single Kibana instance to access both your production cluster and monitoring
cluster.</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">(Optional) Disable the collection of monitoring data in this Kibana instance.
Set the <code class="literal">xpack.monitoring.kibana.collection.enabled</code> setting to <code class="literal">false</code> in the
<code class="literal">kibana.yml</code> file. For more information about this setting, see
<a class="ulink" href="/guide/en/kibana/6.6/monitoring-settings-kb.html" target="_top">Monitoring settings in Kibana</a>.</li></ol></div></li><li class="listitem"><a class="ulink" href="/guide/en/kibana/6.6/monitoring-data.html" target="_top">Configure Kibana to retrieve and display the monitoring data</a>.</li></ol></div></div><div class="navfooter"><span class="prev"><a href="how-monitoring-works.html">
              « 
              How monitoring works</a>
           
        </span><span class="next">
           
          <a href="collecting-monitoring-data.html">Collecting monitoring data
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
