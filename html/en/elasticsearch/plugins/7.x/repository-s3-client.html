<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Client Settings
        | Elasticsearch Plugins and Integrations [7.x]
      | Elastic
    </title><link rel="home" href="index.html" title="Elasticsearch Plugins and Integrations [7.x]" /><link rel="up" href="repository-s3.html" title="S3 Repository Plugin" /><link rel="prev" href="repository-s3-usage.html" title="Getting Started" /><link rel="next" href="repository-s3-repository.html" title="Repository Settings" /><meta name="DC.type" content="Learn/Docs/Elasticsearch/Plugins/7.x" /><meta name="DC.subject" content="Elasticsearch" /><meta name="DC.identifier" content="7.x" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Plugins and Integrations
      [7.x]
    </a></span> » <span class="breadcrumb-link"><a href="repository.html">Snapshot/Restore Repository Plugins</a></span> » <span class="breadcrumb-link"><a href="repository-s3.html">S3 Repository Plugin</a></span> » <span class="breadcrumb-node">Client Settings</span></div><div class="navheader"><span class="prev"><a href="repository-s3-usage.html">
              « 
              Getting Started</a>
           
        </span><span class="next">
           
          <a href="repository-s3-repository.html">Repository Settings
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="repository-s3-client"></a>Client Settings<a href="https://github.com/elastic/elasticsearch/edit/7.x/docs/plugins/repository-s3.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The client that you use to connect to S3 has a number of settings available.
The settings have the form <code class="literal">s3.client.CLIENT_NAME.SETTING_NAME</code>. By default,
<code class="literal">s3</code> repositories use a client named <code class="literal">default</code>, but this can be modified using
the <a class="link" href="repository-s3-repository.html" title="Repository Settings">repository setting</a> <code class="literal">client</code>. For example:</p><div class="pre_wrapper lang-console"><pre class="programlisting prettyprint lang-console">PUT _snapshot/my_s3_repository
{
  "type": "s3",
  "settings": {
    "bucket": "my_bucket",
    "client": "my_alternate_client"
  }
}</pre></div><div class="console_widget" data-snippet="snippets/45.console"></div><p>Most client settings can be added to the <code class="literal">elasticsearch.yml</code> configuration file
with the exception of the secure settings, which you add to the Elasticsearch keystore.
For more information about creating and updating the Elasticsearch keystore, see
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/secure-settings.html" target="_top">Secure settings</a>.</p><p>For example, if you want to use specific credentials to access S3 then run the
following commands to add these credentials to the keystore:</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">bin/elasticsearch-keystore add s3.client.default.access_key
bin/elasticsearch-keystore add s3.client.default.secret_key
# a session token is optional so the following command may not be needed
bin/elasticsearch-keystore add s3.client.default.session_token</pre></div><p>If instead you want to use the instance role or container role to access S3
then you should leave these settings unset. You can switch from using specific
credentials back to the default of using the instance role or container role by
removing these settings from the keystore as follows:</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">bin/elasticsearch-keystore remove s3.client.default.access_key
bin/elasticsearch-keystore remove s3.client.default.secret_key
# a session token is optional so the following command may not be needed
bin/elasticsearch-keystore remove s3.client.default.session_token</pre></div><p><span class="strong strong"><strong>All</strong></span> client secure settings of this plugin are
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/secure-settings.html#reloadable-secure-settings" target="_top">reloadable</a>. After you
reload the settings, the internal <code class="literal">s3</code> clients, used to transfer the snapshot
contents, will utilize the latest settings from the keystore. Any existing <code class="literal">s3</code>
repositories, as well as any newly created ones, will pick up the new values
stored in the keystore.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>In-progress snapshot/restore tasks will not be preempted by a <span class="strong strong"><strong>reload</strong></span> of
the client’s secure settings. The task will complete using the client as it was
built when the operation started.</p></div></div><p>The following list contains the available client settings. Those that must be
stored in the keystore are marked as "secure" and are <span class="strong strong"><strong>reloadable</strong></span>; the other
settings belong in the <code class="literal">elasticsearch.yml</code> file.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">access_key</code> (<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/secure-settings.html" target="_top">Secure</a>, <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/secure-settings.html#reloadable-secure-settings" target="_top">reloadable</a>)</span></dt><dd>An S3 access key. If set, the <code class="literal">secret_key</code> setting must also be specified.
If unset, the client will use the instance or container role instead.</dd><dt><span class="term"><code class="literal">secret_key</code> (<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/secure-settings.html" target="_top">Secure</a>, <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/secure-settings.html#reloadable-secure-settings" target="_top">reloadable</a>)</span></dt><dd>An S3 secret key. If set, the <code class="literal">access_key</code> setting must also be specified.</dd><dt><span class="term"><code class="literal">session_token</code> (<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/secure-settings.html" target="_top">Secure</a>, <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/secure-settings.html#reloadable-secure-settings" target="_top">reloadable</a>)</span></dt><dd>An S3 session token. If set, the <code class="literal">access_key</code> and <code class="literal">secret_key</code> settings
must also be specified.</dd><dt><span class="term"><code class="literal">endpoint</code></span></dt><dd>The S3 service endpoint to connect to. This defaults to <code class="literal">s3.amazonaws.com</code>
but the
<a class="ulink" href="http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region" target="_top">AWS
documentation</a> lists alternative S3 endpoints. If you are using an
<a class="link" href="repository-s3-client.html#repository-s3-compatible-services" title="S3-compatible services">S3-compatible service</a> then you should
set this to the service’s endpoint.</dd><dt><span class="term"><code class="literal">protocol</code></span></dt><dd>The protocol to use to connect to S3. Valid values are either <code class="literal">http</code> or
<code class="literal">https</code>. Defaults to <code class="literal">https</code>.</dd><dt><span class="term"><code class="literal">proxy.host</code></span></dt><dd>The host name of a proxy to connect to S3 through.</dd><dt><span class="term"><code class="literal">proxy.port</code></span></dt><dd>The port of a proxy to connect to S3 through.</dd><dt><span class="term"><code class="literal">proxy.username</code> (<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/secure-settings.html" target="_top">Secure</a>, <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/secure-settings.html#reloadable-secure-settings" target="_top">reloadable</a>)</span></dt><dd>The username to connect to the <code class="literal">proxy.host</code> with.</dd><dt><span class="term"><code class="literal">proxy.password</code> (<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/secure-settings.html" target="_top">Secure</a>, <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.x/secure-settings.html#reloadable-secure-settings" target="_top">reloadable</a>)</span></dt><dd>The password to connect to the <code class="literal">proxy.host</code> with.</dd><dt><span class="term"><code class="literal">read_timeout</code></span></dt><dd>The socket timeout for connecting to S3. The value should specify the unit.
For example, a value of <code class="literal">5s</code> specifies a 5 second timeout. The default value
is 50 seconds.</dd><dt><span class="term"><code class="literal">max_retries</code></span></dt><dd>The number of retries to use when an S3 request fails. The default value is
<code class="literal">3</code>.</dd><dt><span class="term"><code class="literal">use_throttle_retries</code></span></dt><dd>Whether retries should be throttled (i.e. should back off). Must be <code class="literal">true</code>
or <code class="literal">false</code>. Defaults to <code class="literal">true</code>.</dd><dt><span class="term"><code class="literal">path_style_access</code></span></dt><dd>Whether to force the use of the path style access pattern. If <code class="literal">true</code>, the
path style access pattern will be used. If <code class="literal">false</code>, the access pattern will
be automatically determined by the AWS Java SDK (See
<a class="ulink" href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/AmazonS3Builder.html#setPathStyleAccessEnabled-java.lang.Boolean-" target="_top">AWS
documentation</a> for details). Defaults to <code class="literal">false</code>.</dd></dl></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><a id="repository-s3-path-style-deprecation"></a><p>In versions <code class="literal">7.0</code>, <code class="literal">7.1</code>, <code class="literal">7.2</code> and <code class="literal">7.3</code> all bucket operations used the
<a class="ulink" href="https://aws.amazon.com/blogs/aws/amazon-s3-path-deprecation-plan-the-rest-of-the-story/" target="_top">now-deprecated</a>
path style access pattern. If your deployment requires the path style access
pattern then you should set this setting to <code class="literal">true</code> when upgrading.</p></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">disable_chunked_encoding</code></span></dt><dd>Whether chunked encoding should be disabled or not. If <code class="literal">false</code>, chunked
encoding is enabled and will be used where appropriate. If <code class="literal">true</code>, chunked
encoding is disabled and will not be used, which may mean that snapshot
operations consume more resources and take longer to complete. It should
only be set to <code class="literal">true</code> if you are using a storage service that does not
support chunked encoding. See the
<a class="ulink" href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/AmazonS3Builder.html#disableChunkedEncoding--" target="_top">AWS
Java SDK documentation</a> for details. Defaults to <code class="literal">false</code>.</dd></dl></div><h5><a id="repository-s3-compatible-services"></a>S3-compatible services<a href="https://github.com/elastic/elasticsearch/edit/7.x/docs/plugins/repository-s3.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>There are a number of storage systems that provide an S3-compatible API, and
the <code class="literal">repository-s3</code> plugin allows you to use these systems in place of AWS S3.
To do so, you should set the <code class="literal">s3.client.CLIENT_NAME.endpoint</code> setting to the
system’s endpoint. This setting accepts IP addresses and hostnames and may
include a port. For example, the endpoint may be <code class="literal">172.17.0.2</code> or
<code class="literal">172.17.0.2:9000</code>. You may also need to set <code class="literal">s3.client.CLIENT_NAME.protocol</code> to
<code class="literal">http</code> if the endpoint does not support HTTPS.</p><p><a class="ulink" href="https://minio.io" target="_top">Minio</a> is an example of a storage system that provides an
S3-compatible API. The <code class="literal">repository-s3</code> plugin allows Elasticsearch to work with
Minio-backed repositories as well as repositories stored on AWS S3. Other
S3-compatible storage systems may also work with Elasticsearch, but these are not tested
or supported.</p></div><div class="navfooter"><span class="prev"><a href="repository-s3-usage.html">
              « 
              Getting Started</a>
           
        </span><span class="next">
           
          <a href="repository-s3-repository.html">Repository Settings
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
window.initial_state = {}</script>
  </body>
</html>
