<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Google Cloud Platform (GCP)
        | Elastic Cloud Enterprise Reference [2.0]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elastic Cloud Enterprise Reference [2.0]" /><link rel="up" href="ece-configuring.html" title="Prepare Your Environment" /><link rel="prev" href="ece-configure-ami.html" title="Amazon Machine Images (AMIs)" /><link rel="next" href="ece-configure-azure.html" title="Microsoft Azure Virtual Machines" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/CloudEnterprise/Reference/2.0" /><meta name="DC.subject" content="ECE" /><meta name="DC.identifier" content="2.0" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.cookie.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
    <!--
    <script src="https://www.elastic.co/static/js/elastic-apm-js-base.umd.min.2.2.0.js"></script>
    <script type="text/javascript">
      var elasticApm = init({
        serviceName: 'elastic-co-frontend',
        serverUrl: 'https://3ddd1ee09cc242c4b169d36f5a2b8b77.apm.us-west1.gcp.cloud.es.io:443',
        stackTraceLimit: 5,
        serviceVersion: '1.0.0'
      })
    
      var pageLoadName
      var pathname = window.location.pathname.replace(/\/es|\/pt|\/jp|\/pt|\/fr|\/kr|\/cn|\/de/g, '')
      var parts = pathname.split('/');
    
      if (parts.length && parts[1] === 'blog') {
        if (parts.length === 2) {
          pageLoadName =  '/blog';
        }
        else if (parts[2] === 'category') {
          pageLoadName =  '/blog/category';
        }
        else if (parts[2] === 'archive') {
          pageLoadName =  '/blog/archive';
        }
        else {
          pageLoadName =  '/blog/detail';
        }
      }
      else if (parts.length && parts[1] === 'elasticon') {
        if (parts.length === 2) {
          pageLoadName =  '/elasticon';
        }
        else if (parts.length === 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/overview';
        }
        else if (parts.length > 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/video';
        }
      }
      else if (parts.length && parts[1] === 'guide') {
        pageLoadName =  '/guide';
      }
      else if (parts.length === 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos';
      }
      else if (parts.length > 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos/detail';
      }
      else if (parts.length > 2 && parts[1] === 'webinars') {
        pageLoadName =  '/webinars/detail';
      }
      else {
        pageLoadName =  window.location.pathname;
      }
    
      console.log('apm pageLoadName:', pageLoadName, parts)
      elasticApm.setTags({env:"production"});
      elasticApm.setInitialPageLoadName(pageLoadName);
    </script>
    -->

    <!-- Header Section -->
    
    <div id='elastic-nav'></div>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <link rel="stylesheet" type="text/css" href="/static/css/horizon-swiper.min.css">

    <style> 
      .m-shortcuts li a.m-search {
        background: url("/assets/blt7b9c4fe6528dc4ef/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-docs {
        background: url("/assets/blt44d8b7530a76d01c/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-contact {
        background: url("/assets/blt878040795c9d083b/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    </style>

    <script type="text/javascript" src="/static/js/horizon-swiper.min.js"></script>

    <script type="text/javascript">
      $(document).ready( function(){
        // if($('#scrollable-pane li').length > 3){
          $('.horizon-swiper').horizonSwiper({
            showItems: 3,
            arrows: true
          }); 
        // }
        
        $('.navbar-toggle').on('click', function(){
          $('.mobile-navigation, .menu-open').hide();
          $('.navigation-wrapper').addClass('mobile-navigation');
          $('.navbar').addClass('menu-open');
          $('.menu-close').show();
        });
        $('.menu-close').on('click', function(){
          $('.navigation-wrapper').removeClass('mobile-navigation');
          $('.navbar').removeClass('menu-open');
          $('.menu-close').hide();
        });
    
        var active_url = "";
    
        $(".navbar-mobile-header-icon").click(function(index){
          $('.navigation-wrapper').toggleClass('menu-overlay');
          $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
          $(".mobile-inner-nav").slideToggle(500);
          $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
            $(this).css({'animation-delay': (index/25)+'0.4s'});
          });
        });
    
        $('.dropdown-btn').on('click', function(e){
          e.preventDefault();
          setDropdown();
        });
        
        function setDropdown() {
          $('#myDropdown').slideToggle();
        }
    
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {
    
            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
    
      });
      $(window).resize(function () {
        $('.horizon-swiper').horizonSwiper({
          showItems: 3,
          arrows: true
        });
      });
    </script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elastic Cloud Enterprise Reference
      [2.0]
    </a></span> » <span class="breadcrumb-link"><a href="ece-getting-started.html">Getting Started</a></span> » <span class="breadcrumb-link"><a href="ece-configuring.html">Prepare Your Environment</a></span> » <span class="breadcrumb-node">Google Cloud Platform (GCP)</span></div><div class="navheader"><span class="prev"><a href="ece-configure-ami.html">
              « 
              Amazon Machine Images (AMIs)</a>
           
        </span><span class="next">
           
          <a href="ece-configure-azure.html">Microsoft Azure Virtual Machines
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ece-configure-gcp"></a>Google Cloud Platform (GCP)</h2></div></div></div><p>The following steps walk you through creating an instance group with virtual machines on Google Compute Engine in preparation for installing Elastic Cloud Enterprise.</p><p>To learn more about the concepts used in this section, see <a class="ulink" href="https://cloud.google.com/docs/" target="_top">Google Cloud Platform Documentation</a>.</p><p>To set up your GCP instance group with virtual machines:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Log into the <a class="ulink" href="https://console.cloud.google.com" target="_top">Google Cloud Platform console</a>.
</li><li class="listitem"><p class="simpara">
Create an instance template:
</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
Under <span class="strong strong"><strong>Instance Templates</strong></span>, click <span class="strong strong"><strong>CREATE INSTANCE TEMPLATE</strong></span> and name your template.
</li><li class="listitem">
Select a machine type, one of the supported Linux distributions as the boot disk and specify enough storage. Make sure that the template meets the <a class="link" href="ece-prereqs.html" title="Prerequisites">prerequisites</a> for Elastic Cloud Enterprise.
</li><li class="listitem">
Set the Firewall to allow both HTTP and HTTPS access.
</li><li class="listitem">
On the <span class="strong strong"><strong>Networking</strong></span> tab, set IP forwarding to on.
</li><li class="listitem">
On the <span class="strong strong"><strong>SSH keys</strong></span> tab, add your public SSH key.
</li><li class="listitem"><p class="simpara">
Click <span class="strong strong"><strong>Create</strong></span>:
</p><div class="informalfigure"><div class="mediaobject"><img src="images/ece-gcp-template.png" alt="Creating an instance template" /></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
Add a firewall rule:
</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
Under <span class="strong strong"><strong>Instance Templates</strong></span>, select the name of the new template and under <span class="strong strong"><strong>Network</strong></span>, click <span class="strong strong"><strong>default</strong></span>.
</li><li class="listitem"><p class="simpara">
Click <span class="strong strong"><strong>Add firewall rule</strong></span> and select <span class="strong strong"><strong>Allow from any source (0.0.0.0/0)</strong></span>. Enter the following allowed protocols and ports:
</p><pre class="literallayout">tcp:7000; tcp:12375; tcp:12400; tcp:12443; tcp:22191-22195; tcp:12191-12301; tcp:12898-12908; tcp:13898-13908; tcp:2112; tcp:18000-20000; tcp:9200; tcp:9243; tcp:9300; tcp:9343;</pre></li><li class="listitem"><p class="simpara">
Click <span class="strong strong"><strong>Create</strong></span>:
</p><div class="informalfigure"><div class="mediaobject"><img src="images/ece-gcp-firewall.png" alt="Creating an firewall rule" /></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
Create an instance group:
</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
Return to the <span class="strong strong"><strong>Compute Engine</strong></span> panel through the <span class="strong strong"><strong>Products &amp; services</strong></span> menu.
</li><li class="listitem">
Select the <span class="strong strong"><strong>Instance groups</strong></span> panel, click <span class="strong strong"><strong>Create instance group</strong></span>, and name your group.
</li><li class="listitem">
Under <span class="strong strong"><strong>Location</strong></span>, select <span class="strong strong"><strong>Multi-zone</strong></span> and select a region.
</li><li class="listitem"><p class="simpara">
Click <span class="strong strong"><strong>Specify port name mapping</strong></span> and add port 9243, which is the port used by Kibana and Elasticsearch for HTTPS access.
</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>If you are using a load balancer or firewall, consider adding port 443. To add a port, click <span class="strong strong"><strong>Add item</strong></span>. On each host in the Elastic Cloud Enterprise cluster, run <code class="literal">sudo iptables -A PREROUTING -t nat -p tcp --dport 443 -j REDIRECT --to-ports 9243</code>.</p></div></div></li><li class="listitem">
Select the instance template you created earlier.
</li><li class="listitem">
Specify the number of instances to create. For high availability, select at least three instances. These instances are placed into separate zones. See our <a class="link" href="ece-planning.html#ece-topology" title="Deployment Recommendations">deployment recommendations</a> for how many instances you might need to bring up a production Elastic Cloud Enterprise installation.
</li><li class="listitem"><p class="simpara">
Click <span class="strong strong"><strong>Create</strong></span>:
</p><div class="informalfigure"><div class="mediaobject"><img src="images/ece-gcp-group.png" alt="Creating an firewall rule" /></div></div><p class="simpara">Creating the instance group can take a few minutes. After the instances have been created, they appear under <span class="strong strong"><strong>VM instances</strong></span>.</p></li></ol></div></li><li class="listitem"><p class="simpara">
Add a disk to use with XFS to each instance:
</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>We recommend that you add disks with a minimum of 100GB of storage each to avoid performance bottlenecks due to GCP IOPS provisioning. To learn more about how increasing your persistent disk size on GCP also increases IOPS and throughput, see <a class="ulink" href="https://cloud.google.com/compute/docs/disks/performance#ssd-pd-performance" target="_top">Optimizing Persistent Disk and Local SSD Performance</a>.</p></div></div><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>If you use XFS, you must use XFS on all allocators.</p></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
Under <span class="strong strong"><strong>VM instances</strong></span>, select one of the instances and click <span class="strong strong"><strong>EDIT</strong></span>.
</li><li class="listitem">
Under <span class="strong strong"><strong>Additional disk</strong></span>, select to add an item and then select the <span class="strong strong"><strong>Name</strong></span> dropdown to create a new disk.
</li><li class="listitem">
Name your disk. If you plan to use the configuration script in a subsequent step, make sure that the additional disks are named <code class="literal">esdata-1</code>, <code class="literal">esdata-2</code>, and so forth.
</li><li class="listitem">
Specify the storage type you need for your <a class="link" href="ece-planning.html" title="Plan Your Deployment">type of workload</a>.
</li><li class="listitem">
Create a blank disk by selecting <span class="strong strong"><strong>None (blank disk)</strong></span> for the source type.
</li><li class="listitem">
Click <span class="strong strong"><strong>Create</strong></span> to create the new disks.
</li><li class="listitem"><p class="simpara">
Click <span class="strong strong"><strong>Save</strong></span> to add the new disk to your instance.
</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>Don’t forget to save your updated instance after adding the disk to make sure it is available for use. You will set up XFS when you configure the instances.</p></div></div></li><li class="listitem">
Repeat these steps until you have added disks to all instances.
</li></ol></div></li><li class="listitem"><p class="simpara">
<a class="link" href="ece-configuring.html#ece-configure-hosts">Configure the new instances</a> with a user ID that has sudo permission.
</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>For Ubuntu 14.04 LTS, a <a class="ulink" href="https://raw.githubusercontent.com/elastickent/ece_utils/master/gcp/bootstrap.sh" target="_top">configuration script</a> is available that configures the hosts for you. This script is provided as-is and requires your additional disks to be named <code class="literal">esdata-1</code>, <code class="literal">esdata-2</code>, and so forth. After the script reboots your instances, they are ready for Elastic Cloud Enterprise.</p></div></div></li></ol></div><p>Next steps: When your Google Compute Engine virtual machines are up and running, you can connect to them and <a class="link" href="ece-installing.html" title="Install ECE With Internet Access">install Elastic Cloud Enterprise</a>. Afterwards, add your load balancer. To learn more about load balancing that is available with GCP, see <a class="ulink" href="https://cloud.google.com/load-balancing/" target="_top">Google Cloud Load Balancing</a>.</p></div><div class="navfooter"><span class="prev"><a href="ece-configure-ami.html">
              « 
              Amazon Machine Images (AMIs)</a>
           
        </span><span class="next">
           
          <a href="ece-configure-azure.html">Microsoft Azure Virtual Machines
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<!-- Footer Section end-->

<script src='https://www.elastic.co/elastic-nav.js'></script>
<script src='https://www.elastic.co/elastic-footer.js'></script>
      </section>
    </div>

    
<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
window.initial_state = {}
</script>

  </body>
</html>
