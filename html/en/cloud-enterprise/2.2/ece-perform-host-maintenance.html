<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Perform host maintenance
        | Elastic Cloud Enterprise Reference [2.2]
      | Elastic
    </title><link rel="home" href="index.html" title="Elastic Cloud Enterprise Reference [2.2]" /><link rel="up" href="ece-administering-ece.html" title="Administering your installation" /><link rel="prev" href="ece-delete-runner.html" title="Delete runners" /><link rel="next" href="ece-manage-elastic-stack.html" title="Manage Elastic Stack versions" /><meta name="DC.type" content="Learn/Docs/CloudEnterprise/Reference/2.2" /><meta name="DC.subject" content="ECE" /><meta name="DC.identifier" content="2.2" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elastic Cloud Enterprise Reference
      [2.2]
    </a></span> » <span class="breadcrumb-link"><a href="ece-administering-ece.html">Administering your installation</a></span> » <span class="breadcrumb-node">Perform host maintenance</span></div><div class="navheader"><span class="prev"><a href="ece-delete-runner.html">
              « 
              Delete runners</a>
           
        </span><span class="next">
           
          <a href="ece-manage-elastic-stack.html">Manage Elastic Stack versions
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="ece-perform-host-maintenance"></a>Perform host maintenance</h2></div></div></div><p>These steps show how you can safely perform maintenance on hosts in your ECE installation. Host maintenance refers to actions that are not part of taking care of Elastic Cloud Enterprise itself and that you might need to perform for a number of different reasons, including:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
To apply urgent operating system patches or hot fixes
</li><li class="listitem">
To perform regularly scheduled software or hardware upgrades
</li><li class="listitem">
To enable new features, such as encryption of data at rest
</li><li class="listitem">
To meet updated installation prerequisites
</li></ul></div><p>You can perform these maintenance actions on your hosts using one of these methods:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<a class="link" href="ece-perform-host-maintenance.html#ece-perform-host-maintenance-docker-disable" title="By disabling the Docker daemon">By disabling the Docker daemon (nondestructive)</a>
</li><li class="listitem">
<a class="link" href="ece-perform-host-maintenance.html#ece-perform-host-maintenance-delete-runner" title="By deleting the runner">By deleting the runner from your ECE installation (destructive)</a>
</li></ul></div><p>Which method you choose depends on how invasive your host maintenance needs to be. If your host maintenance could affect ECE, use the destructive method that first deletes the runner from your installation. Both methods include a step that moves any hosted Elasticsearch clusters and Kibana instances off the affected runners and are generally considered safe, provided that your ECE installation still has sufficient resources available to operate after the host has been removed.</p><h3><a id="ece-perform-host-maintenance-docker-disable"></a>By disabling the Docker daemon</h3><p>This method lets you perform maintenance actions on hosts without first removing the associated runner from your Elastic Cloud Enterprise installation. It works by disabling the Docker daemon. The runner remains a part of your ECE installation throughout these steps but will be offline and the resources it provides will not be available.</p><p>To perform host maintenance:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
Recommended: If the runner holds the allocator role and you have enough spare capacity:
</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
<a class="link" href="ece-maintenance-mode.html" title="Enable maintenance mode">Enable maintenance mode</a> on the allocator.
</li><li class="listitem">
<a class="link" href="ece-move-nodes.html" title="Move nodes or instances from allocators">Move all nodes off the allocator</a> and to other allocators in your installation. Moving all nodes lets you retain the same level of redundancy for highly available Elasticsearch clusters and ensures that other clusters without high availability remain available.
</li></ol></div><div class="important admon"><div class="icon"></div><div class="admon_content"><p>Skipping Step 1 will affect the availability of clusters with nodes on the allocator. Skip at your own risk.</p></div></div></li><li class="listitem"><p class="simpara">
Disable the Docker daemon:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
On Ubuntu 14.04:
</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">sudo service docker stop</pre></div></li><li class="listitem"><p class="simpara">
On Ubuntu 16.04, RHEL 7, and CentOS 7:
</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">sudo systemctl disable docker
sudo systemctl disable docker.socket</pre></div></li></ul></div></li><li class="listitem"><p class="simpara">
Reboot the host:
</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">sudo reboot</pre></div></li><li class="listitem">
Perform your maintenance on the host, such as patching the operating system.
</li><li class="listitem"><p class="simpara">
Enable the Docker daemon:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
On Ubuntu 14.04:
</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">sudo service docker restart</pre></div></li><li class="listitem"><p class="simpara">
On Ubuntu 16.04, RHEL 7, and CentOS 7:
</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">sudo systemctl enable docker
sudo systemctl enable docker.socket</pre></div></li></ul></div></li><li class="listitem"><p class="simpara">
Reboot the host again:
</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">sudo reboot</pre></div></li><li class="listitem">
If you enabled maintenance mode in Step 1: Take the allocator out of maintenance mode.
</li><li class="listitem">
Optional for allocators: ECE will start using the allocator again as you create new or change existing clusters, but it will not automatically redistribute nodes to an allocator after it becomes available. If you want to move nodes back to the same allocator after host maintenance, you need to manually <a class="link" href="ece-move-nodes.html" title="Move nodes or instances from allocators">move the nodes</a> and specify the allocator as a target.
</li><li class="listitem">
Verify that all ECE services and deployments are back up by checking that the runner shows a green status in the Cloud UI.
</li></ol></div><p>After the runner shows a green status in the Cloud UI, it is fully functional again and can be used as before.</p><h3><a id="ece-perform-host-maintenance-delete-runner"></a>By deleting the runner</h3><p>This method lets you perform potentially destructive maintenance actions on hosts. It works by deleting the associated runner, which removes the host from your Elastic Cloud Enterprise installation. To add the runner to your ECE installation again after host maintenance is complete, you must reinstall ECE.</p><p>To perform host maintenance:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
If the runner holds the allocator role:
</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
<a class="link" href="ece-maintenance-mode.html" title="Enable maintenance mode">Enable maintenance mode</a> on the allocator.
</li><li class="listitem">
<a class="link" href="ece-move-nodes.html" title="Move nodes or instances from allocators">Move all nodes off the allocator</a> and to other allocators in your installation. Moving all nodes lets you retain the same level of redundancy for highly available clusters and ensures that other clusters without high availability remain available.
</li></ol></div><div class="important admon"><div class="icon"></div><div class="admon_content"><p>Do not skip this step or you will affect the availability of clusters with nodes on the allocator. You are in the process of removing the runner from your installation and whatever ECE artifacts are stored on it will be lost.</p></div></div></li><li class="listitem">
<a class="link" href="ece-delete-runner.html" title="Delete runners">Delete the runner from your ECE installation</a>.
</li><li class="listitem">
Perform the maintenance on your host, such as enabling encryption of data at rest.
</li><li class="listitem">
<a class="link" href="ece-installing-online.html#ece-installing-additional" title="Install on additional hosts">Reinstall ECE on the host as if it were a new runner and assign the same roles as before</a>.
</li><li class="listitem">
Optional for allocators: ECE will start using the allocator again as you create new or change existing clusters, but it will not automatically redistribute nodes to an allocator after it becomes available. If you want to move nodes back to the same allocator after host maintenance, you need to manually <a class="link" href="ece-move-nodes.html" title="Move nodes or instances from allocators">move the nodes</a> and specify the allocator as a target.
</li></ol></div><p>After the runner shows a green status in the Cloud UI, the host is part of your ECE installation again and can be used as before.</p></div><div class="navfooter"><span class="prev"><a href="ece-delete-runner.html">
              « 
              Delete runners</a>
           
        </span><span class="next">
           
          <a href="ece-manage-elastic-stack.html">Manage Elastic Stack versions
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
