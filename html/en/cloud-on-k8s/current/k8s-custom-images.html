<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Creating custom images
        | Elastic Cloud on Kubernetes [1.0]
      | Elastic
    </title><link rel="home" href="index.html" title="Elastic Cloud on Kubernetes [1.0]" /><link rel="up" href="index.html" title="Elastic Cloud on Kubernetes [1.0]" /><link rel="prev" href="k8s-apm-server.html" title="Running APM Server on ECK" /><link rel="next" href="k8s-operator-config.html" title="Configuring ECK" /><meta name="DC.type" content="Learn/Docs/Kubernetes/Reference/1.0" /><meta name="DC.subject" content="ECK" /><meta name="DC.identifier" content="1.0" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at the documentation for a beta release.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elastic Cloud on Kubernetes
      [1.0]
    </a></span> » <span class="breadcrumb-node">Creating custom images</span></div><div class="navheader"><span class="prev"><a href="k8s-apm-server.html">
              « 
              Running APM Server on ECK</a>
           
        </span><span class="next">
           
          <a href="k8s-operator-config.html">Configuring ECK
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="k8s-custom-images"></a>Creating custom images<a href="https://github.com/elastic/cloud-on-k8s/edit/1.0/docs/custom-images.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h1></div></div></div><p>You can create your own custom Elasticsearch or Kibana image instead of using the base image provided by Elastic. You might want to do this to preload plugins in the image rather than having to <a class="ulink" href="k8s-init-containers-plugin-downloads.html" target="_top">install them via init container</a> each time a pod starts. To do this, you must use the official image as the base for it to function properly. For example, if you want to create an Elasticsearch 7.3.2 image with the <a class="ulink" href="/guide/en/elasticsearch/plugins/master/repository-gcs.html" target="_top">Google Cloud Storage Repository Plugin</a>, you can do the following:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Create a <code class="literal">Dockerfile</code> containing:</p><pre class="screen">FROM docker.elastic.co/elasticsearch/elasticsearch:7.3.2
RUN bin/elasticsearch-plugin install --batch repository-gcs</pre></li><li class="listitem"><p class="simpara">Build the image with:</p><pre class="screen">docker build --tag elasticsearch-gcs:7.3.2</pre></li></ol></div><p>There are various hosting options for your images. If you use Google Kubernetes Engine, it is automatically configured to use the Google Container Registry (see <a class="ulink" href="https://cloud.google.com/container-registry/docs/using-with-google-cloud-platform#google-kubernetes-engine" target="_top">here</a> for more information). To use the image, you can then <a class="ulink" href="https://cloud.google.com/container-registry/docs/pushing-and-pulling#pushing_an_image_to_a_registry" target="_top">push to the registry</a> with:</p><pre class="screen">docker tag elasticsearch-gcs:7.3.2 gcr.io/$PROJECT-ID/elasticsearch-gcs:7.3.2
docker push gcr.io/$PROJECT-ID/elasticsearch-gcs:7.3.2</pre><p>Configure your Elasticsearch specification to use the newly pushed image, for example:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">spec:
  image: gcr.io/$PROJECT-ID/elasticsearch-gcs:7.3.2</pre></div><p>The steps are similar for <a class="ulink" href="https://docs.microsoft.com/en-us/azure/aks/tutorial-kubernetes-prepare-acr" target="_top">Azure Kubernetes Service</a> and <a class="ulink" href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/docker-basics.html#use-ecr" target="_top">AWS Elastic Container Registry</a>.</p><p>For more information, you can check the following references:</p><h3><a id="k8s-references"></a>References<a href="https://github.com/elastic/cloud-on-k8s/edit/1.0/docs/custom-images.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><a class="ulink" href="/guide/en/elasticsearch/reference/current/docker.html#_c_customized_image" target="_top">Elasticsearch doc on creating custom images</a></li><li class="listitem"><a class="ulink" href="https://cloud.google.com/container-registry/docs/how-to" target="_top">Google Container Registry docs</a></li><li class="listitem"><a class="ulink" href="https://docs.microsoft.com/en-us/azure/container-registry/" target="_top">Azure Container Registry docs</a></li><li class="listitem"><a class="ulink" href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/what-is-ecr.html" target="_top">Amazon Elastic Container Registry docs</a></li><li class="listitem"><a class="ulink" href="https://docs.openshift.com/container-platform/4.1/registry/architecture-component-imageregistry.html" target="_top">OpenShift Container Platform registry docs</a></li></ul></div></div><div class="navfooter"><span class="prev"><a href="k8s-apm-server.html">
              « 
              Running APM Server on ECK</a>
           
        </span><span class="next">
           
          <a href="k8s-operator-config.html">Configuring ECK
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
