<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Setting Up SSL/TLS on a Cluster
        | Shield Reference [2.2]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Shield Reference [2.2]" /><link rel="up" href="securing-communications.html" title="Securing Communications with Encryption and IP Filtering" /><link rel="prev" href="securing-communications.html" title="Securing Communications with Encryption and IP Filtering" /><link rel="next" href="ciphers.html" title="Enabling Cipher Suites for Stronger Encryption" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Legacy/Shield/Reference/2.2" /><meta name="DC.subject" content="Shield" /><meta name="DC.identifier" content="2.2" /><meta name="robots" content="noindex,nofollow" />
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <!-- DC tags section -->
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
    <link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >
    
    <!-- end DC tags -->
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.cookie.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
      // -------------------- set language based on browser language --------------------
      var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
      locales = {
        '/en':'/',
        '/de/': '/de/',
        '/fr/': '/fr/',
        '/ja/':'/jp/',
        '/ko/':'/kr/',
        '/zh/':'/cn/',
        '/es/': '/es/'
      },
      localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}',
      currentlocale = JSON.parse(localeUrl).relative_url_prefix;

      if($.cookie("is_lang_detected") == undefined){
        if(locales[lang] != undefined && locales[lang] != currentlocale){
          locale_lang_url = locales[lang] + window.location.pathname.slice(1,window.location.pathname.length);
          $.cookie("is_lang_detected",true ,{ path: '/'});
          window.location = locale_lang_url;
        }
      }
            
      // --------------------- end of set language based on browser language -----------------
    </script>
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  

</head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
    <!--
    <script src="https://www.elastic.co/static/js/elastic-apm-js-base.umd.min.2.2.0.js"></script>
    <script type="text/javascript">
      var elasticApm = init({
        serviceName: 'elastic-co-frontend',
        serverUrl: 'https://3ddd1ee09cc242c4b169d36f5a2b8b77.apm.us-west1.gcp.cloud.es.io:443',
        stackTraceLimit: 5,
        serviceVersion: '1.0.0'
      })
    
      var pageLoadName
      var pathname = window.location.pathname.replace(/\/es|\/pt|\/jp|\/pt|\/fr|\/kr|\/cn|\/de/g, '')
      var parts = pathname.split('/');
    
      if (parts.length && parts[1] === 'blog') {
        if (parts.length === 2) {
          pageLoadName =  '/blog';
        }
        else if (parts[2] === 'category') {
          pageLoadName =  '/blog/category';
        }
        else if (parts[2] === 'archive') {
          pageLoadName =  '/blog/archive';
        }
        else {
          pageLoadName =  '/blog/detail';
        }
      }
      else if (parts.length && parts[1] === 'elasticon') {
        if (parts.length === 2) {
          pageLoadName =  '/elasticon';
        }
        else if (parts.length === 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/overview';
        }
        else if (parts.length > 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/video';
        }
      }
      else if (parts.length && parts[1] === 'guide') {
        pageLoadName =  '/guide';
      }
      else if (parts.length === 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos';
      }
      else if (parts.length > 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos/detail';
      }
      else if (parts.length > 2 && parts[1] === 'webinars') {
        pageLoadName =  '/webinars/detail';
      }
      else {
        pageLoadName =  window.location.pathname;
      }
    
      console.log('apm pageLoadName:', pageLoadName, parts)
      elasticApm.setTags({env:"production"});
      elasticApm.setInitialPageLoadName(pageLoadName);
    </script>
    -->

    <!-- Header Section -->
    
    <div id='elastic-nav'></div>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <link rel="stylesheet" type="text/css" href="/static/css/horizon-swiper.min.css">

    <style> 
      .m-shortcuts li a.m-search {
        background: url("/assets/blt7b9c4fe6528dc4ef/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-docs {
        background: url("/assets/blt44d8b7530a76d01c/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-contact {
        background: url("/assets/blt878040795c9d083b/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    </style>

    <script type="text/javascript" src="/static/js/horizon-swiper.min.js"></script>

    <script type="text/javascript">
      $(document).ready( function(){
        // if($('#scrollable-pane li').length > 3){
          $('.horizon-swiper').horizonSwiper({
            showItems: 3,
            arrows: true
          }); 
        // }
        
        $('.navbar-toggle').on('click', function(){
          $('.mobile-navigation, .menu-open').hide();
          $('.navigation-wrapper').addClass('mobile-navigation');
          $('.navbar').addClass('menu-open');
          $('.menu-close').show();
        });
        $('.menu-close').on('click', function(){
          $('.navigation-wrapper').removeClass('mobile-navigation');
          $('.navbar').removeClass('menu-open');
          $('.menu-close').hide();
        });
    
        var active_url = "";
    
        $(".navbar-mobile-header-icon").click(function(index){
          $('.navigation-wrapper').toggleClass('menu-overlay');
          $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
          $(".mobile-inner-nav").slideToggle(500);
          $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
            $(this).css({'animation-delay': (index/25)+'0.4s'});
          });
        });
    
        $('.dropdown-btn').on('click', function(e){
          e.preventDefault();
          setDropdown();
        });
        
        function setDropdown() {
          $('#myDropdown').slideToggle();
        }
    
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {
    
            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
    
      });
      $(window).resize(function () {
        $('.horizon-swiper').horizonSwiper({
          showItems: 3,
          arrows: true
        });
      });
    </script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <!-- start body -->
                
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="page_header">From version 5.0 onward, Shield is part of X-Pack. For more information, see
<a href=https://www.elastic.co/guide/en/elastic-stack-overview/current/elasticsearch-security.html>
    Securing the Elastic Stack</a>. 
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Shield Reference
      [2.2]
    </a></span> » <span class="breadcrumb-link"><a href="securing-communications.html">Securing Communications with Encryption and IP Filtering</a></span> » <span class="breadcrumb-node">Setting Up SSL/TLS on a Cluster</span></div><div class="navheader"><span class="prev"><a href="securing-communications.html">
              « 
              Securing Communications with Encryption and IP Filtering</a>
           
        </span><span class="next">
           
          <a href="ciphers.html">Enabling Cipher Suites for Stronger Encryption
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ssl-tls"></a>Setting Up SSL/TLS on a Cluster</h2></div></div></div><p>Shield enables you to encrypt traffic to and from nodes in your Elasticsearch cluster. Connections
are secured using Transport Layer Security (TLS).</p><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>Nodes that do not have encryption enabled send passwords in plain text.</p></div></div><p>To enable encryption, you need to perform the following steps on each node in the cluster:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><a class="link" href="ssl-tls.html#installing-node-certificates" title="Installing Node Certificates">Install an X.509 certificate</a>.</li><li class="listitem"><p class="simpara"><a class="link" href="ssl-tls.html#configure-ssl">Configure the node</a> to:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">Identify itself using its signed certificate.</li><li class="listitem">Enable SSL on the transport and HTTP layers.</li><li class="listitem">Configure the unicast hosts the node can contact to join the cluster.</li></ol></div></li><li class="listitem">Restart Elasticsearch.</li></ol></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="installing-node-certificates"></a>Installing Node Certificates</h3></div></div></div><p>Node certificates should be signed by a certificate authority (CA) that is trusted by every node
in the cluster. You can use a third-party CA, your organization’s existing CA, or
<a class="link" href="certificate-authority.html" title="Setting Up a Certificate Authority">set up a certificate authority</a> specifically for signing node certificates.</p><p>When a client connects to a node using SSL/TLS, the node presents its certificate to the
client and proves that it owns the private key linked with the certificate. The client then
determines if the node’s certificate is valid, trusted, and matches the hostname or IP address
it is trying to connect to. A node acts as a client when connecting to other nodes in the cluster,
so every node must trust all of the other nodes in the cluster.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>While it is technically possible to use self-signed certificates, we strongly recommend using certificates signed by a CA to establish trust between nodes. Self-signed certificates must be trusted individually, which means that each node must have every other node’s certificate installed. If you add a node to the cluster, you have to install the new node’s self-signed certificate on all of the existing nodes and restart them. When you use CA-signed certificates, the existing nodes just need to trust the CA used to sign the new node’s certificate. (You should use the same CA to sign all of your node certificates.)</p></div></div><p>To install a signed certificate, you need to:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><a class="link" href="ssl-tls.html#private-key" title="Creating a Keystore and Generating a Certificate">Create a keystore and generate a certificate for the node</a>.</li><li class="listitem"><a class="link" href="ssl-tls.html#generate-csr" title="Creating a Certificate Signing Request">Create a certificate signing request (CSR)</a>.</li><li class="listitem"><a class="link" href="ssl-tls.html#send-csr" title="Send the Signing Request">Send the certificate to your CA for signing</a>.</li><li class="listitem"><a class="link" href="ssl-tls.html#install-signed-cert" title="Install the Signed Certificate">Add the signed certificate to the node’s keystore</a>.</li></ol></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="private-key"></a>Creating a Keystore and Generating a Certificate</h4></div></div></div><p>To create a keystore and generate a node certificate:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Create a node keystore and import your CA’s certificate with <a class="ulink" href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/keytool.html" target="_top">Java Keytool</a>. This configures the node to trust certificates signed by the CA. For Elasticsearch
to access the keystore, it must be located under the Elasticsearch configuration directory. For example, the following command creates a keystore for <code class="literal">node01</code> and and imports the CA certificate <code class="literal">cacert.pem</code>.</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">cd CONFIG_DIR/shield
keytool -importcert -keystore node01.jks -file cacert.pem -alias my_ca</pre></div><p class="simpara">The Java keystore file (.jks) securely stores certificates for the node. The CA cert must be a
PEM encoded certificate.</p><p class="simpara">When you create a keystore, you are prompted to set a password. This password protects the
integrity of the keystore. You need to provide it whenever you interact with the keystore.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>When the CA certificate expires, you must update the node’s keystore with the new CA
certificate.</p></div></div><p class="simpara">You can also store the CA certificate in a separate truststore. For more
information, see <a class="link" href="ssl-tls.html#create-truststore" title="Configuring a Separate Truststore">Configuring a Truststore</a>.</p></li><li class="listitem"><p class="simpara">Generate a private key and certificate for the node with Java Keytool. For example, the following
command creates a key and certificate for <code class="literal">node01</code>:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">keytool -genkey -alias node01 -keystore node01.jks -keyalg RSA -keysize 2048 -validity 712 -ext san=dns:node01.example.com,ip:192.168.1.1</pre></div><p class="simpara">This command creates an RSA private key with a key size of 2048 bits and a public certificate that
is valid for 712 days. The key and certificate are stored in the <code class="literal">node01.jks</code> keystore.</p><p class="simpara">The <code class="literal">san</code> value specifies all alternative names for the node. The generated certificate is valid for the DNS names and IP addresses specified as alternative names. You can specify multiple DNS or IP address entries as a comma-separated list.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><h3>Specifying the Node Identity</h3><p>With SSL/TLS is enabled, when node A connects to node B, node A normally verifies the identity of
node B by checking the identity information specified in node B’s certificate. This means that you
must include node identity information when you create a node’s certificate.</p><p>The recommended way to specify the node identity when creating a certificate is to specify the
<code class="literal">-ext</code> option and list all of the node’s names and IP addresses in the <code class="literal">san</code>
(Subject Alternative Name) attribute.</p><p>If you use a commercial CA, the DNS names and IP addresses used to identify a node must be publicly resolvable. Internal DNS names and private IP addresses are not accepted due to
<a class="ulink" href="https://cabforum.org/internal-names/" target="_top">security concerns</a>.</p><p>If you need to use private DNS names and IP addresses, using an internal CA is the most secure
option. It enables you to specify node identities and ensure node identities are verified when
nodes connect. If you must use a commercial CA and private DNS names or IP addresses, you cannot
include the node identity in the certificate, so the only option is to disable
<a class="link" href="ref-shield-settings.html#ref-ssl-tls-settings" title="TLS/SSL Settings">hostname verification</a>.</p></div></div><p class="simpara">When you run <code class="literal">keytool -genkey</code>, Keytool prompts you for the information needed to populate the
node’s distinguished name that’s stored the certificate. For example:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">What is your first and last name?
  [Unknown]:  Elasticsearch node01 <a id="CO10-1"></a><i class="conum" data-value="1"></i>
What is the name of your organizational unit?
  [Unknown]:  test
What is the name of your organization?
  [Unknown]:  Elasticsearch
What is the name of your City or Locality?
  [Unknown]:  Amsterdam
What is the name of your State or Province?
  [Unknown]:  Amsterdam
What is the two-letter country code for this unit?
  [Unknown]:  NL
Is CN=Elasticsearch node01, OU=test, O=elasticsearch, L=Amsterdam, ST=Amsterdam, C=NL correct?
  [no]:  yes

Enter key password for &lt;node01&gt; <a id="CO10-2"></a><i class="conum" data-value="2"></i>
    (RETURN if same as keystore password):</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO10-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>Provides information about the node that this certificate is intended for. In the past, this field specified the node’s identity using a DNS name, but that behavior has been deprecated.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO10-2"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>If you don’t specify a password for the certificate, the keystore password is used.</p></td></tr></table></div><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><h3>Extended Key Usage</h3><p>The Extended Key Usage attribute in a certificate is used to indicate the purpose of the key. By default <code class="literal">keytool</code> does not set this attribute in the certificate. If you are generating your certificates with another tool, please ensure the certificates support both <code class="literal">serverAuth</code> and <code class="literal">clientAuth</code> if the Extended Key Usage attribute is set.</p></div></div></li></ol></div><h5><a id="generate-csr"></a>Creating a Certificate Signing Request</h5><p>A node’s certificate needs to be signed by a trusted CA for the certificate to be trusted. To get a certificate signed, you need to create a certificate signing request (CSR) and send it to your CA.</p><p>To create a CSR with Java Keytool, use the <code class="literal">keytool t-certreq</code> command. You specify the same alias, keystore, key algorithm, and DNS names and IP addresses that you used when you created the node certificate. Specify where you want to store the CSR with the <code class="literal">-file</code> option.</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">keytool -certreq -alias node01 -keystore node01.jks -file node01.csr -keyalg rsa -ext san=dns:node01.example.com,ip:192.168.1.1</pre></div><h5><a id="send-csr"></a>Send the Signing Request</h5><p>To get a signed certificate, send the generated CSR file to your CA. The CA will sign it and send
you the signed version of the certificate.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>If you are running your own CA, see <a class="link" href="certificate-authority.html#sign-csr" title="Signing CSRs">Signing CSRs</a> for signing instructions.</p></div></div><h5><a id="install-signed-cert"></a>Install the Signed Certificate</h5><p>To install the signed certificate, use <code class="literal">keytool -importcert</code> to add it to the node’s keystore. You
specify the same alias and keystore that you used when you created the node certificate.</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">cd CONFIG_DIR/shield
keytool -importcert -keystore node01.jks -file node01-signed.crt -alias node01</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>If you attempt to import a PEM-encoded certificate that contains extra text headers, you might get
the error: <code class="literal">java.security.cert.CertificateParsingException: invalid DER-encoded certificate data</code>.
Use the following <code class="literal">openssl</code> command to remove the extra headers and then use <code class="literal">keytool</code> to import
the certificate.</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">openssl x509 -in node01-signed.crt -out node01-signed-noheaders.crt</pre></div></div></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="enable-ssl"></a>Enabling SSL in the Node Configuration</h3></div></div></div><p>Once you have added the signed certificate to the node’s keystore, you need to modify the node
configuration to enable SSL.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>All SSL/TLS related node settings that are considered to be highly sensitive and therefore
are not exposed via the <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.2/cluster-nodes-info.html#cluster-nodes-info" target="_top">nodes info API</a>.</p></div></div><p><a id="configure-ssl"></a>To enable SSL, make the following changes in <code class="literal">elasticsearch.yml</code>:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Specify the location of the node’s keystore and the password(s) needed to access the node’s
certificate. For example:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">shield.ssl.keystore.path:          /home/es/config/shield/node01.jks <a id="CO11-1"></a><i class="conum" data-value="1"></i>
shield.ssl.keystore.password:      myPass <a id="CO11-2"></a><i class="conum" data-value="2"></i>
shield.ssl.keystore.key_password:  myKeyPass <a id="CO11-3"></a><i class="conum" data-value="3"></i></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO11-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>The full path to the node keystore file. This must be a location within the Elasticsearch
configuration directory.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO11-2"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>The password used to access the keystore.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO11-3"><i class="conum" data-value="3"></i></a> </p></td><td valign="top" align="left"><p>The password used to access the certificate. This is only required if you specified a separate
certificate password when generating the certificate.</p></td></tr></table></div><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>You don’t have to store your passwords in plain text in <code class="literal">elasticsearch.yml</code>.
Specify <code class="literal">${prompt.secret}</code> in place of the actual keystore and certificate passwords and
Elasticsearch will prompt for them on startup. For more information, see <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.2/setup-configuration.html#styles" target="_top">
Configuration Styles</a> in the Elasticsearch Reference.
]</p></div></div></li><li class="listitem"><p class="simpara">Enable SSL on the transport networking layer to ensure that communication between nodes is
encrypted:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">shield.transport.ssl: true</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Transport clients can only connect to the cluster with a valid username and password even if
this setting is disabled.</p></div></div></li><li class="listitem"><p class="simpara">Enable SSL on the HTTP layer to ensure that communication between HTTP clients and the cluster is encrypted:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">shield.http.ssl: true</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>HTTP clients can only connect to the cluster with a valid username and password even if this
setting is disabled.</p></div></div></li><li class="listitem"><p class="simpara">Specify the <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.2/modules-discovery-zen.html#unicast" target="_top">unicast hosts</a> the node can contact to join the cluster:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">discovery.zen.ping.unicast.hosts: ["node01:9300", "node02:9301"]</pre></div></li><li class="listitem">Restart Elasticsearch so these configuration changes take effect.</li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="create-truststore"></a>Configuring a Separate Truststore</h3></div></div></div><p>You can store trusted CA certificates in a node’s keystore, or create a separate truststore for CA
certificates.</p><p>To use a separate truststore:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Create a node truststore and import the CA certificate(s) you want to trust with Java Keytool. For example, the following command imports the CA certificate <code class="literal">cacert.pem</code> into <code class="literal">truststore.jks</code>. If the specified truststore doesn’t exist, it is created.</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">cd CONFIG_DIR/shield
keytool -importcert -keystore truststore.jks -file cacert.pem</pre></div><p class="simpara">When you create a truststore, you are prompted to set a password. This password protects the
integrity of the truststore. You need to provide it whenever you interact with the truststore.</p></li><li class="listitem"><p class="simpara">In <code class="literal">elasticsearch.yml</code>, specify the location of the node’s truststore and the password needed to
access it. For example:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">shield.ssl.truststore.path:          /home/es/config/shield/truststore.jks <a id="CO12-1"></a><i class="conum" data-value="1"></i>
shield.ssl.truststore.password:      myPass <a id="CO12-2"></a><i class="conum" data-value="2"></i></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO12-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>The full path to the truststore file. This must be a location within the
Elasticsearch configuration directory.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO12-2"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>The password needed to access the truststore.</p></td></tr></table></div></li></ol></div></div></div><div class="navfooter"><span class="prev"><a href="securing-communications.html">
              « 
              Securing Communications with Encryption and IP Filtering</a>
           
        </span><span class="next">
           
          <a href="ciphers.html">Enabling Cipher Suites for Stronger Encryption
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'</div>
<!-- Footer Section end-->

<script src='https://www.elastic.co/elastic-nav.js'></script>
<script src='https://www.elastic.co/elastic-footer.js'></script>

<style type="text/css">
	
        
            .Facebook a {background:url("/assets/bltf546ff2e0a8f2de5/facebook.svg") no-repeat;}
            .Facebook a:before {
                content: url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Facebook a:hover {background:url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg")}		
        
	
        
            .Twitter a {background:url("/assets/bltdd9556d6b24e2b85/twitter.svg") no-repeat;}
            .Twitter a:before {
                content: url("/assets/blt90b0372cc07a54d3/twitter-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Twitter a:hover {background:url("/assets/blt90b0372cc07a54d3/twitter-hover.svg")}		
        
	
        
            .LinkedIn a {background:url("/assets/bltc4a77e0f52ce07f1/linkedin.svg") no-repeat;}
            .LinkedIn a:before {
                content: url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .LinkedIn a:hover {background:url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg")}		
        
	
        
            .Xing a {background:url("/assets/bltc6347078dcc9ec76/xing.svg") no-repeat;}
            .Xing a:before {
                content: url("/assets/bltededebe5f7521a39/xing-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Xing a:hover {background:url("/assets/bltededebe5f7521a39/xing-hover.svg")}		
        
	
        
            .YouTube a {background:url("/assets/blt4982061ce1aebc7f/youtube.svg") no-repeat;}
            .YouTube a:before {
                content: url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .YouTube a:hover {background:url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg")}		
        
	
</style>

      </section>
    </div>

    
<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/static/js/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script src="/static/js/nav-v5.js"></script>
<script src="/static/js/script.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
  
            <script type="text/javascript">
window.initial_state = {}
</script>

            </body>
        
</html>
