<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Shield with Logstash
        | Shield - Elasticsearch Security Plugin [shield-1.1]
      | Elastic
    </title><link rel="home" href="index.html" title="Shield - Elasticsearch Security Plugin [shield-1.1]" /><link rel="up" href="clients.html" title="Integrating Shield with clients" /><link rel="prev" href="_http_rest_clients.html" title="HTTP/REST Clients" /><link rel="next" href="marvel.html" title="Shield with Marvel" /><meta name="DC.type" content="Learn/Docs/Legacy/Shield/Reference/shield-1.1" /><meta name="DC.subject" content="Shield" /><meta name="DC.identifier" content="shield-1.1" /><meta name="robots" content="noindex,nofollow" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">From version 5.0 onward, Shield is part of X-Pack. For more information, see
<a href=https://www.elastic.co/guide/en/elastic-stack-overview/current/elasticsearch-security.html>
    Securing the Elastic Stack</a>. 
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Shield - Elasticsearch Security Plugin
      [shield-1.1]
    </a></span> » <span class="breadcrumb-link"><a href="clients.html">Integrating Shield with clients</a></span> » <span class="breadcrumb-node">Shield with Logstash</span></div><div class="navheader"><span class="prev"><a href="_http_rest_clients.html">
              « 
              HTTP/REST Clients</a>
           
        </span><span class="next">
           
          <a href="marvel.html">Shield with Marvel
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="logstash"></a>Shield with Logstash</h2></div></div></div><div class="important admon"><div class="icon"></div><div class="admon_content"><p>Shield 1.0+ is compatible with Logstash 1.5 and above.</p></div></div><p>Logstash provides Elasticsearch <a class="ulink" href="/guide/en/logstash/current/plugins-outputs-elasticsearch.html" target="_top">output</a>, <a class="ulink" href="/guide/en/logstash/current/plugins-inputs-elasticsearch.html" target="_top">input</a> and <a class="ulink" href="/guide/en/logstash/current/plugins-filters-elasticsearch.html" target="_top">filter</a> plugins
used to index and retrieve documents through HTTP, transport or client node protocols.
All plugins support authentication and encryption over HTTP, while the output plugin additionally supports these
features over the transport protocol.</p><p>Note: When using the elasticsearch output, only the <code class="literal">transport</code> and <code class="literal">http</code> protocol are supported (i.e. <code class="literal">node</code> protocol is unsupported)</p><p>For information on setting up authentication and authorization on the Elasticsearch side, check the corresponding
documentation sections: <a class="link" href="authorization.html" title="Authorization"><span class="emphasis"><em>Authorization</em></span></a> and <a class="link" href="authentication.html" title="Authentication"><span class="emphasis"><em>Authentication</em></span></a>.</p><p>To configure the certificates and other SSL related options, see <a class="link" href="securing-nodes.html" title="Securing Nodes"><span class="emphasis"><em>Securing Nodes</em></span></a>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ls-user"></a>Creating a user</h3></div></div></div><p>By default, the Shield plugin installs a dedicated user <a class="link" href="authorization.html#roles" title="Roles, Permissions and Privileges">role</a> that enables the creation of indices with names
that match the <code class="literal">logstash-*</code> regular expression, along with privileges to read, scroll, index, update, and delete
documents on those indices:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">logstash:
  cluster: indices:admin/template/get, indices:admin/template/put
  indices:
    'logstash-*': indices:data/write/bulk, indices:data/write/delete, indices:data/write/update, indices:data/read/search, indices:data/read/scroll, create_index</pre></div><p>See the <a class="link" href="authorization.html#roles-file" title="The Role Definition File roles.yml"><span class="emphasis"><em>Role Definition File</em></span></a> section for information on modifying roles.</p><p>Create a user associated with the <code class="literal">logstash</code> role on the Elasticsearch cluster, using the <a class="link" href="esusers.html" title="esusers - Internal File Based Authentication"><code class="literal">esusers</code> tool</a>:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">esusers useradd &lt;username&gt; -p &lt;password&gt; -r logstash</pre></div><div class="note admon"><div class="icon"></div><div class="admon_content"><p>When using the transport protocol, the logstash user requires the predefined <code class="literal">transport_client</code> role in addition to the <code class="literal">logstash</code> role shown above (<code class="literal">-r logstash,transport_client</code>).</p></div></div><p>Once you’ve created the user, you are ready to configure Logstash.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ls-http"></a>Connecting with HTTP/HTTPS</h3></div></div></div><p>All three input, filter and output plugins support HTTP Basic Authentication as well as SSL/TLS.
The sections below demonstrate the output plugin’s configuration parameters, but input and filter are the same.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ls-http-auth"></a>Basic Authentication</h4></div></div></div><p>To connect to an instance of Elasticsearch with Shield, set up the username and password credentials with the following
configuration parameters:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">input { ... }
output {
  elasticsearch {
    protocol =&gt; "http"
    ...
    user =&gt; ... # string
    password =&gt; ... # string
  }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ls-http-ssl"></a>SSL/TLS Configuration for HTTPS</h4></div></div></div><p>To enable SSL/TLS encryption for HTTPS, use the following configuration block:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">input { ... }
output {
  elasticsearch {
    protocol =&gt; "http"
    ...
    ssl =&gt; true
    cacert =&gt; '/path/to/cert.pem' <a id="CO20-1"></a><i class="conum" data-value="1"></i>
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO20-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>The path to the <code class="literal">.pem</code> file in your filesystem that contains the Certificate Authority’s certificate.</p></td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ls-transport"></a>Connecting with Transport protocol</h3></div></div></div><p>By setting the "protocol" option to "transport", Logstash communicates with the Elasticsearch cluster through the same
protocol nodes use between each other. This avoids JSON un/marshalling and is therefore more efficient.</p><p>In order to unlock this option, it’s necessary to install an additional plugin in Logstash using the following command:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">bin/plugin install logstash-output-elasticsearch-shield</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ls-transport-auth"></a>Authentication for Transport protocol</h4></div></div></div><p>To connect to an instance of Elasticsearch with Shield, set up the username and password credentials with the following
configuration parameters:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">input { ... }
output {
  elasticsearch {
    protocol =&gt; "transport"
    ...
    user =&gt; ... # string
    password =&gt; ... # string
  }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ls-transport-conf"></a>SSL Configuration for Transport or Node protocols</h4></div></div></div><p>Specify the paths to the keystore and truststore <code class="literal">.jks</code> files with the following configuration parameters:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">input { ... }
output {
  elasticsearch {
    protocol =&gt; "transport"
    host =&gt; ... # string (optional)
    cluster =&gt; ... # string (optional)
    ...
    ssl =&gt; true
    keystore =&gt;  ... # string
    keystore_password =&gt;  ... # string
    truststore =&gt;  ... # string
    truststore_password =&gt;  ... # string
  }
}</pre></div><p>For more information on encryption and certificates, see the <a class="link" href="ssl-tls.html" title="Encryption and Certificates">Securing Nodes</a> section:</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ls-failure"></a>Failures</h3></div></div></div><p>Logstash raises an exception that halts the processing pipeline when the server’s certificate does not validate over SSL
on any of the protocols discussed in this section. Same for the invalid user credentials.</p></div></div><div class="navfooter"><span class="prev"><a href="_http_rest_clients.html">
              « 
              HTTP/REST Clients</a>
           
        </span><span class="next">
           
          <a href="marvel.html">Shield with Marvel
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
