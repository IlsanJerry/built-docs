<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Transaction API
        | APM Node.js Agent Reference [master]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="APM Node.js Agent Reference [master]" /><link rel="up" href="api.html" title="API Reference" /><link rel="prev" href="agent-api.html" title="Agent API" /><link rel="next" href="span-api.html" title="Span API" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/APM Node.js Agent/Reference/master" /><meta name="DC.subject" content="APM" /><meta name="DC.identifier" content="master" />
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <!-- DC tags section -->
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
    <link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >
    
    <!-- end DC tags -->
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <link href="/static/css/main.css" rel="stylesheet">
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.cookie.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
      // -------------------- set language based on browser language --------------------
      var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
      locales = {
        '/en':'/',
        '/de/': '/de/',
        '/fr/': '/fr/',
        '/ja/':'/jp/',
        '/ko/':'/kr/',
        '/zh/':'/cn/',
        '/es/': '/es/'
      },
      localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}',
      currentlocale = JSON.parse(localeUrl).relative_url_prefix;

      if($.cookie("is_lang_detected") == undefined){
        if(locales[lang] != undefined && locales[lang] != currentlocale){
          locale_lang_url = locales[lang] + window.location.pathname.slice(1,window.location.pathname.length);
          $.cookie("is_lang_detected",true ,{ path: '/'});
          window.location = locale_lang_url;
        }
      }
            
      // --------------------- end of set language based on browser language -----------------
    </script>
    <link type="text/css" rel="stylesheet" href="/static/css/guide.css" />
  
<link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />

</head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
    <!--
    <script src="https://www.elastic.co/static/js/elastic-apm-js-base.umd.min.2.2.0.js"></script>
    <script type="text/javascript">
      var elasticApm = init({
        serviceName: 'elastic-co-frontend',
        serverUrl: 'https://3ddd1ee09cc242c4b169d36f5a2b8b77.apm.us-west1.gcp.cloud.es.io:443',
        stackTraceLimit: 5,
        serviceVersion: '1.0.0'
      })
    
      var pageLoadName
      var pathname = window.location.pathname.replace(/\/es|\/pt|\/jp|\/pt|\/fr|\/kr|\/cn|\/de/g, '')
      var parts = pathname.split('/');
    
      if (parts.length && parts[1] === 'blog') {
        if (parts.length === 2) {
          pageLoadName =  '/blog';
        }
        else if (parts[2] === 'category') {
          pageLoadName =  '/blog/category';
        }
        else if (parts[2] === 'archive') {
          pageLoadName =  '/blog/archive';
        }
        else {
          pageLoadName =  '/blog/detail';
        }
      }
      else if (parts.length && parts[1] === 'elasticon') {
        if (parts.length === 2) {
          pageLoadName =  '/elasticon';
        }
        else if (parts.length === 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/overview';
        }
        else if (parts.length > 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/video';
        }
      }
      else if (parts.length && parts[1] === 'guide') {
        pageLoadName =  '/guide';
      }
      else if (parts.length === 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos';
      }
      else if (parts.length > 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos/detail';
      }
      else if (parts.length > 2 && parts[1] === 'webinars') {
        pageLoadName =  '/webinars/detail';
      }
      else {
        pageLoadName =  window.location.pathname;
      }
    
      console.log('apm pageLoadName:', pageLoadName, parts)
      elasticApm.setTags({env:"production"});
      elasticApm.setInitialPageLoadName(pageLoadName);
    </script>
    -->

    <!-- Header Section -->
    
    <div id='elastic-nav'></div>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <link rel="stylesheet" type="text/css" href="/static/css/horizon-swiper.min.css">

    <style> 
      .m-shortcuts li a.m-search {
        background: url("/assets/blt7b9c4fe6528dc4ef/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-docs {
        background: url("/assets/blt44d8b7530a76d01c/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-contact {
        background: url("/assets/blt878040795c9d083b/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    </style>

    <script type="text/javascript" src="/static/js/horizon-swiper.min.js"></script>

    <script type="text/javascript">
      $(document).ready( function(){
        // if($('#scrollable-pane li').length > 3){
          $('.horizon-swiper').horizonSwiper({
            showItems: 3,
            arrows: true
          }); 
        // }
        
        $('.navbar-toggle').on('click', function(){
          $('.mobile-navigation, .menu-open').hide();
          $('.navigation-wrapper').addClass('mobile-navigation');
          $('.navbar').addClass('menu-open');
          $('.menu-close').show();
        });
        $('.menu-close').on('click', function(){
          $('.navigation-wrapper').removeClass('mobile-navigation');
          $('.navbar').removeClass('menu-open');
          $('.menu-close').hide();
        });
    
        var active_url = "";
    
        $(".navbar-mobile-header-icon").click(function(index){
          $('.navigation-wrapper').toggleClass('menu-overlay');
          $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
          $(".mobile-inner-nav").slideToggle(500);
          $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
            $(this).css({'animation-delay': (index/25)+'0.4s'});
          });
        });
    
        $('.dropdown-btn').on('click', function(e){
          e.preventDefault();
          setDropdown();
        });
        
        function setDropdown() {
          $('#myDropdown').slideToggle();
        }
    
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {
    
            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
    
      });
      $(window).resize(function () {
        $('.horizon-swiper').horizonSwiper({
          showItems: 3,
          arrows: true
        });
      });
    </script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <!-- start body -->
                
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">APM Node.js Agent Reference
      [master]
    </a></span> » <span class="breadcrumb-link"><a href="api.html">API Reference</a></span> » <span class="breadcrumb-node"><code class="literal">Transaction</code> API</span></div><div class="navheader"><span class="prev"><a href="agent-api.html">
              « 
              <code class="literal">Agent</code> API</a>
           
        </span><span class="next">
           
          <a href="span-api.html"><code class="literal">Span</code> API
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="transaction-api"></a><code class="literal">Transaction</code> API<a href="https://github.com/elastic/apm-agent-nodejs/edit/master/docs/transaction-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>A transaction groups multiple spans in a logical group.</p><p>To get a <code class="literal">Transaction</code> object,
you need to call <a class="link" href="agent-api.html#apm-start-transaction" title="apm.startTransaction([name][, type][, options])"><code class="literal">apm.startTransaction()</code></a>.</p><p>To see an example of using custom transactions,
see the <a class="link" href="custom-transactions.html" title="Custom Transactions">Custom Transactions in Node.js</a> article.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transaction-name"></a><code class="literal">transaction.name</code><a href="https://github.com/elastic/apm-agent-nodejs/edit/master/docs/transaction-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><span class="small small">Added in: v0.1.0</span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">unnamed</code></li></ul></div><p>The name of the transaction.</p><p>Can be used to set or overwrite the name of the transaction (visible in the performance monitoring breakdown).
If you don’t have access to the current transaction,
you can also set the name using <a class="link" href="agent-api.html#apm-set-transaction-name" title="apm.setTransactionName(name)"><code class="literal">apm.setTransactionName()</code></a>.</p><p>Transactions with the same name and <a class="link" href="transaction-api.html#transaction-type" title="transaction.type">type</a> are grouped together.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transaction-type"></a><code class="literal">transaction.type</code><a href="https://github.com/elastic/apm-agent-nodejs/edit/master/docs/transaction-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><span class="small small">Added in: v0.1.0</span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">custom</code></li></ul></div><p>The type of the transaction.</p><p>There’s a special type called <code class="literal">request</code> which is used by the agent for the transactions automatically created when an incoming HTTP request is detected.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transaction-traceparent"></a><code class="literal">transaction.traceparent</code><a href="https://github.com/elastic/apm-agent-nodejs/edit/master/docs/transaction-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><span class="small small">Added in: v2.9.0</span></p><p>Get the serialized traceparent string of the transaction.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transaction-result"></a><code class="literal">transaction.result</code><a href="https://github.com/elastic/apm-agent-nodejs/edit/master/docs/transaction-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><span class="small small">Added in: v0.1.0</span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">success</code></li></ul></div><p>A string describing the result of the transaction.
This is typically the HTTP status code,
or e.g. "success" or "failure" for a background task.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transaction-start-span"></a><code class="literal">transaction.startSpan([name][, type][, options])</code><a href="https://github.com/elastic/apm-agent-nodejs/edit/master/docs/transaction-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><span class="small small">Added in: v2.0.0</span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><code class="literal">name</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code> The name of the span.
You can alternatively set this via <a class="link" href="span-api.html#span-name" title="span.name"><code class="literal">span.name</code></a>.
<span class="strong strong"><strong>Default:</strong></span> <code class="literal">unnamed</code></li><li class="listitem"><code class="literal">type</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code> The type of span.
You can alternatively set this via <a class="link" href="span-api.html#span-type" title="span.type"><code class="literal">span.type</code></a>.
<span class="strong strong"><strong>Default:</strong></span> <code class="literal">custom</code></li><li class="listitem"><p class="simpara"><code class="literal">options</code> - The following options are supported:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><code class="literal">startTime</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" target="_top">&lt;number&gt;</a></code> The time when the span started.
Must be a Unix Time Stamp representing the number of milliseconds since January 1, 1970, 00:00:00 UTC.
Sub-millisecond precision can be achieved using decimals.
If not provided,
the current time will be used</li></ul></div></li></ul></div><p>Start and return a new custom span associated with this transaction.
When a span is started it will measure the time until <a class="link" href="span-api.html#span-end" title="span.end([endTime])"><code class="literal">span.end()</code></a> is called.</p><p>See <a class="link" href="span-api.html" title="Span API">Span API</a> docs for details on how to use custom spans.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transaction-set-tag"></a><code class="literal">transaction.setTag(name, value)</code><a href="https://github.com/elastic/apm-agent-nodejs/edit/master/docs/transaction-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><h3>Deprecated in 2.10.0. </h3><p>Replaced by <a class="xref" href="transaction-api.html#transaction-set-label" title="transaction.setLabel(name, value)"><code class="literal">transaction.setLabel(name, value)</code></a></p></div></div><p><span class="small small">Added in: v0.1.0</span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><code class="literal">name</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code>
Periods (<code class="literal">.</code>), asterisks (<code class="literal">*</code>), and double quotation marks (<code class="literal">"</code>) will be replaced by underscores (<code class="literal">_</code>),
as those characters have special meaning in Elasticsearch</li><li class="listitem"><code class="literal">value</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code>
If a non-string data type is given,
it’s converted to a string before being sent to the APM Server</li></ul></div><p>Set a tag on the transaction.
You can set multiple tags on the same transaction.
If an error happens during the transaction,
it will also get tagged with the same tags.</p><p>Tags are key/value pairs that are indexed by Elasticsearch and therefore searchable (as opposed to data set via <a class="link" href="agent-api.html#apm-set-custom-context" title="apm.setCustomContext(context)"><code class="literal">apm.setCustomContext()</code></a>).</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transaction-set-label"></a><code class="literal">transaction.setLabel(name, value)</code><a href="https://github.com/elastic/apm-agent-nodejs/edit/master/docs/transaction-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><span class="small small">Added in: v0.1.0</span></p><p><span class="small small">Renamed from <code class="literal">transaction.setTag()</code> to <code class="literal">transaction.setLabel()</code>: v2.10.0</span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><code class="literal">name</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code>
Periods (<code class="literal">.</code>), asterisks (<code class="literal">*</code>), and double quotation marks (<code class="literal">"</code>) will be replaced by underscores (<code class="literal">_</code>),
as those characters have special meaning in Elasticsearch</li><li class="listitem"><code class="literal">value</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code>
If a non-string data type is given,
it’s converted to a string before being sent to the APM Server</li></ul></div><p>Set a label on the transaction.
You can set multiple labels on the same transaction.
If an error happens during the transaction,
it will also get tagged with the same labels.</p><p>Tags are key/value pairs that are indexed by Elasticsearch and therefore searchable (as opposed to data set via <a class="link" href="agent-api.html#apm-set-custom-context" title="apm.setCustomContext(context)"><code class="literal">apm.setCustomContext()</code></a>).</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transaction-add-tags"></a><code class="literal">transaction.addTags({ [name]: value })</code><a href="https://github.com/elastic/apm-agent-nodejs/edit/master/docs/transaction-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><h3>Deprecated in 2.10.0. </h3><p>Replaced by <a class="xref" href="transaction-api.html#transaction-add-labels" title="transaction.addLabels({ [name]: value })"><code class="literal">transaction.addLabels({ [name]: value })</code></a></p></div></div><p><span class="small small">Added in: v1.5.0</span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara"><code class="literal">tags</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" target="_top">&lt;Object&gt;</a></code> Contains key/value pairs:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><code class="literal">name</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code>
Any periods (<code class="literal">.</code>), asterisks (<code class="literal">*</code>), or double quotation marks (<code class="literal">"</code>) will be replaced by underscores (<code class="literal">_</code>),
as those characters have special meaning in Elasticsearch</li><li class="listitem"><code class="literal">value</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code>
If a non-string data type is given,
it’s converted to a string before being sent to the APM Server</li></ul></div></li></ul></div><p>Add several tags on the transaction.
You can add tags multiple times.
If an error happens during the transaction,
it will also get tagged with the same tags.</p><p>Tags are key/value pairs that are indexed by Elasticsearch and therefore searchable (as opposed to data set via <a class="link" href="agent-api.html#apm-set-custom-context" title="apm.setCustomContext(context)"><code class="literal">apm.setCustomContext()</code></a>).</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transaction-add-labels"></a><code class="literal">transaction.addLabels({ [name]: value })</code><a href="https://github.com/elastic/apm-agent-nodejs/edit/master/docs/transaction-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><span class="small small">Added in: v1.5.0</span></p><p><span class="small small">Renamed from <code class="literal">transaction.addTags()</code> to <code class="literal">transaction.addLabels()</code>: v2.10.0</span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara"><code class="literal">labels</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" target="_top">&lt;Object&gt;</a></code> Contains key/value pairs:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><code class="literal">name</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code>
Any periods (<code class="literal">.</code>), asterisks (<code class="literal">*</code>), or double quotation marks (<code class="literal">"</code>) will be replaced by underscores (<code class="literal">_</code>),
as those characters have special meaning in Elasticsearch</li><li class="listitem"><code class="literal">value</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code>
If a non-string data type is given,
it’s converted to a string before being sent to the APM Server</li></ul></div></li></ul></div><p>Add several labels on the transaction.
You can add labels multiple times.
If an error happens during the transaction,
it will also get tagged with the same labels.</p><p>Labels are key/value pairs that are indexed by Elasticsearch and therefore searchable (as opposed to data set via <a class="link" href="agent-api.html#apm-set-custom-context" title="apm.setCustomContext(context)"><code class="literal">apm.setCustomContext()</code></a>).</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transaction-ensure-parent-id"></a><code class="literal">transaction.ensureParentId()</code><a href="https://github.com/elastic/apm-agent-nodejs/edit/master/docs/transaction-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><span class="small small">Added in: v2.0.0</span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code></li></ul></div><p>If the transaction does not already have a parent id,
calling this method generates a new parent id,
sets it as the parent id of this transaction,
and returns it as a <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code>.</p><p>This enables the correlation of the spans the JavaScript Real User Monitoring (RUM) agent creates for the initial page load with the transaction of the backend service.
If your backend service generates the HTML page dynamically,
initializing the JavaScript RUM agent with the value of this method allows analyzing the time spent in the browser vs in the backend services.</p><p>To enable the JavaScript RUM agent,
add a snippet similar to this to the body of your HTML page,
preferably before other JavaScript libraries:</p><div class="pre_wrapper lang-js"><pre class="programlisting prettyprint lang-js">elasticApm.init({
  serviceName: 'my-frontend-app', // Name of your frontend app
  serverUrl: 'https://example.com:8200', // APM Server host
  pageLoadTraceId: '${transaction.traceId}',
  pageLoadSpanId: '${transaction.ensureParentId()}',
  pageLoadSampled: ${transaction.sampled}
})</pre></div><p>See the <a class="ulink" href="https://www.elastic.co/guide/en/apm/agent/rum-js/current" target="_top">JavaScript RUM agent documentation</a> for more information.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="transaction-end"></a><code class="literal">transaction.end([result][, endTime])</code><a href="https://github.com/elastic/apm-agent-nodejs/edit/master/docs/transaction-api.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><span class="small small">Added in: v0.1.0</span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><code class="literal">result</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" target="_top">&lt;string&gt;</a></code> Describes the result of the transaction.
This is typically the HTTP status code,
or e.g. "success" or "failure" for a background task</li><li class="listitem"><code class="literal">endTime</code> <code class="literal"><a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" target="_top">&lt;number&gt;</a></code> The time when the transaction ended.
Must be a Unix Time Stamp representing the number of milliseconds since January 1, 1970, 00:00:00 UTC.
Sub-millisecond precision can be achieved using decimals.
If not provided,
the current time will be used</li></ul></div><p>Ends the transaction.
If the transaction has already ended,
nothing happens.</p><p>Alternatively you can call <a class="link" href="agent-api.html#apm-end-transaction" title="apm.endTransaction([result][, endTime])"><code class="literal">apm.endTransaction()</code></a> to end the active transaction.</p></div></div><div class="navfooter"><span class="prev"><a href="agent-api.html">
              « 
              <code class="literal">Agent</code> API</a>
           
        </span><span class="next">
           
          <a href="span-api.html"><code class="literal">Span</code> API
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'</div>
<!-- Footer Section end-->

<script src='https://www.elastic.co/elastic-nav.js'></script>
<script src='https://www.elastic.co/elastic-footer.js'></script>

<style type="text/css">
	
        
            .Facebook a {background:url("/assets/bltf546ff2e0a8f2de5/facebook.svg") no-repeat;}
            .Facebook a:before {
                content: url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Facebook a:hover {background:url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg")}		
        
	
        
            .Twitter a {background:url("/assets/bltdd9556d6b24e2b85/twitter.svg") no-repeat;}
            .Twitter a:before {
                content: url("/assets/blt90b0372cc07a54d3/twitter-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Twitter a:hover {background:url("/assets/blt90b0372cc07a54d3/twitter-hover.svg")}		
        
	
        
            .LinkedIn a {background:url("/assets/bltc4a77e0f52ce07f1/linkedin.svg") no-repeat;}
            .LinkedIn a:before {
                content: url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .LinkedIn a:hover {background:url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg")}		
        
	
        
            .Xing a {background:url("/assets/bltc6347078dcc9ec76/xing.svg") no-repeat;}
            .Xing a:before {
                content: url("/assets/bltededebe5f7521a39/xing-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Xing a:hover {background:url("/assets/bltededebe5f7521a39/xing-hover.svg")}		
        
	
        
            .YouTube a {background:url("/assets/blt4982061ce1aebc7f/youtube.svg") no-repeat;}
            .YouTube a:before {
                content: url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .YouTube a:hover {background:url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg")}		
        
	
</style>

<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
<script>
$(document).ready(function(){

    var ipSuccess = function(data) {
        country = data.country_code;
        if (data.in_eu){
                        
            marketo_id = "6196";
            
        }else{ 
            marketo_id = "1398";

        }

        $('.subscribe-form form.sb-form').attr('id', 'mktoForm_' + marketo_id);
        if(window.MktoForms2){
            MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", marketo_id,function(form){
                form.onSuccess(function(form){
                    $('#mktoForm_'+marketo_id).css('display','none');
                    $('.subscribe-wrapper .subscribe-form-container').hide();
                    $('.subscribe-wrapper').find('.form_thanks').removeClass('hide')
                    dataLayer.push({'event': 'mktoFormSubmit'});
                    return false;
                });
            });  
        }
    }

    var marketo_id;

    $.ajax({
        url: "/gdpr-data"
    }).success(function(data) {
        ipSuccess(data);
    });

})
</script>

      </section>
    </div>

    
     <script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/static/js/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script src="/static/js/nav-v5.js"></script>
<script src="/static/js/script.js"></script>

  
            <script type="text/javascript" src="/guide/static/docs.js"></script>

            </body>
        
</html>
