<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Upgrading to APM Server v6.5
        | APM Server Reference [6.7]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="APM Server Reference [6.7]" /><link rel="up" href="upgrading.html" title="Upgrading APM Server" /><link rel="prev" href="breaking-changes.html" title="Breaking Changes" /><link rel="next" href="setting-up-and-running.html" title="Setting up and running APM Server" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/APM Server/Reference/6.7" /><meta name="DC.subject" content="APM" /><meta name="DC.identifier" content="6.7" />
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <!-- DC tags section -->
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
    <link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >
    
    <!-- end DC tags -->
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <link href="/static/css/main.css" rel="stylesheet">
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.cookie.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
      // -------------------- set language based on browser language --------------------
      var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
      locales = {
        '/en':'/',
        '/de/': '/de/',
        '/fr/': '/fr/',
        '/ja/':'/jp/',
        '/ko/':'/kr/',
        '/zh/':'/cn/',
        '/es/': '/es/'
      },
      localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}',
      currentlocale = JSON.parse(localeUrl).relative_url_prefix;

      if($.cookie("is_lang_detected") == undefined){
        if(locales[lang] != undefined && locales[lang] != currentlocale){
          locale_lang_url = locales[lang] + window.location.pathname.slice(1,window.location.pathname.length);
          $.cookie("is_lang_detected",true ,{ path: '/'});
          window.location = locale_lang_url;
        }
      }
            
      // --------------------- end of set language based on browser language -----------------
    </script>
    <link type="text/css" rel="stylesheet" href="/static/css/guide.css" />
  
<link rel="stylesheet" type="text/css" href="styles.css" />

</head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
    <!--
    <script src="https://www.elastic.co/static/js/elastic-apm-js-base.umd.min.2.2.0.js"></script>
    <script type="text/javascript">
      var elasticApm = init({
        serviceName: 'elastic-co-frontend',
        serverUrl: 'https://3ddd1ee09cc242c4b169d36f5a2b8b77.apm.us-west1.gcp.cloud.es.io:443',
        stackTraceLimit: 5,
        serviceVersion: '1.0.0'
      })
    
      var pageLoadName
      var pathname = window.location.pathname.replace(/\/es|\/pt|\/jp|\/pt|\/fr|\/kr|\/cn|\/de/g, '')
      var parts = pathname.split('/');
    
      if (parts.length && parts[1] === 'blog') {
        if (parts.length === 2) {
          pageLoadName =  '/blog';
        }
        else if (parts[2] === 'category') {
          pageLoadName =  '/blog/category';
        }
        else if (parts[2] === 'archive') {
          pageLoadName =  '/blog/archive';
        }
        else {
          pageLoadName =  '/blog/detail';
        }
      }
      else if (parts.length && parts[1] === 'elasticon') {
        if (parts.length === 2) {
          pageLoadName =  '/elasticon';
        }
        else if (parts.length === 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/overview';
        }
        else if (parts.length > 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/video';
        }
      }
      else if (parts.length && parts[1] === 'guide') {
        pageLoadName =  '/guide';
      }
      else if (parts.length === 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos';
      }
      else if (parts.length > 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos/detail';
      }
      else if (parts.length > 2 && parts[1] === 'webinars') {
        pageLoadName =  '/webinars/detail';
      }
      else {
        pageLoadName =  window.location.pathname;
      }
    
      console.log('apm pageLoadName:', pageLoadName, parts)
      elasticApm.setTags({env:"production"});
      elasticApm.setInitialPageLoadName(pageLoadName);
    </script>
    -->

    <!-- Header Section -->
    
    <div id='elastic-nav'></div>

    <link rel="stylesheet" type="text/css" href="/static/css/horizon-swiper.min.css">

    <style> 
      .m-shortcuts li a.m-search {
        background: url("/assets/blt7b9c4fe6528dc4ef/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-docs {
        background: url("/assets/blt44d8b7530a76d01c/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-contact {
        background: url("/assets/blt878040795c9d083b/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    </style>

    <script type="text/javascript" src="/static/js/horizon-swiper.min.js"></script>

    <script type="text/javascript">
      $(document).ready( function(){
        // if($('#scrollable-pane li').length > 3){
          $('.horizon-swiper').horizonSwiper({
            showItems: 3,
            arrows: true
          }); 
        // }
        
        $('.navbar-toggle').on('click', function(){
          $('.mobile-navigation, .menu-open').hide();
          $('.navigation-wrapper').addClass('mobile-navigation');
          $('.navbar').addClass('menu-open');
          $('.menu-close').show();
        });
        $('.menu-close').on('click', function(){
          $('.navigation-wrapper').removeClass('mobile-navigation');
          $('.navbar').removeClass('menu-open');
          $('.menu-close').hide();
        });
    
        var active_url = "";
    
        $(".navbar-mobile-header-icon").click(function(index){
          $('.navigation-wrapper').toggleClass('menu-overlay');
          $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
          $(".mobile-inner-nav").slideToggle(500);
          $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
            $(this).css({'animation-delay': (index/25)+'0.4s'});
          });
        });
    
        $('.dropdown-btn').on('click', function(e){
          e.preventDefault();
          setDropdown();
        });
        
        function setDropdown() {
          $('#myDropdown').slideToggle();
        }
    
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {
    
            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
    
      });
      $(window).resize(function () {
        $('.horizon-swiper').horizonSwiper({
          showItems: 3,
          arrows: true
        });
      });
    </script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <!-- start body -->
                
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">APM Server Reference
      [6.7]
    </a></span> » <span class="breadcrumb-link"><a href="upgrading.html">Upgrading APM Server</a></span> » <span class="breadcrumb-node">Upgrading to APM Server v6.5</span></div><div class="navheader"><span class="prev"><a href="breaking-changes.html">
              « 
              Breaking Changes</a>
           
        </span><span class="next">
           
          <a href="setting-up-and-running.html">Setting up and running APM Server
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="upgrading-to-65"></a>Upgrading to APM Server v6.5<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>If you’re an advanced user, are implementing a custom agent,
or provide custom data to Elasticsearch,
there are some changes in APM Server version 6.5 that you should be aware of.</p><p>None of the changes in APM Server v6.5 are breaking changes,
and the APM Server is still compatible with your currently implemented agents.
However, to take advantage of new features,
it’s recommended you read about the changes below and update accordingly.
If you’d like to continue using the deprecated Intake API and Elasticsearch Schema,
you can view <a class="ulink" href="https://www.elastic.co/guide/en/apm/server/6.4/overview.html" target="_top">previous documentation</a>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="upgrade-steps-65"></a>Upgrade Steps<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Upgrade the Elastic Stack: <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.7/setup-upgrade.html" target="_top">Elasticsearch</a>,
<a class="ulink" href="https://www.elastic.co/guide/en/kibana/6.7/upgrade.html" target="_top">Kibana</a>,
and APM Server.
</li><li class="listitem">
Upgrade your <a class="ulink" href="https://www.elastic.co/guide/en/apm/agent/index.html" target="_top">APM Agent</a>.
</li></ol></div><p>Check the <a class="ulink" href="https://www.elastic.co/guide/en/apm/get-started/6.7/agent-server-compatibility.html" target="_top">agent/server compatibility matrix</a> for more details on which APM agents are compatible with APM Server version 6.5.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>You must upgrade the APM Server before upgrading your APM Agent.
New agents do not support APM Server &lt;6.5 and will not work if you upgrade in the wrong order.</p></div></div><h4><a id="intake-api-changes-65"></a>Intake API Changes<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The Intake API is what we call the internal protocol that APM agents use to talk to the APM Server.
This API has been redesigned in 6.5 to increase the memory efficiency and predictability of the APM Server and APM agents.</p><p>Notably, most of the endpoints associated with this API have been deprecated,
and replaced with a new endpoint: <code class="literal">intake/v2/events</code>.</p><p>Similarly,
the <a class="link" href="rum.html" title="Real User Monitoring (RUM)">RUM</a> endpoint has been deprecated and replaced with a new endpoint: <code class="literal">intake/v2/rum/events</code>.</p><p>Details about these changes,
and the information you can send to the new endpoint,
is available in the <a class="link" href="events-api.html" title="Events API">Events API</a> documentation.</p><h5><a id="metadata-api-changes-65"></a>Metadata<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>Metadata is now sent to the APM Server only once per request.
APM Server will retain this information and apply it to the applicable documents when it writes to Elasticsearch.</p><p>Metadata should be sent to the new <code class="literal">intake/v2/events</code> endpoint.
See the <a class="link" href="metadata-api.html" title="Metadata">metadata documentation</a> for more information.</p><h5><a id="error-api-changes-65"></a>Error<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>The error schema adds three new properties, and deprecates two others.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="emphasis"><em>deprecate</em></span> pattern of <code class="literal">error.id</code>, change format to hex encoded 64 random bits
</li><li class="listitem">
<span class="emphasis"><em>deprecate</em></span> <code class="literal">transaction.id</code>
</li><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">transaction_id</code> (required, hex encoded 64 random bits)
</li><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">parent_id</code> (optional, hex encoded 64 random bits)
</li><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">trace_id</code> (optional, hex encoded 128 random bits)
</li></ul></div><p>Error events should be sent to the new <code class="literal">intake/v2/events</code> endpoint.
See the <a class="link" href="error-api.html#error-schema" title="Error Schema">error schema documentation</a> for more information.</p><h5><a id="transaction-api-changes-65"></a>Transaction<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>The transaction schema adds two new properties, and deprecates two others.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="emphasis"><em>deprecate</em></span> pattern of <code class="literal">transaction.id</code>, change format to hex encoded 64 random bits
</li><li class="listitem">
<span class="emphasis"><em>deprecate</em></span> spans (don’t forbid them, just don’t process them)
</li><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">parent_id</code> (optional, hex encoded 64 random bits string)
</li><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">trace_id</code> (required, hex encoded 128 random bits)
</li></ul></div><p>Transaction events should be sent to the new <code class="literal">intake/v2/events</code> endpoint.
See the <a class="link" href="transaction-api.html#transaction-schema" title="Transaction Schema">transaction schema documentation</a> for more information.</p><h5><a id="span-api-changes-65"></a>Span<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>The span schema adds three new properties, removes two, and changes one.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="emphasis"><em>change</em></span> pattern of <code class="literal">id</code> to hex encoded 64 random bits
</li><li class="listitem">
<span class="emphasis"><em>deprecate</em></span> pattern of <code class="literal">transaction_id</code>
</li><li class="listitem">
<span class="emphasis"><em>deprecate</em></span> use of <code class="literal">parent</code>
</li><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">parent_id</code> (required, hex encoded 64 random bits)
</li><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">trace_id</code> (required, hex encoded 128 random bits)
</li><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">timestamp</code>
</li></ul></div><p>Span events should be sent to the new <code class="literal">intake/v2/events</code> endpoint.
See the <a class="link" href="span-api.html#span-schema" title="Span Schema">span schema documentation</a> for more information.</p><h5><a id="healthcheck-api-changes-65"></a>Healthcheck Endpoint<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>The Healthcheck endpoint, previously <code class="literal">/healthcheck</code>, has been deprecated.
The <a class="link" href="server-info.html" title="Server Information">server information</a> api has replaced it.</p><h5><a id="assets-api-changes-65"></a>Assets Endpoint<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>The assets endpoint, <code class="literal">/v1/rum/sourcemaps</code> has been deprecated,
and replaced with the endpoint: <code class="literal">/assets/v1/sourcemaps</code>.
The data format remains unchanged.</p><h5><a id="metrics-api-changes-65"></a>Metricsets Endpoint<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>The Metricsets endpoint, previously <code class="literal">/v1/metrics</code>,
has also integrated with the new intake endpoint at <code class="literal">/intake/v2/events</code>.
There are two changes to be aware of:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Timestamps are now UTC based and formatted as microseconds since Unix epoch.
</li><li class="listitem">
The <code class="literal">metrics.enabled</code> setting has been deprecated and only applies to <code class="literal">v1/metrics</code>.
Metricsets can’t be disabled in v2.
</li></ul></div><p>See the <a class="link" href="metricset-api.html" title="Metrics">metricset schema</a> for more information.</p><h4><a id="server-config-changes-65"></a>Server Configuration Changes<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>There are some configuration changes that are worth mentioning.</p><p>Deprecated configuration options:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<a class="link" href="configuration-process.html#max_unzipped_size" title="max_unzipped_size"><code class="literal">max_unzipped_size</code></a>
</li><li class="listitem">
<a class="link" href="configuration-process.html#max_request_queue_time" title="max_request_queue_time"><code class="literal">max_request_queue_time</code></a>
</li><li class="listitem">
<a class="link" href="configuration-process.html#concurrent_requests" title="concurrent_request"><code class="literal">concurrent_requests</code></a>
</li></ul></div><p>New configuration options:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<a class="link" href="configuration-process.html#max_event_size" title="max_event_size"><code class="literal">max_event_size</code></a> with a default value: <code class="literal">307200</code> bytes. You may notice this default value is much smaller than the deprecated <a class="link" href="configuration-process.html#max_unzipped_size" title="max_unzipped_size"><code class="literal">max_unzipped_size</code></a> default value. This is because <code class="literal">max_unzipped_size</code> referred to the whole request, while <code class="literal">max_event_size</code> only refers to a single event within the request.
</li></ul></div><p>Notable options:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<a class="link" href="configuration-process.html#read_timeout" title="read_timeout"><code class="literal">read_timeout</code></a> and <a class="link" href="configuration-process.html#write_timeout" title="write_timeout"><code class="literal">write_timeout</code></a> remain at 30 seconds,
but if you have a load balancer in front of the APM server you may notice connections are a little bit longer lived than they used to be.
</li></ul></div><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>If you are updating APM Server from version 6.3 or earlier,
you may not be using an updated <code class="literal">apm-server.yml</code> configuration file. Update your <code class="literal">apm-server.yml</code> configuration file to take advantage of new configuration options.</p></div></div><p>RUM configuration changes:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<a class="link" href="configuration-rum.html#event_rate.limit" title="event_rate.limit"><code class="literal">event_rate.limit</code></a> has replaced the deprecated <a class="link" href="configuration-rum.html#rate_limit_v1" title="rate_limit"><code class="literal">rate_limit</code></a>. In v1 of the intake API, the RUM rate limiter was bound to the number of <span class="emphasis"><em>requests</em></span> per second, per IP. In v2, the rate limiter has changed to be bound to the number of <span class="emphasis"><em>events</em></span> sent per second, per IP.
</li></ul></div><h4><a id="es-schema-changes-65"></a>Elasticsearch Schema Changes<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The Elasticsearch schema defines how APM data is stored in Elasticsearch.
There have been a number of changes to the Elasticsearch schema for 6.5.</p><p>An important change to note is the addition of the <code class="literal">trace</code> and <code class="literal">parent</code> keys,
which have been added to errors, transactions, and spans.
Both only hold a field <code class="literal">id</code>.
These new keys are essential to taking advantage of APM’s new <a class="ulink" href="https://www.elastic.co/guide/en/apm/get-started/6.7/distributed-tracing.html" target="_top">distributed tracing</a> feature.</p><h5><a id="es-error-changes-65"></a>Error<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>The Elasticsearch error schema adds two new keys:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">trace.id</code>
</li><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">parent.id</code>
</li></ul></div><p>View the sample Elasticsearch <a class="link" href="error-indices.html" title="Error Indices">error document</a> for more information.</p><h5><a id="es-transaction-changes-65"></a>Transaction<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>The Elasticsearch transaction schema adds two new keys:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">trace.id</code>
</li><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">parent.id</code>
</li></ul></div><p>View the sample Elasticsearch <a class="link" href="transaction-indices.html" title="Transaction Indices">transaction document</a> for more information.</p><h5><a id="es-span-changes-65"></a>Span<a href="https://github.com/elastic/apm-server/edit/6.7/docs/upgrading-to-65.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>The Elasticsearch span schema adds three new keys, and deprecates two:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">trace.id</code>
</li><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">parent.id</code>
</li><li class="listitem">
<span class="emphasis"><em>add</em></span> <code class="literal">hex_id</code>
</li><li class="listitem">
<span class="emphasis"><em>deprecate</em></span> <code class="literal">parent</code> long
</li><li class="listitem">
<span class="emphasis"><em>deprecate</em></span> <code class="literal">id</code> long
</li></ul></div><p>View the sample Elasticsearch <a class="link" href="span-indices.html" title="Span Indices">span document</a> for more information.</p></div></div><div class="navfooter"><span class="prev"><a href="breaking-changes.html">
              « 
              Breaking Changes</a>
           
        </span><span class="next">
           
          <a href="setting-up-and-running.html">Setting up and running APM Server
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'</div>
<!-- Footer Section end-->

<script src='https://www.elastic.co/elastic-nav.js'></script>
<script src='https://www.elastic.co/elastic-footer.js'></script>

<style type="text/css">
	
        
            .Facebook a {background:url("/assets/bltf546ff2e0a8f2de5/facebook.svg") no-repeat;}
            .Facebook a:before {
                content: url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Facebook a:hover {background:url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg")}		
        
	
        
            .Twitter a {background:url("/assets/bltdd9556d6b24e2b85/twitter.svg") no-repeat;}
            .Twitter a:before {
                content: url("/assets/blt90b0372cc07a54d3/twitter-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Twitter a:hover {background:url("/assets/blt90b0372cc07a54d3/twitter-hover.svg")}		
        
	
        
            .LinkedIn a {background:url("/assets/bltc4a77e0f52ce07f1/linkedin.svg") no-repeat;}
            .LinkedIn a:before {
                content: url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .LinkedIn a:hover {background:url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg")}		
        
	
        
            .Xing a {background:url("/assets/bltc6347078dcc9ec76/xing.svg") no-repeat;}
            .Xing a:before {
                content: url("/assets/bltededebe5f7521a39/xing-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Xing a:hover {background:url("/assets/bltededebe5f7521a39/xing-hover.svg")}		
        
	
        
            .YouTube a {background:url("/assets/blt4982061ce1aebc7f/youtube.svg") no-repeat;}
            .YouTube a:before {
                content: url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .YouTube a:hover {background:url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg")}		
        
	
</style>

<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
<script>
$(document).ready(function(){

    var ipSuccess = function(data) {
        country = data.country_code;
        if (data.in_eu){
                        
            marketo_id = "6196";
            
        }else{ 
            marketo_id = "1398";

        }

        $('.subscribe-form form.sb-form').attr('id', 'mktoForm_' + marketo_id);
        if(window.MktoForms2){
            MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", marketo_id,function(form){
                form.onSuccess(function(form){
                    $('#mktoForm_'+marketo_id).css('display','none');
                    $('.subscribe-wrapper .subscribe-form-container').hide();
                    $('.subscribe-wrapper').find('.form_thanks').removeClass('hide')
                    dataLayer.push({'event': 'mktoFormSubmit'});
                    return false;
                });
            });  
        }
    }

    var marketo_id;

    $.ajax({
        url: "/gdpr-data"
    }).success(function(data) {
        ipSuccess(data);
    });

})
</script>

      </section>
    </div>

    
     <script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/static/js/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script src="/static/js/nav-v5.js"></script>
<script src="/static/js/script.js"></script>
 
     
<script type="text/javascript">
$(document).ready(function(){
	if (window.location.hash.length) {
	      var target = $(window.location.hash);
	      target = target.length ? target : $(window.location.hash);
	      if (target.length) {
	        setTimeout(function(){ $(window).scrollTop(target.offset().top - 60); }, 1200);        
	      }
	}
	$('#guide').on('click','a[href*=#]:not([href=#])',function(e) {
			var flag=true;
		      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
		          var target = $(this.hash);
		          target = target.length ? target :$(this.hash);
		          if (target.length) {
		            if(flag){
		              flag=false;
		              var heightScroll=($('.tertiary-nav.navbar-fixed-top').height())?60:110;
		              $('html,body').animate({
		                  scrollTop: target.offset().top - heightScroll
		                }, 2000, function(){
		                  flag=true;
		                });
		            }                    
		          }
		      }
		    
	});

})

</script>

     <style></style>
     
  
            <script type="text/javascript" src="docs.js"></script>
<script type='text/javascript' src='https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=yaml'></script>

            </body>
        
</html>
