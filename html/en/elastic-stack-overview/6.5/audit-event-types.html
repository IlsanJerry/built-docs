<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Audit event types
        | Elastic Stack Overview [6.5]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elastic Stack Overview [6.5]" /><link rel="up" href="auditing.html" title="Auditing security events" /><link rel="prev" href="auditing.html" title="Auditing security events" /><link rel="next" href="audit-log-output.html" title="Logfile audit output" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Elastic Stack/Overview/6.5" /><meta name="DC.subject" content="Elastic Stack" /><meta name="DC.identifier" content="6.5" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elastic Stack Overview
      [6.5]
    </a></span> » <span class="breadcrumb-link"><a href="elasticsearch-security.html">Securing the Elastic Stack</a></span> » <span class="breadcrumb-link"><a href="auditing.html">Auditing security events</a></span> » <span class="breadcrumb-node">Audit event types</span></div><div class="navheader"><span class="prev"><a href="auditing.html">
              « 
              Auditing security events</a>
           
        </span><span class="next">
           
          <a href="audit-log-output.html">Logfile audit output
               »
            </a></span></div><div class="xpack section"><div class="titlepage"><div><div><h2 class="title"><a id="audit-event-types"></a>Audit event types<a href="https://github.com/elastic/elasticsearch/edit/6.5/x-pack/docs/en/security/auditing/event-types.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><p>When you are <a class="link" href="auditing.html" title="Auditing security events">auditing security events</a>, each request can generate
multiple audit events.</p><p>The following is a list of the events that can be generated:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><tbody><tr><td align="left" valign="top"><p><code class="literal">anonymous_access_denied</code></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Logged when a request is denied due to a missing
                                          authentication token.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">authentication_success</code></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Logged when a user successfully authenticates.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">authentication_failed</code></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Logged when the authentication token cannot be
                                          matched to a known user.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">realm_authentication_failed</code></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Logged for every realm that fails to present a valid
                                          authentication token. <code class="literal">&lt;realm&gt;</code> represents the
                                          realm type.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">access_denied</code></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Logged when an authenticated user attempts to execute
                                          an action they do not have the necessary
                                          <a class="link" href="security-reference.html" title="Reference">privilege</a> to perform.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">access_granted</code></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Logged when an authenticated user attempts to execute
                                          an action they have the necessary privilege to perform.
                                          When the <code class="literal">system_access_granted</code> event is included, all system
                                          (internal) actions are also logged. The default setting does
                                          not log system actions to avoid cluttering the logs.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_as_granted</code></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Logged when an authenticated user attempts to <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as</a>
                                          another user that they have the necessary privileges to do.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_as_denied</code></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Logged when an authenticated user attempts to <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as</a>
                                          another user action they do not have the necessary
                                          <a class="link" href="security-reference.html" title="Reference">privilege</a> to do so.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">tampered_request</code></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Logged when the security features detect that the request has
                                          been tampered with. Typically relates to <code class="literal">search/scroll</code>
                                          requests when the scroll ID is believed to have been
                                          tampered with.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">connection_granted</code></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Logged when an incoming TCP connection passes the
                                          <a class="link" href="ip-filtering.html" title="Restricting connections with IP filtering">IP Filter</a> for a specific
                                          profile.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">connection_denied</code></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Logged when an incoming TCP connection does not pass the
                                          <a class="link" href="ip-filtering.html" title="Restricting connections with IP filtering">IP Filter</a> for a specific
                                          profile.</p></td></tr></tbody></table></div><h3><a id="audit-event-attributes"></a>Audit event attributes<a href="https://github.com/elastic/elasticsearch/edit/6.5/x-pack/docs/en/security/auditing/event-types.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>In 6.5.0, there is a new <a class="link" href="audit-log-output.html" title="Logfile audit output"><code class="literal">logfile</code> audit output</a> format.
This format also brings in a few changes for audit event attributes.</p><p>The new format is output to the <code class="literal">&lt;clustername&gt;_audit.log</code> file.
The audit entries are formatted as flat JSON documents (that is to say, no
nested objects), one per line. Hence, the attribute names are JSON keys and they
follow a dotted name syntax. Any attributes that lack a value (<code class="literal">null</code>) are not
output.</p><p>The following list shows attributes that are common to all audit events.
Their names and values are analogous to those in the deprecated <code class="literal">logfile</code> or
<code class="literal">index</code> output formats. However, it is expected that the formats will evolve
independently during the 6.x releases, so it is advisable to follow the attribute
descriptions for the format that you are using.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">@timestamp</code>      </span></dt><dd>The time, in ISO9601 format, when the event occurred.</dd><dt><span class="term"><code class="literal">node.name</code>       </span></dt><dd>The name of the node. This can be changed
in the <code class="literal">elasticsearch.yml</code> config file.</dd><dt><span class="term"><code class="literal">node.id</code>         </span></dt><dd>The node id. This is automatically generated and is
persistent across full cluster restarts.</dd><dt><span class="term"><code class="literal">host.ip</code>         </span></dt><dd>The bound IP address of the node, with which the node
can be communicated with.</dd><dt><span class="term"><code class="literal">host.name</code>       </span></dt><dd>The unresolved node’s hostname.</dd><dt><span class="term"><code class="literal">origin.address</code>  </span></dt><dd>The source IP address of the request associated with
this event. This could be the address of the remote client,
the address of another cluster node, or the local node’s
bound address, if the request originated locally. Unless
the remote client connects directly to the cluster, the
<span class="emphasis"><em>client  address</em></span> will actually be the address of the first
OSI layer 3 proxy in front of the cluster.</dd><dt><span class="term"><code class="literal">origin.type</code>     </span></dt><dd>The origin type of the request associated with this event:
<code class="literal">rest</code> (request originated from a REST API request),
<code class="literal">transport</code> (request was received on the transport channel),
or <code class="literal">local_node</code> (the local node issued the request).</dd><dt><span class="term"><code class="literal">event.type</code>      </span></dt><dd>The internal processing layer that generated the event:
<code class="literal">rest</code>, <code class="literal">transport</code> or <code class="literal">ip_filter</code>.
This is different from <code class="literal">origin.type</code> because a request
originating from the REST API is translated to a number
of transport messages, generating audit events with
<code class="literal">origin.type: rest</code> and <code class="literal">event.type: transport</code>.</dd><dt><span class="term"><code class="literal">event.action</code>    </span></dt><dd>The type of event that occurred: <code class="literal">anonymous_access_denied</code>,
<code class="literal">authentication_failed</code>, <code class="literal">authentication_success</code>,
<code class="literal">realm_authentication_failed</code>, <code class="literal">access_denied</code>, <code class="literal">access_granted</code>,
<code class="literal">connection_denied</code>, <code class="literal">connection_granted</code>, <code class="literal">tampered_request</code>,
<code class="literal">run_as_denied</code>, or <code class="literal">run_as_granted</code>.</dd><dt><span class="term"><code class="literal">opaque_id</code>       </span></dt><dd>The value of the <code class="literal">X-Opaque-Id</code> HTTP header (if present) of
the request associated with this event. This header can
be used freely by the client to mark API calls, as it has
no semantics in Elasticsearch.</dd></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_audit_event_attributes_of_the_rest_event_type"></a>Audit event attributes of the REST event type<a href="https://github.com/elastic/elasticsearch/edit/6.5/x-pack/docs/en/security/auditing/event-types.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The events with <code class="literal">event.type</code> equal to <code class="literal">rest</code> have one of the following <code class="literal">event.action</code>
attribute values: <code class="literal">authentication_success</code>, <code class="literal">anonymous_access_denied</code>, <code class="literal">authentication_failed</code>,
<code class="literal">realm_authentication_failed</code>, <code class="literal">tampered_request</code> or <code class="literal">run_as_denied</code>.
These event types also have the following extra attributes (in addition to the
common ones):</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">url.path</code>        </span></dt><dd>The path part of the URL (between the port and the query
string) of the REST request associated with this event.
This is URL encoded.</dd><dt><span class="term"><code class="literal">url.query</code>       </span></dt><dd>The query part of the URL (after "?", if present) of the
REST request associated with this event. This is URL encoded.</dd><dt><span class="term"><code class="literal">request.body</code>    </span></dt><dd>The full content of the REST request associated with this
event, if enabled. This contains the query body. The body
is escaped according to the JSON RFC 4627.</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_audit_event_attributes_of_the_transport_event_type"></a>Audit event attributes of the transport event type<a href="https://github.com/elastic/elasticsearch/edit/6.5/x-pack/docs/en/security/auditing/event-types.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The events with <code class="literal">event.type</code> equal to <code class="literal">transport</code> have one of the following <code class="literal">event.action</code>
attribute values: <code class="literal">authentication_success</code>, <code class="literal">anonymous_access_denied</code>, <code class="literal">authentication_failed</code>,
<code class="literal">realm_authentication_failed</code>, <code class="literal">access_granted</code>, <code class="literal">access_denied</code>, <code class="literal">run_as_granted</code>,
<code class="literal">run_as_denied</code>, or <code class="literal">tampered_request</code>.
These event types also have the following extra attributes (in addition to the common
ones):</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">action</code>              </span></dt><dd>The name of the transport action that was executed.
This is like the URL for a REST request.</dd><dt><span class="term"><code class="literal">indices</code>             </span></dt><dd>The indices names array that the request associated
with this event pertains to (when applicable).</dd><dt><span class="term"><code class="literal">request.name</code>        </span></dt><dd>The name of the request handler that was executed.</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_audit_event_attributes_of_the_ip_filter_event_type"></a>Audit event attributes of the ip_filter event type<a href="https://github.com/elastic/elasticsearch/edit/6.5/x-pack/docs/en/security/auditing/event-types.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The events with <code class="literal">event.type</code> equal to <code class="literal">ip_filter</code> have one of the following <code class="literal">event.action</code>
attribute values: <code class="literal">connection_granted</code> or <code class="literal">connection_denied</code>.
These event types also have the following extra attributes (in addition to the common
ones):</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">transport_profile</code>   </span></dt><dd>The transport profile the request targeted.</dd><dt><span class="term"><code class="literal">rule</code>                </span></dt><dd>The <a class="link" href="ip-filtering.html" title="Restricting connections with IP filtering">IP filtering</a> rule that denied
the request.</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_extra_audit_event_attributes_for_specific_events"></a>Extra audit event attributes for specific events<a href="https://github.com/elastic/elasticsearch/edit/6.5/x-pack/docs/en/security/auditing/event-types.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>There are a few events that have some more attributes in addition to those
that have been previously described:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara"><code class="literal">authentication_success</code>:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">realm</code>              </span></dt><dd>The name of the realm that successfully
authenticated the user.</dd><dt><span class="term"><code class="literal">user.name</code>          </span></dt><dd>The name of the <span class="emphasis"><em>effective</em></span> user. This is usually the
same as the <span class="emphasis"><em>authenticated</em></span> user, but if using the
<a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>
this instead denotes the name of the  <span class="emphasis"><em>impersonated</em></span> user.</dd><dt><span class="term"><code class="literal">user.run_by.name</code>   </span></dt><dd>This attribute is present only if the request is
using the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>
and denotes the name of the  <span class="emphasis"><em>authenticated</em></span> user,
which is also known as the <span class="emphasis"><em>impersonator</em></span>.</dd></dl></div></li><li class="listitem"><p class="simpara"><code class="literal">authentication_failed</code>:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">user.name</code>          </span></dt><dd>The name of the user that failed authentication.
If the request authentication token is invalid or
unparsable, this information might be missing.</dd></dl></div></li><li class="listitem"><p class="simpara"><code class="literal">realm_authentication_failed</code>:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">user.name</code>          </span></dt><dd>The name of the user that failed authentication.</dd><dt><span class="term"><code class="literal">realm</code>              </span></dt><dd>The name of the realm that rejected this authentication.
<span class="strong strong"><strong>This event is generated for each consulted realm
in the chain.</strong></span></dd></dl></div></li><li class="listitem"><p class="simpara"><code class="literal">run_as_denied</code> and <code class="literal">run_as_granted</code>:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">user.roles</code>         </span></dt><dd>The role names of the user as an array.</dd><dt><span class="term"><code class="literal">user.name</code>          </span></dt><dd>The name of the <span class="emphasis"><em>authenticated</em></span> user which is being
granted or denied the <span class="emphasis"><em>impersonation</em></span> action.</dd><dt><span class="term"><code class="literal">user.realm</code>         </span></dt><dd>The realm name that the <span class="emphasis"><em>authenticated</em></span> user belongs to.</dd><dt><span class="term"><code class="literal">user.run_as.name</code>   </span></dt><dd>The name of the user as which the <span class="emphasis"><em>impersonation</em></span>
action is granted or denied.</dd><dt><span class="term"><code class="literal">user.run_as.realm</code>  </span></dt><dd>The realm name of that the <span class="emphasis"><em>impersonated</em></span> user belongs to.</dd></dl></div></li><li class="listitem"><p class="simpara"><code class="literal">access_granted</code> or <code class="literal">access_denied</code>:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">user.roles</code>         </span></dt><dd>The role names of the user as an array.</dd><dt><span class="term"><code class="literal">user.name</code>          </span></dt><dd>The name of the <span class="emphasis"><em>effective</em></span> user that is being
authorized or unauthorized. This is usually the <span class="emphasis"><em>authenticated</em></span>
user, but if using the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>
this instead denotes the name of the  <span class="emphasis"><em>impersonated</em></span> user.</dd><dt><span class="term"><code class="literal">user.realm</code>         </span></dt><dd>The realm name that the <span class="emphasis"><em>effective</em></span> user belongs to.</dd><dt><span class="term"><code class="literal">user.run_by.name</code>   </span></dt><dd>This attribute is present only if the request is
using the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>
and denoted the name of the <span class="emphasis"><em>authenticated</em></span> user,
which is also known as the <span class="emphasis"><em>impersonator</em></span>.</dd><dt><span class="term"><code class="literal">user.run_by.realm</code>  </span></dt><dd>This attribute is present only if the request is
using the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>
and denotes the name of the realm that the <span class="emphasis"><em>authenticated</em></span>
(<span class="emphasis"><em>impersonator</em></span>) user belongs to.</dd></dl></div></li></ul></div><h3><a id="audit-event-attributes-deprecated-formats"></a>Audit event attributes for the deprecated formats<a href="https://github.com/elastic/elasticsearch/edit/6.5/x-pack/docs/en/security/auditing/event-types.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The following table shows the common attributes that can be associated with
every event, when it is output to the <code class="literal">&lt;clustername&gt;_access.log</code> file or to the
<a class="link" href="audit-index.html" title="Index audit output">index</a>.</p><div class="table"><a id="id-1.3.7.9.13.6"></a><p class="title"><strong>Table 1. Common attributes</strong></p><div class="table-contents"><table summary="Common attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">@timestamp</code></p></td><td align="left" valign="top"><p>When the event occurred.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">node_name</code></p></td><td align="left" valign="top"><p>The name of the node.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">node_host_name</code></p></td><td align="left" valign="top"><p>The hostname of the node.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">node_host_address</code></p></td><td align="left" valign="top"><p>The IP address of the node.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">layer</code></p></td><td align="left" valign="top"><p>The layer from which this event originated: <code class="literal">rest</code>, <code class="literal">transport</code> or <code class="literal">ip_filter</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">event_type</code></p></td><td align="left" valign="top"><p>The type of event that occurred: <code class="literal">anonymous_access_denied</code>,
                        <code class="literal">authentication_failed</code>, <code class="literal">authentication_success</code>,
                        <code class="literal">realm_authentication_failed</code>, <code class="literal">access_denied</code>, <code class="literal">access_granted</code>,
                        <code class="literal">connection_denied</code>, <code class="literal">connection_granted</code>, <code class="literal">tampered_request</code>,
                        <code class="literal">run_as_denied</code>, <code class="literal">run_as_granted</code>.</p></td></tr></tbody></table></div></div><p>For an event in the <a class="link" href="audit-log-output.html" title="Logfile audit output">audit log file output</a>, these are
positional attributes, which are printed at the beginning of each log line and
are not adjoined by the attribute name. As a matter of course, the names are
present for each attribute when the event is forwarded to the <a class="link" href="audit-index.html" title="Index audit output">index audit output</a>.</p><p>The attribute <code class="literal">origin_address</code> is also common to every audit event. It is always
named, that is, it is not positional. It denotes the source IP address of the
request associated with this event. This might be the address of the client, the
address of another cluster node, or the local node’s bound address (if the request
originated locally). Unless the client connects directly to the cluster, the
<span class="emphasis"><em>client  address</em></span> is the address of the first OSI layer 3 proxy in front of the
cluster.</p><p>In addition, every event might have the <code class="literal">opaque_id</code> attribute, with the value as
it has been passed in by the <code class="literal">X-Opaque-Id</code> HTTP request header. This header can
be used freely by the client to mark API calls, as it has no semantics in
Elasticsearch. Every audit event, generated as part of handling a request thus
marked, contains the <code class="literal">opaque_id</code> attribute.</p><p>The following tables show the attributes that can are associated with each type
of event, in addition to the common ones previously described:</p><div class="table"><a id="id-1.3.7.9.13.11"></a><p class="title"><strong>Table 2. REST anonymous_access_denied attributes</strong></p><div class="table-contents"><table summary="REST anonymous_access_denied attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">uri</code></p></td><td align="left" valign="top"><p>The REST endpoint URI.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request_body</code></p></td><td align="left" valign="top"><p>The body of the request, if enabled.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.12"></a><p class="title"><strong>Table 3. REST authentication_success attributes</strong></p><div class="table-contents"><table summary="REST authentication_success attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>effective</em></span> (impersonated) username. Usually this is
                         the same as the <span class="emphasis"><em>authenticated</em></span> username.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_by_principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>authenticated</em></span> (impersonator) username.
                         This attribute is present only if the request is
                         using the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>.
                         Otherwise, the <span class="emphasis"><em>effective</em></span> user is the same as the
                         <span class="emphasis"><em>authenticated</em></span> one, which is indicated by the <code class="literal">principal</code>
                         attribute.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">realm</code></p></td><td align="left" valign="top"><p>The realm that authenticated the user.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">uri</code></p></td><td align="left" valign="top"><p>The REST endpoint URI.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">params</code></p></td><td align="left" valign="top"><p>The REST URI query parameters.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request_body</code></p></td><td align="left" valign="top"><p>The body of the request, if enabled.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.13"></a><p class="title"><strong>Table 4. REST authentication_failed attributes</strong></p><div class="table-contents"><table summary="REST authentication_failed attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>The principal (username) that failed authentication.
                         If the request’s authentication token is invalid, this
                         information might be missing.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">uri</code></p></td><td align="left" valign="top"><p>The REST endpoint URI.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request_body</code></p></td><td align="left" valign="top"><p>The body of the request, if enabled.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.14"></a><p class="title"><strong>Table 5. REST realm_authentication_failed attributes</strong></p><div class="table-contents"><table summary="REST realm_authentication_failed attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">realm</code></p></td><td align="left" valign="top"><p>The realm that failed to authenticate the user.
                         <span class="strong strong"><strong>A separate entry is logged for each consulted realm.</strong></span></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>The principal (username) that failed authentication.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">uri</code></p></td><td align="left" valign="top"><p>The REST endpoint URI.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request_body</code></p></td><td align="left" valign="top"><p>The body of the request, if enabled.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.15"></a><p class="title"><strong>Table 6. REST tampered_request attributes</strong></p><div class="table-contents"><table summary="REST tampered_request attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">uri</code></p></td><td align="left" valign="top"><p>The REST endpoint URI.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request_body</code></p></td><td align="left" valign="top"><p>The body of the request, if enabled.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.16"></a><p class="title"><strong>Table 7. Transport anonymous_access_denied attributes</strong></p><div class="table-contents"><table summary="Transport anonymous_access_denied attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>Where the request originated: <code class="literal">rest</code> (request
                         originated from a REST API request), <code class="literal">transport</code>
                         (request was received on the transport channel), or
                         <code class="literal">local_node</code> (the local node issued the request).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>The name of the action that was executed.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>A comma-separated list of indices this request
                         pertains to (when applicable).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>The type of request that was executed.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.17"></a><p class="title"><strong>Table 8. Transport authentication_success attributes</strong></p><div class="table-contents"><table summary="Transport authentication_success attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>Where the request originated: <code class="literal">rest</code> (request
                         originated from a REST API request), <code class="literal">transport</code>
                         (request was received on the transport channel), or
                         <code class="literal">local_node</code> (the local node issued the request).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>effective</em></span> (impersonated) username. Usually this is
                         the same as the <span class="emphasis"><em>authenticated</em></span> username.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_by_principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>authenticated</em></span> (impersonator) username.
                         This attribute is present only if the request is
                         using the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>.
                         Otherwise, the <span class="emphasis"><em>effective</em></span> and the <span class="emphasis"><em>authenticated</em></span>
                         users are equivalent and are indicated by the
                         <code class="literal">principal</code> attribute.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">realm</code></p></td><td align="left" valign="top"><p>The realm that authenticated the user.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>The name of the action that was executed.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>A comma-separated list of indices this request
                         pertains to (when applicable).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>The type of request that was executed.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.18"></a><p class="title"><strong>Table 9. Transport authentication_failed attributes</strong></p><div class="table-contents"><table summary="Transport authentication_failed attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>Where the request originated: <code class="literal">rest</code> (request
                         originated from a REST API request), <code class="literal">transport</code>
                         (request was received on the transport channel), or
                         <code class="literal">local_node</code> (the local node issued the request).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>effective</em></span> (impersonated) username. Usually this is
                         the same as the <span class="emphasis"><em>authenticated</em></span> username. If the
                         request’s authentication token is invalid, this
                         information might be missing.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_by_principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>authenticated</em></span> (impersonator) username.
                         This attribute is present only if the request is
                         using the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>.
                         Otherwise, the <span class="emphasis"><em>effective</em></span> and the <span class="emphasis"><em>authenticated</em></span>
                         users are equivalent and are indicated by the
                         <code class="literal">principal</code> attribute.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>The name of the action that was executed.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>A comma-separated list of indices this request
                         pertains to (when applicable).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>The type of request that was executed.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.19"></a><p class="title"><strong>Table 10. Transport realm_authentication_failed attributes</strong></p><div class="table-contents"><table summary="Transport realm_authentication_failed attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">realm</code></p></td><td align="left" valign="top"><p>The realm that failed to authenticate the user.
                         <span class="strong strong"><strong>A separate entry is logged for each consulted realm.</strong></span></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>Where the request originated: <code class="literal">rest</code> (request
                         originated from a REST API request), <code class="literal">transport</code>
                         (request was received on the transport channel), or
                         <code class="literal">local_node</code> (the local node issued the request).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>The principal (username) that failed authentication.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>The name of the action that was executed.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>A comma-separated list of indices this request
                         pertains to (when applicable).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>The type of request that was executed.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.20"></a><p class="title"><strong>Table 11. Transport access_granted attributes</strong></p><div class="table-contents"><table summary="Transport access_granted attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>Where the request originated: <code class="literal">rest</code> (request
                         originated from a REST API request), <code class="literal">transport</code>
                         (request was received on the transport channel), or
                         <code class="literal">local_node</code> (the local node issued the request).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>effective</em></span> (impersonated) username for which
                         authorization succeeded. Unless the request is using
                         the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>,
                         the <span class="emphasis"><em>effective</em></span> and <span class="emphasis"><em>authenticated</em></span> usernames are equivalent.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">realm</code></p></td><td align="left" valign="top"><p>The realm name that <code class="literal">principal</code> belongs to.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_by_principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>authenticated</em></span> (impersonator) username.
                         This attribute is present only if the request is
                         using the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>.
                         Otherwise, the <span class="emphasis"><em>effective</em></span> and the <span class="emphasis"><em>authenticated</em></span>
                         usernames are equivalent and are indicated by the
                         <code class="literal">principal</code> attribute.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_by_realm</code></p></td><td align="left" valign="top"><p>The realm name that <code class="literal">run_by_principal</code> belongs to
                         (when applicable).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">roles</code></p></td><td align="left" valign="top"><p>The set of roles granting permissions.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>The name of the action that was executed.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>A comma-separated list of indices this request
                         pertains to (when applicable).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>The type of request that was executed.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.21"></a><p class="title"><strong>Table 12. Transport access_denied attributes</strong></p><div class="table-contents"><table summary="Transport access_denied attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>Where the request originated: <code class="literal">rest</code> (request
                         originated from a REST API request), <code class="literal">transport</code>
                         (request was received on the transport channel), or
                         <code class="literal">local_node</code> (the local node issued the request).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>effective</em></span> (impersonated) username for which
                         authorization failed. Unless the request is using
                         the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>,
                         the <span class="emphasis"><em>effective</em></span> and the <span class="emphasis"><em>authenticated</em></span> usernames are
                         equivalent.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">realm</code></p></td><td align="left" valign="top"><p>The realm name that <code class="literal">principal</code> belongs to.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_by_principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>authenticated</em></span> (impersonator) username.
                         This attribute is present only if the request is
                         using the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>.
                         Otherwise, the <span class="emphasis"><em>effective</em></span> and the <span class="emphasis"><em>authenticated</em></span>
                         usernames are equivalent and are indicated by the
                         <code class="literal">principal</code> attribute.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_by_realm</code></p></td><td align="left" valign="top"><p>The realm name that <code class="literal">run_by_principal</code> belongs to
                         (when applicable).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">roles</code></p></td><td align="left" valign="top"><p>The set of roles granting permissions.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>The name of the action that was executed.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>A comma-separated list of indices this request
                         relates to (when applicable).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>The type of request that was executed.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.22"></a><p class="title"><strong>Table 13. Transport run_as_granted attributes</strong></p><div class="table-contents"><table summary="Transport run_as_granted attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>Where the request originated: <code class="literal">rest</code> (request
                         originated from a REST API request), <code class="literal">transport</code>
                         (request was received on the transport channel), or
                         <code class="literal">local_node</code> (the local node issued the request).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>authenticated</em></span> (<span class="emphasis"><em>impersonator</em></span>) username for which
                         the impersonation operation was granted.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">realm</code></p></td><td align="left" valign="top"><p>The realm name that the <span class="emphasis"><em>authenticated</em></span> user belongs to.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_as_principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>impersonated</em></span> username.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_as_realm</code></p></td><td align="left" valign="top"><p>The realm name that the <span class="emphasis"><em>impersonated</em></span> username belongs to.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">roles</code></p></td><td align="left" valign="top"><p>The set of roles granting permissions.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>The name of the action that was executed.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>A comma-separated list of indices this request
                         relates to (when applicable).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>The type of request that was executed.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.23"></a><p class="title"><strong>Table 14. Transport run_as_denied attributes</strong></p><div class="table-contents"><table summary="Transport run_as_denied attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>Where the request originated: <code class="literal">rest</code> (request
                         originated from a REST API request), <code class="literal">transport</code>
                         (request was received on the transport channel), or
                         <code class="literal">local_node</code> (the local node issued the request).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>authenticated</em></span> (<span class="emphasis"><em>impersonator</em></span>) username for which
                         the impersonation operation was denied.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">realm</code></p></td><td align="left" valign="top"><p>The realm name that the <span class="emphasis"><em>authenticated</em></span> user belongs to.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_as_principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>impersonated</em></span> username.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_as_realm</code></p></td><td align="left" valign="top"><p>The realm name that the <span class="emphasis"><em>impersonated</em></span> username belongs to.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">roles</code></p></td><td align="left" valign="top"><p>The set of roles granting permissions.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>The name of the action that was executed.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>A comma-separated list of indices this request
                         relates to (when applicable).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>The type of request that was executed.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.24"></a><p class="title"><strong>Table 15. Transport tampered_request attributes</strong></p><div class="table-contents"><table summary="Transport tampered_request attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">origin_type</code></p></td><td align="left" valign="top"><p>Where the request originated: <code class="literal">rest</code> (request
                         originated from a REST API request), <code class="literal">transport</code>
                         (request was received on the transport channel), or
                         <code class="literal">local_node</code> (the local node issued the request).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>effective</em></span> (impersonated) username. Unless the request
                         is using the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>,
                         the <span class="emphasis"><em>effective</em></span> and the <span class="emphasis"><em>authenticated</em></span> usernames are
                         equivalent. If the requests’s authentication token is
                         invalid, this information might be missing.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">run_by_principal</code></p></td><td align="left" valign="top"><p>The <span class="emphasis"><em>authenticated</em></span> (impersonator) username.
                         This attribute is present only if the request is
                         using the <a class="link" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>.
                         Otherwise, the <span class="emphasis"><em>effective</em></span> and the <span class="emphasis"><em>authenticated</em></span> usernames
                         are equivalent and are indicated by the <code class="literal">principal</code> attribute.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">action</code></p></td><td align="left" valign="top"><p>The name of the action that was executed.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">indices</code></p></td><td align="left" valign="top"><p>A comma-separated list of indices this request
                         pertains to (when applicable).</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>The type of request that was executed.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.25"></a><p class="title"><strong>Table 16. IP filter connection_granted attributes</strong></p><div class="table-contents"><table summary="IP filter connection_granted attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">transport_profile</code></p></td><td align="left" valign="top"><p>The transport profile the request targeted.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">rule</code></p></td><td align="left" valign="top"><p>The <a class="link" href="ip-filtering.html" title="Restricting connections with IP filtering">IP filtering</a> rule that granted
                        the request.</p></td></tr></tbody></table></div></div><div class="table"><a id="id-1.3.7.9.13.26"></a><p class="title"><strong>Table 17. IP filter connection_denied attributes</strong></p><div class="table-contents"><table summary="IP filter connection_denied attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Attribute</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">transport_profile</code></p></td><td align="left" valign="top"><p>The transport profile the request targeted.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">rule</code></p></td><td align="left" valign="top"><p>The <a class="link" href="ip-filtering.html" title="Restricting connections with IP filtering">IP filtering</a> rule that denied
                        the request.</p></td></tr></tbody></table></div></div></div></div><div class="navfooter"><span class="prev"><a href="auditing.html">
              « 
              Auditing security events</a>
           
        </span><span class="next">
           
          <a href="audit-log-output.html">Logfile audit output
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
window.initial_state = {}</script>
  </body>
</html>
