<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Creating single metric jobs
        | Elastic Stack Overview [7.1]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elastic Stack Overview [7.1]" /><link rel="up" href="ml-getting-started.html" title="Tutorial: Getting started with machine learning" /><link rel="prev" href="ml-gs-wizards.html" title="Creating jobs in Kibana" /><link rel="next" href="ml-gs-job1-manage.html" title="Managing jobs" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Elastic Stack/Overview/7.1" /><meta name="DC.subject" content="Elastic Stack" /><meta name="DC.identifier" content="7.1" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
    <!--
    <script src="https://www.elastic.co/static/js/elastic-apm-js-base.umd.min.2.2.0.js"></script>
    <script type="text/javascript">
      var elasticApm = init({
        serviceName: 'elastic-co-frontend',
        serverUrl: 'https://3ddd1ee09cc242c4b169d36f5a2b8b77.apm.us-west1.gcp.cloud.es.io:443',
        stackTraceLimit: 5,
        serviceVersion: '1.0.0'
      })
    
      var pageLoadName
      var pathname = window.location.pathname.replace(/\/es|\/pt|\/jp|\/pt|\/fr|\/kr|\/cn|\/de/g, '')
      var parts = pathname.split('/');
    
      if (parts.length && parts[1] === 'blog') {
        if (parts.length === 2) {
          pageLoadName =  '/blog';
        }
        else if (parts[2] === 'category') {
          pageLoadName =  '/blog/category';
        }
        else if (parts[2] === 'archive') {
          pageLoadName =  '/blog/archive';
        }
        else {
          pageLoadName =  '/blog/detail';
        }
      }
      else if (parts.length && parts[1] === 'elasticon') {
        if (parts.length === 2) {
          pageLoadName =  '/elasticon';
        }
        else if (parts.length === 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/overview';
        }
        else if (parts.length > 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/video';
        }
      }
      else if (parts.length && parts[1] === 'guide') {
        pageLoadName =  '/guide';
      }
      else if (parts.length === 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos';
      }
      else if (parts.length > 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos/detail';
      }
      else if (parts.length > 2 && parts[1] === 'webinars') {
        pageLoadName =  '/webinars/detail';
      }
      else {
        pageLoadName =  window.location.pathname;
      }
    
      console.log('apm pageLoadName:', pageLoadName, parts)
      elasticApm.setTags({env:"production"});
      elasticApm.setInitialPageLoadName(pageLoadName);
    </script>
    -->

    <!-- Header Section -->
    
    <div id='elastic-nav'></div>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elastic Stack Overview
      [7.1]
    </a></span> » <span class="breadcrumb-link"><a href="xpack-ml.html">Machine learning in the Elastic Stack</a></span> » <span class="breadcrumb-link"><a href="ml-getting-started.html">Tutorial: Getting started with machine learning</a></span> » <span class="breadcrumb-node">Creating single metric jobs</span></div><div class="navheader"><span class="prev"><a href="ml-gs-wizards.html">
              « 
              Creating jobs in Kibana</a>
           
        </span><span class="next">
           
          <a href="ml-gs-job1-manage.html">Managing jobs
               »
            </a></span></div><div class="xpack section"><div class="titlepage"><div><div><h2 class="title"><a id="ml-gs-jobs"></a>Creating single metric jobs<a href="https://github.com/elastic/stack-docs/edit/7.1/docs/en/stack/ml/getting-started-single.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><p>At this point in the tutorial, the goal is to detect anomalies in the
total requests received by your applications and services. The sample data
contains a single key performance indicator(KPI) to track this, which is the total
requests over time. It is therefore logical to start by creating a single metric
job for this KPI.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>If you are using aggregated data, you can create an advanced job
and configure it to use a <code class="literal">summary_count_field_name</code>. The machine learning algorithms will
make the best possible use of summarized data in this case. For simplicity, in
this tutorial we will not make use of that advanced functionality. For more
information, see <a class="xref" href="ml-configuring-aggregation.html" title="Aggregating data for faster performance">Aggregating data for faster performance</a>.</p></div></div><p>A single metric job contains a single <span class="emphasis"><em>detector</em></span>. A detector defines the type of
analysis that will occur (for example, <code class="literal">max</code>, <code class="literal">average</code>, or <code class="literal">rare</code> analytical
functions) and the fields that will be analyzed.</p><p>To create a single metric job in Kibana:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Open Kibana in your web browser. If you are running Kibana locally,
go to <code class="literal">http://localhost:5601/</code>.</li><li class="listitem">Click <span class="strong strong"><strong>Machine Learning</strong></span> in the side navigation.</li><li class="listitem">Click <span class="strong strong"><strong>Create new job</strong></span>.</li><li class="listitem">Select the index pattern that you created for the sample data.  For example,
<code class="literal">server-metrics*</code>.</li><li class="listitem">In the <span class="strong strong"><strong>Use a wizard</strong></span> section, click <span class="strong strong"><strong>Single metric</strong></span>.</li><li class="listitem"><p class="simpara">Configure the job by providing the following information:</p><div class="screenshot informalfigure"><div class="mediaobject"><img src="ml/images/ml-gs-single-job.jpg" alt="Create a new job from the server-metrics index" /></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">For the <span class="strong strong"><strong>Aggregation</strong></span>, select <code class="literal">Sum</code>. This value specifies the analysis
function that is used.</p><p class="simpara">Some of the analytical functions look for single anomalous data points. For
example, <code class="literal">max</code> identifies the maximum value that is seen within a bucket.
Others perform some aggregation over the length of the bucket. For example,
<code class="literal">mean</code> calculates the mean of all the data points seen within the bucket.
Similarly, <code class="literal">count</code> calculates the total number of data points within the bucket.
In this tutorial, you are using the <code class="literal">sum</code> function, which calculates the sum of
the specified field’s values within the bucket. For descriptions of all the
functions, see <a class="xref" href="ml-functions.html" title="Function reference"><em>Function reference</em></a>.</p></li><li class="listitem"><p class="simpara">For the <span class="strong strong"><strong>Field</strong></span>, select <code class="literal">total</code>. This value specifies the field that
the detector uses in the function.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Some functions such as <code class="literal">count</code> and <code class="literal">rare</code> do not require fields.</p></div></div></li><li class="listitem"><p class="simpara">For the <span class="strong strong"><strong>Bucket span</strong></span>, enter <code class="literal">10m</code>. This value specifies the size of the
interval that the analysis is aggregated into.</p><p class="simpara">The machine learning features use the concept of a bucket to divide up the time series
into batches for processing. For example, if you are monitoring
the total number of requests in the system,
using a bucket span of 1 hour would mean that at the end of each hour, it
calculates the sum of the requests for the last hour and computes the
anomalousness of that value compared to previous hours.</p><p class="simpara">The bucket span has two purposes: it dictates over what time span to look for
anomalous features in data, and also determines how quickly anomalies can be
detected. Choosing a shorter bucket span enables anomalies to be detected more
quickly. However, there is a risk of being too sensitive to natural variations
or noise in the input data. Choosing too long a bucket span can mean that
interesting anomalies are averaged away. There is also the possibility that the
aggregation might smooth out some anomalies based on when the bucket starts
in time.</p><p class="simpara">The bucket span has a significant impact on the analysis. When you’re trying to
determine what value to use, take into account the granularity at which you
want to perform the analysis, the frequency of the input data, the duration of
typical anomalies, and the frequency at which alerting is required.</p></li></ol></div></li><li class="listitem"><p class="simpara">Determine whether you want to process all of the data or only part of it. If
you want to analyze all of the existing data, click
<span class="strong strong"><strong>Use full server-metrics* data</strong></span>. If you want to see what happens when you
stop and start datafeeds and process additional data over time, click the time
picker in the Kibana toolbar. Since the sample data spans a period of time
between March 23, 2017 and April 22, 2017, click <span class="strong strong"><strong>Absolute</strong></span>. Set the start
time to March 23, 2017 and the end time to April 1, 2017, for example. Once
you’ve got the time range set up, click the <span class="strong strong"><strong>Go</strong></span> button.</p><div class="screenshot informalfigure"><div class="mediaobject"><img src="ml/images/ml-gs-job1-time.jpg" alt="Setting the time range for the datafeed" /></div></div><p class="simpara">A graph is generated, which represents the total number of requests over time.</p><p class="simpara">Note that the <span class="strong strong"><strong>Estimate bucket span</strong></span> option is no longer greyed out in the
<span class="strong strong"><strong>Buck span</strong></span> field. This is an experimental feature that you can use to help
determine an appropriate bucket span for your data. For the purposes of this
tutorial, we will leave the bucket span at 10 minutes.</p></li><li class="listitem">Provide a name for the job, for example <code class="literal">total-requests</code>. The job name must
be unique in your cluster. You can also optionally provide a description of the
job and create a job group.</li><li class="listitem"><p class="simpara">Click <span class="strong strong"><strong>Create Job</strong></span>.</p><div class="screenshot informalfigure"><div class="mediaobject"><img src="ml/images/ml-gs-job1.jpg" alt="A graph of the total number of requests over time" /></div></div></li></ol></div><p>As the job is created, the graph is updated to give a visual representation of
the progress of machine learning as the data is processed. This view is only available whilst the
job is running.</p><p>When the job is created, you can choose to view the results, continue the job
in real-time, and create a watch. In this tutorial, we will look at how to
manage jobs and datafeeds before we view the results.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>The <code class="literal">create_single_metric.sh</code> script, which is included with the
<a class="link" href="ml-gs-data.html#ml-gs-sampledata" title="Obtaining a sample data set">sample data</a>, creates a similar job and datafeed by
using the machine learning APIs. Before you run it, you must edit the USERNAME and PASSWORD
variables with your actual user ID and password. If the Elasticsearch security features
are not enabled, use the <code class="literal">create_single_metric_noauth.sh</code> script instead. For
API reference information, see <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.1/ml-apis.html" target="_top">Machine Learning APIs</a>.</p></div></div></div><div class="navfooter"><span class="prev"><a href="ml-gs-wizards.html">
              « 
              Creating jobs in Kibana</a>
           
        </span><span class="next">
           
          <a href="ml-gs-job1-manage.html">Managing jobs
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<!-- Footer Section end-->

<script src='https://www.elastic.co/elastic-nav.js'></script>
<script src='https://www.elastic.co/elastic-footer.js'></script>
      </section>
    </div>

    
<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>

<script type="text/javascript">
window.initial_state = {}</script>
  </body>
</html>
