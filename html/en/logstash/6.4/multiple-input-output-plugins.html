<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Stitching Together Multiple Input and Output Plugins
        | Logstash Reference [6.4]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Logstash Reference [6.4]" /><link rel="up" href="getting-started-with-logstash.html" title="Getting Started with Logstash" /><link rel="prev" href="advanced-pipeline.html" title="Parsing Logs with Logstash" /><link rel="next" href="pipeline.html" title="How Logstash Works" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Logstash/Reference/6.4" /><meta name="DC.subject" content="Logstash" /><meta name="DC.identifier" content="6.4" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
    <!--
    <script src="https://www.elastic.co/static/js/elastic-apm-js-base.umd.min.2.2.0.js"></script>
    <script type="text/javascript">
      var elasticApm = init({
        serviceName: 'elastic-co-frontend',
        serverUrl: 'https://3ddd1ee09cc242c4b169d36f5a2b8b77.apm.us-west1.gcp.cloud.es.io:443',
        stackTraceLimit: 5,
        serviceVersion: '1.0.0'
      })
    
      var pageLoadName
      var pathname = window.location.pathname.replace(/\/es|\/pt|\/jp|\/pt|\/fr|\/kr|\/cn|\/de/g, '')
      var parts = pathname.split('/');
    
      if (parts.length && parts[1] === 'blog') {
        if (parts.length === 2) {
          pageLoadName =  '/blog';
        }
        else if (parts[2] === 'category') {
          pageLoadName =  '/blog/category';
        }
        else if (parts[2] === 'archive') {
          pageLoadName =  '/blog/archive';
        }
        else {
          pageLoadName =  '/blog/detail';
        }
      }
      else if (parts.length && parts[1] === 'elasticon') {
        if (parts.length === 2) {
          pageLoadName =  '/elasticon';
        }
        else if (parts.length === 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/overview';
        }
        else if (parts.length > 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/video';
        }
      }
      else if (parts.length && parts[1] === 'guide') {
        pageLoadName =  '/guide';
      }
      else if (parts.length === 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos';
      }
      else if (parts.length > 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos/detail';
      }
      else if (parts.length > 2 && parts[1] === 'webinars') {
        pageLoadName =  '/webinars/detail';
      }
      else {
        pageLoadName =  window.location.pathname;
      }
    
      console.log('apm pageLoadName:', pageLoadName, parts)
      elasticApm.setTags({env:"production"});
      elasticApm.setInitialPageLoadName(pageLoadName);
    </script>
    -->

    <!-- Header Section -->
    
    <div id='elastic-nav'></div>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Logstash Reference
      [6.4]
    </a></span> » <span class="breadcrumb-link"><a href="getting-started-with-logstash.html">Getting Started with Logstash</a></span> » <span class="breadcrumb-node">Stitching Together Multiple Input and Output Plugins</span></div><div class="navheader"><span class="prev"><a href="advanced-pipeline.html">
              « 
              Parsing Logs with Logstash</a>
           
        </span><span class="next">
           
          <a href="pipeline.html">How Logstash Works
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="multiple-input-output-plugins"></a>Stitching Together Multiple Input and Output Plugins<a href="https://github.com/elastic/logstash/edit/6.4/docs/static/advanced-pipeline.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The information you need to manage often comes from several disparate sources, and use cases can require multiple
destinations for your data. Your Logstash pipeline can use multiple input and output plugins to handle these
requirements.</p><p>In this section, you create a Logstash pipeline that takes input from a Twitter feed and the Filebeat client, then
sends the information to an Elasticsearch cluster as well as writing the information directly to a file.</p><h4><a id="twitter-configuration"></a>Reading from a Twitter Feed<a href="https://github.com/elastic/logstash/edit/6.4/docs/static/advanced-pipeline.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>To add a Twitter feed, you use the <a class="ulink" href="http://www.elastic.co/guide/en/logstash/6.4/plugins-inputs-twitter.html" target="_top"><code class="literal">twitter</code></a> input plugin. To
configure the plugin, you need several pieces of information:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">A <span class="emphasis"><em>consumer key</em></span>, which uniquely identifies your Twitter app.</li><li class="listitem">A <span class="emphasis"><em>consumer secret</em></span>, which serves as the password for your Twitter app.</li><li class="listitem">One or more <span class="emphasis"><em>keywords</em></span> to search in the incoming feed. The example shows using "cloud" as a keyword, but you can use whatever you want.</li><li class="listitem">An <span class="emphasis"><em>oauth token</em></span>, which identifies the Twitter account using this app.</li><li class="listitem">An <span class="emphasis"><em>oauth token secret</em></span>, which serves as the password of the Twitter account.</li></ul></div><p>Visit <a class="ulink" href="https://dev.twitter.com/apps" target="_top">https://dev.twitter.com/apps</a> to set up a Twitter account and generate your consumer
key and secret, as well as your access token and secret. See the docs for the <a class="ulink" href="http://www.elastic.co/guide/en/logstash/6.4/plugins-inputs-twitter.html" target="_top"><code class="literal">twitter</code></a> input plugin if you’re not sure how to generate these keys.</p><p>Like you did earlier when you worked on <a class="xref" href="advanced-pipeline.html" title="Parsing Logs with Logstash">Parsing Logs with Logstash</a>, create a config file (called <code class="literal">second-pipeline.conf</code>) that
contains the skeleton of a configuration pipeline. If you want, you can reuse the file you created earlier, but make
sure you pass in the correct config file name when you run Logstash.</p><p>Add the following lines to the <code class="literal">input</code> section of the <code class="literal">second-pipeline.conf</code> file, substituting your values for the
placeholder values shown here:</p><div class="pre_wrapper lang-json"><pre class="programlisting prettyprint lang-json">    twitter {
        consumer_key =&gt; "enter_your_consumer_key_here"
        consumer_secret =&gt; "enter_your_secret_here"
        keywords =&gt; ["cloud"]
        oauth_token =&gt; "enter_your_access_token_here"
        oauth_token_secret =&gt; "enter_your_access_token_secret_here"
    }</pre></div><h4><a id="configuring-lsf"></a>Configuring Filebeat to Send Log Lines to Logstash<a href="https://github.com/elastic/logstash/edit/6.4/docs/static/advanced-pipeline.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>As you learned earlier in <a class="xref" href="advanced-pipeline.html#configuring-filebeat" title="Configuring Filebeat to Send Log Lines to Logstash">Configuring Filebeat to Send Log Lines to Logstash</a>, the <a class="ulink" href="https://github.com/elastic/beats/tree/master/filebeat" target="_top">Filebeat</a>
client is a lightweight, resource-friendly tool that collects logs from files on the server and forwards these logs to your
Logstash instance for processing.</p><p>After installing Filebeat, you need to configure it. Open the <code class="literal">filebeat.yml</code> file located in your Filebeat installation
directory, and replace the contents with the following lines. Make sure <code class="literal">paths</code> points to your syslog:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">filebeat.prospectors:
- type: log
  paths:
    - /var/log/*.log <a id="CO2-1"></a><i class="conum" data-value="1"></i>
  fields:
    type: syslog <a id="CO2-2"></a><i class="conum" data-value="2"></i>
output.logstash:
  hosts: ["localhost:5044"]</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>Absolute path to the file or files that Filebeat processes.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-2"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>Adds a field called <code class="literal">type</code> with the value <code class="literal">syslog</code> to the event.</p></td></tr></table></div><p>Save your changes.</p><p>To keep the configuration simple, you won’t specify TLS/SSL settings as you would in a real world
scenario.</p><p>Configure your Logstash instance to use the Filebeat input plugin by adding the following lines to the <code class="literal">input</code> section
of the <code class="literal">second-pipeline.conf</code> file:</p><div class="pre_wrapper lang-json"><pre class="programlisting prettyprint lang-json">    beats {
        port =&gt; "5044"
    }</pre></div><h4><a id="logstash-file-output"></a>Writing Logstash Data to a File<a href="https://github.com/elastic/logstash/edit/6.4/docs/static/advanced-pipeline.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>You can configure your Logstash pipeline to write data directly to a file with the
<a class="ulink" href="http://www.elastic.co/guide/en/logstash/6.4/plugins-outputs-file.html" target="_top"><code class="literal">file</code></a> output plugin.</p><p>Configure your Logstash instance to use the <code class="literal">file</code> output plugin by adding the following lines to the <code class="literal">output</code> section
of the <code class="literal">second-pipeline.conf</code> file:</p><div class="pre_wrapper lang-json"><pre class="programlisting prettyprint lang-json">    file {
        path =&gt; "/path/to/target/file"
    }</pre></div><h4><a id="multiple-es-nodes"></a>Writing to Multiple Elasticsearch Nodes<a href="https://github.com/elastic/logstash/edit/6.4/docs/static/advanced-pipeline.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Writing to multiple Elasticsearch nodes lightens the resource demands on a given Elasticsearch node, as well as
providing redundant points of entry into the cluster when a particular node is unavailable.</p><p>To configure your Logstash instance to write to multiple Elasticsearch nodes, edit the <code class="literal">output</code> section of the <code class="literal">second-pipeline.conf</code> file to read:</p><div class="pre_wrapper lang-json"><pre class="programlisting prettyprint lang-json">output {
    elasticsearch {
        hosts =&gt; ["IP Address 1:port1", "IP Address 2:port2", "IP Address 3"]
    }
}</pre></div><p>Use the IP addresses of three non-master nodes in your Elasticsearch cluster in the host line. When the <code class="literal">hosts</code>
parameter lists multiple IP addresses, Logstash load-balances requests across the list of addresses. Also note that
the default port for Elasticsearch is <code class="literal">9200</code> and can be omitted in the configuration above.</p><h5><a id="testing-second-pipeline"></a>Testing the Pipeline<a href="https://github.com/elastic/logstash/edit/6.4/docs/static/advanced-pipeline.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>At this point, your <code class="literal">second-pipeline.conf</code> file looks like this:</p><div class="pre_wrapper lang-json"><pre class="programlisting prettyprint lang-json">input {
    twitter {
        consumer_key =&gt; "enter_your_consumer_key_here"
        consumer_secret =&gt; "enter_your_secret_here"
        keywords =&gt; ["cloud"]
        oauth_token =&gt; "enter_your_access_token_here"
        oauth_token_secret =&gt; "enter_your_access_token_secret_here"
    }
    beats {
        port =&gt; "5044"
    }
}
output {
    elasticsearch {
        hosts =&gt; ["IP Address 1:port1", "IP Address 2:port2", "IP Address 3"]
    }
    file {
        path =&gt; "/path/to/target/file"
    }
}</pre></div><p>Logstash is consuming data from the Twitter feed you configured, receiving data from Filebeat, and
indexing this information to three nodes in an Elasticsearch cluster as well as writing to a file.</p><p>At the data source machine, run Filebeat with the following command:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">sudo ./filebeat -e -c filebeat.yml -d "publish"</pre></div><p>Filebeat will attempt to connect on port 5044. Until Logstash starts with an active Beats plugin, there
won’t be any answer on that port, so any messages you see regarding failure to connect on that port are normal for now.</p><p>To verify your configuration, run the following command:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">bin/logstash -f second-pipeline.conf --config.test_and_exit</pre></div><p>The <code class="literal">--config.test_and_exit</code> option parses your configuration file and reports any errors. When the configuration file
passes the configuration test, start Logstash with the following command:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">bin/logstash -f second-pipeline.conf</pre></div><p>Use the <code class="literal">grep</code> utility to search in the target file to verify that information is present:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">grep syslog /path/to/target/file</pre></div><p>Run an Elasticsearch query to find the same information in the Elasticsearch cluster:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">curl -XGET 'localhost:9200/logstash-$DATE/_search?pretty&amp;q=fields.type:syslog'</pre></div><p>Replace $DATE with the current date, in YYYY.MM.DD format.</p><p>To see data from the Twitter feed, try this query:</p><div class="pre_wrapper lang-shell"><pre class="programlisting prettyprint lang-shell">curl -XGET 'http://localhost:9200/logstash-$DATE/_search?pretty&amp;q=client:iphone'</pre></div><p>Again, remember to replace $DATE with the current date, in YYYY.MM.DD format.</p></div><div class="navfooter"><span class="prev"><a href="advanced-pipeline.html">
              « 
              Parsing Logs with Logstash</a>
           
        </span><span class="next">
           
          <a href="pipeline.html">How Logstash Works
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<!-- Footer Section end-->

<script src='https://www.elastic.co/elastic-nav.js'></script>
<script src='https://www.elastic.co/elastic-footer.js'></script>
      </section>
    </div>

    
<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>

<script type="text/javascript">
window.initial_state = {}</script>
  </body>
</html>
