<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Generate roles tokens
        | Elastic Cloud Enterprise Reference [2.1]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elastic Cloud Enterprise Reference [2.1]" /><link rel="up" href="ece-securing-ece.html" title="Securing your installation" /><link rel="prev" href="ece-securing-considerations.html" title="Security considerations" /><link rel="next" href="ece-revoke-roles-token.html" title="Revoke roles tokens" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/CloudEnterprise/Reference/2.1" /><meta xmlns="" name="DC.subject" content="ECE" /><meta xmlns="" name="DC.identifier" content="2.1" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elastic Cloud Enterprise Reference
      [2.1]
    </a></span> » <span class="breadcrumb-link"><a href="ece-securing-ece.html">Securing your installation</a></span> » <span class="breadcrumb-node">Generate roles tokens</span></div><div xmlns="" class="navheader"><span class="prev"><a href="ece-securing-considerations.html">
              « 
              Security considerations</a>
           
        </span><span class="next">
           
          <a href="ece-revoke-roles-token.html">Revoke roles tokens
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="ece-generate-roles-token"></a>Generate roles tokens</h2></div></div></div><p>At the end of the Elastic Cloud Enterprise installation process on the first host, you are provided with a roles token. This token can be used to install Elastic Cloud Enterprise on additional hosts, but it does not include any role permissions. <a class="link" href="ece-change-roles.html" title="Assign roles to runners">Roles can be assigned</a> to the additional hosts through the Cloud UI later on, but this role assignment is a manual process. For automation purposes, you need to generate a new ephemeral or persistent token with the right role permissions, so that you can install Elastic Cloud Enterprise on hosts and add the right roles at the same time.</p><p>Ephemeral and persistent tokens differ as follows:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
Ephemeral token
</span></dt><dd>
Available for use during Elastic Cloud Enterprise installation on additional hosts for one hour before the token is revoked automatically. Cannot be revoked manually.
</dd><dt><span class="term">
Persistent token
</span></dt><dd>
Available for use during Elastic Cloud Enterprise installation on additional hosts indefinitely. <a class="link" href="ece-revoke-roles-token.html" title="Revoke roles tokens">Can be revoked</a> at any time.
</dd></dl></div><p>The permitted roles are the same as those you can <a class="link" href="ece-change-roles.html" title="Assign roles to runners">assign in the Cloud UI</a>:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">allocator</code>
</span></dt><dd>
 Allocates the available computing resources to Elasticsearch nodes or Kibana instances. In larger installations, a majority of the machines will be allocators.
</dd><dt><span class="term">
<code class="literal">coordinator</code>
</span></dt><dd>
 Serves as a distributed coordination system and resource scheduler.
</dd><dt><span class="term">
<code class="literal">proxy</code>
</span></dt><dd>
 Manages communication between a user and an Elasticsearch or Kibana instance.
</dd><dt><span class="term">
<code class="literal">director</code>
</span></dt><dd>
 Manages the ZooKeeper datastore. This role is typically shared with the coordinator role. In production deployments it can be separated from a coordinator.
</dd></dl></div><p>To generate an ephemeral token for additional allocators:</p><pre class="literallayout">curl -H 'Content-Type: application/json' -u admin<a id="CO6-1"></a><i xmlns="" class="conum" data-value="1"></i>:PASSWORD<a id="CO6-2"></a><i xmlns="" class="conum" data-value="2"></i> http://COORDINATOR_HOST_IP<a id="CO6-3"></a><i xmlns="" class="conum" data-value="3"></i>:12443/api/v1/platform/configuration/security/enrollment-tokens -d '{ "persistent": false, "roles": [ "allocator"] }'
{
  "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI0Njk3N2I3ZC1hM2U2LTQ2MDUtYjcwZC0xNzIzMTI5YWY4ZTQiLCJyb2xlcyI6WyJwcm94eSIsImFsbG9jYXRvciJdLCJpc3MiOiJib290c3RyYXAtaW5pdGlhbCIsImV4cCI6MTQ5MzY0NjIxM30.xsaRb72CsNMuXKy6Y-PJgqLc0qmjCljlB4Smcx_MRxg"
}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO6-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
The <code class="literal">admin</code> user
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO6-2"><i xmlns="" class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>
The password for the user
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO6-3"><i xmlns="" class="conum" data-value="3"></i></a> </p></td><td valign="top" align="left"><p>
A host in your installation that holds the coordinator role
</p></td></tr></table></div><p>To generate a persistent token for additional allocators:</p><pre class="literallayout">curl -H 'Content-Type: application/json' -u admin<a id="CO7-1"></a><i xmlns="" class="conum" data-value="1"></i>:PASSWORD<a id="CO7-2"></a><i xmlns="" class="conum" data-value="2"></i> http://COORDINATOR_HOST_IP<a id="CO7-3"></a><i xmlns="" class="conum" data-value="3"></i>:12443/api/v1/platform/configuration/security/enrollment-tokens -d '{ "persistent": true, "roles": [ "allocator"] }'
{
  "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI0Yzg5OTBkZi0xZmI3LTQ4MjAtYjg2OC02YmM5ZTg4NjA4MTQiLCJyb2xlcyI6WyJwcm94eSIsImFsbG9jYXRvciJdLCJpc3MiOiJib290c3RyYXAtaW5pdGlhbCJ9.mfTkO4j8uZJ-qwB2jmBuMScyYfLmcJpvKgSTLx2WV24",
  "token_id": "4c8990df-1fb7-4820-b868-6bc9e8860814"
}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO7-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
The <code class="literal">admin</code> user
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO7-2"><i xmlns="" class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>
The password for the user
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO7-3"><i xmlns="" class="conum" data-value="3"></i></a> </p></td><td valign="top" align="left"><p>
A host in your installation that holds the coordinator role
</p></td></tr></table></div><p>After your new token has been generated, use it to <a class="link" href="ece-installing-online.html#ece-installing-additional" title="Install on additional hosts">to install Elastic Cloud Enterprise on additional hosts</a>.</p></div><div xmlns="" class="navfooter"><span class="prev"><a href="ece-securing-considerations.html">
              « 
              Security considerations</a>
           
        </span><span class="next">
           
          <a href="ece-revoke-roles-token.html">Revoke roles tokens
               »
            </a></span></div></body></html>