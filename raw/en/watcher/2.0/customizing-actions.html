<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Customizing Actions
        | Elasticsearch Watcher [2.0]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Watcher [2.0]" /><link rel="up" href="customizing-watches.html" title="Customizing Watches" /><link rel="prev" href="using-transforms.html" title="Using Transforms" /><link rel="next" href="how-watcher-works.html" title="How Watcher Works" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Legacy/Watcher/Reference/2.0" /><meta xmlns="" name="DC.subject" content="Watcher" /><meta xmlns="" name="DC.identifier" content="2.0" /><meta xmlns="" name="robots" content="noindex,nofollow" /></head><body><div xmlns="" class="page_header">From version 5.0 onward, Watcher is part of X-Pack. For more information, see 
<a href=https://www.elastic.co/guide/en/elastic-stack-overview/current/xpack-alerting.html>
    Alerting on cluster and index events</a>. </div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Watcher
      [2.0]
    </a></span> » <span class="breadcrumb-link"><a href="customizing-watches.html">Customizing Watches</a></span> » <span class="breadcrumb-node">Customizing Actions</span></div><div xmlns="" class="navheader"><span class="prev"><a href="using-transforms.html">
              « 
              Using Transforms</a>
           
        </span><span class="next">
           
          <a href="how-watcher-works.html">How Watcher Works
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="customizing-actions"></a>Customizing Actions</h2></div></div></div><p>Watcher supports four types of actions <a class="link" href="actions.html#actions-email" title="Email Action">email</a>,
<a class="link" href="actions.html#actions-index" title="Index Action">index</a>, <a class="link" href="actions.html#actions-logging" title="Logging Action">logging</a>, and <a class="link" href="actions.html#actions-webhook" title="Webhook Action">webhook</a>.</p><p>To use the <code class="literal">email</code> action, you need to <a class="link" href="email-services.html" title="Configuring Watcher to Send Email">configure an email account</a> in
<code class="literal">elasticsearch.yml</code> that Watcher can use to send email. Your custom email messages can be
plain text or styled using HTML. You can include information from the watch payload using
<a class="link" href="scripts-templates.html#templates" title="Using Templates">templates</a>, as well as attach the entire watch payload to the message. For example,
the following email action uses a template in the subject line and attaches the payload data to the
message.</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">"actions" : {
  "send_email" : {
    "email" : {
      "to" : "&lt;username&gt;@&lt;domainname&gt;",
      "subject" : "Watcher Notification",
      "body" : "{{ctx.payload.hits.total}} watches took more than 2.5 seconds to execute.",
      "attach_data" : true
    }
  }
}</pre></div><p>The <code class="literal">index</code> action enables you to load data from the watch payload into an Elasticsearch index. The
entire payload can be indexed as a single document, or you can use a transform to populate a
<code class="literal">_doc</code> field with an array of objects that are indexed as separate documents.</p><p>The <code class="literal">logging</code> action enables you to add entries to the Elasticsearch logs, which is useful
during development and testing. For example, the following logging action logs the number
of watches that took longer than 2.5 seconds to run.</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">"actions" : {
  "log" : {
    "logging" : {
      "text" : "{{ctx.payload.hits.total}} watches took more than 2.5 seconds to execute"
    }
  }
}</pre></div><p>The <code class="literal">webhook</code> action enables you to submit a request to any external webservice. For example,
the following webhook action creates a Pagerduty trigger event.</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">"actions" : {
  "send_trigger" : {
    "throttle_period" : "5m",
    "webhook" : {
      "method" : "POST",
      "host" : "https://events.pagerduty.com",
      "port" : 443,
      "path": ":/generic/2010-04-15/create_event.json}",
      "body" : "{
        \"service_key\": \"e93facc04764012d7bfb002500d5d1a6\",
        \"incident_key\": \"long_watches\",
        \"event_type\": \"trigger\",
        \"description\": \"{{ctx.payload.hits.total}} watches took more than 2.5 seconds to execute\",
        \"client\": \"Watcher\"
      }"
      "headers": {"Content-type": "application/json"}
    }
  }
}</pre></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="using-transforms.html">
              « 
              Using Transforms</a>
           
        </span><span class="next">
           
          <a href="how-watcher-works.html">How Watcher Works
               »
            </a></span></div></body></html>