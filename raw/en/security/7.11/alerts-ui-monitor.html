<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Monitoring and troubleshooting rule executions | Elastic Security Solution [7.11] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution [7.11]"/>
<link rel="up" href="detection-engine-overview.html" title="Detections and Alerts"/>
<link rel="prev" href="rules-ui-management.html" title="Managing detection rules"/>
<link rel="next" href="detections-ui-exceptions.html" title="Rule exceptions and value lists"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/7.11"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="7.11"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [7.11]</a></span>
»
<span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and Alerts</a></span>
»
<span class="breadcrumb-node">Monitoring and troubleshooting rule executions</span>
</div>
<div class="navheader">
<span class="prev">
<a href="rules-ui-management.html">« Managing detection rules</a>
</span>
<span class="next">
<a href="detections-ui-exceptions.html">Rule exceptions and value lists »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="alerts-ui-monitor"></a>Monitoring and troubleshooting rule executions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.11/docs/detections/rules-ui-monitor.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<p>To view a summary of all rule executions, such as failures and last execution
times, select the <span class="strong strong"><strong>Rule Monitoring</strong></span> tab in the <span class="strong strong"><strong>All rules</strong></span> table (<span class="strong strong"><strong>Security</strong></span> &#8594;
<span class="strong strong"><strong>Detections</strong></span> &#8594; <span class="strong strong"><strong>Manage detection rules</strong></span>).</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/monitor-table.png" alt="monitor table">
</div>
</div>
<p>For detailed information on a rule, its generated alerts and errors, click on
a rule name in the <span class="strong strong"><strong>All rules</strong></span> table.</p>
<h3><a id="troubleshoot-signals"></a>Troubleshoot missing alerts<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.11/docs/detections/rules-ui-monitor.asciidoc">edit</a></h3>
<p>When a rule fails to run close to its scheduled time, some alerts may be
missing. There are a number of steps you can perform to try and resolve this
issue.</p>
<p>If you see <code class="literal">Gaps</code> in the All rules table or on the Rule details page
for a small number of rules, you can increase those rules'
<code class="literal">Additional look-back time</code> (<span class="strong strong"><strong>Detection rules</strong></span> page &#8594; the rule&#8217;s <span class="strong strong"><strong>All actions</strong></span> button (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>) &#8594; <span class="strong strong"><strong>Edit rule settings</strong></span> &#8594; <span class="strong strong"><strong>Schedule</strong></span> &#8594; <em>Additional look-back time</em>).</p>
<p>If you see gaps for numerous rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you restarted Kibana when many rules were activated, try deactivating them
and then reactivating them in small batches at staggered intervals. This
ensures Kibana does not attempt to run all the rules at the same time.
</li>
<li class="listitem">
Consider adding another Kibana instance to your environment.
</li>
</ul>
</div>
<p>Even if your rule runs at its scheduled time, there might still be missing alerts if your ingestion pipeline delay is greater than your rule interval + additional look-back time. Prebuilt rules have a minimum interval + additional look-back time of 6 minutes in Elastic Stack version &gt;=7.11.0. To avoid missed alerts for prebuilt rules, use caution to ensure that ingestion pipeline delays remain below 6 minutes.</p>
<p>In addition, use caution when creating custom rule schedules to ensure that the specified interval + additional look-back time is greater than your deployment&#8217;s ingestion pipeline delay.</p>
<p>You can eliminate the risk of missed alerts due to ingestion pipeline delay by specifying the <code class="literal">Timestamp override</code> field value to <code class="literal">event.ingested</code> in <a class="xref" href="rules-ui-create.html#rule-ui-advanced-params" title="Configure advanced rule settings (optional)">advanced settings</a> during rule creation or editing. The detection engine uses the value from the <code class="literal">event.ingested</code> field as the timestamp when executing the rule.</p>
<p>For example, if an event occurred at 10:01, and due to a 9-minute ingestion pipeline delay, was ingested into Elasticsearch at 10:10, a rule created to detect that event, with an interval + additional look-back time of 6 minutes, even if executing at 10:12&#8201;&#8212;&#8201;11 minutes after the event occurred&#8201;&#8212;&#8201;would still detect the event since the <code class="literal">event.ingested</code> timestamp was only two minutes earlier, well within the 6-minute rule query.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/timestamp-override.png" alt="timestamp override">
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="rules-ui-management.html">« Managing detection rules</a>
</span>
<span class="next">
<a href="detections-ui-exceptions.html">Rule exceptions and value lists »</a>
</span>
</div>
</div>
</body>
</html>
