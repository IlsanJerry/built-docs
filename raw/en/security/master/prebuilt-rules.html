<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Prebuilt rule reference | Elastic Endpoint Security [master] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Endpoint Security [master]"/>
<link rel="up" href="detection-engine-overview.html" title="Detections (beta)"/>
<link rel="prev" href="rules-ui-create.html" title="Managing signal detection rules"/>
<link rel="next" href="tuning-detection-signals.html" title="Tuning prebuilt detection rules"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/master"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Endpoint Security [master]</a></span>
»
<span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections (beta)</a></span>
»
<span class="breadcrumb-node">Prebuilt rule reference</span>
</div>
<div class="navheader">
<span class="prev">
<a href="rules-ui-create.html">« Managing signal detection rules</a>
</span>
<span class="next">
<a href="tuning-detection-signals.html">Tuning prebuilt detection rules »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="prebuilt-rules"></a>Prebuilt rule reference<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/prebuilt-rules-reference.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>This section lists all available prebuilt rules.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>To run machine learning prebuilt rules, you must have the
<a href="/subscriptions" class="ulink" target="_top">appropriate license</a> or use a
<a href="/cloud/elasticsearch-service/signup?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">Cloud</a> deployment. All machine learning prebuilt rules are tagged with <code class="literal">ML</code>,
and their rule type is <code class="literal">machine_learning</code>.</p>
</div>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Rule</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Tags</th>
<th align="left" valign="top">Last updated</th>
<th align="left" valign="top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#adding-hidden-file-attribute-via-attrib" title="Adding Hidden File Attribute via Attrib">Adding Hidden File Attribute via Attrib</a></p></td>
<td align="left" valign="top"><p>Adversaries can add the <code class="literal">hidden</code> attribute to files to hide them from the user in an attempt to evade detection.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#adding-hidden-file-attribute-via-attrib-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#adobe-hijack-persistence" title="Adobe Hijack Persistence">Adobe Hijack Persistence</a></p></td>
<td align="left" valign="top"><p>Detects the creation of an executable file or files that will be automatically run by Acrobat Reader when it starts.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.6.2</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#adobe-hijack-persistence-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#adversary-behavior-detected-elastic-endpoint" title="Adversary Behavior - Detected - Elastic Endpoint">Adversary Behavior - Detected - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint detected an Adversary Behavior. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#adversary-behavior-detected-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#anomalous-process-for-a-linux-population" title="Anomalous Process For a Linux Population">Anomalous Process For a Linux Population</a></p></td>
<td align="left" valign="top"><p>Searches for rare processes running on multiple Linux hosts in an entire fleet or network. This reduces the detection of false positives since automated maintenance processes usually only run occasionally on a single machine but are common to all or many hosts in a fleet.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux] [ML]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#anomalous-process-for-a-windows-population" title="Anomalous Process For a Windows Population">Anomalous Process For a Windows Population</a></p></td>
<td align="left" valign="top"><p>Searches for rare processes running on multiple hosts in an entire fleet or network. This reduces the detection of false positives since automated maintenance processes usually only run occasionally on a single machine but are common to all or many hosts in a fleet.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#anomalous-windows-process-creation" title="Anomalous Windows Process Creation">Anomalous Windows Process Creation</a></p></td>
<td align="left" valign="top"><p>Identifies unusual parent-child process relationships that can indicate malware execution or persistence mechanisms. Malicious scripts often call on other applications and processes as part of their exploit payload. For example, when a malicious Office document runs scripts as part of an exploit payload, Excel or Word may start a script interpreter process, which, in turn, runs a script that downloads and executes malware. Another common scenario is Outlook running an unusual process when malware is downloaded in an email. Monitoring and identifying anomalous process relationships is a method of detecting new and emerging malware that is not yet recognized by anti-virus scanners.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#attempt-to-disable-iptables-or-firewall" title="Attempt to Disable IPTables or Firewall">Attempt to Disable IPTables or Firewall</a></p></td>
<td align="left" valign="top"><p>Adversaries may attempt to disable the iptables or firewall service in an attempt to affect how a host is allowed to receive or send network traffic.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#attempt-to-disable-syslog-service" title="Attempt to Disable Syslog Service">Attempt to Disable Syslog Service</a></p></td>
<td align="left" valign="top"><p>Adversaries may attempt to disable the syslog service in an attempt to an attempt to disrupt event logging and evade detection by security controls.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#base16-or-base32-encoding-decoding-activity" title="Base16 or Base32 Encoding/Decoding Activity">Base16 or Base32 Encoding/Decoding Activity</a></p></td>
<td align="left" valign="top"><p>Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#base64-encoding-decoding-activity" title="Base64 Encoding/Decoding Activity">Base64 Encoding/Decoding Activity</a></p></td>
<td align="left" valign="top"><p>Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#bypass-uac-via-event-viewer" title="Bypass UAC via Event Viewer">Bypass UAC via Event Viewer</a></p></td>
<td align="left" valign="top"><p>Identifies User Account Control (UAC) bypass via <code class="literal">eventvwr.exe.</code> Attackers bypass UAC to stealthily execute code with elevated permissions.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#clearing-windows-event-logs" title="Clearing Windows Event Logs">Clearing Windows Event Logs</a></p></td>
<td align="left" valign="top"><p>Identifies attempts to clear Windows event log stores. This is often done by attackers in an attempt to evade detection or destroy forensic evidence on a system.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#clearing-windows-event-logs-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#command-prompt-network-connection" title="Command Prompt Network Connection">Command Prompt Network Connection</a></p></td>
<td align="left" valign="top"><p>Identifies <code class="literal">cmd.exe</code> making a network connection. Adversaries can abuse <code class="literal">cmd.exe</code> to download or execute malware from a remote URL.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#command-prompt-network-connection-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#connection-to-external-network-via-telnet" title="Connection to External Network via Telnet">Connection to External Network via Telnet</a></p></td>
<td align="left" valign="top"><p>Telnet provides a command line interface for communication with a remote device or server. This rule identifies Telnet network connections to publicly routable IP addresses.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#connection-to-internal-network-via-telnet" title="Connection to Internal Network via Telnet">Connection to Internal Network via Telnet</a></p></td>
<td align="left" valign="top"><p>Telnet provides a command line interface for communication with a remote device or server. This rule identifies Telnet network connections to non-publicly routable IP addresses.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#credential-dumping-detected-elastic-endpoint" title="Credential Dumping - Detected - Elastic Endpoint">Credential Dumping - Detected - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint detected Credential Dumping. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#credential-dumping-detected-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#credential-dumping-prevented-elastic-endpoint" title="Credential Dumping - Prevented - Elastic Endpoint">Credential Dumping - Prevented - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint prevented Credential Dumping. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#credential-dumping-prevented-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#credential-manipulation-detected-elastic-endpoint" title="Credential Manipulation - Detected - Elastic Endpoint">Credential Manipulation - Detected - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint detected Credential Manipulation. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#credential-manipulation-detected-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#credential-manipulation-prevented-elastic-endpoint" title="Credential Manipulation - Prevented - Elastic Endpoint">Credential Manipulation - Prevented - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint prevented Credential Manipulation. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#credential-manipulation-prevented-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#dns-activity-to-the-internet" title="DNS Activity to the Internet">DNS Activity to the Internet</a></p></td>
<td align="left" valign="top"><p>Detects when an internal network client sends DNS traffic directly to the Internet. This is atypical behavior for a managed network, and can be indicative of malware, exfiltration, command and control, or, simply, misconfiguration. This DNS activity also impacts your organization&#8217;s ability to provide enterprise monitoring and logging of DNS, and opens your network to a variety of abuses and malicious communications.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#dns-activity-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#dns-tunneling" title="DNS Tunneling">DNS Tunneling</a></p></td>
<td align="left" valign="top"><p>Detects unusually large numbers of DNS queries for a single top-level DNS domain, which is often used for DNS tunneling. DNS tunneling can be used for command-and-control, persistence, or data exfiltration activity. For example, <code class="literal">dnscat</code> tends to generate many DNS questions for a top-level domain as it uses the DNS protocol to tunnel data.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Packetbeat]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#delete-volume-usn-journal-with-fsutil" title="Delete Volume USN Journal with Fsutil">Delete Volume USN Journal with Fsutil</a></p></td>
<td align="left" valign="top"><p>Identifies use of the <code class="literal">fsutil.exe</code> to delete the <code class="literal">USNJRNL</code> volume. This technique is used by attackers to eliminate evidence of files created during post-exploitation activities.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#delete-volume-usn-journal-with-fsutil-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#deleting-backup-catalogs-with-wbadmin" title="Deleting Backup Catalogs with Wbadmin">Deleting Backup Catalogs with Wbadmin</a></p></td>
<td align="left" valign="top"><p>Identifies use of the <code class="literal">wbadmin.exe</code> to delete the backup catalog. Ransomware and other malware may do this to prevent system recovery.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#deleting-backup-catalogs-with-wbadmin-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#direct-outbound-smb-connection" title="Direct Outbound SMB Connection">Direct Outbound SMB Connection</a></p></td>
<td align="left" valign="top"><p>Identifies unexpected processes making network connections over port 445. Windows File Sharing is typically implemented over Server Message Block (SMB), which communicates between hosts using port 445. When legitimate, these network connections are established by the kernel. Processes making 445/tcp connections may be port scanners, exploits, or suspicious user-level processes moving laterally.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#direct-outbound-smb-connection-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#disable-windows-firewall-rules-via-netsh" title="Disable Windows Firewall Rules via Netsh">Disable Windows Firewall Rules via Netsh</a></p></td>
<td align="left" valign="top"><p>Identifies use of the <code class="literal">netsh.exe</code> to disable or weaken the local firewall. Attackers will use this command line tool to disable the firewall during troubleshooting or to enable network mobility.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#disable-windows-firewall-rules-via-netsh-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#encoding-or-decoding-files-via-certutil" title="Encoding or Decoding Files via CertUtil">Encoding or Decoding Files via CertUtil</a></p></td>
<td align="left" valign="top"><p>Identifies the use of <code class="literal">certutil.exe</code> to encode or decode data. CertUtil is a native Windows component which is part of Certificate Services. CertUtil is often abused by attackers to encode or decode base64 data for stealthier command and control or exfiltration.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#encoding-or-decoding-files-via-certutil-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#enumeration-of-kernel-modules" title="Enumeration of Kernel Modules">Enumeration of Kernel Modules</a></p></td>
<td align="left" valign="top"><p>Loadable Kernel Modules (or LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. This identifies attempts to enumerate information about a kernel module.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#execution-via-regsvcs-regasm" title="Execution via Regsvcs/Regasm">Execution via Regsvcs/Regasm</a></p></td>
<td align="left" valign="top"><p><code class="literal">RegSvcs.exe</code> and <code class="literal">RegAsm.exe</code> are Windows command line utilities that are used to register .NET Component Object Model (COM) assemblies. Adversaries can use <code class="literal">RegSvcs.exe</code> and <code class="literal">RegAsm.exe</code> to proxy execution of code through a trusted Windows utility.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#exploit-detected-elastic-endpoint" title="Exploit - Detected - Elastic Endpoint">Exploit - Detected - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint detected an Exploit. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#exploit-detected-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#exploit-prevented-elastic-endpoint" title="Exploit - Prevented - Elastic Endpoint">Exploit - Prevented - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint prevented an Exploit. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#exploit-prevented-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#ftp-file-transfer-protocol-activity-to-the-internet" title="FTP (File Transfer Protocol) Activity to the Internet">FTP (File Transfer Protocol) Activity to the Internet</a></p></td>
<td align="left" valign="top"><p>Detects events that may indicate the use of FTP network connections to the Internet. The File Transfer Protocol (FTP) has been around in its current form since the 1980s. It can be a common and efficient procedure on your network to send and receive files. Because of this, adversaries will also often use this protocol to exfiltrate data from your network or download new tools. Additionally, FTP is a plain-text protocol which, if intercepted, may expose usernames and passwords. FTP activity involving servers subject to regulations or compliance standards may be unauthorized.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#ftp-file-transfer-protocol-activity-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#file-deletion-via-shred" title="File Deletion via Shred">File Deletion via Shred</a></p></td>
<td align="left" valign="top"><p>Malware or other files dropped or created on a system by an adversary may leave traces behind as to what was done within a network and how. Adversaries may remove these files over the course of an intrusion to keep their footprint low or remove them at the end as part of the post-intrusion cleanup process.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#file-permission-modification-in-writable-directory" title="File Permission Modification in Writable Directory">File Permission Modification in Writable Directory</a></p></td>
<td align="left" valign="top"><p>Identifies file permission modifications in common writable directories by a non-root user. Adversaries often drop files or payloads into a writable directory and change permissions prior to execution.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#hex-encoding-decoding-activity" title="Hex Encoding/Decoding Activity">Hex Encoding/Decoding Activity</a></p></td>
<td align="left" valign="top"><p>Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#hping-process-activity" title="Hping Process Activity">Hping Process Activity</a></p></td>
<td align="left" valign="top"><p>Hping ran on a Linux host. Hping is a FOSS command-line packet analyzer and has the ability to construct network packets for a wide variety of network security testing applications, including scanning and firewall auditing.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#hping-process-activity-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#ipsec-nat-traversal-port-activity" title="IPSEC NAT Traversal Port Activity">IPSEC NAT Traversal Port Activity</a></p></td>
<td align="left" valign="top"><p>Detects events that could be describing IPSEC NAT Traversal traffic. IPSEC is a VPN technology that allows one system to talk to another using encrypted tunnels. NAT Traversal enables these tunnels to communicate over the Internet where one of the sides is behind a NAT router gateway. This may be common on your network, but this technique is also used by threat actors to avoid detection.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.6.1</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#ipsec-nat-traversal-port-activity-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#irc-internet-relay-chat-protocol-activity-to-the-internet" title="IRC (Internet Relay Chat) Protocol Activity to the Internet">IRC (Internet Relay Chat) Protocol Activity to the Internet</a></p></td>
<td align="left" valign="top"><p>Detects events that use common ports for Internet Relay Chat (IRC) to the Internet. IRC is a common protocol that can be used for chat and file transfers. This protocol is also a good candidate for remote control of malware and data transfers to and from a network.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#irc-internet-relay-chat-protocol-activity-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#interactive-terminal-spawned-via-perl" title="Interactive Terminal Spawned via Perl">Interactive Terminal Spawned via Perl</a></p></td>
<td align="left" valign="top"><p>Identifies when a terminal (tty) is spawned via Perl. Attackers may upgrade a simple reverse shell to a fully interactive tty after obtaining initial access to a host.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#interactive-terminal-spawned-via-python" title="Interactive Terminal Spawned via Python">Interactive Terminal Spawned via Python</a></p></td>
<td align="left" valign="top"><p>Identifies when a terminal (tty) is spawned via Python. Attackers may upgrade a simple reverse shell to a fully interactive tty after obtaining initial access to a host.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#kernel-module-removal" title="Kernel Module Removal">Kernel Module Removal</a></p></td>
<td align="left" valign="top"><p>Kernel modules are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. This rule identifies attempts to remove a kernel module.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#local-scheduled-task-commands" title="Local Scheduled Task Commands">Local Scheduled Task Commands</a></p></td>
<td align="left" valign="top"><p>A scheduled task can be used by an adversary to establish persistence, move laterally, and/or escalate privileges.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#local-scheduled-task-commands-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#local-service-commands" title="Local Service Commands">Local Service Commands</a></p></td>
<td align="left" valign="top"><p>Identifies use of <code class="literal">sc.exe</code> to create, modify, or start services on remote hosts. This could be indicative of adversary lateral movement but will be noisy if commonly done by admins.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#local-service-commands-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#malware-detected-elastic-endpoint" title="Malware - Detected - Elastic Endpoint">Malware - Detected - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint detected Malware. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#malware-detected-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#malware-prevented-elastic-endpoint" title="Malware - Prevented - Elastic Endpoint">Malware - Prevented - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint prevented Malware. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#malware-prevented-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#microsoft-build-engine-loading-windows-credential-libraries" title="Microsoft Build Engine Loading Windows Credential Libraries">Microsoft Build Engine Loading Windows Credential Libraries</a></p></td>
<td align="left" valign="top"><p>An instance of MSBuild, the Microsoft Build Engine, loaded DLLs (dynamically linked libraries) responsible for Windows credential management. This technique is sometimes used for credential dumping.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#microsoft-build-engine-started-an-unusual-process" title="Microsoft Build Engine Started an Unusual Process">Microsoft Build Engine Started an Unusual Process</a></p></td>
<td align="left" valign="top"><p>An instance of MSBuild, the Microsoft Build Engine, started a PowerShell script or the Visual C# Command Line Compiler. This technique is sometimes used to deploy a malicious payload using the Build Engine.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#microsoft-build-engine-started-by-a-script-process" title="Microsoft Build Engine Started by a Script Process">Microsoft Build Engine Started by a Script Process</a></p></td>
<td align="left" valign="top"><p>An instance of MSBuild, the Microsoft Build Engine, was started by a script or the Windows command interpreter. This behavior is unusual and is sometimes used by malicious payloads.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#microsoft-build-engine-started-by-a-system-process" title="Microsoft Build Engine Started by a System Process">Microsoft Build Engine Started by a System Process</a></p></td>
<td align="left" valign="top"><p>An instance of MSBuild, the Microsoft Build Engine, was started by Explorer or the WMI (Windows Management Instrumentation) subsystem. This behavior is unusual and is sometimes used by malicious payloads.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#microsoft-build-engine-started-by-an-office-application" title="Microsoft Build Engine Started by an Office Application">Microsoft Build Engine Started by an Office Application</a></p></td>
<td align="left" valign="top"><p>An instance of MSBuild, the Microsoft Build Engine, was started by Excel or Word. This is unusual behavior for the Build Engine and could have been caused by an Excel or Word document executing a malicious script payload.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#microsoft-build-engine-using-an-alternate-name" title="Microsoft Build Engine Using an Alternate Name">Microsoft Build Engine Using an Alternate Name</a></p></td>
<td align="left" valign="top"><p>An instance of MSBuild, the Microsoft Build Engine, was started after being renamed. This is uncommon behavior and may indicate an attempt to run MSBuild unnoticed or undetected.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#mknod-process-activity" title="Mknod Process Activity">Mknod Process Activity</a></p></td>
<td align="left" valign="top"><p>The Linux <code class="literal">mknod</code> program is sometimes used in the command payload of a remote command injection (RCI) and other exploits. It is used to export a command shell when the traditional version of <code class="literal">netcat</code> is not available to the payload.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#mknod-process-activity-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#modification-of-boot-configuration" title="Modification of Boot Configuration">Modification of Boot Configuration</a></p></td>
<td align="left" valign="top"><p>Identifies use of <code class="literal">bcdedit.exe</code> to delete boot configuration data. Malware and attackers sometimes use this tactic as a destructive technique.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#msbuild-making-network-connections" title="MsBuild Making Network Connections">MsBuild Making Network Connections</a></p></td>
<td align="left" valign="top"><p>Identifies <code class="literal">MsBuild.exe</code> making outbound network connections. This may indicate adversarial activity as MsBuild is often leveraged by adversaries to execute code and evade detection.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#msbuild-making-network-connections-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#net-command-via-system-account" title="Net command via SYSTEM account">Net command via SYSTEM account</a></p></td>
<td align="left" valign="top"><p>Identifies the SYSTEM account using the Net utility. The Net utility is a component of the Windows operating system. It is used in command line operations for control of users, groups, services, and network connections.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#netcat-network-activity" title="Netcat Network Activity">Netcat Network Activity</a></p></td>
<td align="left" valign="top"><p>A <code class="literal">netcat</code> process is engaging in network activity on a Linux host. Netcat is often used as a persistence mechanism by exporting a reverse shell or by serving a shell on a listening port. Netcat is also sometimes used for data exfiltration.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#netcat-network-activity-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#network-connection-via-certutil" title="Network Connection via Certutil">Network Connection via Certutil</a></p></td>
<td align="left" valign="top"><p>Identifies <code class="literal">certutil.exe</code> making a network connection. Adversaries could abuse <code class="literal">certutil.exe</code> to download a certificate or malware from a remote URL.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#network-connection-via-compiled-html-file" title="Network Connection via Compiled HTML File">Network Connection via Compiled HTML File</a></p></td>
<td align="left" valign="top"><p>Compiled HTML files (<code class="literal">.chm</code>) are commonly distributed as part of the Microsoft HTML Help system. Adversaries may conceal malicious code in a CHM file and deliver it to a victim for execution. CHM content is loaded by the HTML Help executable program (<code class="literal">hh.exe</code>).</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#network-connection-via-compiled-html-file-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#network-connection-via-msxsl" title="Network Connection via MsXsl">Network Connection via MsXsl</a></p></td>
<td align="left" valign="top"><p>Identifies <code class="literal">msxsl.exe</code> making a network connection. This may indicate adversarial activity as <code class="literal">msxsl.exe</code> is often leveraged by adversaries to execute malicious scripts and evade detection.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#network-connection-via-mshta" title="Network Connection via Mshta">Network Connection via Mshta</a></p></td>
<td align="left" valign="top"><p>Identifies <code class="literal">mshta.exe</code> making a network connection. This may indicate adversarial activity as <code class="literal">mshta.exe</code> is often leveraged by adversaries to execute malicious scripts and evade detection.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#network-connection-via-mshta-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#network-connection-via-regsvr" title="Network Connection via Regsvr">Network Connection via Regsvr</a></p></td>
<td align="left" valign="top"><p>Identifies the native Windows tools <code class="literal">regsvr32.exe</code> and <code class="literal">regsvr64.exe</code> making a network connection. This may be indicative of an attacker bypassing allowlists or running arbitrary scripts via a signed Microsoft binary.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#network-connection-via-regsvr-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#network-connection-via-signed-binary" title="Network Connection via Signed Binary">Network Connection via Signed Binary</a></p></td>
<td align="left" valign="top"><p>Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Adversaries may use these binaries to <em>live off the land</em> and execute malicious files that could bypass application allowlists and signature validation.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#network-connection-via-signed-binary-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#network-sniffing-via-tcpdump" title="Network Sniffing via Tcpdump">Network Sniffing via Tcpdump</a></p></td>
<td align="left" valign="top"><p>The Tcpdump program ran on a Linux host. Tcpdump is a network monitoring or packet sniffing tool that can be used to capture insecure credentials or data in motion. Sniffing can also be used to discover details of network services as a prelude to lateral movement or defense evasion.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#network-sniffing-via-tcpdump-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#nmap-process-activity" title="Nmap Process Activity">Nmap Process Activity</a></p></td>
<td align="left" valign="top"><p>Nmap was executed on a Linux host. Nmap is a FOSS tool for network scanning and security testing. It can map and discover networks, and identify listening services and operating systems. It is sometimes used to gather information in support of exploitation, execution or lateral movement.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#nmap-process-activity-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#nping-process-activity" title="Nping Process Activity">Nping Process Activity</a></p></td>
<td align="left" valign="top"><p>Nping ran on a Linux host. Nping is part of the Nmap tool suite and has the ability to construct raw packets for a wide variety of security testing applications, including denial of service testing.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#nping-process-activity-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#pptp-point-to-point-tunneling-protocol-activity" title="PPTP (Point to Point Tunneling Protocol) Activity">PPTP (Point to Point Tunneling Protocol) Activity</a></p></td>
<td align="left" valign="top"><p>Detects events that may indicate use of a PPTP VPN connection. Some threat actors use these types of connections to tunnel their traffic while avoiding detection.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.6.1</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#pptp-point-to-point-tunneling-protocol-activity-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#permission-theft-detected-elastic-endpoint" title="Permission Theft - Detected - Elastic Endpoint">Permission Theft - Detected - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint detected Permission Theft. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#permission-theft-detected-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#permission-theft-prevented-elastic-endpoint" title="Permission Theft - Prevented - Elastic Endpoint">Permission Theft - Prevented - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint prevented Permission Theft. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#permission-theft-prevented-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#persistence-via-kernel-module-modification" title="Persistence via Kernel Module Modification">Persistence via Kernel Module Modification</a></p></td>
<td align="left" valign="top"><p>Identifies loadable kernel module errors, which are often indicative of potential persistence attempts.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#persistence-via-kernel-module-modification-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#potential-application-shimming-via-sdbinst" title="Potential Application Shimming via Sdbinst">Potential Application Shimming via Sdbinst</a></p></td>
<td align="left" valign="top"><p>The Application Shim was created to allow for backward compatibility of software as the operating system codebase changes over time. This Windows functionality has been abused by attackers to stealthily gain persistence and arbitrary code execution in legitimate Windows processes.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#potential-application-shimming-via-sdbinst-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#potential-dns-tunneling-via-iodine" title="Potential DNS Tunneling via Iodine">Potential DNS Tunneling via Iodine</a></p></td>
<td align="left" valign="top"><p>Iodine is a tool for tunneling Internet protocol version 4 (IPV4) traffic over the DNS protocol to circumvent firewalls, network security groups, and network access lists while evading detection.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#potential-dns-tunneling-via-iodine-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#potential-disabling-of-selinux" title="Potential Disabling of SELinux">Potential Disabling of SELinux</a></p></td>
<td align="left" valign="top"><p>Identifies potential attempts to disable Security-Enhanced Linux (SELinux), which is a Linux kernel security feature to support access control policies. Adversaries may disable security tools to avoid possible detection of their tools and activities.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#potential-evasion-via-filter-manager" title="Potential Evasion via Filter Manager">Potential Evasion via Filter Manager</a></p></td>
<td align="left" valign="top"><p>The Filter Manager Control Program (fltMC.exe) binary may be abused by adversaries to unload a filter driver and evade defenses.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#potential-evasion-via-filter-manager-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#potential-modification-of-accessibility-binaries" title="Potential Modification of Accessibility Binaries">Potential Modification of Accessibility Binaries</a></p></td>
<td align="left" valign="top"><p>Windows contains accessibility features that may be launched with a key combination before a user has logged in. An adversary can modify the way these programs are launched to get a command prompt or backdoor without logging in to the system.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#potential-modification-of-accessibility-binaries-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#potential-shell-via-web-server" title="Potential Shell via Web Server">Potential Shell via Web Server</a></p></td>
<td align="left" valign="top"><p>Identifies suspicious commands executed via a web server, which may suggest a vulnerability and remote shell access.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#potential-shell-via-web-server-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#powershell-spawning-cmd" title="PowerShell spawning Cmd">PowerShell spawning Cmd</a></p></td>
<td align="left" valign="top"><p>Identifies a suspicious parent child process relationship with <code class="literal">cmd.exe</code> descending from <code class="literal">PowerShell.exe</code>.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#powershell-spawning-cmd-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#process-activity-via-compiled-html-file" title="Process Activity via Compiled HTML File">Process Activity via Compiled HTML File</a></p></td>
<td align="left" valign="top"><p>Compiled HTML files (<code class="literal">.chm</code>) are commonly distributed as part of the Microsoft HTML Help system. Adversaries may conceal malicious code in a CHM file and deliver it to a victim for execution. CHM content is loaded by the HTML Help executable program (<code class="literal">hh.exe</code>).</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#process-activity-via-compiled-html-file-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#process-discovery-via-tasklist" title="Process Discovery via Tasklist">Process Discovery via Tasklist</a></p></td>
<td align="left" valign="top"><p>Adversaries may attempt to get information about running processes on a system.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#process-discovery-via-tasklist-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#process-injection-detected-elastic-endpoint" title="Process Injection - Detected - Elastic Endpoint">Process Injection - Detected - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint detected Process Injection. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#process-injection-detected-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#process-injection-prevented-elastic-endpoint" title="Process Injection - Prevented - Elastic Endpoint">Process Injection - Prevented - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint prevented Process Injection. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#process-injection-prevented-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#process-injection-by-the-microsoft-build-engine" title="Process Injection by the Microsoft Build Engine">Process Injection by the Microsoft Build Engine</a></p></td>
<td align="left" valign="top"><p>An instance of MSBuild, the Microsoft Build Engine, created a thread in another process. This technique is sometimes used to evade detection or elevate privileges.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#proxy-port-activity-to-the-internet" title="Proxy Port Activity to the Internet">Proxy Port Activity to the Internet</a></p></td>
<td align="left" valign="top"><p>Detects events that may describe network events of proxy use to the Internet. It includes popular HTTP proxy ports and SOCKS proxy ports. Typically, environments will use an internal IP address for a proxy server. It can also be used to circumvent network controls and detection mechanisms.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#proxy-port-activity-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#psexec-network-connection" title="PsExec Network Connection">PsExec Network Connection</a></p></td>
<td align="left" valign="top"><p>Identifies use of the SysInternals tool <code class="literal">PsExec.exe</code> making a network connection. This could be an indication of lateral movement.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#psexec-network-connection-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#rdp-remote-desktop-protocol-from-the-internet" title="RDP (Remote Desktop Protocol) from the Internet">RDP (Remote Desktop Protocol) from the Internet</a></p></td>
<td align="left" valign="top"><p>Detects network events that may indicate the use of RDP traffic from the Internet. RDP is commonly used by system administrators to remotely control a system for maintenance or to use shared resources. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#rdp-remote-desktop-protocol-from-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#rdp-remote-desktop-protocol-to-the-internet" title="RDP (Remote Desktop Protocol) to the Internet">RDP (Remote Desktop Protocol) to the Internet</a></p></td>
<td align="left" valign="top"><p>Detects network events that may indicate the use of RDP traffic to the Internet. RDP is commonly used by system administrators to remotely control a system for maintenance or to use shared resources. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#rdp-remote-desktop-protocol-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#rpc-remote-procedure-call-from-the-internet" title="RPC (Remote Procedure Call) from the Internet">RPC (Remote Procedure Call) from the Internet</a></p></td>
<td align="left" valign="top"><p>Detects network events that may indicate the use of RPC traffic from the Internet. RPC is commonly used by system administrators to remotely control a system for maintenance or to use shared resources. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#rpc-remote-procedure-call-from-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#rpc-remote-procedure-call-to-the-internet" title="RPC (Remote Procedure Call) to the Internet">RPC (Remote Procedure Call) to the Internet</a></p></td>
<td align="left" valign="top"><p>Detects network events that may indicate the use of RPC traffic to the Internet. RPC is commonly used by system administrators to remotely control a system for maintenance or to use shared resources. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#rpc-remote-procedure-call-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#ransomware-detected-elastic-endpoint" title="Ransomware - Detected - Elastic Endpoint">Ransomware - Detected - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint detected Ransomware. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#ransomware-detected-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#ransomware-prevented-elastic-endpoint" title="Ransomware - Prevented - Elastic Endpoint">Ransomware - Prevented - Elastic Endpoint</a></p></td>
<td align="left" valign="top"><p>Elastic Endpoint prevented Ransomware. Click the Elastic Endpoint icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p></td>
<td align="left" valign="top"><p>[Elastic] [Endpoint]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#ransomware-prevented-elastic-endpoint-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#smb-windows-file-sharing-activity-to-the-internet" title="SMB (Windows File Sharing) Activity to the Internet">SMB (Windows File Sharing) Activity to the Internet</a></p></td>
<td align="left" valign="top"><p>Detects network events that may indicate the use of Windows file sharing (also called SMB or CIFS) traffic to the Internet. SMB is commonly used within networks to share files, printers, and other system resources amongst trusted systems. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back- door vector or for data exfiltration.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#smb-windows-file-sharing-activity-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#smtp-on-port-26-tcp" title="SMTP on Port 26/TCP">SMTP on Port 26/TCP</a></p></td>
<td align="left" valign="top"><p>Detects events that may indicate use of SMTP on TCP port 26. This port is commonly used by several popular mail transfer agents to deconflict with the default SMTP port 25. This port has also been used by a malware family called BadPatch for command and control of Windows systems.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.6.1</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#smtp-on-port-26-tcp-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#smtp-to-the-internet" title="SMTP to the Internet">SMTP to the Internet</a></p></td>
<td align="left" valign="top"><p>Detects events that may describe SMTP traffic from internal hosts to a host across the Internet. In an enterprise network, there is typically a dedicated internal host that performs this function. It is also frequently abused by threat actors for command and control, or data exfiltration.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#smtp-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#sql-traffic-to-the-internet" title="SQL Traffic to the Internet">SQL Traffic to the Internet</a></p></td>
<td align="left" valign="top"><p>Detects events that may describe database traffic (MS SQL, Oracle, MySQL, and Postgresql) across the Internet. Databases should almost never be directly exposed to the Internet, as they are frequently targeted by threat actors to gain initial access to network resources.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#sql-traffic-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#ssh-secure-shell-from-the-internet" title="SSH (Secure Shell) from the Internet">SSH (Secure Shell) from the Internet</a></p></td>
<td align="left" valign="top"><p>Detects network events that may indicate the use of SSH traffic from the Internet. SSH is commonly used by system administrators to remotely control a system using the command line shell. If it is exposed to the Internet, it should be done with strong security controls as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#ssh-secure-shell-from-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#ssh-secure-shell-to-the-internet" title="SSH (Secure Shell) to the Internet">SSH (Secure Shell) to the Internet</a></p></td>
<td align="left" valign="top"><p>Detects network events that may indicate the use of SSH traffic to the Internet. SSH is commonly used by system administrators to remotely control a system using the command line shell. If it is exposed to the Internet, it should be done with strong security controls as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#ssh-secure-shell-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#setgid-bit-set-via-chmod" title="Setgid Bit Set via chmod">Setgid Bit Set via chmod</a></p></td>
<td align="left" valign="top"><p>An adversary may add the setgid bit to a file or directory in order to run a file with the privileges of the owning group. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setgid bit to get code running in a different user’s context. Additionally, adversaries can use this mechanism on their own malware to make sure they&#8217;re able to execute in elevated contexts in the future.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#setuid-bit-set-via-chmod" title="Setuid Bit Set via chmod">Setuid Bit Set via chmod</a></p></td>
<td align="left" valign="top"><p>An adversary may add the setuid bit to a file or directory in order to run a file with the privileges of the owning user. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setuid bit to get code running in a different user’s context. Additionally, adversaries can use this mechanism on their own malware to make sure they&#8217;re able to execute in elevated contexts in the future.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#socat-process-activity" title="Socat Process Activity">Socat Process Activity</a></p></td>
<td align="left" valign="top"><p>A Socat process is running on a Linux host. Socat is often used as a persistence mechanism by exporting a reverse shell, or by serving a shell on a listening port. Socat is also sometimes used for lateral movement.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#socat-process-activity-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#strace-process-activity" title="Strace Process Activity">Strace Process Activity</a></p></td>
<td align="left" valign="top"><p>Strace runs in a privileged context and can be used to escape restrictive environments by instantiating a shell in order to elevate privileges or move laterally.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#strace-process-activity-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#sudoers-file-modification" title="Sudoers File Modification">Sudoers File Modification</a></p></td>
<td align="left" valign="top"><p>A sudoers file specifies the commands that users or groups can run and from which terminals. Adversaries can take advantage of these configurations to execute commands as other users or spawn processes with higher privileges.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#suspicious-ms-office-child-process" title="Suspicious MS Office Child Process">Suspicious MS Office Child Process</a></p></td>
<td align="left" valign="top"><p>Identifies suspicious child processes of frequently targeted Microsoft Office applications (Word, PowerPoint, Excel). These child processes are often launched during exploitation of Office applications or from documents with malicious macros.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#suspicious-ms-office-child-process-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#suspicious-ms-outlook-child-process" title="Suspicious MS Outlook Child Process">Suspicious MS Outlook Child Process</a></p></td>
<td align="left" valign="top"><p>Identifies suspicious child processes of Microsoft Outlook. These child processes are often associated with spear phishing activity.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#suspicious-ms-outlook-child-process-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#suspicious-pdf-reader-child-process" title="Suspicious PDF Reader Child Process">Suspicious PDF Reader Child Process</a></p></td>
<td align="left" valign="top"><p>Identifies suspicious child processes of PDF reader applications. These child processes are often launched via exploitation of PDF applications or social engineering.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#suspicious-powershell-script" title="Suspicious Powershell Script">Suspicious Powershell Script</a></p></td>
<td align="left" valign="top"><p>A machine learning job detected a PowerShell script with unusual data characteristics, such as obfuscation, that may be a characteristic of malicious PowerShell script text blocks.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#svchost-spawning-cmd" title="Svchost spawning Cmd">Svchost spawning Cmd</a></p></td>
<td align="left" valign="top"><p>Identifies a suspicious parent-child process relationship with cmd.exe descending from <code class="literal">svchost.exe</code>.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#svchost-spawning-cmd-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#system-shells-via-services" title="System Shells via Services">System Shells via Services</a></p></td>
<td align="left" valign="top"><p>Windows services typically run as SYSTEM and can be used as a privilege escalation opportunity. Malware or penetration testers may run a shell as a service to gain SYSTEM permissions.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#system-shells-via-services-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#tcp-port-8000-activity-to-the-internet" title="TCP Port 8000 Activity to the Internet">TCP Port 8000 Activity to the Internet</a></p></td>
<td align="left" valign="top"><p>TCP Port 8000 is commonly used for development environments of web server software. It generally should not be exposed directly to the Internet. If you are running software like this on the Internet, you should consider placing it behind a reverse proxy.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#tcp-port-8000-activity-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#telnet-port-activity" title="Telnet Port Activity">Telnet Port Activity</a></p></td>
<td align="left" valign="top"><p>Detects network events that may indicate the use of Telnet traffic. Telnet is commonly used by system administrators to remotely control older or embedded systems using the command line shell. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector. As a plain-text protocol, it may also expose usernames and passwords to anyone capable of observing the traffic.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.6.1</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#telnet-port-activity-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#tor-activity-to-the-internet" title="Tor Activity to the Internet">Tor Activity to the Internet</a></p></td>
<td align="left" valign="top"><p>Detects network events that may indicate the use of Tor traffic to the Internet. Tor is a network protocol that sends traffic through a series of encrypted tunnels used to conceal a user&#8217;s location and usage. Tor may be used by threat actors as an alternate communication pathway to conceal the actor&#8217;s identity and avoid detection.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#tor-activity-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#trusted-developer-application-usage" title="Trusted Developer Application Usage">Trusted Developer Application Usage</a></p></td>
<td align="left" valign="top"><p>Identifies possibly suspicious activity using a trusted Windows developer utility program.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#trusted-developer-application-usage-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-dns-activity" title="Unusual DNS Activity">Unusual DNS Activity</a></p></td>
<td align="left" valign="top"><p>A machine learning job detected a rare and unusual DNS query that indicates network activity with unusual DNS domains. This can be due to initial access, persistence, command-and-control, or exfiltration activity. For example, when a user clicks on a link in a phishing email or opens a malicious document, a request may be sent to download and run a payload from an uncommon domain. When malware is already running, it may send requests to an uncommon DNS domain the malware uses for command-and-control communication.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Packetbeat]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-linux-network-activity" title="Unusual Linux Network Activity">Unusual Linux Network Activity</a></p></td>
<td align="left" valign="top"><p>Identifies Linux processes that do not usually use the network but have unexpected network activity, which can indicate command-and-control, lateral movement, persistence, or data exfiltration activity. A process with unusual network activity can denote process exploitation or injection, where the process is used to run persistence mechanisms that allow a malicious actor remote access or control of the host, data exfiltration, and execution of unauthorized network applications.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux] [ML]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-linux-network-port-activity" title="Unusual Linux Network Port Activity">Unusual Linux Network Port Activity</a></p></td>
<td align="left" valign="top"><p>Identifies unusual destination port activity that can indicate command-and- control, persistence mechanism, or data exfiltration activity. Rarely used destination port activity is generally unusual in Linux fleets, and can indicate unauthorized access or threat actor activity.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux] [ML]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-linux-network-service" title="Unusual Linux Network Service">Unusual Linux Network Service</a></p></td>
<td align="left" valign="top"><p>Identifies unusual listening ports on Linux instances that can indicate execution of unauthorized services, backdoors, or persistence mechanisms.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux] [ML]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-linux-username" title="Unusual Linux Username">Unusual Linux Username</a></p></td>
<td align="left" valign="top"><p>A machine learning job detected activity for a username that is not normally active, which can indicate unauthorized changes, activity by unauthorized users, lateral movement, or compromised credentials. In many organizations, new usernames are not often created apart from specific types of system activities, such as creating new accounts for new employees. These user accounts quickly become active and routine. Events from rarely used usernames can point to suspicious activity. Additionally, automated Linux fleets tend to see activity from rarely used usernames only when personnel log in to make authorized or unauthorized changes, or threat actors have acquired credentials and log in for malicious purposes. Unusual usernames can also indicate pivoting, where compromised credentials are used to try and move laterally from one host to another.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux] [ML]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-linux-web-activity" title="Unusual Linux Web Activity">Unusual Linux Web Activity</a></p></td>
<td align="left" valign="top"><p>A machine learning job detected an unusual web URL request from a Linux host, which can indicate malware delivery and execution. Wget and cURL are commonly used by Linux programs to download code and data. Most of the time, their usage is entirely normal. Generally, because they use a list of URLs, they repeatedly download from the same locations. However, Wget and cURL are sometimes used to deliver Linux exploit payloads, and threat actors use these tools to download additional software and code. For these reasons, unusual URLs can indicate unauthorized downloads or threat activity.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux] [ML]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-login-activity" title="Unusual Login Activity">Unusual Login Activity</a></p></td>
<td align="left" valign="top"><p>Identifies an unusually high number of authentication attempts.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux] [ML]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-network-connection-via-rundll32" title="Unusual Network Connection via RunDLL32">Unusual Network Connection via RunDLL32</a></p></td>
<td align="left" valign="top"><p>Identifies unusual instances of <code class="literal">rundll32.exe</code> making outbound network connections. This may indicate adversarial activity and may identify malicious DLLs.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#unusual-network-connection-via-rundll32-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-network-destination-domain-name" title="Unusual Network Destination Domain Name">Unusual Network Destination Domain Name</a></p></td>
<td align="left" valign="top"><p>A machine learning job detected an unusual network destination domain name. This can be due to initial access, persistence, command-and-control, or exfiltration activity. For example, when a user clicks on a link in a phishing email or opens a malicious document, a request may be sent to download and run a payload from an uncommon web server name. When malware is already running, it may send requests to an uncommon DNS domain the malware uses for command-and-control communication.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Packetbeat]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-parent-child-relationship" title="Unusual Parent-Child Relationship">Unusual Parent-Child Relationship</a></p></td>
<td align="left" valign="top"><p>Identifies Windows programs run from unexpected parent processes. This could indicate masquerading or other strange activity on a system.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#unusual-parent-child-relationship-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-process-execution-temp" title="Unusual Process Execution - Temp">Unusual Process Execution - Temp</a></p></td>
<td align="left" valign="top"><p>Identifies processes running in a temporary folder. This is sometimes done by adversaries to hide malware.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#unusual-process-execution-temp-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-process-for-a-linux-host" title="Unusual Process For a Linux Host">Unusual Process For a Linux Host</a></p></td>
<td align="left" valign="top"><p>Identifies rare processes that do not usually run on individual hosts, which can indicate execution of unauthorized services, malware, or persistence mechanisms. Processes are considered rare when they only run occasionally as compared with other processes running on the host.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux] [ML]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-process-for-a-windows-host" title="Unusual Process For a Windows Host">Unusual Process For a Windows Host</a></p></td>
<td align="left" valign="top"><p>Identifies rare processes that do not usually run on individual hosts, which can indicate execution of unauthorized services, malware, or persistence mechanisms. Processes are considered rare when they only run occasionally as compared with other processes running on the host.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-process-network-connection" title="Unusual Process Network Connection">Unusual Process Network Connection</a></p></td>
<td align="left" valign="top"><p>Identifies network activity from unexpected system applications. This may indicate adversarial activity as these applications are often leveraged by adversaries to execute code and evade detection.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#unusual-process-network-connection-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-web-request" title="Unusual Web Request">Unusual Web Request</a></p></td>
<td align="left" valign="top"><p>A machine learning job detected a rare and unusual URL that indicates unusual web browsing activity. This can be due to initial access, persistence, command- and-control, or exfiltration activity. For example, in a strategic web compromise or watering hole attack, when a trusted website is compromised to target a particular sector or organization, targeted users may receive emails with uncommon URLs for trusted websites. These URLs can be used to download and run a payload. When malware is already running, it may send requests to uncommon URLs on trusted websites the malware uses for command-and-control communication. When rare URLs are observed being requested for a local web server by a remote source, these can be due to web scanning, enumeration or attack traffic, or they can be due to bots and web scrapers which are part of common Internet background traffic.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Packetbeat]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-web-user-agent" title="Unusual Web User Agent">Unusual Web User Agent</a></p></td>
<td align="left" valign="top"><p>A machine learning job detected a rare and unusual user agent indicating web browsing activity by an unusual process other than a web browser. This can be due to persistence, command-and-control, or exfiltration activity. Uncommon user agents coming from remote sources to local destinations are often the result of scanners, bots, and web scrapers, which are part of common Internet background traffic. Much of this is noise, but more targeted attacks on websites using tools like Burp or SQLmap can sometimes be discovered by spotting uncommon user agents. Uncommon user agents in traffic from local sources to remote destinations can be any number of things, including harmless programs like weather monitoring or stock-trading programs. However, uncommon user agents from local sources can also be due to malware or scanning activity.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Packetbeat]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-windows-network-activity" title="Unusual Windows Network Activity">Unusual Windows Network Activity</a></p></td>
<td align="left" valign="top"><p>Identifies Windows processes that do not usually use the network but have unexpected network activity, which can indicate command-and-control, lateral movement, persistence, or data exfiltration activity. A process with unusual network activity can denote process exploitation or injection, where the process is used to run persistence mechanisms that allow a malicious actor remote access or control of the host, data exfiltration, and execution of unauthorized network applications.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-windows-path-activity" title="Unusual Windows Path Activity">Unusual Windows Path Activity</a></p></td>
<td align="left" valign="top"><p>Identifies processes started from atypical folders in the file system, which may indicate malware execution or persistence mechanisms. In corporate Windows environments, software installation is centrally managed and it is unusual for programs to be executed from user or temporary directories. Processes executed from these locations can denote that a user downloaded software directly from the Internet or a malicious script or macro executed malware.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-windows-remote-user" title="Unusual Windows Remote User">Unusual Windows Remote User</a></p></td>
<td align="left" valign="top"><p>A machine learning job detected an unusual remote desktop protocol (RDP) username, which can indicate account takeover or credentialed persistence using compromised accounts. RDP attacks, such as BlueKeep, also tend to use unusual usernames.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-windows-service" title="Unusual Windows Service">Unusual Windows Service</a></p></td>
<td align="left" valign="top"><p>A machine learning job detected an unusual Windows service, This can indicate execution of unauthorized services, malware, or persistence mechanisms. In corporate Windows environments, hosts do not generally run many rare or unique services. This job helps detect malware and persistence mechanisms that have been installed and run as a service.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-windows-user-privilege-elevation-activity" title="Unusual Windows User Privilege Elevation Activity">Unusual Windows User Privilege Elevation Activity</a></p></td>
<td align="left" valign="top"><p>A machine learning job detected an unusual user context switch, using the <code class="literal">runas</code> command or similar techniques, which can indicate account takeover or privilege escalation using compromised accounts. Privilege elevation using tools like <code class="literal">runas</code> are more commonly used by domain and network administrators than by regular Windows users.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#unusual-windows-username" title="Unusual Windows Username">Unusual Windows Username</a></p></td>
<td align="left" valign="top"><p>A machine learning job detected activity for a username that is not normally active, which can indicate unauthorized changes, activity by unauthorized users, lateral movement, or compromised credentials. In many organizations, new usernames are not often created apart from specific types of system activities, such as creating new accounts for new employees. These user accounts quickly become active and routine. Events from rarely used usernames can point to suspicious activity. Unusual usernames can also indicate pivoting, where compromised credentials are used to try and move laterally from one host to another.</p></td>
<td align="left" valign="top"><p>[Elastic] [ML] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#user-account-creation" title="User Account Creation">User Account Creation</a></p></td>
<td align="left" valign="top"><p>Identifies attempts to create new local users. This is sometimes done by attackers to increase access to a system or domain.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#user-account-creation-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#user-discovery-via-whoami" title="User Discovery via Whoami">User Discovery via Whoami</a></p></td>
<td align="left" valign="top"><p>The <code class="literal">whoami</code> application was executed on a Linux host. This is often used by tools and persistence mechanisms to test for privileged access.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#user-discovery-via-whoami-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#vnc-virtual-network-computing-from-the-internet" title="VNC (Virtual Network Computing) from the Internet">VNC (Virtual Network Computing) from the Internet</a></p></td>
<td align="left" valign="top"><p>Detects network events that may indicate the use of VNC traffic from the Internet. VNC is commonly used by system administrators to remotely control a system for maintenance or to use shared resources. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#vnc-virtual-network-computing-from-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#vnc-virtual-network-computing-to-the-internet" title="VNC (Virtual Network Computing) to the Internet">VNC (Virtual Network Computing) to the Internet</a></p></td>
<td align="left" valign="top"><p>Detects network events that may indicate the use of VNC traffic to the Internet. VNC is commonly used by system administrators to remotely control a system for maintenance or to use shared resources. It should almost never be directly exposed to the Internet, as it is frequently targeted and exploited by threat actors as an initial access or back-door vector.</p></td>
<td align="left" valign="top"><p>[Elastic] [Network]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>3 <a class="xref" href="prebuilt-rules.html#vnc-virtual-network-computing-to-the-internet-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#virtual-machine-fingerprinting" title="Virtual Machine Fingerprinting">Virtual Machine Fingerprinting</a></p></td>
<td align="left" valign="top"><p>An adversary may attempt to get detailed information about the operating system and hardware. This rule identifies common locations used to discover virtual machine hardware by a non-root user. This technique has been used by the Pupy RAT and other malware.</p></td>
<td align="left" valign="top"><p>[Elastic] [Linux]</p></td>
<td align="left" valign="top"><p>7.8.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#volume-shadow-copy-deletion-via-vssadmin" title="Volume Shadow Copy Deletion via VssAdmin">Volume Shadow Copy Deletion via VssAdmin</a></p></td>
<td align="left" valign="top"><p>Identifies use of <code class="literal">vssadmin.exe</code> for shadow copy deletion on endpoints. This commonly occurs in tandem with ransomware or other destructive attacks.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#volume-shadow-copy-deletion-via-vssadmin-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#volume-shadow-copy-deletion-via-wmic" title="Volume Shadow Copy Deletion via WMIC">Volume Shadow Copy Deletion via WMIC</a></p></td>
<td align="left" valign="top"><p>Identifies use of <code class="literal">wmic.exe</code> for shadow copy deletion on endpoints. This commonly occurs in tandem with ransomware or other destructive attacks.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#volume-shadow-copy-deletion-via-wmic-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#web-application-suspicious-activity-no-user-agent" title="Web Application Suspicious Activity: No User Agent">Web Application Suspicious Activity: No User Agent</a></p></td>
<td align="left" valign="top"><p>A request to a web application server contained no identifying user agent string.</p></td>
<td align="left" valign="top"><p>[APM] [Elastic]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#web-application-suspicious-activity-no-user-agent-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#web-application-suspicious-activity-post-request-declined" title="Web Application Suspicious Activity: POST Request Declined">Web Application Suspicious Activity: POST Request Declined</a></p></td>
<td align="left" valign="top"><p>A POST request to web application returned a 403 response, which indicates the web application declined to process the request because the action requested was not allowed.</p></td>
<td align="left" valign="top"><p>[APM] [Elastic]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#web-application-suspicious-activity-post-request-declined-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#web-application-suspicious-activity-unauthorized-method" title="Web Application Suspicious Activity: Unauthorized Method">Web Application Suspicious Activity: Unauthorized Method</a></p></td>
<td align="left" valign="top"><p>A request to web application returned a 405 response which indicates the web application declined to process the request because the HTTP method is not allowed for the resource.</p></td>
<td align="left" valign="top"><p>[APM] [Elastic]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#web-application-suspicious-activity-unauthorized-method-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#web-application-suspicious-activity-sqlmap-user-agent" title="Web Application Suspicious Activity: sqlmap User Agent">Web Application Suspicious Activity: sqlmap User Agent</a></p></td>
<td align="left" valign="top"><p>This is an example of how to detect an unwanted web client user agent. This search matches the user agent for sqlmap 1.3.11, which is a popular FOSS tool for testing web applications for SQL injection vulnerabilities.</p></td>
<td align="left" valign="top"><p>[APM] [Elastic]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#web-application-suspicious-activity-sqlmap-user-agent-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#whoami-process-activity" title="Whoami Process Activity">Whoami Process Activity</a></p></td>
<td align="left" valign="top"><p>Identifies use of <code class="literal">whoami.exe</code> which displays user, group, and privileges information for the user who is currently logged on to the local system.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#whoami-process-activity-history" title="Rule version history">Version history</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#windows-cryptoapi-spoofing-vulnerability-cve-2020-0601-curveball" title="Windows CryptoAPI Spoofing Vulnerability (CVE-2020-0601 - CurveBall)">Windows CryptoAPI Spoofing Vulnerability (CVE-2020-0601 - CurveBall)</a></p></td>
<td align="left" valign="top"><p>A spoofing vulnerability exists in the way Windows CryptoAPI (<code class="literal">Crypt32.dll</code>) validates Elliptic Curve Cryptography (ECC) certificates. An attacker could exploit the vulnerability by using a spoofed code-signing certificate to sign a malicious executable, making it appear the file was from a trusted, legitimate source.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rules.html#windows-script-executing-powershell" title="Windows Script Executing PowerShell">Windows Script Executing PowerShell</a></p></td>
<td align="left" valign="top"><p>Identifies a PowerShell process launched by either <code class="literal">cscript.exe</code> or <code class="literal">wscript.exe</code>. Observing Windows scripting processes executing a PowerShell script, may be indicative of malicious activity.</p></td>
<td align="left" valign="top"><p>[Elastic] [Windows]</p></td>
<td align="left" valign="top"><p>7.7.0</p></td>
<td align="left" valign="top"><p>2 <a class="xref" href="prebuilt-rules.html#windows-script-executing-powershell-history" title="Rule version history">Version history</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="adding-hidden-file-attribute-via-attrib"></a>Adding Hidden File Attribute via Attrib<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/adding-hidden-file-attribute-via-attrib.asciidoc">edit</a></h3>
</div></div></div>
<p>Adversaries can add the <code class="literal">hidden</code> attribute to files to hide them from the user
in an attempt to evade detection.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#adding-hidden-file-attribute-via-attrib-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/adding-hidden-file-attribute-via-attrib.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:attrib.exe and process.args:+h</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/adding-hidden-file-attribute-via-attrib.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Hidden Files and Directories
</li>
<li class="listitem">
ID: T1158
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1158/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1158/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Hidden Files and Directories
</li>
<li class="listitem">
ID: T1158
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1158/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1158/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="adding-hidden-file-attribute-via-attrib-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/adding-hidden-file-attribute-via-attrib.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:"attrib.exe" and process.args:"+h"</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="adobe-hijack-persistence"></a>Adobe Hijack Persistence<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/adobe-hijack-persistence.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects the creation of an executable file or files that will be automatically
run by Acrobat Reader when it starts.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#adobe-hijack-persistence-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.6.2</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_2"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/adobe-hijack-persistence.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">file.path:("C:\Program Files (x86)\Adobe\Acrobat Reader
DC\Reader\AcroCEF\RdrCEF.exe" or "C:\Program Files\Adobe\Acrobat
Reader DC\Reader\AcroCEF\RdrCEF.exe") and event.action:"File created
(rule: FileCreate)" and not process.name:msiexec.exe</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_2"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/adobe-hijack-persistence.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: File System Permissions Weakness
</li>
<li class="listitem">
ID: T1044
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1044/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1044/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="adobe-hijack-persistence-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/adobe-hijack-persistence.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.6.2 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">file.path:("C:\Program Files (x86)\Adobe\Acrobat Reader
DC\Reader\AcroCEF\RdrCEF.exe" or "C:\Program Files\Adobe\Acrobat
Reader DC\Reader\AcroCEF\RdrCEF.exe") and event.action:"File created
(rule: FileCreate)" and not process.name:msiexeec.exe</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="adversary-behavior-detected-elastic-endpoint"></a>Adversary Behavior - Detected - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/adversary-behavior-detected-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint detected an Adversary Behavior. Click the Elastic Endpoint icon
in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the
External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#adversary-behavior-detected-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_3"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/adversary-behavior-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
(event.action:rules_engine_event or
endgame.event_subtype_full:rules_engine_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="adversary-behavior-detected-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/adversary-behavior-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:rules_engine_event</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="anomalous-process-for-a-linux-population"></a>Anomalous Process For a Linux Population<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/anomalous-process-for-a-linux-population.asciidoc">edit</a></h3>
</div></div></div>
<p>Searches for rare processes running on multiple Linux hosts in an entire fleet
or network. This reduces the detection of false positives since automated
maintenance processes usually only run occasionally on a single machine but are
common to all or many hosts in a fleet.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: linux_anomalous_process_all_hosts_ecs</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
<li class="listitem">
ML
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/anomalous-process-for-a-linux-population.asciidoc">edit</a></h4>
</div></div></div>
<p>A newly installed program or one that runs rarely as part of a monthly or
quarterly workflow could trigger this signal.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_investigation_guide"></a>Investigation guide<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/anomalous-process-for-a-linux-population.asciidoc">edit</a></h4>
</div></div></div>
<p>Signals from this rule indicate the presence of a Linux process that is rare
and unusual for all of the monitored Linux hosts for which Auditbeat data is
available. Here are some possible avenues of investigation:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Consider the user as identified by the username field. Is this program part
of an expected workflow for the user who ran this program on this host?
</li>
<li class="listitem">
Examine the history of execution. If this process manifested only very
recently, it might be part of a new software package. If it has a consistent
schedule - for example if it runs monthly or quarterly - it might be part of a
monthly or quarterly business process.
</li>
<li class="listitem">
Examine the process arguments, title and working directory. These may provide
indications as to the source of the program or the nature of the tasks it is
performing.
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="anomalous-process-for-a-windows-population"></a>Anomalous Process For a Windows Population<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/anomalous-process-for-a-windows-population.asciidoc">edit</a></h3>
</div></div></div>
<p>Searches for rare processes running on multiple hosts in an entire fleet or
network. This reduces the detection of false positives since automated
maintenance processes usually only run occasionally on a single machine but are
common to all or many hosts in a fleet.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: windows_anomalous_process_all_hosts_ecs</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_2"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/anomalous-process-for-a-windows-population.asciidoc">edit</a></h4>
</div></div></div>
<p>A newly installed program or one that runs rarely as part of a monthly or
quarterly workflow could trigger this signal.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_investigation_guide_2"></a>Investigation guide<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/anomalous-process-for-a-windows-population.asciidoc">edit</a></h4>
</div></div></div>
<p>Signals from this rule indicate the presence of a Windows process that is rare
and unusual for all of the Windows hosts for which Winlogbeat data is
available. Here are some possible avenues of investigation:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Consider the user as identified by the username field. Is this program part
of an expected workflow for the user who ran this program on this host?
</li>
<li class="listitem">
Examine the history of execution. If this process manifested only very
recently, it might be part of a new software package. If it has a consistent
schedule - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.
</li>
<li class="listitem">
Examine the process metadata like the values of the Company, Description and
Product fields, which may indicate whether the program is associated with an
expected software vendor or package.
</li>
<li class="listitem">
Examine arguments and working directory. These may provide
indications as to the source of the program or the nature of the tasks it is
performing.
</li>
<li class="listitem">
Consider the same for the parent process. If the parent process is
a legitimate system utility or service, this could be related to software
updates or system management. If the parent process is something user-facing
like an Office application, this process could be more suspicious.
</li>
<li class="listitem">
If you have file hash values in the event data, and you suspect malware, you
can optionally run a search for the file hash to see if the file is identified
as malware by anti-malware tools.
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="anomalous-windows-process-creation"></a>Anomalous Windows Process Creation<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/anomalous-windows-process-creation.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies unusual parent-child process relationships that can indicate malware
execution or persistence mechanisms. Malicious scripts often call on other
applications and processes as part of their exploit payload. For example, when a
malicious Office document runs scripts as part of an exploit payload, Excel or
Word may start a script interpreter process, which, in turn, runs a script that
downloads and executes malware. Another common scenario is Outlook running an
unusual process when malware is downloaded in an email. Monitoring and
identifying anomalous process relationships is a method of detecting new and
emerging malware that is not yet recognized by anti-virus scanners.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: windows_anomalous_process_creation</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_3"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/anomalous-windows-process-creation.asciidoc">edit</a></h4>
</div></div></div>
<p>Users running scripts in the course of technical support operations of software
upgrades could trigger this signal. A newly installed program or one that runs
rarely as part of a monthly or quarterly workflow could trigger this signal.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="attempt-to-disable-iptables-or-firewall"></a>Attempt to Disable IPTables or Firewall<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/attempt-to-disable-iptables-or-firewall.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies attempts to disable iptables or a firewall service, a technique
adversaries can to modify the network traffic hosts are allowed to send and
receive.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_4"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/attempt-to-disable-iptables-or-firewall.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:(executed or process_started) and (process.name:service
and process.args:stop or process.name:chkconfig and process.args:off)
and process.args:(ip6tables or iptables) or process.name:systemctl and
process.args:(firewalld and (disable or stop or kill))</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_3"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/attempt-to-disable-iptables-or-firewall.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Disabling Security Tools
</li>
<li class="listitem">
ID: T1089
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1089/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1089/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="attempt-to-disable-syslog-service"></a>Attempt to Disable Syslog Service<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/attempt-to-disable-syslog-service.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies attempts to disable the syslog service, a technique adversaries can
use to disrupt event logging and evade detection by security controls.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_5"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/attempt-to-disable-syslog-service.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:(executed or process_started) and ((process.name:service
and process.args:stop) or (process.name:chkconfig and
process.args:off) or (process.name:systemctl and process.args:(disable
or stop or kill))) and process.args:(syslog or rsyslog or "syslog-ng")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_4"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/attempt-to-disable-syslog-service.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Disabling Security Tools
</li>
<li class="listitem">
ID: T1089
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1089/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1089/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="base16-or-base32-encoding-decoding-activity"></a>Base16 or Base32 Encoding/Decoding Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/base16-or-base32-encoding-decoding-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies attempts to encode and decode data, a technique adversaries can
use to evade detection by host- or network-based security controls.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_4"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/base16-or-base32-encoding-decoding-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Automated tools such as Jenkins may encode or decode files as part of their
normal behavior. These events can be filtered by the process executable or
username values.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_6"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/base16-or-base32-encoding-decoding-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:(executed or process_started) and process.name:(base16 or
base32 or base32plain or base32hex)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_5"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/base16-or-base32-encoding-decoding-activity.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Deobfuscate/Decode Files or Information
</li>
<li class="listitem">
ID: T1140
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1140/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1140/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Obfuscated Files or Information
</li>
<li class="listitem">
ID: T1027
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1027/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1027/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="base64-encoding-decoding-activity"></a>Base64 Encoding/Decoding Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/base64-encoding-decoding-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies attempts to encode and decode data, a technique adversaries can
use to evade detection by host- or network-based security controls.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_5"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/base64-encoding-decoding-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Automated tools such as Jenkins may encode or decode files as part of their normal behavior. These events can be filtered by the process executable or username values.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_7"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/base64-encoding-decoding-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:(executed or process_started) and process.name:(base64 or
base64plain or base64url or base64mime or base64pem)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_6"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/base64-encoding-decoding-activity.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Deobfuscate/Decode Files or Information
</li>
<li class="listitem">
ID: T1140
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1140/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1140/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Obfuscated Files or Information
</li>
<li class="listitem">
ID: T1027
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1027/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1027/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="bypass-uac-via-event-viewer"></a>Bypass UAC via Event Viewer<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/bypass-uac-via-event-viewer.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies User Account Control (UAC) bypass via <code class="literal">eventvwr.exe.</code> Attackers
bypass UAC to stealthily execute code with elevated permissions.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_8"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/bypass-uac-via-event-viewer.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.parent.name:eventvwr.exe and event.action:"Process Create
(rule: ProcessCreate)" and not
process.executable:("C:\Windows\SysWOW64\mmc.exe" or
"C:\Windows\System32\mmc.exe")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_7"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/bypass-uac-via-event-viewer.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Bypass User Account Control
</li>
<li class="listitem">
ID: T1088
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1088/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1088/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clearing-windows-event-logs"></a>Clearing Windows Event Logs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/clearing-windows-event-logs.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies attempts to clear Windows event log stores. This is often done by
attackers in an attempt to evade detection or destroy forensic evidence on a
system.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#clearing-windows-event-logs-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_9"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/clearing-windows-event-logs.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:wevtutil.exe and process.args:cl or
process.name:powershell.exe and process.args:Clear-EventLog</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_8"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/clearing-windows-event-logs.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Indicator Removal on Host
</li>
<li class="listitem">
ID: T1070
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1070/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1070/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="clearing-windows-event-logs-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/clearing-windows-event-logs.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
(process.name:"wevtutil.exe" and process.args:"cl") or
(process.name:"powershell.exe" and process.args:"Clear-EventLog")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="command-prompt-network-connection"></a>Command Prompt Network Connection<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/command-prompt-network-connection.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies <code class="literal">cmd.exe</code> making a network connection. Adversaries can abuse
<code class="literal">cmd.exe</code> to download or execute malware from a remote URL.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#command-prompt-network-connection-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_6"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/command-prompt-network-connection.asciidoc">edit</a></h4>
</div></div></div>
<p>Administrators may use the command prompt for regular administrative tasks. It&#8217;s
important to baseline your environment for network connections being made from
the command prompt to determine any abnormal use of this tool.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_10"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/command-prompt-network-connection.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:cmd.exe and event.action:"Network connection detected
(rule: NetworkConnect)" and not destination.ip:(10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_9"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/command-prompt-network-connection.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command-Line Interface
</li>
<li class="listitem">
ID: T1059
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1059/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1059/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Remote File Copy
</li>
<li class="listitem">
ID: T1105
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1105/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1105/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="command-prompt-network-connection-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/command-prompt-network-connection.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:cmd.exe and event.action:"Network connection detected
(rule: NetworkConnect)" and not destination.ip:10.0.0.0/8 and not
destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="connection-to-external-network-via-telnet"></a>Connection to External Network via Telnet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/connection-to-external-network-via-telnet.asciidoc">edit</a></h3>
</div></div></div>
<p>Telnet provides a command line interface for communication with a remote device or server. This rule identifies Telnet network connections to publicly routable IP addresses.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_7"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/connection-to-external-network-via-telnet.asciidoc">edit</a></h4>
</div></div></div>
<p>Telnet can be used for both benign or malicious purposes. Telnet is included by default in some Linux distributions, so its presence is not inherently suspicious. The use of Telnet to manage devices remotely has declined in recent years in favor of more secure protocols such as SSH. Telnet usage by non-automated tools or frameworks may be suspicious.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_11"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/connection-to-external-network-via-telnet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:("connected-to" or "network_flow") and
process.name:telnet and not destination.ip:(127.0.0.0/8 or 10.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16 or "FE80::/10" or "::1/128")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_10"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/connection-to-external-network-via-telnet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Lateral Movement
</li>
<li class="listitem">
ID: TA0008
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0008/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0008/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Remote Services
</li>
<li class="listitem">
ID: T1021
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1021/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1021/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="connection-to-internal-network-via-telnet"></a>Connection to Internal Network via Telnet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/connection-to-internal-network-via-telnet.asciidoc">edit</a></h3>
</div></div></div>
<p>Telnet provides a command line interface for communication with a remote device or server. This rule identifies Telnet network connections to non-publicly routable IP addresses.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_8"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/connection-to-internal-network-via-telnet.asciidoc">edit</a></h4>
</div></div></div>
<p>Telnet can be used for both benign or malicious purposes. Telnet is included by default in some Linux distributions, so its presence is not inherently suspicious. The use of Telnet to manage devices remotely has declined in recent years in favor of more secure protocols such as SSH. Telnet usage by non-automated tools or frameworks may be suspicious.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_12"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/connection-to-internal-network-via-telnet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:("connected-to" or "network_flow") and
process.name:telnet and destination.ip:((10.0.0.0/8 or 172.16.0.0/12
or 192.168.0.0/16 or "FE80::/10") and not (127.0.0.0/8 or "::1/128"))</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_11"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/connection-to-internal-network-via-telnet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Lateral Movement
</li>
<li class="listitem">
ID: TA0008
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0008/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0008/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Remote Services
</li>
<li class="listitem">
ID: T1021
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1021/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1021/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="credential-dumping-detected-elastic-endpoint"></a>Credential Dumping - Detected - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/credential-dumping-detected-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint detected Credential Dumping. Click the Elastic Endpoint icon in
the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the
External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#credential-dumping-detected-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_13"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/credential-dumping-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:detection and (event.action:cred_theft_event or
endgame.event_subtype_full:cred_theft_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="credential-dumping-detected-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/credential-dumping-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:cred_theft_event and endgame.metadata.type:detection</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="credential-dumping-prevented-elastic-endpoint"></a>Credential Dumping - Prevented - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/credential-dumping-prevented-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint prevented Credential Dumping. Click the Elastic Endpoint icon
in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the
External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#credential-dumping-prevented-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_14"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/credential-dumping-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:prevention and (event.action:cred_theft_event or
endgame.event_subtype_full:cred_theft_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="credential-dumping-prevented-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/credential-dumping-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:cred_theft_event and endgame.metadata.type:prevention</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="credential-manipulation-detected-elastic-endpoint"></a>Credential Manipulation - Detected - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/credential-manipulation-detected-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint detected Credential Manipulation. Click the Elastic Endpoint
icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in
the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional
information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#credential-manipulation-detected-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_15"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/credential-manipulation-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:detection and
(event.action:token_manipulation_event or
endgame.event_subtype_full:token_manipulation_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="credential-manipulation-detected-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/credential-manipulation-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:token_manipulation_event and
endgame.metadata.type:detection</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="credential-manipulation-prevented-elastic-endpoint"></a>Credential Manipulation - Prevented - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/credential-manipulation-prevented-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint prevented Credential Manipulation. Click the Elastic Endpoint
icon in the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in
the External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional
information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#credential-manipulation-prevented-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_16"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/credential-manipulation-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:prevention and
(event.action:token_manipulation_event or
endgame.event_subtype_full:token_manipulation_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="credential-manipulation-prevented-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/credential-manipulation-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:token_manipulation_event and
endgame.metadata.type:prevention</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="dns-activity-to-the-internet"></a>DNS Activity to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/dns-activity-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects when an internal network client sends DNS traffic directly to the
Internet. This is atypical behavior for a managed network, and can be indicative
of malware, exfiltration, command and control, or, simply, misconfiguration.
This DNS activity also impacts your organization&#8217;s ability to provide enterprise
monitoring and logging of DNS, and opens your network to a variety of abuses and
malicious communications.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://www.us-cert.gov/ncas/alerts/TA15-240A" class="ulink" target="_top">https://www.us-cert.gov/ncas/alerts/TA15-240A</a>
</li>
<li class="listitem">
<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-81-2.pdf" class="ulink" target="_top">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-81-2.pdf</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#dns-activity-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_9"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/dns-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>Exclude DNS servers from this rule as this is expected behavior. Endpoints
usually query local DNS servers defined in their DHCP scopes, but this may be
overridden if a user configures their endpoint to use a remote DNS server. This
is uncommon in managed enterprise networks because it could break intranet name
resolution when split horizon DNS is utilized. Some consumer VPN services and
browser plug-ins may send DNS traffic to remote Internet destinations. In that
case, such devices or networks can be excluded from this rule when this is
expected behavior.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_17"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/dns-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">destination.port:53 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or
169.254.169.254/32 or 172.16.0.0/12 or 192.168.0.0/16 or 224.0.0.251
or 224.0.0.252 or 255.255.255.255 or "::1" or "ff02::fb")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_12"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/dns-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="dns-activity-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/dns-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">destination.port:53 and ( network.direction: outbound or (
source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not
destination.ip:( 169.254.169.254/32 or 127.0.0.53/32 or 10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16 or 224.0.0.251 or ff02\:\:fb or
255.255.255.255 ) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="dns-tunneling"></a>DNS Tunneling<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/dns-tunneling.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects unusually large numbers of DNS queries for a single top-level DNS
domain, which is often used for DNS tunneling. DNS tunneling can be used for
command-and-control, persistence, or data exfiltration activity. For example,
<code class="literal">dnscat</code> tends to generate many DNS questions for a top-level domain as it uses
the DNS protocol to tunnel data.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: packetbeat_dns_tunneling</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Packetbeat
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_10"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/dns-tunneling.asciidoc">edit</a></h4>
</div></div></div>
<p>DNS domains that use large numbers of child domains, such as software or content
distribution networks, can trigger this signal and such parent domains can be
excluded.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-volume-usn-journal-with-fsutil"></a>Delete Volume USN Journal with Fsutil<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/delete-volume-usn-journal-with-fsutil.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies use of the <code class="literal">fsutil.exe</code> to delete the <code class="literal">USNJRNL</code> volume. This
technique is used by attackers to eliminate evidence of files created during
post-exploitation activities.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#delete-volume-usn-journal-with-fsutil-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_18"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/delete-volume-usn-journal-with-fsutil.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:fsutil.exe and process.args:(deletejournal and usn)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_13"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/delete-volume-usn-journal-with-fsutil.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: File Deletion
</li>
<li class="listitem">
ID: T1107
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1107/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1107/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="delete-volume-usn-journal-with-fsutil-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/delete-volume-usn-journal-with-fsutil.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:"fsutil.exe" and process.args:("usn" and "deletejournal")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="deleting-backup-catalogs-with-wbadmin"></a>Deleting Backup Catalogs with Wbadmin<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/deleting-backup-catalogs-with-wbadmin.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies use of the <code class="literal">wbadmin.exe</code> to delete the backup catalog. Ransomware and
other malware may do this to prevent system recovery.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#deleting-backup-catalogs-with-wbadmin-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_19"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/deleting-backup-catalogs-with-wbadmin.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:wbadmin.exe and process.args:(catalog and delete)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_14"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/deleting-backup-catalogs-with-wbadmin.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: File Deletion
</li>
<li class="listitem">
ID: T1107
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1107/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1107/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="deleting-backup-catalogs-with-wbadmin-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/deleting-backup-catalogs-with-wbadmin.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:"wbadmin.exe" and process.args:("delete" and "catalog")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="direct-outbound-smb-connection"></a>Direct Outbound SMB Connection<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/direct-outbound-smb-connection.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies unexpected processes making network connections over port 445.
Windows File Sharing is typically implemented over Server Message Block (SMB),
which communicates between hosts using port 445. When legitimate, these network
connections are established by the kernel. Processes making 445/tcp connections
may be port scanners, exploits, or suspicious user-level processes moving
laterally.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#direct-outbound-smb-connection-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_20"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/direct-outbound-smb-connection.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Network connection detected (rule: NetworkConnect)" and
destination.port:445 and not process.pid:4 and not
destination.ip:(127.0.0.1 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_15"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/direct-outbound-smb-connection.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Lateral Movement
</li>
<li class="listitem">
ID: TA0008
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0008/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0008/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exploitation of Remote Services
</li>
<li class="listitem">
ID: T1210
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1210/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1210/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="direct-outbound-smb-connection-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/direct-outbound-smb-connection.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Network connection detected (rule: NetworkConnect)" and
destination.port:445 and not process.pid:4 and not
destination.ip:("127.0.0.1" or "::1")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="disable-windows-firewall-rules-via-netsh"></a>Disable Windows Firewall Rules via Netsh<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/disable-windows-firewall-rules-via-netsh.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies use of the <code class="literal">netsh.exe</code> to disable or weaken the local firewall.
Attackers will use this command line tool to disable the firewall during
troubleshooting or to enable network mobility.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#disable-windows-firewall-rules-via-netsh-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_21"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/disable-windows-firewall-rules-via-netsh.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:netsh.exe and process.args:(disable and firewall and set)
or process.args:(advfirewall and off and state)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_16"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/disable-windows-firewall-rules-via-netsh.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Disabling Security Tools
</li>
<li class="listitem">
ID: T1089
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1089/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1089/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="disable-windows-firewall-rules-via-netsh-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/disable-windows-firewall-rules-via-netsh.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:"netsh.exe" and process.args:("firewall" and "set" and
"disable") or process.args:("advfirewall" and "state" and "off")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="encoding-or-decoding-files-via-certutil"></a>Encoding or Decoding Files via CertUtil<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/encoding-or-decoding-files-via-certutil.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies the use of <code class="literal">certutil.exe</code> to encode or decode data. CertUtil is a
native Windows component which is part of Certificate Services. CertUtil is
often abused by attackers to encode or decode base64 data for stealthier command
and control or exfiltration.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#encoding-or-decoding-files-via-certutil-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_22"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/encoding-or-decoding-files-via-certutil.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:certutil.exe and process.args:(-decode or -encode or
/decode or /encode)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_17"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/encoding-or-decoding-files-via-certutil.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Deobfuscate/Decode Files or Information
</li>
<li class="listitem">
ID: T1140
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1140/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1140/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="encoding-or-decoding-files-via-certutil-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/encoding-or-decoding-files-via-certutil.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:"certutil.exe" and process.args:("-encode" or "/encode"
or "-decode" or "/decode")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="enumeration-of-kernel-modules"></a>Enumeration of Kernel Modules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/enumeration-of-kernel-modules.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies attempts to enumerate information about a kernel module. Loadable
Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded into
the kernel upon demand. They extend the functionality of the kernel without the
need to reboot the system.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_11"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/enumeration-of-kernel-modules.asciidoc">edit</a></h4>
</div></div></div>
<p>Security tools and device drivers may run these programs in order to enumerate kernel modules. Use of these programs by ordinary users is uncommon. These can be exempted by process name or username.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_23"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/enumeration-of-kernel-modules.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:executed and process.args:(kmod and list and sudo or sudo
and (depmod or lsmod or modinfo))</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_18"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/enumeration-of-kernel-modules.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Discovery
</li>
<li class="listitem">
ID: TA0007
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0007/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0007/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: System Information Discovery
</li>
<li class="listitem">
ID: T1082
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1082/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1082/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="execution-via-regsvcs-regasm"></a>Execution via Regsvcs/Regasm<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/execution-via-regsvcs-regasm.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">RegSvcs.exe</code> and <code class="literal">RegAsm.exe</code> are Windows command line utilities that are used
to register .NET Component Object Model (COM) assemblies. Adversaries can use
<code class="literal">RegSvcs.exe</code> and <code class="literal">RegAsm.exe</code> to proxy execution of code through a trusted
Windows utility.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_24"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/execution-via-regsvcs-regasm.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:(RegAsm.exe or RegSvcs.exe) and event.action:"Process
Create (rule: ProcessCreate)"</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_19"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/execution-via-regsvcs-regasm.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Regsvcs/Regasm
</li>
<li class="listitem">
ID: T1121
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1121/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1121/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Regsvcs/Regasm
</li>
<li class="listitem">
ID: T1121
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1121/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1121/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="exploit-detected-elastic-endpoint"></a>Exploit - Detected - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/exploit-detected-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint detected an Exploit. Click the Elastic Endpoint icon in the
<code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External
Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#exploit-detected-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_25"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/exploit-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:detection and (event.action:exploit_event or
endgame.event_subtype_full:exploit_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="exploit-detected-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/exploit-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:exploit_event and endgame.metadata.type:detection</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="exploit-prevented-elastic-endpoint"></a>Exploit - Prevented - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/exploit-prevented-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint prevented an Exploit. Click the Elastic Endpoint icon in the
<code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External
Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#exploit-prevented-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_26"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/exploit-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:prevention and (event.action:exploit_event or
endgame.event_subtype_full:exploit_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="exploit-prevented-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/exploit-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:exploit_event and endgame.metadata.type:prevention</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ftp-file-transfer-protocol-activity-to-the-internet"></a>FTP (File Transfer Protocol) Activity to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ftp-file-transfer-protocol-activity-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects events that may indicate the use of FTP network connections to the
Internet. The File Transfer Protocol (FTP) has been around in its current form
since the 1980s. It can be a common and efficient procedure on your network to
send and receive files. Because of this, adversaries will also often use this
protocol to exfiltrate data from your network or download new tools.
Additionally, FTP is a plain-text protocol which, if intercepted, may expose
usernames and passwords. FTP activity involving servers subject to regulations
or compliance standards may be unauthorized.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#ftp-file-transfer-protocol-activity-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_12"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ftp-file-transfer-protocol-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>FTP servers should be excluded from this rule as this is expected behavior. Some
business workflows may use FTP for data exchange. These workflows often have
expected characteristics such as users, sources, and destinations. FTP activity
involving an unusual source or destination may be more suspicious. FTP activity
involving a production server that has no known associated FTP workflow or
business requirement is often suspicious.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_27"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ftp-file-transfer-protocol-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:(20 or 21) and
source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not
destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_20"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ftp-file-transfer-protocol-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration
</li>
<li class="listitem">
ID: TA0010
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0010/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0010/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration Over Alternative Protocol
</li>
<li class="listitem">
ID: T1048
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1048/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1048/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ftp-file-transfer-protocol-activity-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ftp-file-transfer-protocol-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port: (20 or 21) and (
network.direction: outbound or ( source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="file-deletion-via-shred"></a>File Deletion via Shred<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/file-deletion-via-shred.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies file deletions using the <code class="literal">shred</code> command. Malware or other files
dropped or created on a system by an adversary may leave traces behind as to
what was done within a network and how. Adversaries may remove these files over
the course of an intrusion to keep their footprint low or remove them at the
end as part of the post-intrusion cleanup process.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_28"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/file-deletion-via-shred.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:(executed or process_started) and process.name:shred and
process.args:("-u" or "--remove" or "-z" or "--zero")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_21"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/file-deletion-via-shred.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: File Deletion
</li>
<li class="listitem">
ID: T1107
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1107/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1107/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="file-permission-modification-in-writable-directory"></a>File Permission Modification in Writable Directory<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/file-permission-modification-in-writable-directory.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies file permission modifications in common writable directories by a
non-root user. Adversaries often drop files or payloads into a writable
directory, and change permissions prior to execution.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_13"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/file-permission-modification-in-writable-directory.asciidoc">edit</a></h4>
</div></div></div>
<p>Certain programs or applications may modify files or change ownership in writable directories. These can be exempted by username.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_29"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/file-permission-modification-in-writable-directory.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:executed and process.name:(chmod or chown or chattr or
chgrp) and process.working_directory:(/tmp or /var/tmp or /dev/shm)
and not user.name:root</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_22"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/file-permission-modification-in-writable-directory.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: File and Directory Permissions Modification
</li>
<li class="listitem">
ID: T1222
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1222/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1222/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="hex-encoding-decoding-activity"></a>Hex Encoding/Decoding Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/hex-encoding-decoding-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies attempts to encode and decode data, a technique adversaries can
use to evade detection by host- or network-based security controls.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_14"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/hex-encoding-decoding-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Automated tools such as Jenkins may encode or decode files as part of their normal behavior. These events can be filtered by the process executable or username values.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_30"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/hex-encoding-decoding-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:(executed or process_started) and process.name:(hex or
xxd)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_23"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/hex-encoding-decoding-activity.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Deobfuscate/Decode Files or Information
</li>
<li class="listitem">
ID: T1140
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1140/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1140/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Obfuscated Files or Information
</li>
<li class="listitem">
ID: T1027
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1027/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1027/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="hping-process-activity"></a>Hping Process Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/hping-process-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Hping ran on a Linux host. Hping is a FOSS command-line packet analyzer and has
the ability to construct network packets for a wide variety of network security
testing applications, including scanning and firewall auditing.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://en.wikipedia.org/wiki/Hping" class="ulink" target="_top">https://en.wikipedia.org/wiki/Hping</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#hping-process-activity-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_15"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/hping-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Normal use of hping is uncommon apart from security testing and research. Use by
non-security engineers is very uncommon.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_31"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/hping-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:(hping or hping2 or hping3) and event.action:executed</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="hping-process-activity-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/hping-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name: (hping3 or hping2 or hping) and event.action:executed</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ipsec-nat-traversal-port-activity"></a>IPSEC NAT Traversal Port Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ipsec-nat-traversal-port-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects events that could be describing IPSEC NAT Traversal traffic. IPSEC is a
VPN technology that allows one system to talk to another using encrypted
tunnels. NAT Traversal enables these tunnels to communicate over the Internet
where one of the sides is behind a NAT router gateway. This may be common on
your network, but this technique is also used by threat actors to avoid
detection.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#ipsec-nat-traversal-port-activity-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.6.1</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_16"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ipsec-nat-traversal-port-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Some networks may utilize these protocols but usage that is unfamiliar to local
network administrators can be unexpected and suspicious. Because this port is in
the ephemeral range, this rule may false under certain conditions, such as when
an application server with a public IP address replies to a client which has
used a UDP port in the range by coincidence. This is uncommon but such servers
can be excluded.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_32"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ipsec-nat-traversal-port-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:udp and destination.port:4500</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_24"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ipsec-nat-traversal-port-activity.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ipsec-nat-traversal-port-activity-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ipsec-nat-traversal-port-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="irc-internet-relay-chat-protocol-activity-to-the-internet"></a>IRC (Internet Relay Chat) Protocol Activity to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/irc-internet-relay-chat-protocol-activity-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects events that use common ports for Internet Relay Chat (IRC) to the
Internet. IRC is a common protocol that can be used for chat and file transfers.
This protocol is also a good candidate for remote control of malware and data
transfers to and from a network.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#irc-internet-relay-chat-protocol-activity-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_17"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/irc-internet-relay-chat-protocol-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>IRC activity may be normal behavior for developers and engineers but is unusual
for non-engineering end users. IRC activity involving an unusual source or
destination may be more suspicious. IRC activity involving a production server
is often suspicious. Because these ports are in the ephemeral range, this rule
may false under certain conditions, such as when a NAT-ed web server replies to
a client which has used a port in the range by coincidence. In this case, these
servers can be excluded. Some legacy applications may use these ports, but this
is very uncommon and usually only appears in local traffic using private IPs,
which does not match this rule&#8217;s conditions.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_33"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/irc-internet-relay-chat-protocol-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:(6667 or 6697) and
source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not
destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_25"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/irc-internet-relay-chat-protocol-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration
</li>
<li class="listitem">
ID: TA0010
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration Over Alternative Protocol
</li>
<li class="listitem">
ID: T1048
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1048/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1048/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="irc-internet-relay-chat-protocol-activity-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/irc-internet-relay-chat-protocol-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port:(6667 or 6697) and (
network.direction: outbound or ( source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="interactive-terminal-spawned-via-perl"></a>Interactive Terminal Spawned via Perl<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/interactive-terminal-spawned-via-perl.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies when a terminal (<code class="literal">tty</code>) is spawned via Perl. Attackers may upgrade a
simple reverse shell to a fully interactive <code class="literal">tty</code> after obtaining initial
access to a host.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_34"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/interactive-terminal-spawned-via-perl.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:executed and process.name:perl and process.args:("exec
\"/bin/sh\";" or "exec \"/bin/dash\";" or "exec \"/bin/bash\";")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_26"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/interactive-terminal-spawned-via-perl.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command-Line Interface
</li>
<li class="listitem">
ID: T1059
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1059/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1059/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="interactive-terminal-spawned-via-python"></a>Interactive Terminal Spawned via Python<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/interactive-terminal-spawned-via-python.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies when a terminal (<code class="literal">tty</code>) is spawned via Python. Attackers may upgrade
a simple reverse shell to a fully interactive <code class="literal">tty</code> after obtaining initial
access to a host.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_35"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/interactive-terminal-spawned-via-python.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:executed and process.name:python and
process.args:("import pty; pty.spawn(\"/bin/sh\")" or "import pty;
pty.spawn(\"/bin/dash\")" or "import pty; pty.spawn(\"/bin/bash\")")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_27"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/interactive-terminal-spawned-via-python.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command-Line Interface
</li>
<li class="listitem">
ID: T1059
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1059/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1059/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="kernel-module-removal"></a>Kernel Module Removal<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/kernel-module-removal.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies attempts to remove a kernel module. Kernel modules are pieces of
code that can be loaded and unloaded into the kernel upon demand. They extend
the functionality of the kernel without the need to reboot the system.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="http://man7.org/linux/man-pages/man8/modprobe.8.html" class="ulink" target="_top">http://man7.org/linux/man-pages/man8/modprobe.8.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_18"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/kernel-module-removal.asciidoc">edit</a></h4>
</div></div></div>
<p>There is usually no reason to remove modules, but some buggy modules require
removal. These can be exempted by username. Note that some Linux distributions
are not built to support the removal of modules at all.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_36"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/kernel-module-removal.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:executed and process.args:(rmmod and sudo or modprobe and
sudo and ("--remove" or "-r"))</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_28"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/kernel-module-removal.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Disabling Security Tools
</li>
<li class="listitem">
ID: T1089
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1089/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1089/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Kernel Modules and Extensions
</li>
<li class="listitem">
ID: T1215
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1215/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1215/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="local-scheduled-task-commands"></a>Local Scheduled Task Commands<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/local-scheduled-task-commands.asciidoc">edit</a></h3>
</div></div></div>
<p>A scheduled task can be used by an adversary to establish persistence, move
laterally, and/or escalate privileges.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#local-scheduled-task-commands-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_19"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/local-scheduled-task-commands.asciidoc">edit</a></h4>
</div></div></div>
<p>Legitimate scheduled tasks may be created during installation of new software.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_37"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/local-scheduled-task-commands.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:schtasks.exe and process.args:(-change or -create or -run
or -s or /S or /change or /create or /run)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_29"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/local-scheduled-task-commands.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Scheduled Task
</li>
<li class="listitem">
ID: T1053
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1053/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1053/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="local-scheduled-task-commands-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/local-scheduled-task-commands.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:schtasks.exe and process.args:("/create" or "-create" or
"/S" or "-s" or "/run" or "-run" or "/change" or "-change")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="local-service-commands"></a>Local Service Commands<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/local-service-commands.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies use of <code class="literal">sc.exe</code> to create, modify, or start services on remote hosts.
This could be indicative of adversary lateral movement but will be noisy if
commonly done by admins.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#local-service-commands-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_38"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/local-service-commands.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:sc.exe and process.args:(config or create or failure or
start)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_30"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/local-service-commands.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Remote Services
</li>
<li class="listitem">
ID: T1021
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1021/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1021/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="local-service-commands-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/local-service-commands.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:sc.exe and process.args:("create" or "config" or
"failure" or "start")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="malware-detected-elastic-endpoint"></a>Malware - Detected - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/malware-detected-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint detected Malware. Click the Elastic Endpoint icon in the
<code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External
Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: critical</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 99</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#malware-detected-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_39"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/malware-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:detection and
(event.action:file_classification_event or
endgame.event_subtype_full:file_classification_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="malware-detected-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/malware-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:file_classification_event and
endgame.metadata.type:detection</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="malware-prevented-elastic-endpoint"></a>Malware - Prevented - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/malware-prevented-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint prevented Malware. Click the Elastic Endpoint icon in the
<code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External
Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#malware-prevented-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_40"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/malware-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:prevention and
(event.action:file_classification_event or
endgame.event_subtype_full:file_classification_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="malware-prevented-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/malware-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:file_classification_event and
endgame.metadata.type:prevention</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="microsoft-build-engine-loading-windows-credential-libraries"></a>Microsoft Build Engine Loading Windows Credential Libraries<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-loading-windows-credential-libraries.asciidoc">edit</a></h3>
</div></div></div>
<p>An instance of MSBuild, the Microsoft Build Engine, loaded DLLs (dynamically
linked libraries) responsible for Windows credential management. This technique
is sometimes used for credential dumping.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_20"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-loading-windows-credential-libraries.asciidoc">edit</a></h4>
</div></div></div>
<p>The Build Engine is commonly used by Windows developers but use by non-engineers
is unusual.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_41"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-loading-windows-credential-libraries.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">(winlog.event_data.OriginalFileName: (vaultcli.dll or SAMLib.DLL) or
dll.name: (vaultcli.dll or SAMLib.DLL)) and process.name: MSBuild.exe
and event.action: "Image loaded (rule: ImageLoad)"</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_31"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-loading-windows-credential-libraries.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Credential Access
</li>
<li class="listitem">
ID: TA0006
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0006/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0006/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Credential Dumping
</li>
<li class="listitem">
ID: T1003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1003/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1003/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="microsoft-build-engine-started-an-unusual-process"></a>Microsoft Build Engine Started an Unusual Process<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-an-unusual-process.asciidoc">edit</a></h3>
</div></div></div>
<p>An instance of MSBuild, the Microsoft Build Engine, started a PowerShell script
or the Visual C# Command Line Compiler. This technique is sometimes used to
deploy a malicious payload using the Build Engine.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html" class="ulink" target="_top">https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_21"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-an-unusual-process.asciidoc">edit</a></h4>
</div></div></div>
<p>The Build Engine is commonly used by Windows developers but use by non-engineers
is unusual. If a build system triggers this rule it can be exempted by process,
user, or host name.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_42"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-an-unusual-process.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.parent.name:MSBuild.exe and process.name:(csc.exe or
iexplore.exe or powershell.exe)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_32"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-an-unusual-process.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Compile After Delivery
</li>
<li class="listitem">
ID: T1500
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1500/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1500/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="microsoft-build-engine-started-by-a-script-process"></a>Microsoft Build Engine Started by a Script Process<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-by-a-script-process.asciidoc">edit</a></h3>
</div></div></div>
<p>An instance of MSBuild, the Microsoft Build Engine, was started by a script or
the Windows command interpreter. This behavior is unusual and is sometimes used
by malicious payloads.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_22"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-by-a-script-process.asciidoc">edit</a></h4>
</div></div></div>
<p>The Build Engine is commonly used by Windows developers but use by non-engineers
is unusual.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_43"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-by-a-script-process.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:MSBuild.exe and process.parent.name:(cmd.exe or
powershell.exe or cscript.exe or wscript.exe) and
event.action:"Process Create (rule: ProcessCreate)"</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_33"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-by-a-script-process.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Trusted Developer Utilities
</li>
<li class="listitem">
ID: T1127
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1127/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1127/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Trusted Developer Utilities
</li>
<li class="listitem">
ID: T1127
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1127/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1127/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="microsoft-build-engine-started-by-a-system-process"></a>Microsoft Build Engine Started by a System Process<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-by-a-system-process.asciidoc">edit</a></h3>
</div></div></div>
<p>An instance of MSBuild, the Microsoft Build Engine, was started by Explorer or
the WMI (Windows Management Instrumentation) subsystem. This behavior is unusual
and is sometimes used by malicious payloads.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_23"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-by-a-system-process.asciidoc">edit</a></h4>
</div></div></div>
<p>The Build Engine is commonly used by Windows developers but use by non-engineers
is unusual.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_44"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-by-a-system-process.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:MSBuild.exe and process.parent.name:(explorer.exe or
wmiprvse.exe) and event.action:"Process Create (rule: ProcessCreate)"</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_34"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-by-a-system-process.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Trusted Developer Utilities
</li>
<li class="listitem">
ID: T1127
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1127/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1127/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Trusted Developer Utilities
</li>
<li class="listitem">
ID: T1127
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1127/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1127/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="microsoft-build-engine-started-by-an-office-application"></a>Microsoft Build Engine Started by an Office Application<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-by-an-office-application.asciidoc">edit</a></h3>
</div></div></div>
<p>An instance of MSBuild, the Microsoft Build Engine, was started by Excel or
Word. This is unusual behavior for the Build Engine and could have been caused
by an Excel or Word document executing a malicious script payload.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html" class="ulink" target="_top">https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_24"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-by-an-office-application.asciidoc">edit</a></h4>
</div></div></div>
<p>The Build Engine is commonly used by Windows developers but use by non-engineers
is unusual. It is quite unusual for this program to be started by an Office
application like Word or Excel.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_45"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-by-an-office-application.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:MSBuild.exe and process.parent.name:(eqnedt32.exe or
excel.exe or fltldr.exe or msaccess.exe or mspub.exe or outlook.exe or
powerpnt.exe or winword.exe) and event.action: "Process Create (rule:
ProcessCreate)"</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_35"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-started-by-an-office-application.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Trusted Developer Utilities
</li>
<li class="listitem">
ID: T1127
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1127/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1127/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Trusted Developer Utilities
</li>
<li class="listitem">
ID: T1127
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1127/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1127/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="microsoft-build-engine-using-an-alternate-name"></a>Microsoft Build Engine Using an Alternate Name<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-using-an-alternate-name.asciidoc">edit</a></h3>
</div></div></div>
<p>An instance of MSBuild, the Microsoft Build Engine, was started after being
renamed. This is uncommon behavior and may indicate an attempt to run MSBuild
unnoticed or undetected.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_25"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-using-an-alternate-name.asciidoc">edit</a></h4>
</div></div></div>
<p>The Build Engine is commonly used by Windows developers but use by non-engineers
is unusual.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_46"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-using-an-alternate-name.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">(pe.original_file_name:MSBuild.exe or
winlog.event_data.OriginalFileName: MSBuild.exe) and not process.name:
MSBuild.exe and event.action: "Process Create (rule: ProcessCreate)"</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_36"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/microsoft-build-engine-using-an-alternate-name.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Masquerading
</li>
<li class="listitem">
ID: T1036
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1036/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1036/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="mknod-process-activity"></a>Mknod Process Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/mknod-process-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>The Linux <code class="literal">mknod</code> program is sometimes used in the command payload of a remote
command injection (RCI) and other exploits. It is used to export a command shell
when the traditional version of <code class="literal">netcat</code> is not available to the payload.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pen-testing.sans.org/blog/2013/05/06/netcat-without-e-no-problem" class="ulink" target="_top">https://pen-testing.sans.org/blog/2013/05/06/netcat-without-e-no-problem</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#mknod-process-activity-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_26"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/mknod-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Mknod is a Linux system program. Some normal use of this program, at varying
levels of frequency, may originate from scripts, automation tools, and
frameworks. Usage by web servers is more likely to be suspicious.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_47"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/mknod-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:mknod and event.action:executed</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="mknod-process-activity-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/mknod-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name: mknod and event.action:executed</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="modification-of-boot-configuration"></a>Modification of Boot Configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/modification-of-boot-configuration.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies use of <code class="literal">bcdedit.exe</code> to delete boot configuration data. Malware and
attackers sometimes use this tactic as a destructive technique.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_48"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/modification-of-boot-configuration.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:bcdedit.exe and process.args:(/set and (bootstatuspolicy
and ignoreallfailures or no and recoveryenabled))</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_37"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/modification-of-boot-configuration.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: File Deletion
</li>
<li class="listitem">
ID: T1107
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1107/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1107/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="msbuild-making-network-connections"></a>MsBuild Making Network Connections<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/msbuild-making-network-connections.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies <code class="literal">MsBuild.exe</code> making outbound network connections. This may indicate
adversarial activity as MsBuild is often leveraged by adversaries to execute
code and evade detection.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#msbuild-making-network-connections-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_49"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/msbuild-making-network-connections.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Network connection detected (rule: NetworkConnect)" and
process.name:MSBuild.exe and not destination.ip:(127.0.0.1 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_38"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/msbuild-making-network-connections.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Trusted Developer Utilities
</li>
<li class="listitem">
ID: T1127
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1127/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1127/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="msbuild-making-network-connections-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/msbuild-making-network-connections.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Network connection detected (rule: NetworkConnect)" and
process.name:MSBuild.exe and not destination.ip:("127.0.0.1" or "::1")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="net-command-via-system-account"></a>Net command via SYSTEM account<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/net-command-via-system-account.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies the SYSTEM account using the Net utility. The Net utility is a
component of the Windows operating system. It is used in command line operations
for control of users, groups, services, and network connections.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_50"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/net-command-via-system-account.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">(process.name:net.exe or process.name:net1.exe and not
process.parent.name:net.exe) and user.name:SYSTEM and
event.action:"Process Create (rule: ProcessCreate)"</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_39"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/net-command-via-system-account.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Discovery
</li>
<li class="listitem">
ID: TA0007
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0007/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0007/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Account Discovery
</li>
<li class="listitem">
ID: T1087
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1087/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1087/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="netcat-network-activity"></a>Netcat Network Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/netcat-network-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>A <code class="literal">netcat</code> process is engaging in network activity on a Linux host. Netcat is
often used as a persistence mechanism by exporting a reverse shell or by serving
a shell on a listening port. Netcat is also sometimes used for data
exfiltration.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" class="ulink" target="_top">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a>
</li>
<li class="listitem">
<a href="https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf" class="ulink" target="_top">https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf</a>
</li>
<li class="listitem">
<a href="https://en.wikipedia.org/wiki/Netcat" class="ulink" target="_top">https://en.wikipedia.org/wiki/Netcat</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#netcat-network-activity-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_27"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/netcat-network-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Netcat is a dual-use tool that can be used for benign or malicious activity.
Netcat is included in some Linux distributions so its presence is not
necessarily suspicious. Some normal use of this program, while uncommon, may
originate from scripts, automation tools, and frameworks.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_51"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/netcat-network-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:(nc or ncat or netcat or netcat.openbsd or
netcat.traditional) and event.action:(bound-socket or connected-to or
socket_opened)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="netcat-network-activity-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/netcat-network-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name: (nc or ncat or netcat or netcat.openbsd or
netcat.traditional) and event.action: (connected-to or bound-socket or
socket_opened)</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="network-connection-via-certutil"></a>Network Connection via Certutil<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-certutil.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies <code class="literal">certutil.exe</code> making a network connection. Adversaries could abuse
<code class="literal">certutil.exe</code> to download a certificate or malware from a remote URL.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_52"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-certutil.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:certutil.exe and event.action:"Network connection
detected (rule: NetworkConnect)" and not destination.ip:(10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_40"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-certutil.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Remote File Copy
</li>
<li class="listitem">
ID: T1105
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1105/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1105/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="network-connection-via-compiled-html-file"></a>Network Connection via Compiled HTML File<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-compiled-html-file.asciidoc">edit</a></h3>
</div></div></div>
<p>Compiled HTML files (<code class="literal">.chm</code>) are commonly distributed as part of the Microsoft
HTML Help system. Adversaries may conceal malicious code in a CHM file and
deliver it to a victim for execution. CHM content is loaded by the HTML Help
executable program (<code class="literal">hh.exe</code>).</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#network-connection-via-compiled-html-file-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_53"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-compiled-html-file.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:hh.exe and event.action:"Network connection detected
(rule: NetworkConnect)" and not destination.ip:(10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_41"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-compiled-html-file.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Compiled HTML File
</li>
<li class="listitem">
ID: T1223
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1223/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1223/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Compiled HTML File
</li>
<li class="listitem">
ID: T1223
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1223/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1223/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="network-connection-via-compiled-html-file-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-compiled-html-file.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:hh.exe and event.action:"Network connection detected
(rule: NetworkConnect)" and not destination.ip:10.0.0.0/8 and not
destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="network-connection-via-msxsl"></a>Network Connection via MsXsl<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-msxsl.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies <code class="literal">msxsl.exe</code> making a network connection. This may indicate
adversarial activity as <code class="literal">msxsl.exe</code> is often leveraged by adversaries to
execute malicious scripts and evade detection.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_54"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-msxsl.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:msxsl.exe and event.action:"Network connection detected
(rule: NetworkConnect)" and not destination.ip:(10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_42"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-msxsl.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: XSL Script Processing
</li>
<li class="listitem">
ID: T1220
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1220/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1220/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="network-connection-via-mshta"></a>Network Connection via Mshta<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-mshta.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies <code class="literal">mshta.exe</code> making a network connection. This may indicate
adversarial activity as <code class="literal">mshta.exe</code> is often leveraged by adversaries to execute
malicious scripts and evade detection.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html" class="ulink" target="_top">https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#network-connection-via-mshta-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_55"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-mshta.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Network connection detected (rule: NetworkConnect)" and
process.name:mshta.exe</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_43"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-mshta.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Mshta
</li>
<li class="listitem">
ID: T1170
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1170/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1170/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="network-connection-via-mshta-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-mshta.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Network connection detected (rule: NetworkConnect)" and
process.name:"mshta.exe"</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="network-connection-via-regsvr"></a>Network Connection via Regsvr<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-regsvr.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies the native Windows tools <code class="literal">regsvr32.exe</code> and <code class="literal">regsvr64.exe</code> making a
network connection. This may be indicative of an attacker bypassing allowlists
or running arbitrary scripts via a signed Microsoft binary.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#network-connection-via-regsvr-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_28"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-regsvr.asciidoc">edit</a></h4>
</div></div></div>
<p>Security testing may produce events like this. Activity of this kind performed
by non-engineers and ordinary users is unusual.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_56"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-regsvr.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:(regsvr32.exe or regsvr64.exe) and event.action:"Network
connection detected (rule: NetworkConnect)" and not
destination.ip:(10.0.0.0/8 or 169.254.169.254 or 172.16.0.0/12 or
192.168.0.0/16)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_44"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-regsvr.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Regsvr32
</li>
<li class="listitem">
ID: T1117
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1117/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1117/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Regsvr32
</li>
<li class="listitem">
ID: T1117
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1117/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1117/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="network-connection-via-regsvr-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-regsvr.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">(process.name:regsvr32.exe or process.name:regsvr64.exe) and
event.action:"Network connection detected (rule: NetworkConnect)" and
not destination.ip:169.254.169.254/32 and not
destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not
destination.ip:192.168.0.0/16</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="network-connection-via-signed-binary"></a>Network Connection via Signed Binary<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-signed-binary.asciidoc">edit</a></h3>
</div></div></div>
<p>Binaries signed with trusted digital certificates can execute on Windows systems
protected by digital signature validation. Adversaries may use these binaries to
<em>live off the land</em> and execute malicious files that could bypass application
allowlists and signature validation.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#network-connection-via-signed-binary-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_57"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-signed-binary.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:(expand.exe or extrac.exe or ieexec.exe or makecab.exe)
and event.action:"Network connection detected (rule: NetworkConnect)"
and not destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_45"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-signed-binary.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Signed Binary Proxy Execution
</li>
<li class="listitem">
ID: T1218
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1218/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1218/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Signed Binary Proxy Execution
</li>
<li class="listitem">
ID: T1218
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1218/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1218/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="network-connection-via-signed-binary-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-connection-via-signed-binary.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">(process.name:expand.exe or process.name:extrac.exe or
process.name:ieexec.exe or process.name:makecab.exe) and
event.action:"Network connection detected (rule: NetworkConnect)" and
not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and
not destination.ip:192.168.0.0/16</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="network-sniffing-via-tcpdump"></a>Network Sniffing via Tcpdump<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-sniffing-via-tcpdump.asciidoc">edit</a></h3>
</div></div></div>
<p>The Tcpdump program ran on a Linux host. Tcpdump is a network monitoring or
packet sniffing tool that can be used to capture insecure credentials or data in
motion. Sniffing can also be used to discover details of network services as a
prelude to lateral movement or defense evasion.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#network-sniffing-via-tcpdump-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_29"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-sniffing-via-tcpdump.asciidoc">edit</a></h4>
</div></div></div>
<p>Some normal use of this command may originate from server or network
administrators engaged in network troubleshooting.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_58"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-sniffing-via-tcpdump.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:tcpdump and event.action:executed</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_46"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-sniffing-via-tcpdump.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Credential Access
</li>
<li class="listitem">
ID: TA0006
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0006/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0006/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Network Sniffing
</li>
<li class="listitem">
ID: T1040
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1040/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1040/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Discovery
</li>
<li class="listitem">
ID: TA0007
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0007/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0007/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Network Sniffing
</li>
<li class="listitem">
ID: T1040
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1040/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1040/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="network-sniffing-via-tcpdump-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/network-sniffing-via-tcpdump.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name: tcpdump and event.action:executed</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="nmap-process-activity"></a>Nmap Process Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/nmap-process-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Nmap was executed on a Linux host. Nmap is a FOSS tool for network scanning and
security testing. It can map and discover networks, and identify listening
services and operating systems. It is sometimes used to gather information in
support of exploitation, execution or lateral movement.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://en.wikipedia.org/wiki/Nmap" class="ulink" target="_top">https://en.wikipedia.org/wiki/Nmap</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#nmap-process-activity-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_30"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/nmap-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Security testing tools and frameworks may run <code class="literal">Nmap</code> in the course of security
auditing. Some normal use of this command may originate from security engineers
and network or server administrators. Use of nmap by ordinary users is uncommon.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_59"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/nmap-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:nmap</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="nmap-process-activity-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/nmap-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name: nmap</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="nping-process-activity"></a>Nping Process Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/nping-process-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Nping ran on a Linux host. Nping is part of the Nmap tool suite and has the
ability to construct raw packets for a wide variety of security testing
applications, including denial of service testing.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://en.wikipedia.org/wiki/Nmap" class="ulink" target="_top">https://en.wikipedia.org/wiki/Nmap</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#nping-process-activity-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_31"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/nping-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Some normal use of this command may originate from security engineers and
network or server administrators, but this is usually not routine or
unannounced. Use of <code class="literal">Nping</code> by non-engineers or ordinary users is uncommon.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_60"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/nping-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:nping and event.action:executed</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="nping-process-activity-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/nping-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name: nping and event.action:executed</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="pptp-point-to-point-tunneling-protocol-activity"></a>PPTP (Point to Point Tunneling Protocol) Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/pptp-point-to-point-tunneling-protocol-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects events that may indicate use of a PPTP VPN connection. Some threat
actors use these types of connections to tunnel their traffic while avoiding
detection.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#pptp-point-to-point-tunneling-protocol-activity-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.6.1</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_32"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/pptp-point-to-point-tunneling-protocol-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Some networks may utilize PPTP protocols but this is uncommon as more modern VPN
technologies are available. Usage that is unfamiliar to local network
administrators can be unexpected and suspicious. Torrenting applications may use
this port. Because this port is in the ephemeral range, this rule may false
under certain conditions, such as when an application server replies to a client
that used this port by coincidence. This is uncommon but such servers can be
excluded.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_61"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/pptp-point-to-point-tunneling-protocol-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:1723</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_47"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/pptp-point-to-point-tunneling-protocol-activity.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="pptp-point-to-point-tunneling-protocol-activity-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/pptp-point-to-point-tunneling-protocol-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="permission-theft-detected-elastic-endpoint"></a>Permission Theft - Detected - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/permission-theft-detected-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint detected Permission Theft. Click the Elastic Endpoint icon in
the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the
External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#permission-theft-detected-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_62"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/permission-theft-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:detection and
(event.action:token_protection_event or
endgame.event_subtype_full:token_protection_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="permission-theft-detected-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/permission-theft-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:token_protection_event and
endgame.metadata.type:detection</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="permission-theft-prevented-elastic-endpoint"></a>Permission Theft - Prevented - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/permission-theft-prevented-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint prevented Permission Theft. Click the Elastic Endpoint icon in
the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the
External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#permission-theft-prevented-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_63"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/permission-theft-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:prevention and
(event.action:token_protection_event or
endgame.event_subtype_full:token_protection_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="permission-theft-prevented-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/permission-theft-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:token_protection_event and
endgame.metadata.type:prevention</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="persistence-via-kernel-module-modification"></a>Persistence via Kernel Module Modification<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/persistence-via-kernel-module-modification.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies loadable kernel module errors, which are often indicative of
potential persistence attempts.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://www.hackers-arise.com/single-post/2017/11/03/Linux-for-Hackers-Part-10-Loadable-Kernel-Modules-LKM" class="ulink" target="_top">https://www.hackers-arise.com/single-post/2017/11/03/Linux-for-Hackers-Part-10-Loadable-Kernel-Modules-LKM</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#persistence-via-kernel-module-modification-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_33"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/persistence-via-kernel-module-modification.asciidoc">edit</a></h4>
</div></div></div>
<p>Security tools and device drivers may run these programs in order to load
legitimate kernel modules. Use of these programs by ordinary users is uncommon.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_64"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/persistence-via-kernel-module-modification.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:(insmod or kmod or modprobe or rmod) and
event.action:executed</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_48"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/persistence-via-kernel-module-modification.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/TA0003/" class="ulink" target="_top">https://attack.mitre.org/techniques/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Kernel Modules and Extensions
</li>
<li class="listitem">
ID: T1215
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1215/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1215/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="persistence-via-kernel-module-modification-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/persistence-via-kernel-module-modification.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name: (insmod or kmod or modprobe or rmod) and
event.action:executed</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="potential-application-shimming-via-sdbinst"></a>Potential Application Shimming via Sdbinst<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-application-shimming-via-sdbinst.asciidoc">edit</a></h3>
</div></div></div>
<p>The Application Shim was created to allow for backward compatibility of software
as the operating system codebase changes over time. This Windows functionality
has been abused by attackers to stealthily gain persistence and arbitrary code
execution in legitimate Windows processes.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#potential-application-shimming-via-sdbinst-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_65"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-application-shimming-via-sdbinst.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.code:1 and process.name:sdbinst.exe</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_49"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-application-shimming-via-sdbinst.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Application Shimming
</li>
<li class="listitem">
ID: T1138
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1138/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1138/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Application Shimming
</li>
<li class="listitem">
ID: T1138
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1138/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1138/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="potential-application-shimming-via-sdbinst-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-application-shimming-via-sdbinst.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="potential-dns-tunneling-via-iodine"></a>Potential DNS Tunneling via Iodine<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-dns-tunneling-via-iodine.asciidoc">edit</a></h3>
</div></div></div>
<p>Iodine is a tool for tunneling Internet protocol version 4 (IPV4) traffic over
the DNS protocol to circumvent firewalls, network security groups, and network
access lists while evading detection.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://code.kryo.se/iodine/" class="ulink" target="_top">https://code.kryo.se/iodine/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#potential-dns-tunneling-via-iodine-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_34"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-dns-tunneling-via-iodine.asciidoc">edit</a></h4>
</div></div></div>
<p>Normal use of Iodine is uncommon apart from security testing and research. Use
by non-security engineers is very uncommon.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_66"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-dns-tunneling-via-iodine.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:(iodine or iodined) and event.action:executed</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="potential-dns-tunneling-via-iodine-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-dns-tunneling-via-iodine.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name: (iodine or iodined) and event.action:executed</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="potential-disabling-of-selinux"></a>Potential Disabling of SELinux<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-disabling-of-selinux.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies potential attempts to disable Security-Enhanced Linux (SELinux),
which is a Linux kernel security feature that supports access control policies.
Adversaries may disable security tools to avoid possible detection of their
tools and activities.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_67"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-disabling-of-selinux.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:executed and process.name:setenforce and process.args:0</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_50"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-disabling-of-selinux.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Disabling Security Tools
</li>
<li class="listitem">
ID: T1089
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1089/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1089/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="potential-evasion-via-filter-manager"></a>Potential Evasion via Filter Manager<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-evasion-via-filter-manager.asciidoc">edit</a></h3>
</div></div></div>
<p>The Filter Manager Control Program (fltMC.exe) binary may be abused by
adversaries to unload a filter driver and evade defenses.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#potential-evasion-via-filter-manager-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_68"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-evasion-via-filter-manager.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.code:1 and process.name:fltMC.exe</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_51"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-evasion-via-filter-manager.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: File and Directory Permissions Modification
</li>
<li class="listitem">
ID: T1222
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1222/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1222/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="potential-evasion-via-filter-manager-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-evasion-via-filter-manager.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="potential-modification-of-accessibility-binaries"></a>Potential Modification of Accessibility Binaries<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-modification-of-accessibility-binaries.asciidoc">edit</a></h3>
</div></div></div>
<p>Windows contains accessibility features that may be launched with a key
combination before a user has logged in. An adversary can modify the way these
programs are launched to get a command prompt or backdoor without logging in to
the system.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#potential-modification-of-accessibility-binaries-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_69"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-modification-of-accessibility-binaries.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.code:1 and process.parent.name:winlogon.exe and
process.name:(atbroker.exe or displayswitch.exe or magnify.exe or
narrator.exe or osk.exe or sethc.exe or utilman.exe)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_52"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-modification-of-accessibility-binaries.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Accessibility Features
</li>
<li class="listitem">
ID: T1015
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1015/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1015/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Accessibility Features
</li>
<li class="listitem">
ID: T1015
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1015/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1015/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="potential-modification-of-accessibility-binaries-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-modification-of-accessibility-binaries.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.code:1 and process.parent.name:winlogon.exe and
(process.name:atbroker.exe or process.name:displayswitch.exe or
process.name:magnify.exe or process.name:narrator.exe or
process.name:osk.exe or process.name:sethc.exe or
process.name:utilman.exe)</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="potential-shell-via-web-server"></a>Potential Shell via Web Server<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-shell-via-web-server.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies suspicious commands executed via a web server, which may suggest a
vulnerability and remote shell access.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pentestlab.blog/tag/web-shell/" class="ulink" target="_top">https://pentestlab.blog/tag/web-shell/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#potential-shell-via-web-server-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_35"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-shell-via-web-server.asciidoc">edit</a></h4>
</div></div></div>
<p>Network monitoring or management products may have a web server component that
runs shell commands as part of normal behavior.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_70"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-shell-via-web-server.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:(bash or dash) and user.name:(apache or nginx or www or
"www-data") and event.action:executed</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_53"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-shell-via-web-server.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/TA0003/" class="ulink" target="_top">https://attack.mitre.org/techniques/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Web Shell
</li>
<li class="listitem">
ID: T1100
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1100/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1100/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="potential-shell-via-web-server-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/potential-shell-via-web-server.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.8.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:bash and user.name:(apache or www or www-data) and
event.action:executed</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name: bash and user.name: (apache or www or "wwww-data") and
event.action:executed</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="powershell-spawning-cmd"></a>PowerShell spawning Cmd<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/powershell-spawning-cmd.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies a suspicious parent child process relationship with <code class="literal">cmd.exe</code>
descending from <code class="literal">PowerShell.exe</code>.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#powershell-spawning-cmd-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_71"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/powershell-spawning-cmd.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.parent.name:powershell.exe and process.name:cmd.exe</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_54"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/powershell-spawning-cmd.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command-Line Interface
</li>
<li class="listitem">
ID: T1059
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1059/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1059/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: PowerShell
</li>
<li class="listitem">
ID: T1086
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1086/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1086/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="powershell-spawning-cmd-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/powershell-spawning-cmd.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="process-activity-via-compiled-html-file"></a>Process Activity via Compiled HTML File<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-activity-via-compiled-html-file.asciidoc">edit</a></h3>
</div></div></div>
<p>Compiled HTML files (<code class="literal">.chm</code>) are commonly distributed as part of the Microsoft
HTML Help system. Adversaries may conceal malicious code in a CHM file and
deliver it to a victim for execution. CHM content is loaded by the HTML Help
executable program (<code class="literal">hh.exe</code>).</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#process-activity-via-compiled-html-file-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_36"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-activity-via-compiled-html-file.asciidoc">edit</a></h4>
</div></div></div>
<p>The HTML Help executable program (<code class="literal">hh.exe</code>) runs whenever a user clicks a
compiled help (<code class="literal">.chm</code>) file or menu item that opens the help file inside the
Help Viewer. This is not always malicious, but adversaries may abuse this
technology to conceal malicious code.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_72"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-activity-via-compiled-html-file.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.code:1 and process.name:hh.exe</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_55"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-activity-via-compiled-html-file.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Compiled HTML File
</li>
<li class="listitem">
ID: T1223
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1223/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1223/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Compiled HTML File
</li>
<li class="listitem">
ID: T1223
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1223/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1223/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="process-activity-via-compiled-html-file-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-activity-via-compiled-html-file.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="process-discovery-via-tasklist"></a>Process Discovery via Tasklist<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-discovery-via-tasklist.asciidoc">edit</a></h3>
</div></div></div>
<p>Adversaries may attempt to get information about running processes on a system.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#process-discovery-via-tasklist-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_37"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-discovery-via-tasklist.asciidoc">edit</a></h4>
</div></div></div>
<p>Administrators may use the tasklist command to display a list of currently
running processes. By itself, it does not indicate malicious activity. After
obtaining a foothold, it&#8217;s possible adversaries may use discovery commands like
tasklist to get information about running processes.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_73"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-discovery-via-tasklist.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.code:1 and process.name:tasklist.exe</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_56"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-discovery-via-tasklist.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Discovery
</li>
<li class="listitem">
ID: TA0007
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0007/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0007/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Process Discovery
</li>
<li class="listitem">
ID: T1057
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1057/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1057/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="process-discovery-via-tasklist-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-discovery-via-tasklist.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="process-injection-detected-elastic-endpoint"></a>Process Injection - Detected - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-injection-detected-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint detected Process Injection. Click the Elastic Endpoint icon in
the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the
External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#process-injection-detected-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_74"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-injection-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:detection and
(event.action:kernel_shellcode_event or
endgame.event_subtype_full:kernel_shellcode_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="process-injection-detected-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-injection-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:kernel_shellcode_event and
endgame.metadata.type:detection</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="process-injection-prevented-elastic-endpoint"></a>Process Injection - Prevented - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-injection-prevented-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint prevented Process Injection. Click the Elastic Endpoint icon in
the <code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the
External Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#process-injection-prevented-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_75"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-injection-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:prevention and
(event.action:kernel_shellcode_event or
endgame.event_subtype_full:kernel_shellcode_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="process-injection-prevented-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-injection-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:kernel_shellcode_event and
endgame.metadata.type:prevention</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="process-injection-by-the-microsoft-build-engine"></a>Process Injection by the Microsoft Build Engine<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-injection-by-the-microsoft-build-engine.asciidoc">edit</a></h3>
</div></div></div>
<p>An instance of MSBuild, the Microsoft Build Engine, created a thread in another
process. This technique is sometimes used to evade detection or elevate
privileges.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_38"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-injection-by-the-microsoft-build-engine.asciidoc">edit</a></h4>
</div></div></div>
<p>The Build Engine is commonly used by Windows developers but use by non-engineers
is unusual.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_76"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-injection-by-the-microsoft-build-engine.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:MSBuild.exe and event.action:"CreateRemoteThread detected
(rule: CreateRemoteThread)"</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_57"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/process-injection-by-the-microsoft-build-engine.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Process Injection
</li>
<li class="listitem">
ID: T1055
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1055/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1055/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Process Injection
</li>
<li class="listitem">
ID: T1055
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1055/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1055/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="proxy-port-activity-to-the-internet"></a>Proxy Port Activity to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/proxy-port-activity-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects events that may describe network events of proxy use to the Internet. It
includes popular HTTP proxy ports and SOCKS proxy ports. Typically, environments
will use an internal IP address for a proxy server. It can also be used to
circumvent network controls and detection mechanisms.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#proxy-port-activity-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_39"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/proxy-port-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>Some proxied applications may use these ports but this usually occurs in local
traffic using private IPs which this rule does not match. Proxies are widely
used as a security technology but in enterprise environments this is usually
local traffic which this rule does not match. If desired, internet proxy
services using these ports can be added to allowlists. Some screen recording
applications may use these ports.</p>
<p>Proxy port activity involving an unusual source or
destination may be more suspicious. Some cloud environments may use this port
when VPNs or direct connects are not in use and cloud instances are accessed
across the Internet. Because these ports are in the ephemeral range, this rule
may false under certain conditions such as when a NATed web server replies to a
client which has used a port in the range by coincidence. In this case, such
servers can be excluded.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_77"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/proxy-port-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:(1080 or 3128 or 8080) and
source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not
destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_58"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/proxy-port-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="proxy-port-activity-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/proxy-port-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port: (3128 or 8080 or 1080)
and ( network.direction: outbound or ( source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="psexec-network-connection"></a>PsExec Network Connection<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/psexec-network-connection.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies use of the SysInternals tool <code class="literal">PsExec.exe</code> making a network
connection. This could be an indication of lateral movement.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#psexec-network-connection-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_40"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/psexec-network-connection.asciidoc">edit</a></h4>
</div></div></div>
<p>PsExec is a dual-use tool that can be used for benign or malicious activity.
It&#8217;s important to baseline your environment to determine the amount of noise to
expect from this tool.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_78"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/psexec-network-connection.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:PsExec.exe and event.action:"Network connection detected
(rule: NetworkConnect)"</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_59"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/psexec-network-connection.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Service Execution
</li>
<li class="listitem">
ID: T1035
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1035/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1035/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Lateral Movement
</li>
<li class="listitem">
ID: TA0008
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0008/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0008/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Service Execution
</li>
<li class="listitem">
ID: T1035
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1035/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1035/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="psexec-network-connection-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/psexec-network-connection.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:PsExec.exe and event.action:"Network connection detected
(rule: NetworkConnect)"</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rdp-remote-desktop-protocol-from-the-internet"></a>RDP (Remote Desktop Protocol) from the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rdp-remote-desktop-protocol-from-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects network events that may indicate the use of RDP traffic from the
Internet. RDP is commonly used by system administrators to remotely control a
system for maintenance or to use shared resources. It should almost never be
directly exposed to the Internet, as it is frequently targeted and exploited by
threat actors as an initial access or back-door vector.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#rdp-remote-desktop-protocol-from-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_41"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rdp-remote-desktop-protocol-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>Some network security policies allow RDP directly from the Internet but usage
that is unfamiliar to server or network owners can be unexpected and suspicious.
RDP services may be exposed directly to the Internet in some networks such as
cloud environments. In such cases, only RDP gateways, bastions or jump servers
may be expected expose RDP directly to the Internet and can be exempted from
this rule. RDP may be required by some workflows such as remote access and
support for specialized software products and servers. Such work- flows are
usually known and not unexpected.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_79"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rdp-remote-desktop-protocol-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:3389 and not
source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and
destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_60"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rdp-remote-desktop-protocol-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Lateral Movement
</li>
<li class="listitem">
ID: TA0008
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0008/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0008/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Remote Services
</li>
<li class="listitem">
ID: T1021
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1021/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1021/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Initial Access
</li>
<li class="listitem">
ID: TA0001
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0001/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0001/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exploit Public-Facing Application
</li>
<li class="listitem">
ID: T1190
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1190/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1190/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="rdp-remote-desktop-protocol-from-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rdp-remote-desktop-protocol-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port: 3389 and (
network.direction: inbound or ( not source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and destination.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rdp-remote-desktop-protocol-to-the-internet"></a>RDP (Remote Desktop Protocol) to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rdp-remote-desktop-protocol-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects network events that may indicate the use of RDP traffic to the Internet.
RDP is commonly used by system administrators to remotely control a system for
maintenance or to use shared resources. It should almost never be directly
exposed to the Internet, as it is frequently targeted and exploited by threat
actors as an initial access or back-door vector.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#rdp-remote-desktop-protocol-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_42"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rdp-remote-desktop-protocol-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>RDP connections may be made directly to Internet destinations in order to access
Windows cloud server instances but such connections are usually made only by
engineers. In such cases, only RDP gateways, bastions or jump servers may be
expected Internet destinations and can be exempted from this rule. RDP may be
required by some workflows such as remote access and support for specialized
software products and servers. Such workflows are usually known and not
unexpected. Usage that is unfamiliar to server or network owners can be
unexpected and suspicious.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_80"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rdp-remote-desktop-protocol-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:3389 and
source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not
destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_61"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rdp-remote-desktop-protocol-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Initial Access
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exploit Public-Facing Application
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration
</li>
<li class="listitem">
ID: TA0010
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0010/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0010/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration Over Alternative Protocol
</li>
<li class="listitem">
ID: T1048
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1048/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1048/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="rdp-remote-desktop-protocol-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rdp-remote-desktop-protocol-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port: 3389 and (
network.direction: outbound or ( source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rpc-remote-procedure-call-from-the-internet"></a>RPC (Remote Procedure Call) from the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rpc-remote-procedure-call-from-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects network events that may indicate the use of RPC traffic from the
Internet. RPC is commonly used by system administrators to remotely control a
system for maintenance or to use shared resources. It should almost never be
directly exposed to the Internet, as it is frequently targeted and exploited by
threat actors as an initial access or back-door vector.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#rpc-remote-procedure-call-from-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_81"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rpc-remote-procedure-call-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:135 and not
source.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1") and destination.ip:(10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_62"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rpc-remote-procedure-call-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Initial Access
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exploit Public-Facing Application
</li>
<li class="listitem">
ID: T1190
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1190/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1190/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="rpc-remote-procedure-call-from-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rpc-remote-procedure-call-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port: 135 and (
network.direction: inbound or ( not source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and destination.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rpc-remote-procedure-call-to-the-internet"></a>RPC (Remote Procedure Call) to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rpc-remote-procedure-call-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects network events that may indicate the use of RPC traffic to the Internet.
RPC is commonly used by system administrators to remotely control a system for
maintenance or to use shared resources. It should almost never be directly
exposed to the Internet, as it is frequently targeted and exploited by threat
actors as an initial access or back-door vector.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#rpc-remote-procedure-call-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_82"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rpc-remote-procedure-call-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:135 and
source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not
destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_63"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rpc-remote-procedure-call-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Initial Access
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exploit Public-Facing Application
</li>
<li class="listitem">
ID: T1190
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1190/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1190/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="rpc-remote-procedure-call-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/rpc-remote-procedure-call-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port: 135 and (
network.direction: outbound or ( source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ransomware-detected-elastic-endpoint"></a>Ransomware - Detected - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ransomware-detected-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint detected Ransomware. Click the Elastic Endpoint icon in the
<code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External
Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: critical</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 99</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#ransomware-detected-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_83"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ransomware-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:detection and (event.action:ransomware_event or
endgame.event_subtype_full:ransomware_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ransomware-detected-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ransomware-detected-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:ransomware_event and endgame.metadata.type:detection</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ransomware-prevented-elastic-endpoint"></a>Ransomware - Prevented - Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ransomware-prevented-elastic-endpoint.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Endpoint prevented Ransomware. Click the Elastic Endpoint icon in the
<code class="literal">event.module</code> column or the link in the <code class="literal">rule.reference</code> column in the External
Alerts tab of the SIEM <span class="strong strong"><strong>Detections</strong></span> page for additional information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
endgame-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 10 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-15m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Endpoint
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#ransomware-prevented-elastic-endpoint-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_84"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ransomware-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
endgame.metadata.type:prevention and (event.action:ransomware_event or
endgame.event_subtype_full:ransomware_event)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ransomware-prevented-elastic-endpoint-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ransomware-prevented-elastic-endpoint.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:endgame and
event.action:ransomware_event and endgame.metadata.type:prevention</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="smb-windows-file-sharing-activity-to-the-internet"></a>SMB (Windows File Sharing) Activity to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smb-windows-file-sharing-activity-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects network events that may indicate the use of Windows file sharing (also
called SMB or CIFS) traffic to the Internet. SMB is commonly used within
networks to share files, printers, and other system resources amongst trusted
systems. It should almost never be directly exposed to the Internet, as it is
frequently targeted and exploited by threat actors as an initial access or back-
door vector or for data exfiltration.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#smb-windows-file-sharing-activity-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_85"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smb-windows-file-sharing-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:(139 or 445) and
source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not
destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_64"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smb-windows-file-sharing-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Initial Access
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exploit Public-Facing Application
</li>
<li class="listitem">
ID: T1190
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1190/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1190/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration
</li>
<li class="listitem">
ID: TA0010
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0010/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0010/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration Over Alternative Protocol
</li>
<li class="listitem">
ID: T1048
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1048/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1048/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="smb-windows-file-sharing-activity-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smb-windows-file-sharing-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port: (139 or 445) and (
network.direction: outbound or ( source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="smtp-on-port-26-tcp"></a>SMTP on Port 26/TCP<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smtp-on-port-26-tcp.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects events that may indicate use of SMTP on TCP port 26. This port is
commonly used by several popular mail transfer agents to deconflict with the
default SMTP port 25. This port has also been used by a malware family called
BadPatch for command and control of Windows systems.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://unit42.paloaltonetworks.com/unit42-badpatch/" class="ulink" target="_top">https://unit42.paloaltonetworks.com/unit42-badpatch/</a>
</li>
<li class="listitem">
<a href="https://isc.sans.edu/forums/diary/Next+up+whats+up+with+TCP+port+26/25564/" class="ulink" target="_top">https://isc.sans.edu/forums/diary/Next+up+whats+up+with+TCP+port+26/25564/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#smtp-on-port-26-tcp-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.6.1</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_43"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smtp-on-port-26-tcp.asciidoc">edit</a></h4>
</div></div></div>
<p>Servers that process email traffic may cause false positives and should be
excluded from this rule as this is expected behavior.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_86"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smtp-on-port-26-tcp.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:26</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_65"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smtp-on-port-26-tcp.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration
</li>
<li class="listitem">
ID: TA0010
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration Over Alternative Protocol
</li>
<li class="listitem">
ID: T1048
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1048/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1048/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="smtp-on-port-26-tcp-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smtp-on-port-26-tcp.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="smtp-to-the-internet"></a>SMTP to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smtp-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects events that may describe SMTP traffic from internal hosts to a host
across the Internet. In an enterprise network, there is typically a dedicated
internal host that performs this function. It is also frequently abused by
threat actors for command and control, or data exfiltration.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#smtp-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_44"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smtp-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>NATed servers that process email traffic may false and should be excluded from
this rule as this is expected behavior for them. Consumer and personal devices
may send email traffic to remote Internet destinations. In this case, such
devices or networks can be excluded from this rule if this is expected behavior.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_87"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smtp-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:(25 or 465 or 587) and
source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not
destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_66"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smtp-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration
</li>
<li class="listitem">
ID: TA0010
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0010/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0010/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration Over Alternative Protocol
</li>
<li class="listitem">
ID: T1048
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1048/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1048/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="smtp-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/smtp-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port: (25 or 465 or 587) and (
network.direction: outbound or ( source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="sql-traffic-to-the-internet"></a>SQL Traffic to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/sql-traffic-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects events that may describe database traffic (MS SQL, Oracle, MySQL, and
Postgresql) across the Internet. Databases should almost never be directly
exposed to the Internet, as they are frequently targeted by threat actors to
gain initial access to network resources.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#sql-traffic-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_45"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/sql-traffic-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>Because these ports are in the ephemeral range, this rule may false under
certain conditions such as when a NATed web server replies to a client which has
used a port in the range by coincidence. In this case, such servers can be
excluded if desired. Some cloud environments may use this port when VPNs or
direct connects are not in use and database instances are accessed directly
across the Internet.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_88"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/sql-traffic-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:(1433 or 1521 or 3336 or
5432) and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)
and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_67"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/sql-traffic-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="sql-traffic-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/sql-traffic-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port: (1433 or 1521 or 3336 or
5432) and ( network.direction: outbound or ( source.ip: (10.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16) and not destination.ip:
(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ssh-secure-shell-from-the-internet"></a>SSH (Secure Shell) from the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ssh-secure-shell-from-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects network events that may indicate the use of SSH traffic from the
Internet. SSH is commonly used by system administrators to remotely control a
system using the command line shell. If it is exposed to the Internet, it should
be done with strong security controls as it is frequently targeted and exploited
by threat actors as an initial access or back-door vector.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#ssh-secure-shell-from-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_46"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ssh-secure-shell-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>Some network security policies allow SSH directly from the Internet but usage
that is unfamiliar to server or network owners can be unexpected and suspicious.
SSH services may be exposed directly to the Internet in some networks such as
cloud environments. In such cases, only SSH gateways, bastions or jump servers
may be expected expose SSH directly to the Internet and can be exempted from
this rule. SSH may be required by some workflows such as remote access and
support for specialized software products and servers. Such workflows are
usually known and not unexpected.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_89"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ssh-secure-shell-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:22 and not
source.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1") and destination.ip:(10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_68"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ssh-secure-shell-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Lateral Movement
</li>
<li class="listitem">
ID: TA0008
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0008/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0008/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Remote Services
</li>
<li class="listitem">
ID: T1021
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1021/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1021/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Initial Access
</li>
<li class="listitem">
ID: TA0001
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0001/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0001/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exploit Public-Facing Application
</li>
<li class="listitem">
ID: T1190
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1190/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1190/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ssh-secure-shell-from-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ssh-secure-shell-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port:22 and (
network.direction: inbound or ( not source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and destination.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ssh-secure-shell-to-the-internet"></a>SSH (Secure Shell) to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ssh-secure-shell-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects network events that may indicate the use of SSH traffic to the Internet.
SSH is commonly used by system administrators to remotely control a system using
the command line shell. If it is exposed to the Internet, it should be done with
strong security controls as it is frequently targeted and exploited by threat
actors as an initial access or back-door vector.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#ssh-secure-shell-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_47"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ssh-secure-shell-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>SSH connections may be made directly to Internet destinations in order to access
Linux cloud server instances but such connections are usually made only by
engineers. In such cases, only SSH gateways, bastions or jump servers may be
expected Internet destinations and can be exempted from this rule. SSH may be
required by some workflows such as remote access and support for specialized
software products and servers. Such workflows are usually known and not
unexpected. Usage that is unfamiliar to server or network owners can be
unexpected and suspicious.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_90"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ssh-secure-shell-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:22 and
source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not
destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_69"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ssh-secure-shell-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ssh-secure-shell-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/ssh-secure-shell-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port:22 and (
network.direction: outbound or ( source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="setgid-bit-set-via-chmod"></a>Setgid Bit Set via chmod<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/setgid-bit-set-via-chmod.asciidoc">edit</a></h3>
</div></div></div>
<p>An adversary may add the setgid bit to a file or directory in order to run a file with the privileges of the owning group. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setgid bit to get code running in a different user’s context. Additionally, adversaries can use this mechanism on their own malware to make sure they&#8217;re able to execute in elevated contexts in the future.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 33</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_91"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/setgid-bit-set-via-chmod.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:(executed OR process_started) AND process.name:chmod AND
process.args:(g+s OR /2[0-9]{3}/) AND NOT user.name:root</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_70"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/setgid-bit-set-via-chmod.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Setuid and Setgid
</li>
<li class="listitem">
ID: T1166
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1166/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1166/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Setuid and Setgid
</li>
<li class="listitem">
ID: T1166
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1166/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1166/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="setuid-bit-set-via-chmod"></a>Setuid Bit Set via chmod<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/setuid-bit-set-via-chmod.asciidoc">edit</a></h3>
</div></div></div>
<p>An adversary may add the setuid bit to a file or directory in order to run a file with the privileges of the owning user. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setuid bit to get code running in a different user’s context. Additionally, adversaries can use this mechanism on their own malware to make sure they&#8217;re able to execute in elevated contexts in the future.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 33</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_92"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/setuid-bit-set-via-chmod.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:(executed OR process_started) AND process.name:chmod AND
process.args:(u+s OR /4[0-9]{3}/) AND NOT user.name:root</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_71"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/setuid-bit-set-via-chmod.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Setuid and Setgid
</li>
<li class="listitem">
ID: T1166
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1166/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1166/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Setuid and Setgid
</li>
<li class="listitem">
ID: T1166
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1166/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1166/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="socat-process-activity"></a>Socat Process Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/socat-process-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>A Socat process is running on a Linux host. Socat is often used as a persistence
mechanism by exporting a reverse shell, or by serving a shell on a listening
port. Socat is also sometimes used for lateral movement.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#method-2-using-socat" class="ulink" target="_top">https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#method-2-using-socat</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#socat-process-activity-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_48"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/socat-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Socat is a dual-use tool that can be used for benign or malicious activity. Some
normal use of this program, at varying levels of frequency, may originate from
scripts, automation tools, and frameworks. Usage by web servers is more likely
to be suspicious.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_93"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/socat-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:socat and not process.args:-V and event.action:executed</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="socat-process-activity-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/socat-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:socat and not process.args:"-V" and event.action:executed</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="strace-process-activity"></a>Strace Process Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/strace-process-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Strace runs in a privileged context and can be used to escape restrictive
environments by instantiating a shell in order to elevate privileges or move
laterally.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://en.wikipedia.org/wiki/Strace" class="ulink" target="_top">https://en.wikipedia.org/wiki/Strace</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#strace-process-activity-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_49"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/strace-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Strace is a dual-use tool that can be used for benign or malicious activity.
Some normal use of this command may originate from developers or SREs engaged in
debugging or system call tracing.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_94"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/strace-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:strace and event.action:executed</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="strace-process-activity-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/strace-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name: strace and event.action:executed</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="sudoers-file-modification"></a>Sudoers File Modification<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/sudoers-file-modification.asciidoc">edit</a></h3>
</div></div></div>
<p>A sudoers file specifies the commands that users or groups can run and from which terminals. Adversaries can take advantage of these configurations to execute commands as other users or spawn processes with higher privileges.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_95"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/sudoers-file-modification.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.module:file_integrity and event.action:updated and
file.path:/etc/sudoers</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_72"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/sudoers-file-modification.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Sudo
</li>
<li class="listitem">
ID: T1169
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1169/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1169/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="suspicious-ms-office-child-process"></a>Suspicious MS Office Child Process<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-ms-office-child-process.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies suspicious child processes of frequently targeted Microsoft Office
applications (Word, PowerPoint, Excel). These child processes are often launched
during exploitation of Office applications or from documents with malicious
macros.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#suspicious-ms-office-child-process-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_96"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-ms-office-child-process.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.name:(eqnedt32.exe or excel.exe or fltldr.exe or
msaccess.exe or mspub.exe or powerpnt.exe or winword.exe) and
process.name:(Microsoft.Workflow.Compiler.exe or arp.exe or
atbroker.exe or bginfo.exe or bitsadmin.exe or cdb.exe or certutil.exe
or cmd.exe or cmstp.exe or cscript.exe or csi.exe or dnx.exe or
dsget.exe or dsquery.exe or forfiles.exe or fsi.exe or ftp.exe or
gpresult.exe or hostname.exe or ieexec.exe or iexpress.exe or
installutil.exe or ipconfig.exe or mshta.exe or msxsl.exe or
nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or
nltest.exe or odbcconf.exe or ping.exe or powershell.exe or pwsh.exe
or qprocess.exe or quser.exe or qwinsta.exe or rcsi.exe or reg.exe or
regasm.exe or regsvcs.exe or regsvr32.exe or sc.exe or schtasks.exe or
systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or
wmic.exe or wscript.exe or xwizard.exe)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_73"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-ms-office-child-process.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Spearphishing Attachment
</li>
<li class="listitem">
ID: T1193
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1193/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1193/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="suspicious-ms-office-child-process-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-ms-office-child-process.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.name:("winword.exe" or "excel.exe" or "powerpnt.exe" or
"eqnedt32.exe" or "fltldr.exe" or "mspub.exe" or "msaccess.exe") and
process.name:("arp.exe" or "dsquery.exe" or "dsget.exe" or
"gpresult.exe" or "hostname.exe" or "ipconfig.exe" or "nbtstat.exe" or
"net.exe" or "net1.exe" or "netsh.exe" or "netstat.exe" or
"nltest.exe" or "ping.exe" or "qprocess.exe" or "quser.exe" or
"qwinsta.exe" or "reg.exe" or "sc.exe" or "systeminfo.exe" or
"tasklist.exe" or "tracert.exe" or "whoami.exe" or "bginfo.exe" or
"cdb.exe" or "cmstp.exe" or "csi.exe" or "dnx.exe" or "fsi.exe" or
"ieexec.exe" or "iexpress.exe" or "installutil.exe" or
"Microsoft.Workflow.Compiler.exe" or "msbuild.exe" or "mshta.exe" or
"msxsl.exe" or "odbcconf.exe" or "rcsi.exe" or "regsvr32.exe" or
"xwizard.exe" or "atbroker.exe" or "forfiles.exe" or "schtasks.exe" or
"regasm.exe" or "regsvcs.exe" or "cmd.exe" or "cscript.exe" or
"powershell.exe" or "pwsh.exe" or "wmic.exe" or "wscript.exe" or
"bitsadmin.exe" or "certutil.exe" or "ftp.exe")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="suspicious-ms-outlook-child-process"></a>Suspicious MS Outlook Child Process<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-ms-outlook-child-process.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies suspicious child processes of Microsoft Outlook. These child
processes are often associated with spear phishing activity.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#suspicious-ms-outlook-child-process-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_97"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-ms-outlook-child-process.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.name:outlook.exe and
process.name:(Microsoft.Workflow.Compiler.exe or arp.exe or
atbroker.exe or bginfo.exe or bitsadmin.exe or cdb.exe or certutil.exe
or cmd.exe or cmstp.exe or cscript.exe or csi.exe or dnx.exe or
dsget.exe or dsquery.exe or forfiles.exe or fsi.exe or ftp.exe or
gpresult.exe or hostname.exe or ieexec.exe or iexpress.exe or
installutil.exe or ipconfig.exe or mshta.exe or msxsl.exe or
nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or
nltest.exe or odbcconf.exe or ping.exe or powershell.exe or pwsh.exe
or qprocess.exe or quser.exe or qwinsta.exe or rcsi.exe or reg.exe or
regasm.exe or regsvcs.exe or regsvr32.exe or sc.exe or schtasks.exe or
systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or
wmic.exe or wscript.exe or xwizard.exe)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_74"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-ms-outlook-child-process.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Spearphishing Attachment
</li>
<li class="listitem">
ID: T1193
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1193/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1193/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="suspicious-ms-outlook-child-process-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-ms-outlook-child-process.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.name:"outlook.exe" and process.name:("arp.exe" or
"dsquery.exe" or "dsget.exe" or "gpresult.exe" or "hostname.exe" or
"ipconfig.exe" or "nbtstat.exe" or "net.exe" or "net1.exe" or
"netsh.exe" or "netstat.exe" or "nltest.exe" or "ping.exe" or
"qprocess.exe" or "quser.exe" or "qwinsta.exe" or "reg.exe" or
"sc.exe" or "systeminfo.exe" or "tasklist.exe" or "tracert.exe" or
"whoami.exe" or "bginfo.exe" or "cdb.exe" or "cmstp.exe" or "csi.exe"
or "dnx.exe" or "fsi.exe" or "ieexec.exe" or "iexpress.exe" or
"installutil.exe" or "Microsoft.Workflow.Compiler.exe" or
"msbuild.exe" or "mshta.exe" or "msxsl.exe" or "odbcconf.exe" or
"rcsi.exe" or "regsvr32.exe" or "xwizard.exe" or "atbroker.exe" or
"forfiles.exe" or "schtasks.exe" or "regasm.exe" or "regsvcs.exe" or
"cmd.exe" or "cscript.exe" or "powershell.exe" or "pwsh.exe" or
"wmic.exe" or "wscript.exe" or "bitsadmin.exe" or "certutil.exe" or
"ftp.exe")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="suspicious-pdf-reader-child-process"></a>Suspicious PDF Reader Child Process<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-pdf-reader-child-process.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies suspicious child processes of PDF reader applications. These child
processes are often launched via exploitation of PDF applications or social
engineering.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_98"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-pdf-reader-child-process.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.name:(AcroRd32.exe or Acrobat.exe or
FoxitPhantomPDF.exe or FoxitReader.exe) and process.name:(arp.exe or
dsquery.exe or dsget.exe or gpresult.exe or hostname.exe or
ipconfig.exe or nbtstat.exe or net.exe or net1.exe or netsh.exe or
netstat.exe or nltest.exe or ping.exe or qprocess.exe or quser.exe or
qwinsta.exe or reg.exe or sc.exe or systeminfo.exe or tasklist.exe or
tracert.exe or whoami.exe or bginfo.exe or cdb.exe or cmstp.exe or
csi.exe or dnx.exe or fsi.exe or ieexec.exe or iexpress.exe or
installutil.exe or Microsoft.Workflow.Compiler.exe or msbuild.exe or
mshta.exe or msxsl.exe or odbcconf.exe or rcsi.exe or regsvr32.exe or
xwizard.exe or atbroker.exe or forfiles.exe or schtasks.exe or
regasm.exe or regsvcs.exe or cmd.exe or cscript.exe or powershell.exe
or pwsh.exe or wmic.exe or wscript.exe or bitsadmin.exe or
certutil.exe or ftp.exe)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_75"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-pdf-reader-child-process.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: User Execution
</li>
<li class="listitem">
ID: T1204
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1204/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1204/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="suspicious-powershell-script"></a>Suspicious Powershell Script<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-powershell-script.asciidoc">edit</a></h3>
</div></div></div>
<p>A machine learning job detected a PowerShell script with unusual data
characteristics, such as obfuscation, that may be a characteristic of malicious
PowerShell script text blocks.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: windows_anomalous_script</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_50"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/suspicious-powershell-script.asciidoc">edit</a></h4>
</div></div></div>
<p>Certain kinds of security testing may trigger this signal. PowerShell scripts
that use high levels of obfuscation or have unusual script block payloads may
trigger this signal.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="svchost-spawning-cmd"></a>Svchost spawning Cmd<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/svchost-spawning-cmd.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies a suspicious parent-child process relationship with cmd.exe
descending from <code class="literal">svchost.exe</code>.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#svchost-spawning-cmd-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_99"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/svchost-spawning-cmd.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.parent.name:svchost.exe and process.name:cmd.exe</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_76"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/svchost-spawning-cmd.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command-Line Interface
</li>
<li class="listitem">
ID: T1059
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1059/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1059/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="svchost-spawning-cmd-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/svchost-spawning-cmd.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="system-shells-via-services"></a>System Shells via Services<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/system-shells-via-services.asciidoc">edit</a></h3>
</div></div></div>
<p>Windows services typically run as SYSTEM and can be used as a privilege
escalation opportunity. Malware or penetration testers may run a shell as a
service to gain SYSTEM permissions.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#system-shells-via-services-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_100"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/system-shells-via-services.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.name:services.exe and process.name:(cmd.exe or
powershell.exe)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_77"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/system-shells-via-services.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: New Service
</li>
<li class="listitem">
ID: T1050
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1050/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1050/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="system-shells-via-services-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/system-shells-via-services.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.name:"services.exe" and process.name:("cmd.exe" or
"powershell.exe")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="tcp-port-8000-activity-to-the-internet"></a>TCP Port 8000 Activity to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/tcp-port-8000-activity-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>TCP Port 8000 is commonly used for development environments of web server
software. It generally should not be exposed directly to the Internet. If you
are running software like this on the Internet, you should consider placing it
behind a reverse proxy.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#tcp-port-8000-activity-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_51"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/tcp-port-8000-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>Because this port is in the ephemeral range, this rule may false under certain
conditions, such as when a NATed web server replies to a client which has used a
port in the range by coincidence. In this case, such servers can be excluded.
Some applications may use this port but this is very uncommon and usually
appears in local traffic using private IPs, which this rule does not match. Some
cloud environments, particularly development environments, may use this port
when VPNs or direct connects are not in use and cloud instances are accessed
across the Internet.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_101"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/tcp-port-8000-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:8000 and
source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not
destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_78"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/tcp-port-8000-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="tcp-port-8000-activity-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/tcp-port-8000-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port: 8000 and (
network.direction: outbound or ( source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="telnet-port-activity"></a>Telnet Port Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/telnet-port-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects network events that may indicate the use of Telnet traffic. Telnet is
commonly used by system administrators to remotely control older or embedded
systems using the command line shell. It should almost never be directly exposed
to the Internet, as it is frequently targeted and exploited by threat actors as
an initial access or back-door vector. As a plain-text protocol, it may also
expose usernames and passwords to anyone capable of observing the traffic.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#telnet-port-activity-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.6.1</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_52"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/telnet-port-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>IoT (Internet of Things) devices and networks may use telnet and can be excluded
if desired. Some business workflows may use Telnet for administration of older
devices. These often have a predictable behavior. Telnet activity involving an
unusual source or destination may be more suspicious. Telnet activity involving
a production server that has no known associated Telnet workflow or business
requirement is often suspicious.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_102"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/telnet-port-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:23</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_79"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/telnet-port-activity.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Lateral Movement
</li>
<li class="listitem">
ID: TA0008
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0008/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0008/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Remote Services
</li>
<li class="listitem">
ID: T1021
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1021/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1021/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Initial Access
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exploit Public-Facing Application
</li>
<li class="listitem">
ID: T1190
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1190/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1190/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="telnet-port-activity-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/telnet-port-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="tor-activity-to-the-internet"></a>Tor Activity to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/tor-activity-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects network events that may indicate the use of Tor traffic to the Internet.
Tor is a network protocol that sends traffic through a series of encrypted
tunnels used to conceal a user&#8217;s location and usage. Tor may be used by threat
actors as an alternate communication pathway to conceal the actor&#8217;s identity and
avoid detection.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#tor-activity-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_53"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/tor-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>Tor client activity is uncommon in managed enterprise networks but may be common
in unmanaged or public networks where few security policies apply. Because these
ports are in the ephemeral range, this rule may false under certain conditions
such as when a NATed web server replies to a client which has used one of these
ports by coincidence. In this case, such servers can be excluded if desired.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_103"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/tor-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port:(9001 or 9030) and
source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not
destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_80"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/tor-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Commonly Used Port
</li>
<li class="listitem">
ID: T1043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1043/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1043/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Multi-hop Proxy
</li>
<li class="listitem">
ID: T1188
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1188/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1188/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="tor-activity-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/tor-activity-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and destination.port: (9001 or 9030) and (
network.direction: outbound or ( source.ip: (10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16) and not destination.ip: (10.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="trusted-developer-application-usage"></a>Trusted Developer Application Usage<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/trusted-developer-application-usage.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies possibly suspicious activity using a trusted Windows developer
utility program.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#trusted-developer-application-usage-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_54"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/trusted-developer-application-usage.asciidoc">edit</a></h4>
</div></div></div>
<p>These programs may be used by Windows developers but use by non-engineers is
unusual.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_104"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/trusted-developer-application-usage.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.code:1 and process.name:(MSBuild.exe or msxsl.exe)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_81"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/trusted-developer-application-usage.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Trusted Developer Utilities
</li>
<li class="listitem">
ID: T1127
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1127/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1127/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Trusted Developer Utilities
</li>
<li class="listitem">
ID: T1127
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1127/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1127/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="trusted-developer-application-usage-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/trusted-developer-application-usage.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.code:1 and (process.name:MSBuild.exe or process.name:msxsl.exe)</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-dns-activity"></a>Unusual DNS Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-dns-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>A machine learning job detected a rare and unusual DNS query that indicates
network activity with unusual DNS domains. This can be due to initial access,
persistence, command-and-control, or exfiltration activity. For example, when a
user clicks on a link in a phishing email or opens a malicious document, a
request may be sent to download and run a payload from an uncommon domain. When
malware is already running, it may send requests to an uncommon DNS domain the
malware uses for command-and-control communication.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: packetbeat_rare_dns_question</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Packetbeat
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_55"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-dns-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>A newly installed program or one that runs rarely as part of a monthly or
quarterly workflow could trigger this signal. Network activity that occurs
rarely, in small quantities, can trigger this signal. Possible examples are
browsing technical support or vendor networks sparsely. A user who visits a new
or unique web destination may trigger this signal.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-linux-network-activity"></a>Unusual Linux Network Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-linux-network-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies Linux processes that do not usually use the network but have
unexpected network activity, which can indicate command-and-control, lateral
movement, persistence, or data exfiltration activity. A process with unusual
network activity can denote process exploitation or injection, where the process
is used to run persistence mechanisms that allow a malicious actor remote access
or control of the host, data exfiltration, and execution of unauthorized network
applications.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: linux_anomalous_network_activity_ecs</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
<li class="listitem">
ML
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_56"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-linux-network-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>A newly installed program or one that rarely uses the network could trigger this
signal.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_investigation_guide_3"></a>Investigation guide<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-linux-network-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Signals from this rule indicate the presence of network activity from a Linux
process for which network activity is rare and unusual.  Here are some possible
avenues of investigation:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Consider the IP addresses and ports. Are these used by normal but infrequent
network workflows? Are they expected or unexpected?
</li>
<li class="listitem">
<p>If the destination IP address is remote or external, does it associate with
an expected domain, organization or geography?</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Avoid interacting directly with suspected malicious IP addresses.</p>
</div>
</div>
</li>
<li class="listitem">
Consider the user as identified by the username field. Is this network
activity part of an expected workflow for the user who ran the program?
</li>
<li class="listitem">
Examine the history of execution. If this process manifested only
very recently, it might be part of a new software package. If it has a
consistent schedule - for example if it runs monthly or quarterly - it might be
part of a monthly or quarterly business or maintenance process.
</li>
<li class="listitem">
Examine the process arguments, title and working directory. These may provide
indications as to the source of the program or the nature of the tasks it is
performing.
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-linux-network-port-activity"></a>Unusual Linux Network Port Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-linux-network-port-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies unusual destination port activity that can indicate command-and-
control, persistence mechanism, or data exfiltration activity. Rarely used
destination port activity is generally unusual in Linux fleets, and can indicate
unauthorized access or threat actor activity.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: linux_anomalous_network_port_activity_ecs</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
<li class="listitem">
ML
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_57"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-linux-network-port-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>A newly installed program or one that rarely uses the network could trigger this
signal.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-linux-network-service"></a>Unusual Linux Network Service<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-linux-network-service.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies unusual listening ports on Linux instances that can indicate
execution of unauthorized services, backdoors, or persistence mechanisms.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: linux_anomalous_network_service</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
<li class="listitem">
ML
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_58"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-linux-network-service.asciidoc">edit</a></h4>
</div></div></div>
<p>A newly installed program or one that rarely uses the network could trigger this
signal.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-linux-username"></a>Unusual Linux Username<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-linux-username.asciidoc">edit</a></h3>
</div></div></div>
<p>A machine learning job detected activity for a username that is not normally
active, which can indicate unauthorized changes, activity by unauthorized users,
lateral movement, or compromised credentials. In many organizations, new
usernames are not often created apart from specific types of system activities,
such as creating new accounts for new employees. These user accounts quickly
become active and routine. Events from rarely used usernames can point to
suspicious activity. Additionally, automated Linux fleets tend to see activity
from rarely used usernames only when personnel log in to make authorized or
unauthorized changes, or threat actors have acquired credentials and log in for
malicious purposes. Unusual usernames can also indicate pivoting, where
compromised credentials are used to try and move laterally from one host to
another.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: linux_anomalous_user_name_ecs</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
<li class="listitem">
ML
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_59"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-linux-username.asciidoc">edit</a></h4>
</div></div></div>
<p>Uncommon user activity can be due to an engineer logging in to a server instance
in order to perform manual troubleshooting or reconfiguration.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_investigation_guide_4"></a>Investigation guide<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-linux-username.asciidoc">edit</a></h4>
</div></div></div>
<p>Signals from this rule indicate activity for a Linux user name that is rare and
unusual. Here are some possible avenues of investigation:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Consider the user as identified by the username field. Is this program part
of an expected workflow for the user who ran this program on this host? Could
this be related to troubleshooting or debugging activity by a developer or site
reliability engineer?
</li>
<li class="listitem">
Examine the history of user activity. If this user manifested only very
recently, it might be a service account for a new software package. If it has a
consistent schedule - for example if it runs monthly or quarterly - it might be
part of a monthly or quarterly business process.
</li>
<li class="listitem">
Examine the process arguments, title and working directory. These may provide
indications as to the source of the program or the nature of the tasks that the
user is performing.
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-linux-web-activity"></a>Unusual Linux Web Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-linux-web-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>A machine learning job detected an unusual web URL request from a Linux host,
which can indicate malware delivery and execution. Wget and cURL are commonly
used by Linux programs to download code and data. Most of the time, their usage
is entirely normal. Generally, because they use a list of URLs, they repeatedly
download from the same locations. However, Wget and cURL are sometimes used to
deliver Linux exploit payloads, and threat actors use these tools to download
additional software and code. For these reasons, unusual URLs can indicate
unauthorized downloads or threat activity.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: linux_anomalous_network_url_activity_ecs</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
<li class="listitem">
ML
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_60"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-linux-web-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>A new and unusual program or artifact download in the course of software
upgrades, debugging, or troubleshooting could trigger this signal.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-login-activity"></a>Unusual Login Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-login-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies an unusually high number of authentication attempts.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: suspicious_login_activity_ecs</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
<li class="listitem">
ML
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_61"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-login-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Security audits may trigger this signal. Conditions that generate bursts of
failed logins, such as misconfigured applications or account lockouts could
trigger this signal.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-network-connection-via-rundll32"></a>Unusual Network Connection via RunDLL32<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-network-connection-via-rundll32.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies unusual instances of <code class="literal">rundll32.exe</code> making outbound network
connections. This may indicate adversarial activity and may identify malicious
DLLs.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#unusual-network-connection-via-rundll32-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_105"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-network-connection-via-rundll32.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:rundll32.exe and event.action:"Network connection
detected (rule: NetworkConnect)" and not destination.ip:(10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16 or 127.0.0.0/8)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_82"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-network-connection-via-rundll32.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Rundll32
</li>
<li class="listitem">
ID: T1085
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1085/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1085/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="unusual-network-connection-via-rundll32-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-network-connection-via-rundll32.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.8.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:rundll32.exe and event.action:"Network connection
detected (rule: NetworkConnect)" and not destination.ip:(10.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16)</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:rundll32.exe and event.action:"Network connection
detected (rule: NetworkConnect)" and not destination.ip:10.0.0.0/8 and
not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-network-destination-domain-name"></a>Unusual Network Destination Domain Name<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-network-destination-domain-name.asciidoc">edit</a></h3>
</div></div></div>
<p>A machine learning job detected an unusual network destination domain name. This
can be due to initial access, persistence, command-and-control, or exfiltration
activity. For example, when a user clicks on a link in a phishing email or opens
a malicious document, a request may be sent to download and run a payload from
an uncommon web server name. When malware is already running, it may send
requests to an uncommon DNS domain the malware uses for command-and-control
communication.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: packetbeat_rare_server_domain</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Packetbeat
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_62"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-network-destination-domain-name.asciidoc">edit</a></h4>
</div></div></div>
<p>Web activity that occurs rarely in small quantities can trigger this signal.
Possible examples are browsing technical support or vendor URLs that are used
very sparsely. A user who visits a new and unique web destination may trigger
this signal when the activity is sparse. Web applications that generate URLs
unique to a transaction may trigger this when they are used sparsely. Web
domains can be excluded in these cases.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-parent-child-relationship"></a>Unusual Parent-Child Relationship<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-parent-child-relationship.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies Windows programs run from unexpected parent processes. This could
indicate masquerading or other strange activity on a system.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#unusual-parent-child-relationship-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_106"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-parent-child-relationship.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.executable:* and (process.name:smss.exe and not
process.parent.name:(System or smss.exe) or process.name:csrss.exe and
not process.parent.name:(smss.exe or svchost.exe) or
process.name:wininit.exe and not process.parent.name:smss.exe or
process.name:winlogon.exe and not process.parent.name:smss.exe or
process.name:lsass.exe and not process.parent.name:wininit.exe or
process.name:LogonUI.exe and not process.parent.name:(wininit.exe or
winlogon.exe) or process.name:services.exe and not
process.parent.name:wininit.exe or process.name:svchost.exe and not
process.parent.name:(MsMpEng.exe or services.exe) or
process.name:spoolsv.exe and not process.parent.name:services.exe or
process.name:taskhost.exe and not process.parent.name:(services.exe or
svchost.exe) or process.name:taskhostw.exe and not
process.parent.name:(services.exe or svchost.exe) or
process.name:userinit.exe and not process.parent.name:(dwm.exe or
winlogon.exe))</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_83"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-parent-child-relationship.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Process Hollowing
</li>
<li class="listitem">
ID: T1093
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1093/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1093/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="unusual-parent-child-relationship-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-parent-child-relationship.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.executable:* and ( (process.name:"smss.exe" and not
process.parent.name:("System" or "smss.exe")) or
(process.name:"csrss.exe" and not process.parent.name:("smss.exe" or
"svchost.exe")) or (process.name:"wininit.exe" and not
process.parent.name:"smss.exe") or (process.name:"winlogon.exe" and
not process.parent.name:"smss.exe") or (process.name:"lsass.exe" and
not process.parent.name:"wininit.exe") or (process.name:"LogonUI.exe"
and not process.parent.name:("winlogon.exe" or "wininit.exe")) or
(process.name:"services.exe" and not
process.parent.name:"wininit.exe") or (process.name:"svchost.exe" and
not process.parent.name:("services.exe" or "MsMpEng.exe")) or
(process.name:"spoolsv.exe" and not
process.parent.name:"services.exe") or (process.name:"taskhost.exe"
and not process.parent.name:("services.exe" or "svchost.exe")) or
(process.name:"taskhostw.exe" and not
process.parent.name:("services.exe" or "svchost.exe")) or
(process.name:"userinit.exe" and not process.parent.name:("dwm.exe" or
"winlogon.exe")) )</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-process-execution-temp"></a>Unusual Process Execution - Temp<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-execution-temp.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies processes running in a temporary folder. This is sometimes done by
adversaries to hide malware.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#unusual-process-execution-temp-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_63"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-execution-temp.asciidoc">edit</a></h4>
</div></div></div>
<p>Build systems, like Jenkins, may start processes in the <code class="literal">/tmp</code> directory. These
can be exempted by name or by username.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_107"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-execution-temp.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.working_directory:/tmp and event.action:executed</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="unusual-process-execution-temp-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-execution-temp.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.working_directory: /tmp and event.action:executed</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-process-for-a-linux-host"></a>Unusual Process For a Linux Host<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-for-a-linux-host.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies rare processes that do not usually run on individual hosts, which can
indicate execution of unauthorized services, malware, or persistence mechanisms.
Processes are considered rare when they only run occasionally as compared with
other processes running on the host.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: rare_process_by_host_linux_ecs</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
<li class="listitem">
ML
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_64"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-for-a-linux-host.asciidoc">edit</a></h4>
</div></div></div>
<p>A newly installed program or one that runs rarely as part of a monthly or
quarterly workflow could trigger this signal.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_investigation_guide_5"></a>Investigation guide<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-for-a-linux-host.asciidoc">edit</a></h4>
</div></div></div>
<p>Signals from this rule indicate the presence of a Linux process that is rare and unusual for the host it ran on. Here are some possible avenues of investigation:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Consider the user as identified by the username field. Is this program part
of an expected workflow for the user who ran this program on this host?
</li>
<li class="listitem">
Examine the history of execution. If this process manifested only very
recently, it might be part of a new software package. If it has a consistent
schedule - for example if it runs monthly or quarterly - it might be part of a
monthly or quarterly business process.
</li>
<li class="listitem">
Examine the process arguments, title and working directory. These may
provide indications as to the source of the program or the nature of the tasks
it is performing.
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-process-for-a-windows-host"></a>Unusual Process For a Windows Host<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-for-a-windows-host.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies rare processes that do not usually run on individual hosts, which can
indicate execution of unauthorized services, malware, or persistence mechanisms.
Processes are considered rare when they only run occasionally as compared with
other processes running on the host.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: rare_process_by_host_windows_ecs</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_65"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-for-a-windows-host.asciidoc">edit</a></h4>
</div></div></div>
<p>A newly installed program or one that runs rarely as part of a monthly or
quarterly workflow could trigger this signal.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_investigation_guide_6"></a>Investigation guide<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-for-a-windows-host.asciidoc">edit</a></h4>
</div></div></div>
<p>Signals from this rule indicate the presence of a Windows process that is rare and unusual for the host it ran on. Here are some possible avenues of investigation:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Consider the user as identified by the username field. Is this program part
of an expected workflow for the user who ran this program on this host?
</li>
<li class="listitem">
Examine the history of execution. If this process manifested only very
recently, it might be part of a new software package. If it has a consistent
schedule - for example if it runs monthly or quarterly - it might be part of a
monthly or quarterly business process.
</li>
<li class="listitem">
Examine the process metadata like the values of the Company, Description and
Product fields which may indicate whether the program is associated with an
expected software vendor or package.
</li>
<li class="listitem">
Examine arguments and working directory. These may provide indications as to
the source of the program or the nature of the tasks it is performing.
</li>
<li class="listitem">
Consider the same for the parent process. If the parent process is a
legitimate system utility or service, this could be related to software updates
or system management. If the parent process is something user-facing like an
Office application, this process could be more suspicious.
</li>
<li class="listitem">
If you have file hash values in the event data, and you suspect malware, you
can optionally run a search for the file hash to see if the file is identified
as malware by anti-malware tools.
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-process-network-connection"></a>Unusual Process Network Connection<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-network-connection.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies network activity from unexpected system applications. This may
indicate adversarial activity as these applications are often leveraged by
adversaries to execute code and evade detection.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#unusual-process-network-connection-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_108"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-network-connection.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Network connection detected (rule: NetworkConnect)" and
process.name:(Microsoft.Workflow.Compiler.exe or bginfo.exe or cdb.exe
or cmstp.exe or csi.exe or dnx.exe or fsi.exe or ieexec.exe or
iexpress.exe or odbcconf.exe or rcsi.exe or xwizard.exe)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_84"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-network-connection.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Trusted Developer Utilities
</li>
<li class="listitem">
ID: T1127
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1127/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1127/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="unusual-process-network-connection-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-process-network-connection.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Network connection detected (rule: NetworkConnect)" and
process.name:(bginfo.exe or cdb.exe or cmstp.exe or csi.exe or dnx.exe
or fsi.exe or ieexec.exe or iexpress.exe or
Microsoft.Workflow.Compiler.exe or odbcconf.exe or rcsi.exe or
xwizard.exe)</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-web-request"></a>Unusual Web Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-web-request.asciidoc">edit</a></h3>
</div></div></div>
<p>A machine learning job detected a rare and unusual URL that indicates unusual
web browsing activity. This can be due to initial access, persistence, command-
and-control, or exfiltration activity. For example, in a strategic web
compromise or watering hole attack, when a trusted website is compromised to
target a particular sector or organization, targeted users may receive emails
with uncommon URLs for trusted websites. These URLs can be used to download and
run a payload. When malware is already running, it may send requests to uncommon
URLs on trusted websites the malware uses for command-and-control communication.
When rare URLs are observed being requested for a local web server by a remote
source, these can be due to web scanning, enumeration or attack traffic, or they
can be due to bots and web scrapers which are part of common Internet background
traffic.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: packetbeat_rare_urls</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Packetbeat
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_66"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-web-request.asciidoc">edit</a></h4>
</div></div></div>
<p>Web activity that occurs rarely in small quantities can trigger this signal.
Possible examples are browsing technical support or vendor URLs that are used
very sparsely. A user who visits a new and unique web destination may trigger
this signal when the activity is sparse. Web applications that generate URLs
unique to a transaction may trigger this when they are used sparsely. Web
domains can be excluded in cases such as these.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-web-user-agent"></a>Unusual Web User Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-web-user-agent.asciidoc">edit</a></h3>
</div></div></div>
<p>A machine learning job detected a rare and unusual user agent indicating web
browsing activity by an unusual process other than a web browser. This can be
due to persistence, command-and-control, or exfiltration activity. Uncommon user
agents coming from remote sources to local destinations are often the result of
scanners, bots, and web scrapers, which are part of common Internet background
traffic. Much of this is noise, but more targeted attacks on websites using
tools like Burp or SQLmap can sometimes be discovered by spotting uncommon user
agents. Uncommon user agents in traffic from local sources to remote
destinations can be any number of things, including harmless programs like
weather monitoring or stock-trading programs. However, uncommon user agents from
local sources can also be due to malware or scanning activity.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: packetbeat_rare_user_agent</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Packetbeat
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_67"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-web-user-agent.asciidoc">edit</a></h4>
</div></div></div>
<p>Web activity that is uncommon, like security scans, may trigger a signal and
may need to be excluded. A new or rarely used program that calls web services
may trigger a signal.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-windows-network-activity"></a>Unusual Windows Network Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-network-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies Windows processes that do not usually use the network but have
unexpected network activity, which can indicate command-and-control, lateral
movement, persistence, or data exfiltration activity. A process with unusual
network activity can denote process exploitation or injection, where the process
is used to run persistence mechanisms that allow a malicious actor remote access
or control of the host, data exfiltration, and execution of unauthorized network
applications.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: windows_anomalous_network_activity_ecs</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_68"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-network-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>A newly installed program or one that rarely uses the network could trigger this
signal.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_investigation_guide_7"></a>Investigation guide<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-network-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Signals from this rule indicate the presence of network activity from a Windows
process for which network activity is very unusual.  Here are some possible
avenues of investigation:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Consider the IP addresses, protocol and ports. Are these used by normal but
infrequent network workflows? Are they expected or unexpected?
</li>
<li class="listitem">
If the destination IP address is remote or external, does it associate with
an expected domain, organization or geography? Note: avoid interacting directly
with suspected malicious IP addresses.
</li>
<li class="listitem">
Consider the user as identified by the username field. Is this network
activity part of an expected workflow for the user who ran the program?
</li>
<li class="listitem">
Examine the history of execution. If this process manifested only very
recently, it might be part of a new software package. If it has a consistent
schedule - for example if it runs monthly or quarterly - it might be part of a
monthly or quarterly business process.
</li>
<li class="listitem">
Examine the process arguments, title and working directory. These may provide
indications as to the source of the program or the nature of the tasks it is
performing.
</li>
<li class="listitem">
Consider the same for the parent process. If the parent process is a
legitimate system utility or service, this could be related to software updates
or system management. If the parent process is something user-facing like an
Office application, this process could be more suspicious.
</li>
<li class="listitem">
If you have file hash values in the event data, and you suspect malware, you
can optionally run a search for the file hash to see if the file is identified
as malware by anti-malware tools.
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-windows-path-activity"></a>Unusual Windows Path Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-path-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies processes started from atypical folders in the file system, which
may indicate malware execution or persistence mechanisms. In corporate Windows
environments, software installation is centrally managed and it is unusual for
programs to be executed from user or temporary directories. Processes executed
from these locations can denote that a user downloaded software directly from
the Internet or a malicious script or macro executed malware.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: windows_anomalous_path_activity_ecs</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_69"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-path-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>A new and unusual program or artifact download in the course of software
upgrades, debugging, or troubleshooting could trigger this signal. Users
downloading and running programs from unusual locations, such as temporary
directories, browser caches, or profile paths could trigger this signal.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-windows-remote-user"></a>Unusual Windows Remote User<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-remote-user.asciidoc">edit</a></h3>
</div></div></div>
<p>A machine learning job detected an unusual remote desktop protocol (RDP)
username, which can indicate account takeover or credentialed persistence using
compromised accounts. RDP attacks, such as BlueKeep, also tend to use unusual
usernames.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: windows_rare_user_type10_remote_login</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_70"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-remote-user.asciidoc">edit</a></h4>
</div></div></div>
<p>Uncommon username activity can be due to an engineer logging in to a server
instance in order to perform manual troubleshooting or reconfiguration.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_investigation_guide_8"></a>Investigation guide<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-remote-user.asciidoc">edit</a></h4>
</div></div></div>
<p>Signals from this rule indicate activity for a rare and unusual Windows RDP
(remote desktop) user. Here are some possible avenues of investigation:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Consider the user as identified by the username field. Is the user part of a
group who normally logs in to Windows hosts using RDP (remote desktop
protocol)? Is this logon activity part of an expected workflow for the user?
</li>
<li class="listitem">
Consider the source of the login. If the source is remote, could this be
related to occasional troubleshooting or support activity by a vendor or an
employee working remotely?
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-windows-service"></a>Unusual Windows Service<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-service.asciidoc">edit</a></h3>
</div></div></div>
<p>A machine learning job detected an unusual Windows service, This can indicate
execution of unauthorized services, malware, or persistence mechanisms. In
corporate Windows environments, hosts do not generally run many rare or unique
services. This job helps detect malware and persistence mechanisms that have
been installed and run as a service.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: windows_anomalous_service</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_71"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-service.asciidoc">edit</a></h4>
</div></div></div>
<p>A newly installed program or one that runs rarely as part of a monthly or
quarterly workflow could trigger this signal.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-windows-user-privilege-elevation-activity"></a>Unusual Windows User Privilege Elevation Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-user-privilege-elevation-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>A machine learning job detected an unusual user context switch, using the
<code class="literal">runas</code> command or similar techniques, which can indicate account takeover or
privilege escalation using compromised accounts. Privilege elevation using
tools like <code class="literal">runas</code> are more commonly used by domain and network administrators
than by regular Windows users.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: windows_rare_user_runas_event</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_72"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-user-privilege-elevation-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Uncommon user privilege elevation activity can be due to an administrator, help
desk technician, or a user performing manual troubleshooting or reconfiguration.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unusual-windows-username"></a>Unusual Windows Username<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-username.asciidoc">edit</a></h3>
</div></div></div>
<p>A machine learning job detected activity for a username that is not normally
active, which can indicate unauthorized changes, activity by unauthorized users,
lateral movement, or compromised credentials. In many organizations, new
usernames are not often created apart from specific types of system activities,
such as creating new accounts for new employees. These user accounts quickly
become active and routine. Events from rarely used usernames can point to
suspicious activity. Unusual usernames can also indicate pivoting, where
compromised credentials are used to try and move laterally from one host to
another.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Machine learning job</strong></span>: windows_anomalous_user_name_ecs</p>
<p><span class="strong strong"><strong>Machine learning anomaly threshold</strong></span>: 50</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-45m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/siem/guide/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
ML
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_73"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-username.asciidoc">edit</a></h4>
</div></div></div>
<p>Uncommon user activity can be due to an administrator or help desk technician
logging in to a workstation or server to perform manual troubleshooting or
reconfiguration.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_investigation_guide_9"></a>Investigation guide<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/unusual-windows-username.asciidoc">edit</a></h4>
</div></div></div>
<p>Signals from this rule indicate activity for a Windows user name that is rare
and unusual. Here are some possible avenues of investigation:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Consider the user as identified by the username field. Is this program part
of an expected workflow for the user who ran this program on this host? Could
this be related to occasional troubleshooting or support activity?
</li>
<li class="listitem">
Examine the history of user activity. If this user manifested only very
recently, it might be a service account for a new software package. If it has a
consistent schedule - for example if it runs monthly or quarterly - it might be
part of a monthly or quarterly business process.
</li>
<li class="listitem">
Examine the process arguments, title and working directory. These may
provide indications as to the source of the program or the nature of the tasks
that the user is performing.
</li>
<li class="listitem">
Consider the same for the parent process. If the parent process is a
legitimate system utility or service, this could be related to software updates
or system management. If the parent process is something user-facing like an
Office application, this process could be more suspicious.
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="user-account-creation"></a>User Account Creation<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/user-account-creation.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies attempts to create new local users. This is sometimes done by
attackers to increase access to a system or domain.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#user-account-creation-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_109"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/user-account-creation.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:(net.exe or net1.exe) and not process.parent.name:net.exe
and process.args:(user and (/ad or /add))</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_85"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/user-account-creation.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Create Account
</li>
<li class="listitem">
ID: T1136
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1136/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1136/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="user-account-creation-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/user-account-creation.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:("net.exe" or "net1.exe") and not
process.parent.name:"net.exe" and process.args:("user" and ("/add" or
"/ad"))</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="user-discovery-via-whoami"></a>User Discovery via Whoami<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/user-discovery-via-whoami.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">whoami</code> application was executed on a Linux host. This is often used by
tools and persistence mechanisms to test for privileged access.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#user-discovery-via-whoami-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_74"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/user-discovery-via-whoami.asciidoc">edit</a></h4>
</div></div></div>
<p>Security testing tools and frameworks may run this command. Some normal use of
this command may originate from automation tools and frameworks.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_110"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/user-discovery-via-whoami.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:whoami and event.action:executed</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_86"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/user-discovery-via-whoami.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Discovery
</li>
<li class="listitem">
ID: TA0007
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0007/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0007/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: System Owner/User Discovery
</li>
<li class="listitem">
ID: T1033
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1033/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1033/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="user-discovery-via-whoami-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/user-discovery-via-whoami.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name: whoami and event.action:executed</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="vnc-virtual-network-computing-from-the-internet"></a>VNC (Virtual Network Computing) from the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/vnc-virtual-network-computing-from-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects network events that may indicate the use of VNC traffic from the
Internet. VNC is commonly used by system administrators to remotely control a
system for maintenance or to use shared resources. It should almost never be
directly exposed to the Internet, as it is frequently targeted and exploited by
threat actors as an initial access or back-door vector.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#vnc-virtual-network-computing-from-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_75"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/vnc-virtual-network-computing-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>VNC connections may be received directly to Linux cloud server instances but
such connections are usually made only by engineers. VNC is less common than SSH
or RDP but may be required by some workflows such as remote access and support
for specialized software products or servers. Such workflows are usually known
and not unexpected. Usage that is unfamiliar to server or network owners can be
unexpected and suspicious.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_111"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/vnc-virtual-network-computing-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port &gt;= 5800 and
destination.port &lt;= 5810 and not source.ip:(10.0.0.0/8 or 127.0.0.0/8
or 172.16.0.0/12 or 192.168.0.0/16 or "::1") and
destination.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_87"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/vnc-virtual-network-computing-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Remote Access Tools
</li>
<li class="listitem">
ID: T1219
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1219/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1219/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Initial Access
</li>
<li class="listitem">
ID: TA0001
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0001/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0001/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exploit Public-Facing Application
</li>
<li class="listitem">
ID: T1190
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1190/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1190/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="vnc-virtual-network-computing-from-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/vnc-virtual-network-computing-from-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and (destination.port &gt;= 5800 and
destination.port &lt;= 5810) and ( network.direction: inbound or ( not
source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and
destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="vnc-virtual-network-computing-to-the-internet"></a>VNC (Virtual Network Computing) to the Internet<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/vnc-virtual-network-computing-to-the-internet.asciidoc">edit</a></h3>
</div></div></div>
<p>Detects network events that may indicate the use of VNC traffic to the Internet.
VNC is commonly used by system administrators to remotely control a system for
maintenance or to use shared resources. It should almost never be directly
exposed to the Internet, as it is frequently targeted and exploited by threat
actors as an initial access or back-door vector.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Network
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3 (<a class="xref" href="prebuilt-rules.html#vnc-virtual-network-computing-to-the-internet-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_76"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/vnc-virtual-network-computing-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p>VNC connections may be made directly to Linux cloud server instances but such
connections are usually made only by engineers. VNC is less common than SSH or
RDP but may be required by some work flows such as remote access and support for
specialized software products or servers. Such workflows are usually known and
not unexpected. Usage that is unfamiliar to server or network owners can be
unexpected and suspicious.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_112"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/vnc-virtual-network-computing-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport:tcp and destination.port &gt;= 5800 and
destination.port &lt;= 5810 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or
192.168.0.0/16) and not destination.ip:(10.0.0.0/8 or 127.0.0.0/8 or
172.16.0.0/12 or 192.168.0.0/16 or "::1")</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_88"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/vnc-virtual-network-computing-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Remote Access Tools
</li>
<li class="listitem">
ID: T1219
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1219/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1219/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="vnc-virtual-network-computing-to-the-internet-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/vnc-virtual-network-computing-to-the-internet.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 3 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">network.transport: tcp and (destination.port &gt;= 5800 and
destination.port &lt;= 5810) and ( network.direction: outbound or (
source.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) and not
destination.ip: (10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16) ) )</pre>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.6.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removed auditbeat-*, packetbeat-*, and winlogbeat-* from the rule indices.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="virtual-machine-fingerprinting"></a>Virtual Machine Fingerprinting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/virtual-machine-fingerprinting.asciidoc">edit</a></h3>
</div></div></div>
<p>An adversary may attempt to get detailed information about the operating system and hardware. This rule identifies common locations used to discover virtual machine hardware by a non-root user. This technique has been used by Pupy RAT and other malware.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Linux
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.8.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_77"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/virtual-machine-fingerprinting.asciidoc">edit</a></h4>
</div></div></div>
<p>Certain tools or automated software may enumerate hardware information. These tools can be exempted via user name or process arguments to eliminate potential noise.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_113"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/virtual-machine-fingerprinting.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:executed and
process.args:("/sys/class/dmi/id/bios_version" or
"/sys/class/dmi/id/product_name" or "/sys/class/dmi/id/chassis_vendor"
or "/proc/scsi/scsi" or "/proc/ide/hd0/model") and not user.name:root</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_89"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/virtual-machine-fingerprinting.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Discovery
</li>
<li class="listitem">
ID: TA0007
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0007/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0007/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: System Information Discovery
</li>
<li class="listitem">
ID: T1082
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1082/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1082/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="volume-shadow-copy-deletion-via-vssadmin"></a>Volume Shadow Copy Deletion via VssAdmin<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/volume-shadow-copy-deletion-via-vssadmin.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies use of <code class="literal">vssadmin.exe</code> for shadow copy deletion on endpoints. This
commonly occurs in tandem with ransomware or other destructive attacks.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#volume-shadow-copy-deletion-via-vssadmin-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_114"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/volume-shadow-copy-deletion-via-vssadmin.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:vssadmin.exe and process.args:(delete and shadows)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_90"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/volume-shadow-copy-deletion-via-vssadmin.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Inhibit System Recovery
</li>
<li class="listitem">
ID: T1490
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1490/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1490/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="volume-shadow-copy-deletion-via-vssadmin-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/volume-shadow-copy-deletion-via-vssadmin.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:"vssadmin.exe" and process.args:("delete" and "shadows")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="volume-shadow-copy-deletion-via-wmic"></a>Volume Shadow Copy Deletion via WMIC<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/volume-shadow-copy-deletion-via-wmic.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies use of <code class="literal">wmic.exe</code> for shadow copy deletion on endpoints. This
commonly occurs in tandem with ransomware or other destructive attacks.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#volume-shadow-copy-deletion-via-wmic-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_115"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/volume-shadow-copy-deletion-via-wmic.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:WMIC.exe and process.args:(delete and shadowcopy)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_91"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/volume-shadow-copy-deletion-via-wmic.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: File Deletion
</li>
<li class="listitem">
ID: T1107
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1107/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1107/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="volume-shadow-copy-deletion-via-wmic-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/volume-shadow-copy-deletion-via-wmic.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.name:"WMIC.exe" and process.args:("shadowcopy" and "delete")</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-application-suspicious-activity-no-user-agent"></a>Web Application Suspicious Activity: No User Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-no-user-agent.asciidoc">edit</a></h3>
</div></div></div>
<p>A request to a web application server contained no identifying user agent
string.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
apm-<span class="strong strong"><strong>-transaction</strong></span>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://en.wikipedia.org/wiki/User_agent" class="ulink" target="_top">https://en.wikipedia.org/wiki/User_agent</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
APM
</li>
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#web-application-suspicious-activity-no-user-agent-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_78"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-no-user-agent.asciidoc">edit</a></h4>
</div></div></div>
<p>Some normal applications and scripts may contain no user agent. Most legitimate
web requests from the Internet contain a user agent string. Requests from web
browsers almost always contain a user agent string. If the source is unexpected,
the user unauthorized, or the request unusual, these may indicate suspicious or
malicious activity.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_116"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-no-user-agent.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">url.path:*</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_filters"></a>Rule filters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-no-user-agent.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
    "$state": {
        "store": "appState"
    },
    "exists": {
        "field": "user_agent.original"
    },
    "meta": {
        "disabled": false,
        "indexRefName": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
        "key": "user_agent.original",
        "negate": true,
        "type": "exists",
        "value": "exists"
    }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-application-suspicious-activity-no-user-agent-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-no-user-agent.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">url.path: *</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-application-suspicious-activity-post-request-declined"></a>Web Application Suspicious Activity: POST Request Declined<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-post-request-declined.asciidoc">edit</a></h3>
</div></div></div>
<p>A POST request to web application returned a 403 response, which indicates the
web application declined to process the request because the action requested was
not allowed.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
apm-<span class="strong strong"><strong>-transaction</strong></span>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://en.wikipedia.org/wiki/HTTP_403" class="ulink" target="_top">https://en.wikipedia.org/wiki/HTTP_403</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
APM
</li>
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#web-application-suspicious-activity-post-request-declined-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_79"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-post-request-declined.asciidoc">edit</a></h4>
</div></div></div>
<p>Security scans and tests may result in these errors. Misconfigured or buggy
applications may produce large numbers of these errors. If the source is
unexpected, the user unauthorized, or the request unusual, these may indicate
suspicious or malicious activity.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_117"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-post-request-declined.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">http.response.status_code:403 and http.request.method:post</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-application-suspicious-activity-post-request-declined-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-post-request-declined.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-application-suspicious-activity-unauthorized-method"></a>Web Application Suspicious Activity: Unauthorized Method<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-unauthorized-method.asciidoc">edit</a></h3>
</div></div></div>
<p>A request to web application returned a 405 response which indicates the web
application declined to process the request because the HTTP method is not
allowed for the resource.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
apm-<span class="strong strong"><strong>-transaction</strong></span>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://en.wikipedia.org/wiki/HTTP_405" class="ulink" target="_top">https://en.wikipedia.org/wiki/HTTP_405</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
APM
</li>
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#web-application-suspicious-activity-unauthorized-method-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_80"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-unauthorized-method.asciidoc">edit</a></h4>
</div></div></div>
<p>Security scans and tests may result in these errors. Misconfigured or buggy
applications may produce large numbers of these errors. If the source is
unexpected, the user unauthorized, or the request unusual, these may indicate
suspicious or malicious activity.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_118"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-unauthorized-method.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">http.response.status_code:405</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-application-suspicious-activity-unauthorized-method-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-unauthorized-method.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-application-suspicious-activity-sqlmap-user-agent"></a>Web Application Suspicious Activity: sqlmap User Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-sqlmap-user-agent.asciidoc">edit</a></h3>
</div></div></div>
<p>This is an example of how to detect an unwanted web client user agent. This
search matches the user agent for sqlmap 1.3.11, which is a popular FOSS tool
for testing web applications for SQL injection vulnerabilities.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
apm-<span class="strong strong"><strong>-transaction</strong></span>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="http://sqlmap.org/" class="ulink" target="_top">http://sqlmap.org/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
APM
</li>
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#web-application-suspicious-activity-sqlmap-user-agent-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_81"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-sqlmap-user-agent.asciidoc">edit</a></h4>
</div></div></div>
<p>This rule does not indicate that a SQL injection attack occurred, only that the
<code class="literal">sqlmap</code> tool was used. Security scans and tests may result in these errors. If
the source is not an authorized security tester, this is generally suspicious or
malicious activity.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_119"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-sqlmap-user-agent.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">user_agent.original:"sqlmap/1.3.11#stable (http://sqlmap.org)"</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-application-suspicious-activity-sqlmap-user-agent-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/web-application-suspicious-activity-sqlmap-user-agent.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="whoami-process-activity"></a>Whoami Process Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/whoami-process-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies use of <code class="literal">whoami.exe</code> which displays user, group, and privileges
information for the user who is currently logged on to the local system.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#whoami-process-activity-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_potential_false_positives_82"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/whoami-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<p>Some normal use of this program, at varying levels of frequency, may originate
from scripts, automation tools and frameworks. Usage by non-engineers and
ordinary users is unusual.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_120"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/whoami-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:whoami.exe and event.code:1</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_92"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/whoami-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Discovery
</li>
<li class="listitem">
ID: TA0007
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0007/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0007/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: System Owner/User Discovery
</li>
<li class="listitem">
ID: T1033
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1033/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1033/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="whoami-process-activity-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/whoami-process-activity.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="windows-cryptoapi-spoofing-vulnerability-cve-2020-0601-curveball"></a>Windows CryptoAPI Spoofing Vulnerability (CVE-2020-0601 - CurveBall)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/windows-cryptoapi-spoofing-vulnerability-cve-2020-0601-curveball.asciidoc">edit</a></h3>
</div></div></div>
<p>A spoofing vulnerability exists in the way Windows CryptoAPI (<code class="literal">Crypt32.dll</code>)
validates Elliptic Curve Cryptography (ECC) certificates. An attacker could
exploit the vulnerability by using a spoofed code-signing certificate to sign a
malicious executable, making it appear the file was from a trusted, legitimate
source.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_121"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/windows-cryptoapi-spoofing-vulnerability-cve-2020-0601-curveball.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.provider:"Microsoft-Windows-Audit-CVE" and
message:"[CVE-2020-0601]"</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_93"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/windows-cryptoapi-spoofing-vulnerability-cve-2020-0601-curveball.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Code Signing
</li>
<li class="listitem">
ID: T1116
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1116/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1116/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="windows-script-executing-powershell"></a>Windows Script Executing PowerShell<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/windows-script-executing-powershell.asciidoc">edit</a></h3>
</div></div></div>
<p>Identifies a PowerShell process launched by either <code class="literal">cscript.exe</code> or
<code class="literal">wscript.exe</code>. Observing Windows scripting processes executing a PowerShell
script, may be indicative of malicious activity.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum signals per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Windows
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2 (<a class="xref" href="prebuilt-rules.html#windows-script-executing-powershell-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.7.0</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rule_query_122"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/windows-script-executing-powershell.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.name:(cscript.exe or wscript.exe) and
process.name:powershell.exe</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_threat_mapping_94"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/windows-script-executing-powershell.asciidoc">edit</a></h4>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Spearphishing Attachment
</li>
<li class="listitem">
ID: T1193
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1193/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1193/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="windows-script-executing-powershell-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/siem/detections/prebuilt-rules/rule-details/windows-script-executing-powershell.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<p>
Updated query, changed from:
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.action:"Process Create (rule: ProcessCreate)" and
process.parent.name:("wscript.exe" or "cscript.exe") and
process.name:"powershell.exe"</pre>
</div>
</dd>
</dl>
</div>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="rules-ui-create.html">« Managing signal detection rules</a>
</span>
<span class="next">
<a href="tuning-detection-signals.html">Tuning prebuilt detection rules »</a>
</span>
</div>
</div>
</body>
</html>
