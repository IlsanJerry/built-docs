<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Run Osquery | Elastic Security Solution [master] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution [master]"/>
<link rel="up" href="alerts-ui-manage.html" title="Manage detection alerts"/>
<link rel="prev" href="alerts-ui-manage.html" title="Manage detection alerts"/>
<link rel="next" href="visual-event-analyzer.html" title="Visual event analyzer"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/master"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [master]</a></span>
»
<span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
»
<span class="breadcrumb-link"><a href="alerts-ui-manage.html">Manage detection alerts</a></span>
»
<span class="breadcrumb-node">Run Osquery</span>
</div>
<div class="navheader">
<span class="prev">
<a href="alerts-ui-manage.html">« Manage detection alerts</a>
</span>
<span class="next">
<a href="visual-event-analyzer.html">Visual event analyzer »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="alerts-run-osquery"></a>Run Osquery<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/detections/alerts-run-osquery.asciidoc">edit</a></h2>
</div></div></div>
<p><a href="/guide/en/kibana/master/osquery.html" class="ulink" target="_top">Osquery</a> allows you to run live queries against an alert&#8217;s host to learn more about your infrastructure and operating systems. For example, with Osquery, you can search your system for indicators of compromise that might have contributed to the alert. You can then use this data to form your investigation and alert triage efforts.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must complete the following to access Osquery and run searches against your hosts:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Enable the <a href="/guide/en/kibana/master/manage-osquery-integration.html" class="ulink" target="_top">Osquery manager integration</a> on the host associated with the alert.
</li>
<li class="listitem">
Update your <a href="/guide/en/kibana/master/osquery.html" class="ulink" target="_top">role&#8217;s privileges</a> to allow access to Osquery.
</li>
<li class="listitem">
Verify that <a href="/guide/en/fleet/master/view-elastic-agent-status.html" class="ulink" target="_top">Elastic Agent&#8217;s status</a> is <span class="strong strong"><strong>Healthy</strong></span>. Refer to <a href="/guide/en/fleet/master/fleet-troubleshooting.html" class="ulink" target="_top">Fleet Troubleshooting</a> if it is not.
</li>
</ul>
</div>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click the <span class="strong strong"><strong>View details</strong></span> button from the Alerts table to open the Alert details flyout.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Take action</strong></span>, then select <span class="strong strong"><strong>Run Osquery</strong></span>.
</li>
<li class="listitem">
<p>Select one or more Elastic Agents or groups to query. Start typing in the search field to get suggestions for Elastic Agents by name, ID, platform, and policy.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The host associated with the alert is automatically selected. You can specify additional hosts to query.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Enter a new query or select a saved query.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/setup-query.png" alt="setup query" width="80%][height=80%][Shows how to set up the query">
</div>
</div>
</li>
<li class="listitem">
(Optional) Expand the <span class="strong strong"><strong>Advanced</strong></span> section to view or set <a href="/guide/en/kibana/master/advanced-osquery.html" class="ulink" target="_top">mapped ECS fields</a> included in the results from the live query.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Submit</strong></span>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>To save the query for future use, click <span class="strong strong"><strong>Save for later</strong></span> and define the ID,
description, and other <a href="/guide/en/kibana/master/osquery.html#osquery-manage-query" class="ulink" target="_top">details</a>.</p>
</div>
</div>
</li>
<li class="listitem">
Review the results in the table. You can also navigate to <span class="strong strong"><strong>Discover</strong></span> to dive deeper into the response,
or use the drag-and-drop <span class="strong strong"><strong>Lens</strong></span> editor to create visualizations.
</li>
<li class="listitem">
<p>To view more information about the request, such as failures, open the <span class="strong strong"><strong>Status</strong></span> tab in the results table.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/query-results.png" alt="query results" width="80%][height=80%][Shows query results">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="alerts-ui-manage.html">« Manage detection alerts</a>
</span>
<span class="next">
<a href="visual-event-analyzer.html">Visual event analyzer »</a>
</span>
</div>
</div>
</body>
</html>
