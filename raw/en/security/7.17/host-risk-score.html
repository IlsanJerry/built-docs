<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Host Risk Score | Elastic Security Solution [7.17] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution [7.17]"/>
<link rel="up" href="sec-experimental-intro.html" title="Experimental features"/>
<link rel="prev" href="sec-experimental-intro.html" title="Experimental features"/>
<link rel="next" href="network-beaconing-framework.html" title="Network Beaconing"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/7.17"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="7.17"/>
</head>
<body><div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [7.17]</a></span>
»
<span class="breadcrumb-link"><a href="sec-experimental-intro.html">Experimental features</a></span>
»
<span class="breadcrumb-node">Host Risk Score</span>
</div>
<div class="navheader">
<span class="prev">
<a href="sec-experimental-intro.html">« Experimental features</a>
</span>
<span class="next">
<a href="network-beaconing-framework.html">Network Beaconing »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="host-risk-score"></a>Host Risk Score<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.17/docs/experimental-features/host-risk-score.asciidoc">edit</a></h2>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is available for Elastic Stack versions 7.16.0 and newer.</p>
</div>
</div>
<p>The Host Risk Score feature highlights risky hosts from within your environment. It utilizes a transform with a scripted metric aggregation to calculate host risk scores based on detection rule alerts with an "open" status within a 5-day window. The transform runs hourly to update the score as new detection rule alerts are generated.</p>
<p>The contribution of each rule to the host risk score is calculated as a function of the rule risk score (<code class="literal">signal.rule.risk_score</code>) and a time decay factor to reduce the contribution of stale alerts, while considering recent alerts. A weighted sum of the individual time-corrected rule risks is then applied to the risk score. As such, rules with a higher time-corrected risk also have a higher weight. Each host risk score is normalized to a scale of 0 to 100.</p>
<p>The following table shows how risk levels are applied to a host, based on the normalized risk score:</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Risk level</th>
<th align="left" valign="top">Host Risk Score</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Unknown</p></td>
<td align="left" valign="top"><p>&lt; 20</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Low</p></td>
<td align="left" valign="top"><p>20-40</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Moderate</p></td>
<td align="left" valign="top"><p>40-70</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>High</p></td>
<td align="left" valign="top"><p>70-90</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Critical</p></td>
<td align="left" valign="top"><p>&gt; 90</p></td>
</tr>
</tbody>
</table>
</div>
<h3><a id="_deploy_the_host_risk_score_package"></a>Deploy the Host Risk Score package<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.17/docs/experimental-features/host-risk-score.asciidoc">edit</a></h3>
<p>To deploy the Host Risk Score framework in your environment, follow <a href="https://github.com/elastic/detection-rules/blob/main/docs/experimental-machine-learning/host-risk-score.md" class="ulink" target="_top">these steps</a>. These instructions also include steps to enable the <code class="literal">riskyHostsEnabled</code> feature flag.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To view host risk score data on the Elastic Security Overview page and the Alert details flyout, you must enable the feature flag. However, enabling the feature flag is NOT required to view the Lens dashboards.</p>
</div>
</div>
<h3><a id="_view_host_risk_score_data"></a>View host risk score data<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/7.17/docs/experimental-features/host-risk-score.asciidoc">edit</a></h3>
<p>If the <code class="literal">riskyHostsEnabled</code> feature flag is enabled:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the Elastic Security app, go to the <span class="strong strong"><strong>Overview</strong></span> page, then locate the <span class="strong strong"><strong>Current host risk scores</strong></span> card in the lower-right corner.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>View dashboard</strong></span>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/host-score-overview.png" alt="host score overview">
</div>
</div>
</li>
</ol>
</div>
<p>If the <code class="literal">riskyHostsEnabled</code> feature flag is NOT enabled:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Kibana, go to <span class="strong strong"><strong>Analytics &#8594; Dashboard</strong></span>.
</li>
<li class="listitem">
<p>Select the <span class="strong strong"><strong>Current Risk Score for Hosts</strong></span> dashboard.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/select-dashboard.png" alt="select dashboard">
</div>
</div>
</li>
<li class="listitem">
<p>In the <span class="strong strong"><strong>Current Risk Scores for Hosts</strong></span> list, hover over the host name to view, click the <span class="strong strong"><strong>+</strong></span> button, then select <span class="strong strong"><strong>Go to Dashboard</strong></span>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/go-to-dashboard.png" alt="go to dashboard">
</div>
</div>
</li>
</ol>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>It is recommended you analyze hosts with the highest risk scores&#8201;&#8212;&#8201;or those in the <code class="literal">Critical</code> and <code class="literal">Moderate</code> categories first.</p>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/full-dashboard.png" alt="full dashboard">
</div>
</div>
<p>Use the histogram to track how the risk score for a particular host has changed over time. To specify a date range, use the date and time picker or drag and select a time range within the histogram.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/histogram.png" alt="histogram">
</div>
</div>
<p>To go to the host&#8217;s detail page, left-click any host&#8217;s corresponding bar in the histogram, then select <span class="strong strong"><strong>Go to Host View</strong></span>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/go-to-host-view.png" alt="go to host view">
</div>
</div>
<p>The data tables beneath the histogram display associated rules, users, and MITRE tactics of risky hosts. The table data is sorted in reverse chronological order by default, with the highest total risk score at the top. Use this information to triage alerts that pose the highest risk to your network.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/data-tables.png" alt="data tables">
</div>
</div>
<p><span class="strong strong"><strong>Host risk score in Alert details flyout</strong></span></p>
<p>If the <code class="literal">riskyHostsEnabled</code> feature flag is enabled, the host risk score keyword is displayed in the <span class="strong strong"><strong>Overview</strong></span> tab of the Alert details flyout.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/score-in-flyout.png" alt="score in flyout">
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="sec-experimental-intro.html">« Experimental features</a>
</span>
<span class="next">
<a href="network-beaconing-framework.html">Network Beaconing »</a>
</span>
</div>
</div>
</body>
</html>
