<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Grant users access to secured resources
        | Metricbeat Reference [master]
      | Elastic
    </title><link rel="home" href="index.html" title="Metricbeat Reference [master]" /><link rel="up" href="securing-beats.html" title="Configure Metricbeat to use X-Pack security" /><link rel="prev" href="securing-beats.html" title="Configure Metricbeat to use X-Pack security" /><link rel="next" href="beats-basic-auth.html" title="Configure authentication credentials" /><meta name="DC.type" content="Learn/Docs/Metricbeat/Reference/master" /><meta name="DC.subject" content="Metricbeat" /><meta name="DC.identifier" content="master" /></head><body><div class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Metricbeat Reference
      [master]
    </a></span> » <span class="breadcrumb-link"><a href="securing-metricbeat.html">Securing Metricbeat</a></span> » <span class="breadcrumb-link"><a href="securing-beats.html">Configure Metricbeat to use X-Pack security</a></span> » <span class="breadcrumb-node">Grant users access to secured resources</span></div><div class="navheader"><span class="prev"><a href="securing-beats.html">
              « 
              Configure Metricbeat to use X-Pack security</a>
           
        </span><span class="next">
           
          <a href="beats-basic-auth.html">Configure authentication credentials
               »
            </a></span></div><div class="xpack section"><div class="titlepage"><div><div><h2 class="title"><a id="feature-roles"></a>Grant users access to secured resources<a href="https://github.com/elastic/beats/edit/master/libbeat/docs/security/users.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><p>You can use role-based access control to grant users access to secured
resources. The roles that you set up depend on your organization’s security
requirements and the minimum privileges required to use specific features.</p><p>Typically you need the create the following separate roles:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><a class="link" href="feature-roles.html#privileges-to-setup-beats" title="Grant privileges and roles needed for setup">setup role</a> for setting up index templates and
other dependencies</li><li class="listitem"><a class="link" href="feature-roles.html#privileges-to-publish-monitoring" title="Grant privileges and roles needed for monitoring">monitoring role</a> for sending monitoring
information</li><li class="listitem"><a class="link" href="feature-roles.html#privileges-to-publish-events" title="Grant privileges and roles needed for publishing">writer role</a>  for publishing events collected
by Metricbeat</li><li class="listitem"><a class="link" href="feature-roles.html#kibana-user-privileges" title="Grant privileges and roles needed to read Metricbeat data">reader role</a> for Kibana users who need to view and
create visualizations that access Metricbeat data</li></ul></div><p>X-Pack security provides <a class="ulink" href="/guide/en/elasticsearch/reference/master/built-in-roles.html" target="_top">built-in roles</a> that grant a
subset of the privileges needed by Metricbeat users. When possible, use the
built-in roles to minimize the affect of future changes on your security
strategy.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="privileges-to-setup-beats"></a>Grant privileges and roles needed for setup<a href="https://github.com/elastic/beats/edit/master/libbeat/docs/security/users.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="important admon"><div class="icon"></div><div class="admon_content"><p>Setting up Metricbeat is an admin-level task that requires extra
privileges. As a best practice, grant the setup role to administrators only, and
use a less restrictive role for event publishing.</p></div></div><p>Administrators who set up Metricbeat typically need to load mappings,
dashboards, and other objects used to index data into Elasticsearch and visualize it in
Kibana.</p><p>To grant users the required privileges:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Create a <span class="strong strong"><strong>setup role</strong></span>, called something like <code class="literal">metricbeat_setup</code>, that has
the following privileges:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top">Type</th><th align="left" valign="top">Privilege</th><th align="left" valign="top">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top"><p>Cluster</p></td><td align="left" valign="top"><p><code class="literal">monitor</code></p></td><td align="left" valign="top"><p>Retrieve cluster details (e.g. version)</p></td></tr><tr><td align="left" valign="top"><p>Cluster</p></td><td align="left" valign="top"><p><code class="literal">manage_ilm</code></p></td><td align="left" valign="top"><p>Set up and manage index lifecycle management (ILM) policy</p></td></tr><tr><td align="left" valign="top"><p>Index</p></td><td align="left" valign="top"><p><code class="literal">manage</code> on <code class="literal">metricbeat-*</code> indices</p></td><td align="left" valign="top"><p>Set up aliases used by ILM</p></td></tr></tbody></table></div><p class="simpara">Omit any privileges that aren’t relevant in your environment.</p><div class="note admon"><div class="icon"></div><div class="admon_content"><p>These instructions assume that you are using the default name for
Metricbeat indices. If you are using a custom name, modify the privileges to
match your index naming pattern.</p></div></div></li><li class="listitem"><p class="simpara">Assign the <span class="strong strong"><strong>setup role</strong></span>, along with the following built-in roles, to users who
need to set up Metricbeat:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Role</th><th align="left" valign="top">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">kibana_user</code></p></td><td align="left" valign="top"><p>Load dependencies, such as example dashboards, if available, into Kibana</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">ingest_admin</code></p></td><td align="left" valign="top"><p>Set up index templates and, if available, ingest pipelines</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">beats_admin</code></p></td><td align="left" valign="top"><p>Enroll and manage configurations in Beats central management</p></td></tr></tbody></table></div><p class="simpara">Omit any roles that aren’t relevant in your environment.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="privileges-to-publish-monitoring"></a>Grant privileges and roles needed for monitoring<a href="https://github.com/elastic/beats/edit/master/libbeat/docs/security/users.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>X-Pack security provides built-in users and roles for monitoring. The privileges and
roles needed depend on the method used to collect monitoring data.</p><div class="important admon"><div class="icon"></div><div class="admon_content"><h3>Important note for Elastic Cloud users</h3><p>Built-in users are not available when running our
<a class="ulink" href="/cloud/elasticsearch-service" target="_top">hosted Elasticsearch Service</a>
on Elastic Cloud. To send monitoring data securely, create a monitoring user and
grant it the roles described in the following sections.</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">If you’re using <a class="link" href="monitoring-internal-collection.html" title="Collect Metricbeat monitoring data with internal collectors">internal collection</a> to
collect metrics about Metricbeat, X-Pack security provides
the <code class="literal">beats_system</code> <a class="ulink" href="/guide/en/elasticsearch/reference/master/built-in-users.html" target="_top">built-in user</a> and
<code class="literal">beats_system</code> <a class="ulink" href="/guide/en/elasticsearch/reference/master/built-in-roles.html" target="_top">built-in role</a> to send
monitoring information. You can use the built-in user, if it’s available in your
environment, or create a user who has the privileges needed to send monitoring
information.</p><p class="simpara">If you use the <code class="literal">beats_system</code> user, make sure you set the password.</p><p class="simpara">If you don’t use the <code class="literal">beats_system</code> user:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Create a <span class="strong strong"><strong>monitoring role</strong></span>, called something like
<code class="literal">metricbeat_monitoring</code>, that has the following privileges:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top">Type</th><th align="left" valign="top">Privilege</th><th align="left" valign="top">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top"><p>Cluster</p></td><td align="left" valign="top"><p><code class="literal">monitor</code></p></td><td align="left" valign="top"><p>Retrieve cluster details (e.g. version)</p></td></tr></tbody></table></div></li><li class="listitem"><p class="simpara">Assign the <span class="strong strong"><strong>monitoring role</strong></span>, along with the following built-in roles, to
users who need to monitor Metricbeat:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Role</th><th align="left" valign="top">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">kibana_user</code></p></td><td align="left" valign="top"><p>Use Kibana</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">monitoring_user</code></p></td><td align="left" valign="top"><p>Use <span class="strong strong"><strong>Stack Monitoring</strong></span> in Kibana to monitor Metricbeat</p></td></tr></tbody></table></div></li></ol></div></li><li class="listitem"><p class="simpara">If you’re <a class="link" href="monitoring-metricbeat-collection.html" title="Collect Metricbeat monitoring data with Metricbeat">using Metricbeat</a> to collect
metrics about Metricbeat, X-Pack security provides the <code class="literal">remote_monitoring_user</code>
<a class="ulink" href="/guide/en/elasticsearch/reference/master/built-in-users.html" target="_top">built-in user</a>, and the <code class="literal">remote_monitoring_collector</code>
and <code class="literal">remote_monitoring_agent</code> <a class="ulink" href="/guide/en/elasticsearch/reference/master/built-in-roles.html" target="_top">built-in roles</a> for
collecting and sending monitoring information. You can use the built-in user, if
it’s available in your environment, or create a user who has the privileges
needed to collect and send monitoring information.</p><p class="simpara">If you use the <code class="literal">remote_monitoring_user</code> user, make sure you set the password.</p><p class="simpara">If you don’t use the <code class="literal">remote_monitoring_user</code> user:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Create a user on the production cluster who will collect and send monitoring
information.</li><li class="listitem"><p class="simpara">Assign the following roles to the user:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Role</th><th align="left" valign="top">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">remote_monitoring_collector</code></p></td><td align="left" valign="top"><p>Collect monitoring metrics from Metricbeat</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">remote_monitoring_agent</code></p></td><td align="left" valign="top"><p>Send monitoring data to the monitoring cluster</p></td></tr></tbody></table></div></li><li class="listitem"><p class="simpara">Assign the following role to users who will view the monitoring data in
Kibana:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Role</th><th align="left" valign="top">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">monitoring_user</code></p></td><td align="left" valign="top"><p>Use <span class="strong strong"><strong>Stack Monitoring</strong></span> in Kibana to monitor Metricbeat</p></td></tr></tbody></table></div></li></ol></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="privileges-to-publish-events"></a>Grant privileges and roles needed for publishing<a href="https://github.com/elastic/beats/edit/master/libbeat/docs/security/users.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Users who publish events to Elasticsearch need to create and write to Metricbeat
indices. To minimize the privileges required by the writer role, you can use the
<a class="link" href="feature-roles.html#privileges-to-setup-beats" title="Grant privileges and roles needed for setup">setup role</a> to pre-load dependencies.</p><p>When using ILM, turn off the ILM setup check in the Metricbeat config file before
running Metricbeat to publish events:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">setup.ilm.check_exists: false</pre></div><p>To grant the required privileges:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Create a <span class="strong strong"><strong>writer role</strong></span>, called something like <code class="literal">metricbeat_writer</code>,
that has the following privileges:</p><div class="note admon"><div class="icon"></div><div class="admon_content"><p>The <code class="literal">monitor</code> cluster privilege and the <code class="literal">create_doc</code> privilege on
<code class="literal">metricbeat-*</code> indices are required in every configuration.</p></div></div><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top">Type</th><th align="left" valign="top">Privilege</th><th align="left" valign="top">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top"><p>Cluster</p></td><td align="left" valign="top"><p><code class="literal">monitor</code></p></td><td align="left" valign="top"><p>Retrieve cluster details (e.g. version)</p></td></tr><tr><td align="left" valign="top"><p>Cluster</p></td><td align="left" valign="top"><p><code class="literal">read_ilm</code></p></td><td align="left" valign="top"><p>Read the ILM policy when connecting to clusters that support ILM.
Not needed when <code class="literal">setup.ilm.check_exists</code> is <code class="literal">false</code>.</p></td></tr><tr><td align="left" valign="top"><p>Index</p></td><td align="left" valign="top"><p><code class="literal">create_doc</code> on <code class="literal">metricbeat-*</code> indices</p></td><td align="left" valign="top"><p>Write events into Elasticsearch</p></td></tr><tr><td align="left" valign="top"><p>Index</p></td><td align="left" valign="top"><p><code class="literal">view_index_metadata</code> on <code class="literal">metricbeat-*</code> indices</p></td><td align="left" valign="top"><p>Check for alias when connecting to clusters that support ILM.
Not needed when <code class="literal">setup.ilm.check_exists</code> is <code class="literal">false</code>.</p></td></tr><tr><td align="left" valign="top"><p>Index</p></td><td align="left" valign="top"><p><code class="literal">create_index</code> on <code class="literal">metricbeat-*</code> indices</p></td><td align="left" valign="top"><p>Create daily indices when connecting to clusters that do not support ILM.
Not needed when using ILM.</p></td></tr></tbody></table></div><p class="simpara">Omit any privileges that aren’t relevant in your environment.</p></li><li class="listitem">Assign the <span class="strong strong"><strong>writer role</strong></span> to users who will index events into Elasticsearch.</li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="kibana-user-privileges"></a>Grant privileges and roles needed to read Metricbeat data<a href="https://github.com/elastic/beats/edit/master/libbeat/docs/security/users.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Kibana users typically need to view dashboards and visualizations that contain
Metricbeat data. These users might also need to create and edit dashboards
and visualizations.
If you’re using Beats central management, some of these users might need to
create and manage configurations.</p><p>To grant users the required privileges:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Create a <span class="strong strong"><strong>reader role</strong></span>, called something like <code class="literal">metricbeat_reader</code>, that has
the following privilege:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top">Type</th><th align="left" valign="top">Privilege</th><th align="left" valign="top">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top"><p>Index</p></td><td align="left" valign="top"><p><code class="literal">read</code> on <code class="literal">metricbeat-*</code> indices</p></td><td align="left" valign="top"><p>Read data indexed by Metricbeat</p></td></tr></tbody></table></div></li><li class="listitem"><p class="simpara">Assign the <span class="strong strong"><strong>reader role</strong></span>, along with the following built-in roles, to
users who need to read Metricbeat data:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Role</th><th align="left" valign="top">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">kibana_user</code> or <code class="literal">kibana_dashboard_only_user</code></p></td><td align="left" valign="top"><p>Use Kibana. <code class="literal">kibana_dashboard_only_user</code> grants read-only access to dashboards.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">beats_admin</code></p></td><td align="left" valign="top"><p>Create and manage configurations in Beats central management. Only assign this
role to users who need to use Beats central management.</p></td></tr></tbody></table></div><p class="simpara">Omit any roles that aren’t relevant in your environment.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="learn-more-security"></a>Learn more about users and roles<a href="https://github.com/elastic/beats/edit/master/libbeat/docs/security/users.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Want to learn more about creating users and roles? See
<a class="ulink" href="/guide/en/elasticsearch/reference/master/elasticsearch-security.html" target="_top">Securing the Elastic Stack</a>. Also see:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><a class="ulink" href="/guide/en/elasticsearch/reference/master/security-privileges.html" target="_top">Security privileges</a> for a description of
available privileges</li><li class="listitem"><a class="ulink" href="/guide/en/elasticsearch/reference/master/built-in-roles.html" target="_top">Built-in roles</a> for a description of roles that
you can assign to users</li></ul></div></div></div><div class="navfooter"><span class="prev"><a href="securing-beats.html">
              « 
              Configure Metricbeat to use X-Pack security</a>
           
        </span><span class="next">
           
          <a href="beats-basic-auth.html">Configure authentication credentials
               »
            </a></span></div></body></html>
