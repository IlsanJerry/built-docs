<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>OneDrive connector | Workplace Search Guide | Elastic</title>
<link rel="home" href="index.html" title="Workplace Search Guide"/>
<link rel="up" href="workplace-search-content-sources.html" title="Content sources overview"/>
<link rel="prev" href="workplace-search-jira-server-connector.html" title="Jira Server connector"/>
<link rel="next" href="workplace-search-salesforce-connector.html" title="Connecting Salesforce"/>
<meta name="DC.type" content="Learn/Docs/Workplace Search/Reference"/>
<meta name="DC.subject" content="Workplace Search"/>
<meta name="DC.identifier" content="7.6"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Workplace Search Guide</a></span>
»
<span class="breadcrumb-link"><a href="workplace-search-content-sources.html">Content sources overview</a></span>
»
<span class="breadcrumb-node">OneDrive connector</span>
</div>
<div class="navheader">
<span class="prev">
<a href="workplace-search-jira-server-connector.html">« Jira Server connector</a>
</span>
<span class="next">
<a href="workplace-search-salesforce-connector.html">Connecting Salesforce »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="workplace-search-onedrive-connector"></a>OneDrive connector</h2>
</div></div></div>

<p>Ingest all of your OneDrive files into Workplace Search.</p>
<p>The OneDrive Connector requires that you create an <span class="strong strong"><strong>OAuth App</strong></span> within OneDrive.</p>
<h3><a id="onedrive-configuration"></a>Configuration</h3>
<p>Sign in to <a href="https://portal.azure.com/" class="ulink" target="_top">https://portal.azure.com/</a> and click on <span class="strong strong"><strong>Azure Active Directory</strong></span>:</p>
<div id="onedrive-1" class="imageblock screenshot">
<div class="content">
<img src="images/guides/onedrive/onedrive-1.png" alt="">
</div>
<div class="title">Figure 48. Connecting OneDrive</div>
</div>
<p>Next, click on <span class="strong strong"><strong>App Registrations</strong></span>:</p>
<div id="onedrive-2" class="imageblock screenshot">
<div class="content">
<img src="images/guides/onedrive/onedrive-2.png" alt="">
</div>
<div class="title">Figure 49. Connecting OneDrive</div>
</div>
<p>Then <span class="strong strong"><strong>New Registration</strong></span>:</p>
<div id="onedrive-3" class="imageblock screenshot">
<div class="content">
<img src="images/guides/onedrive/onedrive-3.png" alt="">
</div>
<div class="title">Figure 50. Connecting OneDrive</div>
</div>
<p>Give your App a name - like "Workplace Search" - and make it Multitenant; the middle option.</p>
<p><span class="strong strong"><strong>If your app is left as single tenant, it will not be able to access the appropriate APIs.</strong></span></p>
<p>Leave the "redirect URIs" blank for now.</p>
<p>We will need two - one for Organizational Sources and the other for Personal Sources - so we&#8217;ll add this as another step.</p>
<p>Finally, hit the <span class="strong strong"><strong>Register</strong></span> button:</p>
<div id="onedrive-4" class="imageblock screenshot">
<div class="content">
<img src="images/guides/onedrive/onedrive-4.png" alt="">
</div>
<div class="title">Figure 51. Connecting OneDrive</div>
</div>
<p>Retrieve the <span class="strong strong"><strong>Client ID</strong></span> - we&#8217;ll need it within Workplace Search.</p>
<p>Next, add two redirect URIs.</p>
<p>Click the <span class="strong strong"><strong>Add Redirect URIs</strong></span> link in the header:</p>
<div id="onedrive-5" class="imageblock screenshot">
<div class="content">
<img src="images/guides/onedrive/onedrive-5.png" alt="">
</div>
<div class="title">Figure 52. Connecting OneDrive</div>
</div>
<p>The two redirect URIs are:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<code class="literal">http://localhost:3002/ws/sources/one_drive/create</code>
</li>
<li class="listitem">
<code class="literal">http://localhost:3002/ws/org/sources/one_drive/create</code>
</li>
</ol>
</div>
<p>Remember: the hostname must be relative to your own hostname.</p>
<p><em>If you are also using SharePoint, you can add all four redirects.</em></p>
<p>Once you&#8217;ve added them both, press that sweet <span class="strong strong"><strong>Save</strong></span> button in the upper left:</p>
<div id="onedrive-6" class="imageblock screenshot">
<div class="content">
<img src="images/guides/onedrive/onedrive-6.png" alt="">
</div>
<div class="title">Figure 53. Connecting OneDrive</div>
</div>
<p>Now let&#8217;s get ourselves the <span class="strong strong"><strong>Client Secret</strong></span>, so we have everything we need to configure the connector in Workplace Search.</p>
<p>Navigate to <span class="strong strong"><strong>Certificates &amp; Secrets</strong></span>:</p>
<div id="onedrive-7" class="imageblock screenshot">
<div class="content">
<img src="images/guides/onedrive/onedrive-7.png" alt="">
</div>
<div class="title">Figure 54. Connecting OneDrive</div>
</div>
<p>Pick a name for your client secret, like Workplace Search.</p>
<p>Select "never" as the expiration date, then give that <span class="strong strong"><strong>Add</strong></span> button a click:</p>
<div id="onedrive-8" class="imageblock screenshot">
<div class="content">
<img src="images/guides/onedrive/onedrive-8.png" alt="">
</div>
<div class="title">Figure 55. Connecting OneDrive</div>
</div>
<p>Now secure your <span class="strong strong"><strong>Client Secret</strong></span> value before you leave this screen.</p>
<p>Keep this secret!</p>
<p>A few more things to do…</p>
<div id="onedrive-9" class="imageblock screenshot">
<div class="content">
<img src="images/guides/onedrive/onedrive-9.png" alt="">
</div>
<div class="title">Figure 56. Connecting OneDrive</div>
</div>
<p>We must set up the permissions the Application will request from the Admin.</p>
<p>Navigate to <span class="strong strong"><strong>API Permissions</strong></span> and click <span class="strong strong"><strong>Add Permission</strong></span>.</p>
<p>Add "delegated" permissions until the list resembles the one below:</p>
<div id="onedrive-10" class="imageblock screenshot">
<div class="content">
<img src="images/guides/onedrive/onedrive-10.png" alt="">
</div>
<div class="title">Figure 57. Connecting OneDrive</div>
</div>
<p><em>If you are also using SharePoint, OneDrive uses the same permissions.</em></p>
<p>Finally, at the bottom of the page click <span class="strong strong"><strong>Grant admin consent for [YOUR_ORG_NAME]</strong></span>.</p>
<p>That&#8217;s it for OneDrive!</p>
<p>For the final steps, you must <span class="strong strong"><strong>return back to Workplace Search</strong></span>.</p>
<p>Login to Workplace Search and enter your new <span class="strong strong"><strong>Client ID</strong></span> and <span class="strong strong"><strong>Client Secret</strong></span>.</p>
<p>Congratulations! It&#8217;s time to search.</p>
<p><span class="strong strong"><strong>You can now make the source available to various groups and scale its relevance priority.</strong></span></p>
</div>
<div class="navfooter">
<span class="prev">
<a href="workplace-search-jira-server-connector.html">« Jira Server connector</a>
</span>
<span class="next">
<a href="workplace-search-salesforce-connector.html">Connecting Salesforce »</a>
</span>
</div>
</div>
</body>
</html>
