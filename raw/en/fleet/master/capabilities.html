<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Capabilities | Fleet User Guide [master] | Elastic</title>
<link rel="home" href="index.html" title="Fleet User Guide [master]"/>
<link rel="up" href="dynamic-input-configuration.html" title="Variables and conditions in input configurations"/>
<link rel="prev" href="debug-configs.html" title="Debugging"/>
<link rel="next" href="agent-redirects.html" title="Appendix A: Deleted pages"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/master"/>
<meta name="DC.subject" content="Fleet"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Fleet User Guide [master]</a></span>
»
<span class="breadcrumb-link"><a href="elastic-agent-installation-configuration.html">Manage your Elastic Agents</a></span>
»
<span class="breadcrumb-link"><a href="dynamic-input-configuration.html">Variables and conditions in input configurations</a></span>
»
<span class="breadcrumb-node">Capabilities</span>
</div>
<div class="navheader">
<span class="prev">
<a href="debug-configs.html">« Debugging</a>
</span>
<span class="next">
<a href="agent-redirects.html">Appendix A: Deleted pages »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="capabilities"></a>Capabilities<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/master/docs/en/ingest-management/elastic-agent/elastic-agent-capabilities.asciidoc">edit</a></h3>
</div></div></div>
<p>Capabilities are a set of rules that can define the behavior of Elastic Agent on specific machines.
When capabilities are specified, the input configuration is overridden, and any details that are not used are subject to the capabilities' definition.
When Elastic Agent starts, it locates the <code class="literal">capabilities.yml</code> file next to its configuration file. Please note, Elastic Agent will not reload the definition after it starts.</p>
<p>This example definition configuration enables the system/metrics input and denies every other input. Rules are applied in the order they are defined, with the first matching rule being applied. The * wildcard is also supported.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">version: 0.0.1
capabilities:
- rule: allow
  input: system/metrics
- rule: deny
  input: "*"</pre>
</div>
<p>Let&#8217;s use the following configuration and the capabilities defined above.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">inputs:
	- type: logfile
	  streams:
	  	- paths: []{a.error,b.access}
	- type: system/logs
	  streams:
	  	- paths: []{a,b}
	- type: system/metrics
	  streams:
	  	- metricset: cpu
	  	- metricset: memory</pre>
</div>
<p>The resulting configuration is this.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">inputs:
	- type: system/metrics
	  streams:
	  	- metricset: cpu
	  	- metricset: memory</pre>
</div>
<p>In this example, the stream is applied if the host platform is not Windows:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">inputs:
  - type: system/metrics
    streams:
      - metricset: load
        data_stream.dataset: system.cpu
        condition: ${host.platform} != 'windows'</pre>
</div>
<p>In this example, the processor is applied if the host platform is not Windows:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">inputs:
  - type: system/metrics
    streams:
      - metricset: load
        data_stream.dataset: system.cpu
    processors:
      - add_fields:
          fields:
            platform: ${host.platform}
          to: host
        condition: ${host.platform} != 'windows'</pre>
</div>
<div class="supported-capabilities">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_supported_capabilities"></a>Supported capabilities<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/master/docs/en/ingest-management/elastic-agent/elastic-agent-capabilities.asciidoc">edit</a></h4>
</div></div></div>
<p>You can use capabilities to modify the congestion of outputs, inputs or upgrade the capability of Elastic Agent.</p>
<div class="capabilities-inputs">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_inputs"></a>Inputs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/master/docs/en/ingest-management/elastic-agent/elastic-agent-capabilities.asciidoc">edit</a></h5>
</div></div></div>
<p>For inputs, you can the <code class="literal">input</code> key containing an expression.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">version: 0.0.1
capabilities:
- rule: allow
  input: system/*</pre>
</div>
</div>

<div class="capabilities-outputs">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_outputs"></a>Outputs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/master/docs/en/ingest-management/elastic-agent/elastic-agent-capabilities.asciidoc">edit</a></h5>
</div></div></div>
<p>For outputs, you can use the <code class="literal">output</code> key containing an expression.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">version: 0.0.1
capabilities:
- rule: deny
  output: kafka</pre>
</div>
</div>

<div class="capabilities-upgrade">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_upgrade"></a>Upgrade<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/master/docs/en/ingest-management/elastic-agent/elastic-agent-capabilities.asciidoc">edit</a></h5>
</div></div></div>
<p>For an upgrade, you can use the <code class="literal">output</code> key containing an expression that allows a specific upgrade to version <code class="literal">8.0.0</code>. <code class="literal">${version}</code> is the target version.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">version: 0.0.1
capabilities:
- rule: allow
  upgrade: "${version} == '8.0.0'"</pre>
</div>
<p>With a versioned EQL, conditions can be used, as well as a * wildcard. This allows upgrades just for bug fixes.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">version: 0.0.1
capabilities:
- rule: allow
  upgrade: "${version} == '8.0.*'"</pre>
</div>
<p><span class="strong strong"><strong>Upgrade capability definition</strong></span></p>
<p>This upgrade definition allows upgrades just for minor version changes.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">version: 0.0.1
capabilities:
- rule: allow
  upgrade: "${version} == '8.*.*'"</pre>
</div>
<p>Part of the upgrade action is also a <code class="literal">source_uri</code> address that specifies the repository from where artifacts should be
downloaded.</p>
<p>To restrict to HTTPS, you can use the following.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">version: 0.0.1
capabilities:
- rule: allow
  upgrade: "startsWith(${source_uri}, 'https')"</pre>
</div>
<p>Upgrade capability is blocking. This means that if an action does not meet the first upgrade definition, we’re not proceeding with the evaluation.</p>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="debug-configs.html">« Debugging</a>
</span>
<span class="next">
<a href="agent-redirects.html">Appendix A: Deleted pages »</a>
</span>
</div>
</div>
</body>
</html>
