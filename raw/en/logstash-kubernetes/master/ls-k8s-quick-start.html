<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Quick start | Logstash and Kubernetes Reference | Elastic</title>
<link rel="home" href="index.html" title="Logstash and Kubernetes Reference"/>
<link rel="up" href="index.html" title="Logstash and Kubernetes Reference"/>
<link rel="prev" href="introduction.html" title="Introduction"/>
<link rel="next" href="sample-configuration-files.html" title="Sample configuration files"/>
<meta name="DC.type" content="Learn/Docs/Logstash/Kubernetes"/>
<meta name="DC.subject" content="Logstash"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Logstash and Kubernetes Reference</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="introduction.html">« Introduction</a>
</span>
<span class="next">
<a href="sample-configuration-files.html">Sample configuration files »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h1 class="title"><a id="ls-k8s-quick-start"></a>Quick start<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/logstash/edit/main/docsk8s/quick-start/ls-k8s-quick-start.asciidoc">edit</a></h1>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This documentation is still in development and may be changed or removed in a future release.</p>
</div>
</div>
<p>This guide describes how to set up Logstash to deliver Kubernetes logs to Elasticsearch. The logs will be monitored by Filebeat, processed through a Logstash pipeline, and then delivered into an Elasticsearch cluster in the Kubernetes environment.</p>
<p>This section includes the following topics:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="ls-k8s-quick-start.html#qs-prerequisites" title="Prerequisites">Prerequisites</a>
</li>
<li class="listitem">
<a class="xref" href="ls-k8s-quick-start.html#qs-set-up" title="Set up your environment">Set up your environment</a>
</li>
<li class="listitem">
<a class="xref" href="ls-k8s-quick-start.html#qs-generate-certificate" title="Generate certificate files">Generate certificate files</a>
</li>
<li class="listitem">
<a class="xref" href="ls-k8s-quick-start.html#qs-create-elastic-stack" title="Create an Elastic Stack">Create an Elastic Stack</a>
</li>
<li class="listitem">
<a class="xref" href="ls-k8s-quick-start.html#qs-view-monitoring-data" title="View the stack monitoring data">View the stack monitoring data</a>
</li>
<li class="listitem">
<a class="xref" href="ls-k8s-quick-start.html#qs-tidy-up" title="Tidy up">Tidy up</a>
</li>
<li class="listitem">
<a class="xref" href="ls-k8s-quick-start.html#qs-learn-more" title="Learn more">Learn more</a>
</li>
</ul>
</div>
<h3><a id="qs-prerequisites"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/logstash/edit/main/docsk8s/quick-start/ls-k8s-quick-start.asciidoc">edit</a></h3>
<p>Before you start, there are a few things you&#8217;ll need:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
A running Kubernetes cluster - For single node testing we recommend using <a href="https://minikube.sigs.k8s.io" class="ulink" target="_top">Minikube</a>, which allows you to easily run a single node Kubernetes cluster on your system. Check the <code class="literal">Getting Started</code> section for install and set up instructions.
</li>
<li class="listitem">
A <a href="https://github.com/elastic/logstash/blob/feature/kubernetes/k8s/recipes/logstash-k8s-quickstart.zip" class="ulink" target="_top">small zip file</a> of config files - Download and expand this archive into an empty directory on your local system. The files are described in <a class="xref" href="sample-configuration-files.html" title="Sample configuration files">Sample configuration files</a>.
</li>
</ol>
</div>
<h3><a id="qs-set-up"></a>Set up your environment<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/logstash/edit/main/docsk8s/quick-start/ls-k8s-quick-start.asciidoc">edit</a></h3>
<p>Let&#8217;s start by getting your Minikube Kubernetes cluster up and running:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">minikube start</pre>
</div>
<p>Install the Elastic custom resource definition (CRD) files, as well as the <code class="literal">elastic-operator</code> custom controller, which will be used to manage the Elastic resources in your cluster:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">kubectl create -f https://download.elastic.co/downloads/eck/2.4.0/crds.yaml
kubectl apply -f https://download.elastic.co/downloads/eck/2.4.0/operator.yaml</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The Elastic CRDs and ECK operator can also be set up using Elastic Helm charts, available at <a href="https://helm.elastic.co" class="ulink" target="_top">https://helm.elastic.co</a>.</p>
</div>
</div>
<p>Check the Kubernetes pods status to confirm that the <code class="literal">elastic-operator</code> pod is running:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">kubectl get pods</pre>
</div>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">NAME                 READY   STATUS    RESTARTS      AGE
elastic-operator-0   1/1     Running   4 (12m ago)   13d</pre>
</div>
<h3><a id="qs-generate-certificate"></a>Generate certificate files<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/logstash/edit/main/docsk8s/quick-start/ls-k8s-quick-start.asciidoc">edit</a></h3>
<p>To enable secure communication throughout your Kubernetes resources, run the sample script to generate the CA certificate files. Details about these files are in <a class="xref" href="sample-configuration-files.html" title="Sample configuration files">Sample configuration files</a>.</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">./cert/generate_cert.sh</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Expand to view output</strong></span></summary>
<div class="content">
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">Generating RSA private key, 2048 bit long modulus
.......................+++
...........................................................................+++
e is 65537 (0x10001)
Generating RSA private key, 2048 bit long modulus
..............................................+++
.............................................+++
e is 65537 (0x10001)
Signature ok
subject=/C=EU/ST=NA/O=Elastic/CN=ServerHostName
Getting CA Private Key
Generating RSA private key, 2048 bit long modulus
............+++
.......................................................................................................................................+++
e is 65537 (0x10001)
Signature ok
subject=/C=EU/ST=NA/O=Elastic/CN=ClientName
Getting CA Private Key</pre>
</div>
</div>
</details>
<p>Your <code class="literal">logstash-k8s-gs/cert</code> folder should now contain a set of certificate files, including <code class="literal">client</code> certificates for Filebeat and Metricbeat, and <code class="literal">server</code> certificates for Logstash.</p>
<p>The parent <code class="literal">logstash-k8s-gs</code> directory also has a new <code class="literal">001-secret.yaml</code> resources file that stores a hash of the client and server certificates.</p>
<div class="imageblock">
<div class="content">
<img src="./images/gs-cert-files.png" alt="generated CA certificate files">
</div>
</div>
<h3><a id="qs-create-elastic-stack"></a>Create an Elastic Stack<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/logstash/edit/main/docsk8s/quick-start/ls-k8s-quick-start.asciidoc">edit</a></h3>
<p>Now that your environment and certificates are set up, it&#8217;s time to create an Elastic Stack. Run the following command to deploy the example using the sample CRDs:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">kubectl apply -f .</pre>
</div>
<p>The resources are created:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">elasticsearch.elasticsearch.k8s.elastic.co/demo created
configmap/logstash-pipeline created
configmap/logstash-config created
secret/logstash-beats-tls created
deployment.apps/logstash created
service/logstash created
horizontalpodautoscaler.autoscaling/logstash created
beat.beat.k8s.elastic.co/demo created
beat.beat.k8s.elastic.co/demo configured
kibana.kibana.k8s.elastic.co/demo created</pre>
</div>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">kubectl get pods</pre>
</div>
<p>The pods are starting up. You may need to wait a minute or two for all of them to be ready.</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">NAME                                    READY   STATUS    RESTARTS       AGE
demo-beat-filebeat-7f4d97f69f-qkkbl     1/1     Running   0              42s
demo-beat-metricbeat-59f4b68cc7-9zrrn   1/1     Running   0              39s
demo-es-default-0                       1/1     Running   0              41s
demo-kb-d7f585494-vbf6s                 1/1     Running   0              39s
elastic-operator-0                      1/1     Running   4 (164m ago)   13d
logstash-7974b9ccb9-jd5xl               1/1     Running   0              42s</pre>
</div>
<h3><a id="qs-view-monitoring-data"></a>View the stack monitoring data<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/logstash/edit/main/docsk8s/quick-start/ls-k8s-quick-start.asciidoc">edit</a></h3>
<p>Now that your stack monitoring data is flowing, let&#8217;s access it in Kibana.</p>
<p>First, enable port forwarding for the Kibana service on port <code class="literal">5601</code>. Open a second shell window and run the following:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">kubectl port-forward service/demo-kb-http 5601</pre>
</div>
<p>Then, open up a web browser at address <code class="literal">https://localhost:5601</code>. Depending on your browser you may need to accept the site certificate.</p>
<p>Log in to Kibana using the <code class="literal">elastic</code> username and password. To obtain the password, run:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">kubectl get secret demo-es-elastic-user -o=jsonpath='{.data.elastic}' | base64 --decode; echo</pre>
</div>
<p>Open the Kibana main menu and select <span class="strong strong"><strong>Management</strong></span>, then <span class="strong strong"><strong>Stack Monitoring</strong></span>.</p>
<p>Select the Logstash <span class="strong strong"><strong>Overview</strong></span>, and under the <span class="strong strong"><strong>Nodes</strong></span> tab select the link for the Logstash node.</p>
<div class="imageblock">
<div class="content">
<img src="./images/gs-logstash-node-metrics.png" alt="Logstash metrics data in Kibana">
</div>
</div>
<p>That&#8217;s it! The Kubernetes API server metrics data is flowing through Logstash into Elasticsearch and Kibana. You can monitor the JVM Heap, CPU Utilization, and System Load data as it updates in real time.</p>
<h3><a id="qs-tidy-up"></a>Tidy up<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/logstash/edit/main/docsk8s/quick-start/ls-k8s-quick-start.asciidoc">edit</a></h3>
<p>After finishing with this demo, you can run the following command to remove all of the created resources:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">kubectl delete service,pods,deployment,hpa,configmap,secret,beat,elasticsearch,kibana -l app=logstash-demo</pre>
</div>
<h3><a id="qs-learn-more"></a>Learn more<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/logstash/edit/main/docsk8s/quick-start/ls-k8s-quick-start.asciidoc">edit</a></h3>
<p>Now that you&#8217;re familiar with how to get a Logstash monitoring setup running in your Kubernetes environment, here are a few suggested next steps:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="ls-k8s-external-resource.html" title="Ship to an external resource">Ship to an external resource</a>
</li>
<li class="listitem">
<a class="xref" href="ls-k8s-design-for-plugins.html" title="Design your installation based on plugin usage">Design your installation based on plugin usage</a>
</li>
<li class="listitem">
<a class="xref" href="ls-k8s-sizing.html" title="Sizing Logstash instances">Sizing Logstash instances</a>
</li>
<li class="listitem">
<a class="xref" href="ls-k8s-secure.html" title="Secure your environment">Secure your environment</a>
</li>
<li class="listitem">
<a class="xref" href="ls-k8s-stack-monitoring.html" title="Set up stack monitoring">Set up stack monitoring</a>
</li>
</ul>
</div>
<p>As well, we have a variety of <a class="xref" href="ls-k8s-recipes.html" title="Recipes">recipes</a> that you can use as templates to configure an environment to match your specific use case.</p>


</div>
<div class="navfooter">
<span class="prev">
<a href="introduction.html">« Introduction</a>
</span>
<span class="next">
<a href="sample-configuration-files.html">Sample configuration files »</a>
</span>
</div>
</div>
</body>
</html>
