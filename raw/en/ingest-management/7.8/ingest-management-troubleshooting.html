<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Troubleshooting | Ingest Management Guide [7.8] | Elastic</title>
<link rel="home" href="index.html" title="Ingest Management Guide [7.8]"/>
<link rel="up" href="index.html" title="Ingest Management Guide [7.8]"/>
<link rel="prev" href="elastic-agent-configuration.html" title="Configuration settings"/>
<meta name="DC.type" content="Learn/Docs/Ingest Management/Guide/7.8"/>
<meta name="DC.subject" content="Ingest Management"/>
<meta name="DC.identifier" content="7.8"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Ingest Management Guide [7.8]</a></span>
»
<span class="breadcrumb-node">Troubleshooting</span>
</div>
<div class="navheader">
<span class="prev">
<a href="elastic-agent-configuration.html">« Configuration settings</a>
</span>
<span class="next">
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h1 class="title"><a id="ingest-management-troubleshooting"></a>Troubleshooting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h1>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is experimental and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but experimental features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>This early release of ingest management is experimental. We invite you to
install and test these capabilities <span class="strong strong"><strong>in a test environment</strong></span>. You might run
into problems and need to modify your setup to get this feature running.</p>
<p>We have collected the most common known problems below. If your question isn&#8217;t answered here, please review open issues in the <a href="https://github.com/elastic/kibana/issues" class="ulink" target="_top">https://github.com/elastic/kibana/issues</a>, <a href="https://github.com/elastic/beats/issuess" class="ulink" target="_top">https://github.com/elastic/beats/issuess</a>, <a href="https://github.com/elastic/package-registry/issues" class="ulink" target="_top">https://github.com/elastic/package-registry/issues</a>, and contact us <a href="https://ela.st/ingest-manager-feedback" class="ulink" target="_top">here</a>. Your feedback is very valuable to us.</p>
<h3><a id="ingest-manager-not-in-cloud-kibana"></a>The Ingest Manager app is not listed in my Kibana cloud navigation list<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>In 7.8, the Ingest Manager app is in Alpha state and as such is only shown when specifically enabled in the start up or cloud <em>override</em> options. To enable Ingest Manager on cloud, go to your deployment in the user console. Click on the <em>edit</em> link directly beneath the deployment name. Then click on <em>user setting overrides</em> underneath the Kibana heading. Here you must enter the following x-pack option and click the save button at the bottom:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">xpack.ingestManager.enabled: true</pre>
</div>
<p>This will restart Kibana automatically and when done, you can refresh the browser and see the app in the left hand navigation.</p>
<h3><a id="ingest-management-setup-fails"></a>The endpoint <code class="literal">/api/ingest_management/setup</code> returns an error that the package registry can&#8217;t be reached<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>In order to install Integrations, the Ingest Manager app needs to connect to an external service, the Elastic Package Registry. For this to work, Kibana server must be able to connect to <a href="http://epr-experimental.elastic.co" class="ulink" target="_top">http://epr-experimental.elastic.co</a> on port 80.</p>
<h3><a id="ingest-manager-app-crashes"></a>The Ingest Manager app in Kibana crashes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>To find more about the error, open the development console of your browser,
navigate to the <span class="strong strong"><strong>Network</strong></span> tab, and refresh the page. One of the requests to the
Ingest Manager API will most likely have returned an error. If the error
message doesn&#8217;t give you enough information to fix the problem on your own,
please contact us <a href="https://ela.st/ingest-manager-feedback" class="ulink" target="_top">here</a>.</p>
<h3><a id="agent-enrollment-timeout"></a>I get a time-out when I try to run the agent enrollment on my host<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>This can look like the below console output:</p>
<div class="pre_wrapper lang-output">
<pre class="programlisting prettyprint lang-output">fail to enroll: fail to execute request to {kib}:Post http://kibana:5601/api/ingest_manager/fleet/agents/enroll?: net/http: request canceled while waiting for connection (Client.Timeout exceeded while awaiting headers)</pre>
</div>
<p>This is possibly due to a connectivity problem with the host talking to the Kibana instance. It may be a networking problem, attempt a <em>ping</em> command from the host to confirm it can reach the Kibana instance. If this works, then it could be a problem with the specified enrollment command executed. If <em>ping</em> works, check the URL and port, both are correct for your environment. If those are correct and working, check the enrollment key in the enrollment command you are trying to execute is valid. You can do this by viewing the Fleet ui in Ingest Manager and clicking on the Enrollment Tokens tab. If you click the <em>eyeball</em> for each listed secret, one listed should match the string being used in your host&#8217;s enrollment command. If it is not listed, create a new enrollment token and replace it in the command, this can be done in that same UI.</p>
<h3><a id="enrolled-agent-not-showing-up"></a>I ran the Elastic Agent enrollment step but I don’t see the agent in the UI<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>If Elastic Agent was successfully enrolled, but doesn&#8217;t show up in the Fleet list a common problem is that it was not <em>started</em>. Starting the agent is a separate step.</p>
<p>On linux &amp; macos hosts:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">./elastic-agent run</pre>
</div>
<p>On Windows hosts:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent.exe run</pre>
</div>
<h3><a id="where-are-the-agent-logs"></a>I need to find the logs when Elastic Agent starts up<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>When started successfully, the logs are in the folder where the Elastic Agent was started, in a sub-directory <code class="literal">data/logs/metricbeat</code>.
If that path of logs does not exist, it indicates the agent did not successfully run Metricbeat, which is a higher level problem to triage.</p>
<h3><a id="what-is-my-agent-config"></a>I need to know the configuration used in the running Elastic Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>You can inspect the files in the folder from where you ran Elastic Agent. The <code class="literal">elastic-agent.yml</code> file will have an uncommented citation if it is in <em>Fleet</em> mode:
Management: mode: "fleet"</p>
<p>The <code class="literal">action_store.yml</code> has the whole configuration, unencrypted. Look for <em>outputs:hosts</em> section with elasticsearch location. This file will also have the current versions of the packages in use by the current configuration. The version of the Elastic Agent is in the download folder / zip.</p>
<h3><a id="where-is-the-data-agent-is-sending"></a>I&#8217;m not sure Ingest Manager app is showing the data my Elastic Agent is sending<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>I think I have Elastic Agent set up and running and there are no errors on the agent logs and I still don&#8217;t see data in Kibana. The recommended way to assess this is to go straight to Elasticsearch data queries, or maybe just use Kibana Discover app. Look for any data in the index your Elastic Agent is sending to (metrics-* for example) and see if the name.host of your host machine shows. If not, then perhaps the data is getting trapped / blocked in the network or isn&#8217;t sent off of the Elastic Agent host correctly in the first place due to some Firewall or security reason. While it should be redundant, it is all the same potentially helpful to install the stand-alone Metricbeat (see the Elastic docs for information) to see if that works to send data into ES, which would indicate a bug or problem in the Elastic Agent side.</p>
<h3><a id="i-deleted-my-agent"></a>I deleted Elastic Agent in the Fleet Ingest Manager app how can I get it back?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>Its ok, we got your back!  The data is still in Elasticsearch. And get the Elastic Agent back in the UI, you will need only to stop, then re-enroll the Elastic Agent on the host and run it again.</p>
<h3><a id="i-need-to-stop-agent"></a>I need to stop Elastic Agent and all processes running on my host<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>To stop the Elastic Agent and relating executables running on my hosts is as easy as stopping the Elastic Agent process. If you installed it as a service on Windows you will need to manage that, as well. After that, if needed, on Windows you can use Task Manager and shut down Elastic Agent which will kill it and the sub-processes it created (Beats). On Linux / macOS you can kill the <code class="literal">elastic-agent</code> process running, look with a <code class="literal">ps | grep elastic-agent</code> call to get the id to kill.</p>
<h3><a id="i-rebooted-my-host"></a>I needed to reboot my host, how do I restart Elastic Agent?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>If you installed Elastic Agent on Windows as a service with powershell, the agent should still be running after a reboot of the host. On macOS and Linux you will need to start the agent again from the command line each time as noted in the prior Agent start up steps. Adding support to install as a service on all supported systems will be done in a future release. To achieve this in the meantime, you can add the start command to a user&#8217;s start up profile.</p>
<h3><a id="what-is-the-endpoint-package"></a>The Ingest Manager app shows an Integration called <em>Endpoint</em>, what is it?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>In 7.8, the Endpoint Integration is non-functional. It cannot be used yet. It exists as an artifact of the current feature development, please watch for announcements during coming release cycles. As a teaser, Endpoint is the integration that will allow the Elastic Security app to have a dedicated executable running like a beat to protect the host and allow responses to security concerns that are found. It will be managed by Elastic Agent as other beats are.</p>
<h3><a id="ingest-manager-not-in-on-prem-kibana"></a>The Ingest Manager app is not listed in my Kibana on-premises navigation list.<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.8/docs/en/ingest-management/troubleshooting.asciidoc">edit</a></h3>
<p>In 7.8, the Ingest Manager app is in Alpha state and as such is only shown when specifically enabled in the start up config. To do this you must modify both the Elasticsearch and Kibana configs as well as adhering to all <em>security enabled</em> requirements, like modifying the default elastic user password, see below for details:</p>
<p>For Elasticsearch, file <code class="literal">config/elasticsearch.yml</code> you must set these startup options:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">xpack.security.enabled: true
xpack.security.authc.api_key.enabled: true</pre>
</div>
<p>For Kibana <code class="literal">config/kibana.yml</code> you must set these start up options (the exception is tlsCheckDisabled which is not required if configure TLS checking)</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">xpack.ingestManager.enabled: true
xpack.ingestManager.fleet.tlsCheckDisabled: true
xpack.security.enabled: true
elasticsearch.username: "elastic"
elasticsearch.password: "abc123iUnbRftkABC123"</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Your <code class="literal">elasticsearch.password</code> above will be different, of course. It can be set with the documented Elastic apis, or you may wish to use the password re-setting script that comes with Elasticsearch. It is in the Elasticsearch <code class="literal">/bin</code> directory and can be used like:</p>
</div>
</div>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">./bin/elasticsearch-setup-passwords auto</pre>
</div>
<p>After running the script, copy the Elastic user name to the Kibana config file.
Then re-start Kibana.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="elastic-agent-configuration.html">« Configuration settings</a>
</span>
<span class="next">
</span>
</div>
</div>
</body>
</html>
