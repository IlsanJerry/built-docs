<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Prebuilt anomaly detection jobs | Machine Learning in the Elastic Stack [master] | Elastic</title>
<link rel="home" href="index.html" title="Machine Learning in the Elastic Stack [master]"/>
<link rel="up" href="xpack-ml.html" title="Anomaly detection"/>
<link rel="prev" href="ml-api-quickref.html" title="API quick reference"/>
<link rel="next" href="ml-functions.html" title="Function reference"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack/Machine learning/master"/>
<meta name="DC.subject" content="Machine learning"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Machine Learning in the Elastic Stack [master]</a></span>
»
<span class="breadcrumb-link"><a href="xpack-ml.html">Anomaly detection</a></span>
»
<span class="breadcrumb-node">Prebuilt anomaly detection jobs</span>
</div>
<div class="navheader">
<span class="prev">
<a href="ml-api-quickref.html">« API quick reference</a>
</span>
<span class="next">
<a href="ml-functions.html">Function reference »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ootb-ml-jobs"></a>Prebuilt anomaly detection jobs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<p>Anomaly detection jobs contain the configuration information and metadata necessary
to perform an analytics task. Kibana can recognize certain types of data and
provide specialized wizards for that context. This page lists the available
prebuilt anomaly detection jobs that you can use via Kibana.</p>
<h3><a id="ootb-ml-jobs-apache"></a>Apache<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
<p>These anomaly detection job wizards appear in Kibana if you use
<a href="/guide/en/beats/filebeat/master/index.html" class="ulink" target="_top">Filebeat</a> to ship access logs from your
<a href="https://httpd.apache.org/" class="ulink" target="_top">Apache</a> HTTP servers to Elasticsearch and store it using fields
and datatypes from the Elastic Common Schema (ECS).</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
low_request_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">apache.access</code>.
</li>
<li class="listitem">
Models the event rate of HTTP requests.
</li>
<li class="listitem">
Detects unusually low counts of HTTP requests compared to the previous event
rate (using the <a class="xref" href="ml-count-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">low_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
source_ip_request_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">apache.access</code>.
</li>
<li class="listitem">
Models the event rate of HTTP requests by source IP.
</li>
<li class="listitem">
Detects source IPs with unusually high request rates in the HTTP access log
compared to the previous rate (using the <a class="xref" href="ml-count-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">high_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
source_ip_url_count_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">apache.access</code>.
</li>
<li class="listitem">
Models the event rate of HTTP requests by source IP.
</li>
<li class="listitem">
Detects source IPs with unusually high distinct count of URLs in the HTTP
access log (using the <a class="xref" href="ml-count-functions.html#ml-distinct-count" title="Distinct_count, high_distinct_count, low_distinct_count"><code class="literal">high_distinct_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
status_code_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">apache.access</code>.
</li>
<li class="listitem">
Models the occurrences of HTTP response status codes (<code class="literal">partition_field_name</code>
is <code class="literal">http.response.status_code</code>).
</li>
<li class="listitem">
Detects unusual status code rates in the HTTP access log compared to previous
rates (using the <a class="xref" href="ml-count-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
visitor_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">apache.access</code>.
</li>
<li class="listitem">
Models visitor rates.
</li>
<li class="listitem">
Detects unusual visitor rates in the HTTP access log ompared to previous
rates (using the <a class="xref" href="ml-count-functions.html#ml-nonzero-count" title="Non_zero_count, high_non_zero_count, low_non_zero_count"><code class="literal">non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h3><a id="ootb-ml-jobs-apm"></a>APM<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
<p>These anomaly detection job wizards appear in Kibana if you have data from APM Agents or an APM Server stored in Elasticsearch.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
abnormal_span_durations_jsbase
</span>
</dt>
<dt>
<span class="term">
abnormal_span_durations_nodejs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For data from Elastic APM RUM JavaScript Agents or Elastic APM Node.js Agents (where <code class="literal">agent.name</code> is <code class="literal">js-base</code> or <code class="literal">nodejs</code>).
</li>
<li class="listitem">
Models the duration of spans (<code class="literal">partition_field_name</code> is <code class="literal">span.type</code>).
</li>
<li class="listitem">
Detects for spans that are taking longer than usual to process (using the
<a class="xref" href="ml-metric-functions.html#ml-metric-mean" title="Mean, high_mean, low_mean"><code class="literal">high_mean</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
abnormal_trace_durations_nodejs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For data from Elastic APM Node.js Agents (where <code class="literal">agent.name</code> is <code class="literal">nodejs</code>).
</li>
<li class="listitem">
Models the duration of trace transactions.
</li>
<li class="listitem">
Detects trace transactions that are processing slower than usual (using the
<a class="xref" href="ml-metric-functions.html#ml-metric-mean" title="Mean, high_mean, low_mean"><code class="literal">high_mean</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
anomalous_error_rate_for_user_agents_jsbase
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For data from Elastic APM RUM JavaScript Agents (where <code class="literal">agent.name</code> is <code class="literal">js-base</code>).
</li>
<li class="listitem">
Models the error rate of user agents (<code class="literal">partition_field_name</code> is
<code class="literal">user_agent.name</code>).
</li>
<li class="listitem">
Detects user agents that are encountering errors at an above normal rate
(using the <a class="xref" href="ml-count-functions.html#ml-nonzero-count" title="Non_zero_count, high_non_zero_count, low_non_zero_count"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>This job can help detect browser compatibility issues.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
decreased_throughput_jsbase
</span>
</dt>
<dt>
<span class="term">
decreased_throughput_nodejs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For data from Elastic APM RUM JavaScript Agents or Elastic APM Node.js Agents (where <code class="literal">agent.name</code> is <code class="literal">js-base</code> or <code class="literal">nodejs</code>).
</li>
<li class="listitem">
Models the transaction rate of the application.
</li>
<li class="listitem">
Detects periods during which the application is processing fewer requests
than normal (using the <a class="xref" href="ml-count-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">low_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
high_count_by_user_agent_jsbase
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For data from Elastic APM RUM JavaScript Agents (where <code class="literal">agent.name</code> is <code class="literal">js-base</code>).
</li>
<li class="listitem">
Models the request rate of user agents (<code class="literal">partition_field_name</code> is
<code class="literal">user_agent.name</code>).
</li>
<li class="listitem">
Detects user agents that are making requests at a suspiciously high rate
(using the <a class="xref" href="ml-count-functions.html#ml-nonzero-count" title="Non_zero_count, high_non_zero_count, low_non_zero_count"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>This job is useful in identifying bots.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
high_mean_response_time
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For transaction data where <code class="literal">processor.event</code> is <code class="literal">transaction</code> and
<code class="literal">transaction.type</code> is <code class="literal">request</code>.
</li>
<li class="listitem">
Models response time duration of transactions.
</li>
<li class="listitem">
Detects anomalies in high mean of transaction duration (using the
<a class="xref" href="ml-metric-functions.html#ml-metric-mean" title="Mean, high_mean, low_mean"><code class="literal">high_mean</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h3><a id="ootb-ml-jobs-auditbeat"></a>Auditbeat<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
<p>These anomaly detection job wizards appear in Kibana if you use
<a href="/guide/en/beats/auditbeat/master/index.html" class="ulink" target="_top">Auditbeat</a> to audit process activity on your
systems.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
docker_high_count_process_events_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Auditbeat data where <code class="literal">event.module</code> is <code class="literal">auditd</code> and <code class="literal">container.runtime</code> is
<code class="literal">docker</code>.
</li>
<li class="listitem">
Models process execution rates (<code class="literal">partition_field_name</code> is <code class="literal">container.name</code>).
</li>
<li class="listitem">
Detects unusual increases in process execution rates in Docker containers
(using the <a class="xref" href="ml-count-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">high_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
docker_rare_process_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Auditbeat data where <code class="literal">event.module</code> is <code class="literal">auditd</code> and <code class="literal">container.runtime</code> is
<code class="literal">docker</code>.
</li>
<li class="listitem">
Models occurrences of process execution (<code class="literal">partition_field_name</code> is
<code class="literal">container.name</code>).
</li>
<li class="listitem">
Detects rare process executions in Docker containers (using the
<a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
hosts_high_count_process_events_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Auditbeat data where <code class="literal">event.module</code> is <code class="literal">auditd</code>.
</li>
<li class="listitem">
Models process execution rates (<code class="literal">partition_field_name</code> is <code class="literal">host.name</code>).
</li>
<li class="listitem">
Detects unusual increases in process execution rates (using the
<a class="xref" href="ml-count-functions.html#ml-nonzero-count" title="Non_zero_count, high_non_zero_count, low_non_zero_count"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
hosts_rare_process_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Auditbeat data where <code class="literal">event.module</code> is <code class="literal">auditd</code>.
</li>
<li class="listitem">
Models process execution rates (<code class="literal">partition_field_name</code> is <code class="literal">host.name</code>).
</li>
<li class="listitem">
Detects rare process executions on hosts (using the
<a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h3><a id="ootb-ml-jobs-logs-ui"></a>Logs UI<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
<p>These anomaly detection jobs appear by default in the <a href="/guide/en/kibana/master/xpack-logs.html" class="ulink" target="_top">Logs app</a> in Kibana.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
log_entry_categories_count
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For log entry categories via the Logs UI.
</li>
<li class="listitem">
Models the occurrences of log events (<code class="literal">partition_field_name</code> is
<code class="literal">event.dataset</code>).
</li>
<li class="listitem">
Detects anomalies in count of log entries by category (using the
<a class="xref" href="ml-count-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
log_entry_rate
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For log entries via the Logs UI.
</li>
<li class="listitem">
Models ingestion rates (<code class="literal">partition_field_name</code> is <code class="literal">event.dataset</code>).
</li>
<li class="listitem">
Detects anomalies in the log entry ingestion rate (using the
<a class="xref" href="ml-count-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">low_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h3><a id="ootb-ml-jobs-metricbeat"></a>Metricbeat<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
<p>These anomaly detection job wizards appear in Kibana if you use the
<a href="/guide/en/beats/metricbeat/master/metricbeat-module-system.html" class="ulink" target="_top">Metricbeat system module</a> to
monitor your servers.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
high_mean_cpu_iowait_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Metricbeat data where <code class="literal">event.dataset</code> is <code class="literal">system.cpu</code> and
<code class="literal">system.filesystem</code>.
</li>
<li class="listitem">
Models CPU time spent in iowait (<code class="literal">partition_field_name</code> is <code class="literal">host.name</code>).
</li>
<li class="listitem">
Detects unusual increases in cpu time spent in iowait (using the
<a class="xref" href="ml-metric-functions.html#ml-metric-mean" title="Mean, high_mean, low_mean"><code class="literal">high_mean</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
max_disk_utilization_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Metricbeat data where <code class="literal">event.dataset</code> is <code class="literal">system.cpu</code> and
<code class="literal">system.filesystem</code>.
</li>
<li class="listitem">
Models disc utilization (<code class="literal">partition_field_name</code> is <code class="literal">host.name</code>).
</li>
<li class="listitem">
Detects unusual increases in disk utilization (using the
<a class="xref" href="ml-metric-functions.html#ml-metric-max" title="Max"><code class="literal">max</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
metricbeat_outages_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Metricbeat data where <code class="literal">event.dataset</code> is <code class="literal">system.cpu</code> and
<code class="literal">system.filesystem</code>.
</li>
<li class="listitem">
Models counts of Metricbeat documents
(<code class="literal">partition_field_name</code> is <code class="literal">event.dataset</code>).
</li>
<li class="listitem">
Detects unusual decreases in Metricbeat documents (using the
<a class="xref" href="ml-count-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">low_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h3><a id="ootb-ml-jobs-nginx"></a>Nginx<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
<p>These anomaly detection job wizards appear in Kibana if you use Filebeat to ship access
logs from your <a href="http://nginx.org/" class="ulink" target="_top">Nginx</a> HTTP servers to Elasticsearch and store it using
fields and datatypes from the Elastic Common Schema (ECS).</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
low_request_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">nginx.access</code>.
</li>
<li class="listitem">
Models the event rate of http requests.
</li>
<li class="listitem">
Detects unusually low counts of HTTP requests compared to the previous event
rate (using the <a class="xref" href="ml-count-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">low_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
source_ip_request_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">nginx.access</code>.
</li>
<li class="listitem">
Models the event rate of HTTP requests by source IP.
</li>
<li class="listitem">
Detects source IPs with unusually high request rates in the HTTP access log
compared to the previous rate (using the <a class="xref" href="ml-count-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">high_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
source_ip_url_count_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">nginx.access</code>.
</li>
<li class="listitem">
Models the event rate of HTTP requests by source IP.
</li>
<li class="listitem">
Detects source IPs with unusually high distinct count of URLs in the HTTP
access log (using the <a class="xref" href="ml-count-functions.html#ml-distinct-count" title="Distinct_count, high_distinct_count, low_distinct_count"><code class="literal">high_distinct_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
status_code_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">nginx.access</code>.
</li>
<li class="listitem">
Models the occurrences of HTTP response status codes (<code class="literal">partition_field_name</code>
is <code class="literal">http.response.status_code</code>).
</li>
<li class="listitem">
Detects unusual status code rates in the HTTP access log compared to previous
rates (using the <a class="xref" href="ml-count-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
visitor_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">nginx.access</code>.
</li>
<li class="listitem">
Models visitor rates.
</li>
<li class="listitem">
Detects unusual visitor rates in the HTTP access log ompared to previous
rates (using the <a class="xref" href="ml-count-functions.html#ml-nonzero-count" title="Non_zero_count, high_non_zero_count, low_non_zero_count"><code class="literal">non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h3><a id="ootb-ml-jobs-siem"></a>SIEM<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
<p>These anomaly detection jobs appear by default in the Anomaly Detection interface of the
<a href="/guide/en/siem/guide/master/machine-learning.html" class="ulink" target="_top">SIEM app</a> in Kibana. They help you
automatically detect file system and network anomalies on your hosts. The list
below contains the jobs organized by <code class="literal">agent.type</code> (Auditbeat, Packetbeat, and
Winlogbeat).</p>
<h4><a id="ootb-ml-jobs-siem-audit"></a>SIEM - Auditbeat<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_network_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models the occurrences of processes that cause network activity.
</li>
<li class="listitem">
Detects network activity caused by processes that occur rarely compared to
other processes (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual processes using the network which could indicate
command-and-control, lateral movement, persistence, or data exfiltration
activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_network_port_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models destination port activity.
</li>
<li class="listitem">
Detects destination port activity that occurs rarely compared to other port
activities (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual destination port activity that could indicate
command-and-control, persistence mechanism, or data exfiltration activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_network_service
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models listening port activity.
</li>
<li class="listitem">
Detects unusual listening port activity that occurs rarely compared to
other port activities (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual listening ports that could indicate execution of unauthorized
services, backdoors, or persistence mechanisms.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_network_url_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models the occurrences of URL requests.
</li>
<li class="listitem">
Detects unusual web URL request that is rare compared to other web URL
requests (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for an unusual web URL request from a Linux instance. Curl and wget web
request activity is very common but unusual web requests from a Linux server can
sometimes be malware delivery or execution.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_process_all_hosts_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models the occurrences of processes on all hosts.
</li>
<li class="listitem">
Detects processes that occur rarely compared to other processes to all
Linux/Windows hosts (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for processes that are unusual to all Linux hosts. Such unusual processes
may indicate unauthorized services, malware, or persistence mechanisms.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_user_name_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Rare and unusual users that are not normally active may indicate unauthorized
changes or activity by an unauthorized user which may be credentialed access or
lateral movement.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
rare_process_by_host_linux_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models occurrences of process activities on the host.
</li>
<li class="listitem">
Detect unusually rare processes compared to other processes on Linux (using
the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
suspicious_login_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models occurrences of authentication attempts (<code class="literal">partition_field_name</code> is
<code class="literal">host.name</code>).
</li>
<li class="listitem">
Detects unusually high number of authentication attempts (using the
<a class="xref" href="ml-count-functions.html#ml-nonzero-count" title="Non_zero_count, high_non_zero_count, low_non_zero_count"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h4><a id="ootb-ml-jobs-siem-packet"></a>SIEM - Packetbeat<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
packetbeat_dns_tunneling
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrances of DNS activity.
</li>
<li class="listitem">
Detects unusual DNS activity (using the
<a class="xref" href="ml-info-functions.html#ml-info-content" title="Info_content, High_info_content, Low_info_content"><code class="literal">high_info_content</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual DNS activity that could indicate command-and-control or data
exfiltration activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
packetbeat_rare_dns_question
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of DNS activity.
</li>
<li class="listitem">
Detects DNS activity that is rare compared to other DNS activities (using the
<a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual DNS activity that could indicate command-and-control activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
packetbeat_rare_server_domain
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models HTTP or TLS domain activity.
</li>
<li class="listitem">
Detects HTTP or TLS domain activity that is rarely occurs compared to other
activities (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual HTTP or TLS destination domain activity that could indicate
execution, persistence, command-and-control or data exfiltration activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
packetbeat_rare_urls
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of web browsing URL activity.
</li>
<li class="listitem">
Detects URL activity that rarely occurs compared to other URL activities
(using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual web browsing URL activity that could indicate execution,
persistence, command-and-control or data exfiltration activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
packetbeat_rare_user_agent
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of HTTP user agent activity.
</li>
<li class="listitem">
Detects HTTP user agent activity that occurs rarely compared to other HTTP
user agent activities (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual HTTP user agent activity that could indicate execution,
persistence, command-and-control or data exfiltration activity.</p>
<h4><a id="ootb-ml-jobs-siem-winlog"></a>SIEM - Winlogbeat<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_network_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models the occurrences of processes that cause network activity.
</li>
<li class="listitem">
Detects network activity caused by processes that occur rarely compared to
other processes (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual processes using the network which could indicate
command-and-control, lateral movement, persistence, or data exfiltration
activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_process_all_hosts_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models the occurrences of processes on all hosts.
</li>
<li class="listitem">
Detects processes that occur rarely compared to other processes to all
Linux/Windows hosts (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for processes that are unusual to all Windows hosts. Such unusual
processes may indicate unauthorized services, malware, or persistence
mechanisms.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_user_name_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Rare and unusual users that are not normally active may indicate unauthorized
changes or activity by an unauthorized user which may be credentialed access or
lateral movement.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
rare_process_by_host_windows_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of process activities on the host.
</li>
<li class="listitem">
Detect unusually rare processes compared to other processes on Windows (using
the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_path_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of processes in paths.
</li>
<li class="listitem">
Detects activity in unusual paths (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Activities in unusual paths may indicate execution of malware or persistence
mechanisms. Windows payloads often execute from user profile paths.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_process_creation
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of process creation activities (<code class="literal">partition_field_name</code> is
<code class="literal">process.parent.name</code>).
</li>
<li class="listitem">
Detects process relationships that are rare compared to other process
relationships (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual process relationships which may indicate execution of malware
or persistence mechanisms.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_script
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of powershell script activities.
</li>
<li class="listitem">
Detects unusual powershell script execution compared to other powershell
script activities (using the
<a class="xref" href="ml-info-functions.html#ml-info-content" title="Info_content, High_info_content, Low_info_content"><code class="literal">high_info_content</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual powershell scripts that may indicate execution of malware, or
persistence mechanisms.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_service
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of Windows service activities.
</li>
<li class="listitem">
Detects Windows service activities that occur rarely compared to other Windows
service activities (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for rare and unusual Windows services which may indicate execution of
unauthorized services, malware, or persistence mechanisms.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_rare_user_runas_event
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of user context switches.
</li>
<li class="listitem">
Detects user context switches that occur rarely compared to other user context
switches (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Unusual user context switches can be due to privilege escalation.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_rare_user_type10_remote_login
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of user remote login activities.
</li>
<li class="listitem">
Detects user remote login activities that occur rarely compared to other
user remote login activities (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual user remote logins. Unusual RDP (remote desktop protocol)
user logins can indicate account takeover or credentialed access.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="ml-api-quickref.html">« API quick reference</a>
</span>
<span class="next">
<a href="ml-functions.html">Function reference »</a>
</span>
</div>
</div>
</body>
</html>
