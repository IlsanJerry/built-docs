<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Setting Up SSL/TLS on a Cluster
        | X-Pack for the Elastic Stack [5.6]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="X-Pack for the Elastic Stack [5.6]" /><link rel="up" href="encrypting-communications.html" title="Encrypting Communications" /><link rel="prev" href="encrypting-communications.html" title="Encrypting Communications" /><link rel="next" href="ciphers.html" title="Enabling Cipher Suites for Stronger Encryption" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Legacy/XPack/Reference/5.6" /><meta xmlns="" name="DC.subject" content="X-Pack" /><meta xmlns="" name="DC.identifier" content="5.6" /><meta xmlns="" name="robots" content="noindex,nofollow" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">X-Pack for the Elastic Stack
      [5.6]
    </a></span> » <span class="breadcrumb-link"><a href="xpack-security.html">Securing Elasticsearch and Kibana</a></span> » <span class="breadcrumb-link"><a href="encrypting-communications.html">Encrypting Communications</a></span> » <span class="breadcrumb-node">Setting Up SSL/TLS on a Cluster</span></div><div xmlns="" class="navheader"><span class="prev"><a href="encrypting-communications.html">
              « 
              Encrypting Communications</a>
           
        </span><span class="next">
           
          <a href="ciphers.html">Enabling Cipher Suites for Stronger Encryption
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ssl-tls"></a>Setting Up SSL/TLS on a Cluster</h2></div></div></div><p>X-Pack security enables you to encrypt traffic to, from, and within your Elasticsearch
cluster. Connections are secured using Transport Layer Security (TLS), which is
commonly referred to as "SSL".</p><div xmlns="" class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">Clusters that do not have encryption enabled send all data in plain text
including passwords.</p></div></div><p>To enable encryption, you need to perform the following steps on each node in
the cluster:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><a class="link" href="ssl-tls.html#installing-node-certificates" title="Node Certificates">Generate a private key and X.509 certificate</a>.</li><li class="listitem"><p class="simpara"><a class="link" href="ssl-tls.html#configure-ssl">Configure the node</a> to:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">Identify itself using its signed certificate.</li><li class="listitem">Enable SSL on the transport and HTTP layers.</li></ol></div></li><li class="listitem">Restart Elasticsearch.</li></ol></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="installing-node-certificates"></a>Node Certificates</h3></div></div></div><p>TLS requires X.509 certificates to perform encryption and authentication of the application
that is being communicated with. In order for the communication between nodes to be truly
secure, the certificates must be validated. The recommended approach for validating
certificate authenticity in a Elasticsearch cluster is to trust the certificate authority (CA)
that signed the certificate. By doing this, as nodes are added to your cluster they just need
to use a certificate signed by the same CA and the node is automatically allowed to join the
cluster. Additionally, it is recommended that the certificates contain subject alternative
names (SAN) that correspond to the node’s ip address and dns name so that hostname verification
can be performed.</p><p>In order to simplify the process of generating certificates for the Elastic Stack, a command
line tool, <code class="literal">certgen</code> has been included with X-Pack. This tool takes care of the generating
a CA and signing certificates with the CA. <code class="literal">certgen</code> can be used interactively or in a silent
mode through the use of an input file. The <code class="literal">certgen</code> tool also supports generation of certificate
signing requests (CSR), so that a commercial or organization specific CA may be used to sign
the certificates. For more information, see <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/5.6/certgen.html" target="_top">certgen</a>.</p><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">If you choose not to use <code class="literal">certgen</code>, the certificates that you obtain must allow for both
<code class="literal">clientAuth</code> and <code class="literal">serverAuth</code> if the extended key usage extension is present. The certificates
need to be in PEM format. Although not required, it is highly recommended that the certificate contain
the dns name(s) and/or ip address(es) of the node so that hostname verification may be used.</p></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="enable-ssl"></a>Enabling SSL in the Node Configuration</h3></div></div></div><p>Once you have the signed certificate, private key, and CA certificate you need to
modify the node configuration to enable SSL.</p><p><a id="configure-ssl"></a>To enable SSL, make the following changes in <code class="literal">elasticsearch.yml</code>:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Specify the location of the node’s keystore and the password(s) needed to
access the node’s certificate. For example:</p><div xmlns="" class="pre_wrapper lang-yaml"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">xpack.ssl.key:                     /home/es/config/x-pack/node01.key <a id="CO19-1"></a><i xmlns="" class="conum" data-value="1"></i>
xpack.ssl.certificate:             /home/es/config/x-pack/node01.crt <a id="CO19-2"></a><i xmlns="" class="conum" data-value="2"></i>
xpack.ssl.certificate_authorities: [ "/home/es/config/x-pack/ca.crt" ] <a id="CO19-3"></a><i xmlns="" class="conum" data-value="3"></i></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO19-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>The full path to the node key file. This must be a location within the
Elasticsearch configuration directory.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO19-2"><i xmlns="" class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>The full path to the node certificate. This must be a location within the
Elasticsearch configuration directory.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO19-3"><i xmlns="" class="conum" data-value="3"></i></a> </p></td><td valign="top" align="left"><p>An array of paths to the CA certificates that should be trusted. These paths
must be a location within the Elasticsearch configuration directory.</p></td></tr></table></div></li><li class="listitem"><p class="simpara">Enable SSL on the transport networking layer to ensure that communication
between nodes is encrypted:</p><div xmlns="" class="pre_wrapper lang-yaml"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">xpack.security.transport.ssl.enabled: true</pre></div></li><li class="listitem"><p class="simpara">Enable SSL on the HTTP layer to ensure that communication between HTTP clients
and the cluster is encrypted:</p><div xmlns="" class="pre_wrapper lang-yaml"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">xpack.security.http.ssl.enabled: true</pre></div></li><li class="listitem"><p class="simpara">Restart Elasticsearch.</p><p class="simpara">You must perform a full cluster restart. Nodes which are configured to use
SSL/TLS cannot communicate with nodes that are using unencrypted networking
(and vice-versa). After enabling SSL/TLS you must restart all nodes in order
to maintain communication across the cluster.</p></li></ol></div><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">All SSL related node settings that are considered to be highly sensitive
      and therefore are not exposed via the
      <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/5.6/cluster-nodes-info.html#cluster-nodes-info" target="_top">nodes info API</a>.</p></div></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="encrypting-communications.html">
              « 
              Encrypting Communications</a>
           
        </span><span class="next">
           
          <a href="ciphers.html">Enabling Cipher Suites for Stronger Encryption
               »
            </a></span></div></body></html>