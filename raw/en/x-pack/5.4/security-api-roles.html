<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Role Management APIs
        | X-Pack for the Elastic Stack [5.4]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="X-Pack for the Elastic Stack [5.4]" /><link rel="up" href="security-api.html" title="Security APIs" /><link rel="prev" href="security-api-users.html" title="User Management APIs" /><link rel="next" href="security-api-privileges.html" title="Privilege APIs" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Legacy/XPack/Reference/5.4" /><meta xmlns="" name="DC.subject" content="X-Pack" /><meta xmlns="" name="DC.identifier" content="5.4" /><meta xmlns="" name="robots" content="noindex,nofollow" /></head><body><div xmlns="" class="page_header">Why not take our <a href="https://www.elastic.co/products/x-pack/machine-learning">machine learning</a> beta for a spin and join us in the <a href="https://discuss.elastic.co/c/x-pack">public X-Pack forum</a>?
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">X-Pack for the Elastic Stack
      [5.4]
    </a></span> » <span class="breadcrumb-link"><a href="xpack-api.html">X-Pack APIs</a></span> » <span class="breadcrumb-link"><a href="security-api.html">Security APIs</a></span> » <span class="breadcrumb-node">Role Management APIs</span></div><div xmlns="" class="navheader"><span class="prev"><a href="security-api-users.html">
              « 
              User Management APIs</a>
           
        </span><span class="next">
           
          <a href="security-api-privileges.html">Privilege APIs
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security-api-roles"></a>Role Management APIs</h2></div></div></div><p>The Roles API enables you to add, remove, and retrieve roles in the <code class="literal">native</code>
realm. To use this API, you must have at least the <code class="literal">manage_security</code> cluster
privilege.</p><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">The Roles API is now the preferred way to manage roles.</p></div></div><p><a id="security-api-put-role"></a>To add a role, submit a PUT or POST request to the <code class="literal">/_xpack/security/role/&lt;rolename&gt;</code>
endpoint:</p><div xmlns="" class="pre_wrapper lang-console"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-console">POST /_xpack/security/role/my_admin_role
{
  "cluster": ["all"],
  "indices": [
    {
      "names": [ "index1", "index2" ],
      "privileges": ["all"],
      "field_security" : { // optional
        "grant" : [ "title", "body" ]
      },
      "query": "{\"match\": {\"title\": \"foo\"}}" // optional
    }
  ],
  "run_as": [ "other_user" ], // optional
  "metadata" : { // optional
    "version" : 1
  }
}</pre></div><div xmlns="" class="console_widget" data-snippet="snippets/91.console"></div><p>The <code class="literal">name</code>, <code class="literal">cluster</code>, and <code class="literal">indices</code> fields are required at the top-level.
Within the <code class="literal">indices</code> array, the <code class="literal">names</code> and <code class="literal">privileges</code> fields are required.
Within the <code class="literal">metadata</code> object, keys beginning with <code class="literal">_</code> are reserved for system
usage.</p><p>The <code class="literal">field_security</code> and <code class="literal">query</code> fields are both optional. They are used to
implement <a class="link" href="field-and-document-access-control.html" title="Setting Up Field and Document Level Security">Field and Document Level Security</a>.</p><p>A successful call returns a JSON structure that shows whether the role has been
created or updated.</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "role": {
    "created": true <a id="CO83-1"></a><i xmlns="" class="conum" data-value="1"></i>
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO83-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>When an existing role is updated, <code class="literal">created</code> is set to false.</p></td></tr></table></div><p><a id="security-api-get-role"></a>To retrieve a role from the <code class="literal">native</code> Security realm, issue a GET request to the
<code class="literal">/_xpack/security/role/&lt;rolename&gt;</code> endpoint:</p><div xmlns="" class="pre_wrapper lang-console"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-console">GET /_xpack/security/role/my_admin_role</pre></div><div xmlns="" class="console_widget" data-snippet="snippets/92.console"></div><p>A successful call returns an array of roles with the JSON representation of the
role. If the role is not defined in the <code class="literal">native</code> realm, the request 404s.</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "my_admin_role": {
    "cluster" : [ "all" ],
    "indices" : [ {
      "names" : [ "index1", "index2" ],
      "privileges" : [ "all" ],
      "field_security" : {
        "grant" : [ "title", "body" ]
      },
      "query" : "{\"match\": {\"title\": \"foo\"}}"
    } ],
    "run_as" : [ "other_user" ],
    "metadata" : {
      "version" : 1
    },
    "transient_metadata": {
      "enabled": true
    }
  }
}</pre></div><p>You can specify multiple roles as a comma-separated list. To retrieve all roles,
omit the role name.</p><div xmlns="" class="pre_wrapper lang-console"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-console"># Retrieve roles "r1", "r2", and "my_admin_role"
GET /_xpack/security/role/r1,r2,my_admin_role

# Retrieve all roles
GET /_xpack/security/role</pre></div><div xmlns="" class="console_widget" data-snippet="snippets/93.console"></div><p><a id="security-api-delete-role"></a>To delete a role, submit a DELETE request to the <code class="literal">/_xpack/security/role/&lt;rolename&gt;</code>
endpoint:</p><div xmlns="" class="pre_wrapper lang-console"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-console">DELETE /_xpack/security/role/my_admin_role</pre></div><div xmlns="" class="console_widget" data-snippet="snippets/94.console"></div><p>If the role is successfully deleted, the request returns <code class="literal">{"found": true}</code>.
Otherwise, <code class="literal">found</code> is set to false.</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "found" : true
}</pre></div><p><a id="security-api-clear-role-cache"></a>The Clear Roles Cache API evicts roles from the native role cache. To clear the
cache for a role, submit a POST request <code class="literal">/_xpack/security/role/&lt;rolename&gt;/_clear_cache</code>
endpoint:</p><div xmlns="" class="pre_wrapper lang-console"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-console">POST /_xpack/security/role/my_admin_role/_clear_cache</pre></div><div xmlns="" class="console_widget" data-snippet="snippets/95.console"></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="security-api-users.html">
              « 
              User Management APIs</a>
           
        </span><span class="next">
           
          <a href="security-api-privileges.html">Privilege APIs
               »
            </a></span></div></body></html>