<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Search API
        | Groovy API [2.0]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Groovy API [2.0]" /><link rel="up" href="index.html" title="Groovy API [2.0]" /><link rel="prev" href="delete.html" title="Delete API" /><link rel="next" href="count.html" title="Count API" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Legacy/Clients/Groovy/2.0" /><meta xmlns="" name="DC.subject" content="Clients" /><meta xmlns="" name="DC.identifier" content="2.0" /><meta xmlns="" name="robots" content="noindex,nofollow" /></head><body><div xmlns="" class="page_header">The Groovy API is no longer actively maintained or supported. </div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Groovy API
      [2.0]
    </a></span> » <span class="breadcrumb-node">Search API</span></div><div xmlns="" class="navheader"><span class="prev"><a href="delete.html">
              « 
              Delete API</a>
           
        </span><span class="next">
           
          <a href="count.html">Count API
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="search"></a>Search API<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/2.0/docs/groovy-api/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h1></div></div></div><p>The search API is very similar to the
Java search API. The Groovy
extension allows to provide the search source to execute as a <code class="literal">Closure</code>
including the query itself (similar to GORM criteria builder):</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">def search = node.client.search {
    indices "test"
    types "type1"
    source {
        query {
            term(test: "value")
        }
    }
}

search.response.hits.each {SearchHit hit -&gt;
    println "Got hit $hit.id from $hit.index/$hit.type"
}</pre></div><p>It can also be executed using the "Java API" while still using a closure
for the query:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">def search = node.client.prepareSearch("test").setQuery({
        term(test: "value")
}).gexecute();

search.response.hits.each {SearchHit hit -&gt;
    println "Got hit $hit.id from $hit.index/$hit.type"
}</pre></div><p>The format of the search <code class="literal">Closure</code> follows the same JSON syntax as the
<a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/search-search.html" target="_top">Search API</a> request.</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="more-examples"></a>More examples<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/2.0/docs/groovy-api/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Term query where multiple values are provided (see
<a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/query-dsl-terms-query.html" target="_top">terms</a>):</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">def search = node.client.search {
    indices "test"
    types "type1"
    source {
        query {
            terms(test: ["value1", "value2"])
        }
    }
}</pre></div><p>Query string (see
<a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/query-dsl-query-string-query.html" target="_top">query string</a>):</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">def search = node.client.search {
    indices "test"
    types "type1"
    source {
        query {
            query_string(
                fields: ["test"],
                query: "value1 value2")
        }
    }
}</pre></div><p>Pagination (see
<a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/search-request-from-size.html" target="_top">from/size</a>):</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">def search = node.client.search {
    indices "test"
    types "type1"
    source {
        from = 0
        size = 10
        query {
            term(test: "value")
        }
    }
}</pre></div><p>Sorting (see <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/2.0/search-request-sort.html" target="_top">sort</a>):</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">def search = node.client.search {
    indices "test"
    types "type1"
    source {
        query {
            term(test: "value")
        }
        sort = [
            date : [ order: "desc"]
        ]
    }
}</pre></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="delete.html">
              « 
              Delete API</a>
           
        </span><span class="next">
           
          <a href="count.html">Count API
               »
            </a></span></div></body></html>