<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Connection Pooling and Cluster Failover
        | Elasticsearch.Net and NEST: the .NET clients [1.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch.Net and NEST: the .NET clients [1.x]" /><link rel="up" href="elasticsearch-net.html" title="Elasticsearch.Net" /><link rel="prev" href="security.html" title="Security" /><link rel="next" href="building-requests.html" title="Building Requests" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Clients/.Net/1.x" /><meta xmlns="" name="DC.subject" content="Clients" /><meta xmlns="" name="DC.identifier" content="1.x" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch.Net and NEST:    the .NET clients
      [1.x]
    </a></span> » <span class="breadcrumb-link"><a href="elasticsearch-net.html">Elasticsearch.Net</a></span> » <span class="breadcrumb-node">Connection Pooling and Cluster Failover</span></div><div xmlns="" class="navheader"><span class="prev"><a href="security.html">
              « 
              Security</a>
           
        </span><span class="next">
           
          <a href="building-requests.html">Building Requests
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="cluster-failover"></a>Connection Pooling and Cluster Failover<a xmlns="" href="https://github.com/elastic/elasticsearch-net/edit/1.x/docs/elasticsearch-net/connection-pooling.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>One of the major benefits of Elasticsearch is that it can handle dying and respawning  nodes.
As long as enough nodes agree that the cluster is healthy, the cluster will continue to operate.
<code class="literal">Elasticsearch.Net</code> comes with builtin support for handle falling over to a different node when the requested node failed.</p><h3><a id="_configuring"></a>Configuring<a xmlns="" href="https://github.com/elastic/elasticsearch-net/edit/1.x/docs/elasticsearch-net/connection-pooling.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Configuring how the registered <code class="literal">IConnectionPool</code> should behave happens on the <code class="literal">IConnectionConfigurationValues</code> passed to client
[see the section on connecting ](/elasticsearch-net/connecting.html)</p><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">var settings = new ConnectionConfiguration(connectionPool)
    .SniffOnConnectionFault(false)
    .SniffOnStartup(false)
    .SniffLifeSpan(TimeSpan.FromMinutes(1));</pre></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">SniffOnConnectionFault</span></dt><dd>Should the connection pool resniff the cluster state everytime an operation on a node throws an exception or a faulty http status code.
Defaults to true.</dd><dt><span class="term">SniffOnStartup</span></dt><dd>Should the connection pool sniff the cluster state the first time its instantiated. Defaults to true.</dd><dt><span class="term">SniffLifeSpan</span></dt><dd>When set will cause the connectionpool to resniff whenever it notices the last sniff information happened too long ago. Defaults to null.</dd><dt><span class="term">SetDeadTimeout</span></dt><dd>Sets the timeout before a node is retried.
The default <code class="literal">DateTimeProvider</code> will increment this timeout exponentially based on the number of attempts.</dd><dt><span class="term">SetMaxDeadTimeout</span></dt><dd>Sets the maximum time a node may be marked dead.</dd><dt><span class="term">DisablePing</span></dt><dd>By default before a previously dead node is retried a short ping will be sent to the node to make sure the node will respond.
The reason for a separate call is that a ping will call an elasticsearch endpoint that won’t stress the JVM.
If a node is having issues retrying a possible heavy search operation on it might cause the request
to fail later rather then asap. This setting allows you to disable these pings before retries.</dd><dt><span class="term">MaximumRetries</span></dt><dd>By default an <code class="literal">IConnectionPool</code> itself will decide how many times to retry (usually all the registered nodes) if you wish to
limit this you can explicitly tell the connection pool to never retry more than <code class="literal">retries</code>.</dd></dl></div><h3><a id="sniffing-connection-pool"></a>SniffingConnectionPool<a xmlns="" href="https://github.com/elastic/elasticsearch-net/edit/1.x/docs/elasticsearch-net/connection-pooling.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>This <code class="literal">IConnectionPool</code> implementation will <code class="literal">sniff</code> the cluster state on the passed seed nodes to find all the alive nodes in the cluster. It will round robin requests over all the alive nodes it knows about.</p><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">var pool = new SniffingConnectionPool(seedUris);</pre></div><h3><a id="static-connection-pool"></a>StaticConnectionPool<a xmlns="" href="https://github.com/elastic/elasticsearch-net/edit/1.x/docs/elasticsearch-net/connection-pooling.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>This <code class="literal">IConnectionPool</code> implementation will round robin over the provided nodes. When nodes are dead it will mark it dead with an incremental timeout before
retrying requests on that node. When all the known nodes are marked dead an operation will be tried once on a random node from the list.</p><p>The difference between this implementation and <code class="literal">SniffingConnectionPool</code> is that this implementation effectively treats the <code class="literal">Sniff()</code> call as a
 <a class="ulink" href="http://en.wikipedia.org/wiki/Noop" target="_top">NOOP</a></p><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">var pool = new StaticConnectionPool(seedUris);</pre></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="security.html">
              « 
              Security</a>
           
        </span><span class="next">
           
          <a href="building-requests.html">Building Requests
               »
            </a></span></div></body></html>