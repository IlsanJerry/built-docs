<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Keeping track of nodes
        | Elasticsearch.Net and NEST: the .NET clients [7.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch.Net and NEST: the .NET clients [7.x]" /><link rel="up" href="transports-and-pipelines.html" title="Transports and pipelines" /><link rel="prev" href="date-time-providers.html" title="Date time providers" /><link rel="next" href="sniffing-behaviour.html" title="Sniffing behaviour" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Clients/.Net/7.x" /><meta xmlns="" name="DC.subject" content="Clients" /><meta xmlns="" name="DC.identifier" content="7.x" /></head><body><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch.Net and NEST:  the .NET clients
      [7.x]
    </a></span> » <span class="breadcrumb-link"><a href="api-conventions.html">API Conventions</a></span> » <span class="breadcrumb-link"><a href="transports-and-pipelines.html">Transports and pipelines</a></span> » <span class="breadcrumb-node">Keeping track of nodes</span></div><div xmlns="" class="navheader"><span class="prev"><a href="date-time-providers.html">
              « 
              Date time providers</a>
           
        </span><span class="next">
           
          <a href="sniffing-behaviour.html">Sniffing behaviour
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="keeping-track-of-nodes"></a>Keeping track of nodes<a xmlns="" href="https://github.com/elastic/elasticsearch-net/edit/7.x/docs/client-concepts/connection-pooling/building-blocks/keeping-track-of-nodes.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_creating_a_node"></a>Creating a Node<a xmlns="" href="https://github.com/elastic/elasticsearch-net/edit/7.x/docs/client-concepts/connection-pooling/building-blocks/keeping-track-of-nodes.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>A <code class="literal">Node</code> can be instantiated by passing it a <code class="literal">Uri</code></p><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">var node = new Node(new Uri("http://localhost:9200"));
node.Uri.Should().NotBeNull();
node.Uri.Port.Should().Be(9200);</pre></div><p>By default master eligible and holds data is presumed to be true *</p><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">node.MasterEligible.Should().BeTrue();
node.HoldsData.Should().BeTrue();</pre></div><p>Is resurrected is true on first usage, hints to the transport that a ping might be useful</p><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">node.IsResurrected.Should().BeTrue();</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_building_a_node_path"></a>Building a Node path<a xmlns="" href="https://github.com/elastic/elasticsearch-net/edit/7.x/docs/client-concepts/connection-pooling/building-blocks/keeping-track-of-nodes.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>passing a node with a path should be preserved.
Sometimes an Elasticsearch node lives behind a proxy</p><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">var node = new Node(new Uri("http://test.example/elasticsearch"));

node.Uri.Port.Should().Be(80);
node.Uri.AbsolutePath.Should().Be("/elasticsearch/");</pre></div><p><span class="strong strong"><strong>We force paths to end with a forward slash</strong></span> so that they can later be safely combined</p><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">var combinedPath = new Uri(node.Uri, "index/type/_search");
combinedPath.AbsolutePath.Should().Be("/elasticsearch/index/type/_search");</pre></div><p>which is exactly what the <code class="literal">CreatePath</code> method does on <code class="literal">Node</code></p><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">combinedPath = node.CreatePath("index/type/_search");
combinedPath.AbsolutePath.Should().Be("/elasticsearch/index/type/_search");</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_marking_nodes"></a>Marking Nodes<a xmlns="" href="https://github.com/elastic/elasticsearch-net/edit/7.x/docs/client-concepts/connection-pooling/building-blocks/keeping-track-of-nodes.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">var node = new Node(new Uri("http://localhost:9200"));
node.FailedAttempts.Should().Be(0);
node.IsAlive.Should().BeTrue();</pre></div><p>every time a node is marked dead, the number of attempts should increase
and the passed datetime should be exposed.</p><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">for(var i = 0; i&lt;10;i++)
{
    var deadUntil = DateTime.Now.AddMinutes(1);
    node.MarkDead(deadUntil);
    node.FailedAttempts.Should().Be(i + 1);
    node.IsAlive.Should().BeFalse();
    node.DeadUntil.Should().Be(deadUntil);
}</pre></div><p>however when marking a node alive, the <code class="literal">DeadUntil</code> property should be reset and <code class="literal">FailedAttempts</code> reset to 0</p><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">node.MarkAlive();
node.FailedAttempts.Should().Be(0);
node.DeadUntil.Should().Be(default(DateTime));
node.IsAlive.Should().BeTrue();</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_node_equality"></a>Node Equality<a xmlns="" href="https://github.com/elastic/elasticsearch-net/edit/7.x/docs/client-concepts/connection-pooling/building-blocks/keeping-track-of-nodes.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Nodes are considered equal if they have the same endpoint, no matter what other metadata is associated</p><div xmlns="" class="pre_wrapper lang-csharp"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-csharp">var node = new Node(new Uri("http://localhost:9200")) { MasterEligible = false };
var nodeAsMaster = new Node(new Uri("http://localhost:9200")) { MasterEligible = true };

(node == nodeAsMaster).Should().BeTrue();
(node != nodeAsMaster).Should().BeFalse();

var uri = new Uri("http://localhost:9200");
(node == uri).Should().BeTrue();

var differentUri = new Uri("http://localhost:9201");
(node != differentUri).Should().BeTrue();

node.Should().Be(nodeAsMaster);</pre></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="date-time-providers.html">
              « 
              Date time providers</a>
           
        </span><span class="next">
           
          <a href="sniffing-behaviour.html">Sniffing behaviour
               »
            </a></span></div></body></html>