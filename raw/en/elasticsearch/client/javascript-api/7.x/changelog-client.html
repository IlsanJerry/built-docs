<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Changelog | Elasticsearch Node.js client [7.x] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Node.js client [7.x]"/>
<link rel="up" href="index.html" title="Elasticsearch Node.js client [7.x]"/>
<link rel="prev" href="introduction.html" title="Introduction"/>
<link rel="next" href="client-usage.html" title="Usage"/>
<meta name="DC.type" content="Learn/Docs/Clients/JavaScript/7.x"/>
<meta name="DC.subject" content="Clients"/>
<meta name="DC.identifier" content="7.x"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Node.js client [7.x]</a></span>
»
<span class="breadcrumb-node">Changelog</span>
</div>
<div class="navheader">
<span class="prev">
<a href="introduction.html">« Introduction</a>
</span>
<span class="next">
<a href="client-usage.html">Usage »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h1 class="title"><a id="changelog-client"></a>Changelog<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h1>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_7_0"></a>7.7.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_features_2"></a>Features<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_support_for_elasticsearch_v7_7"></a>Support for Elasticsearch <code class="literal">v7.7</code>.<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>You can find all the API changes <a href="/guide/en/elasticsearch/reference/7.7/release-notes-7.7.0.html" class="ulink" target="_top">here</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_introduced_client_helpers_1107"></a>Introduced client helpers - <a href="https://github.com/elastic/elasticsearch-js/pull/1107" class="ulink" target="_top">#1107</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>From now on, the client comes with an handy collection of helpers to give you a more comfortable experience with some APIs.</p>
<div class="caution admon">
<div class="icon"></div>
<div class="admon_content">
<p>The client helpers are experimental, and the API may change in the next minor releases.</p>
</div>
</div>
<p>The following helpers has been introduced:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">client.helpers.bulk</code>
</li>
<li class="listitem">
<code class="literal">client.helpers.search</code>
</li>
<li class="listitem">
<code class="literal">client.helpers.scrollSearch</code>
</li>
<li class="listitem">
<code class="literal">client.helpers.scrollDocuments</code>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_the_connectionpool_getconnection_now_always_returns_a_connection_1127"></a>The <code class="literal">ConnectionPool.getConnection</code> now always returns a <code class="literal">Connection</code> - <a href="https://github.com/elastic/elasticsearch-js/pull/1127" class="ulink" target="_top">#1127</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>What does this mean? It means that you will see less <code class="literal">NoLivingConnectionError</code>, which now can only be caused if you set a selector/filter too strict.
For improving the debugging experience, the <code class="literal">NoLivingConnectionsError</code> error message has been updated.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_abortable_promises_1141"></a>Abortable promises - <a href="https://github.com/elastic/elasticsearch-js/pull/1141" class="ulink" target="_top">#1141</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>From now on, it will be possible to abort a request generated with the promise-styl API. If you abort a request generated from a promise, the promise will be rejected with a <code class="literal">RequestAbortedError</code>.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">const promise = client.search({
  body: {
    query: { match_all: {} }
  }
})

promise
  .then(console.log)
  .catch(console.log)

promise.abort()</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_major_refactor_of_the_type_definitions_1119_1130_1132"></a>Major refactor of the Type Definitions - <a href="https://github.com/elastic/elasticsearch-js/pull/1119" class="ulink" target="_top">#1119</a> <a href="https://github.com/elastic/elasticsearch-js/issues/1130" class="ulink" target="_top">#1130</a> <a href="https://github.com/elastic/elasticsearch-js/pull/1132" class="ulink" target="_top">#1132</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>Now every API makes better use of the generics and overloading, so you can (or not, by default request/response bodies are <code class="literal">Record&lt;string, any&gt;</code>) define the request/response bodies in the generics.</p>
<div class="pre_wrapper lang-ts">
<pre class="programlisting prettyprint lang-ts">// request and response bodies are generics
client.search(...)
// response body is `SearchResponse` and request body is generic
client.search&lt;SearchResponse&gt;(...)
// request body is `SearchBody` and response body is `SearchResponse`
client.search&lt;SearchResponse, SearchBody&gt;(...)</pre>
</div>
<p>This <span class="strong strong"><strong>should</strong></span> not be a breaking change, as every generics defaults to <code class="literal">any</code>. It might happen to some users that the code breaks, but our test didn&#8217;t detect any of it, probably because they were not robust enough. However, given the gigantic improvement in the developer experience, we have decided to release this change in the 7.x line.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fixes"></a>Fixes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_the_connectionpool_update_method_now_cleans_the_dead_list_1122_1127"></a>The <code class="literal">ConnectionPool.update</code> method now cleans the <code class="literal">dead</code> list - <a href="https://github.com/elastic/elasticsearch-js/issues/1122" class="ulink" target="_top">#1122</a> <a href="https://github.com/elastic/elasticsearch-js/pull/1127" class="ulink" target="_top">#1127</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>It can happen in a situation where we are updating the connections list and running sniff, leaving the <code class="literal">dead</code> list in a dirty state. Now the <code class="literal">ConnectionPool.update</code> cleans up the <code class="literal">dead</code> list every time, which makes way more sense given that all the new connections are alive.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_connectionpoolmarkdead_should_ignore_connections_that_no_longer_exists_1159"></a><code class="literal">ConnectionPoolmarkDead</code> should ignore connections that no longer exists - <a href="https://github.com/elastic/elasticsearch-js/pull/1159" class="ulink" target="_top">#1159</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>It might happen that markDead is called just after a pool update, and in such case, the clint was adding the dead list a node that no longer exists, causing unhandled exceptions later.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_do_not_retry_a_request_if_the_body_is_a_stream_1143"></a>Do not retry a request if the body is a stream - <a href="https://github.com/elastic/elasticsearch-js/pull/1143" class="ulink" target="_top">#1143</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>The client should not retry if it&#8217;s sending a stream body, because it should store in memory a copy of the stream to be able to send it again, but since it doesn&#8217;t know in advance the size of the stream, it risks to take too much memory.
Furthermore, copying everytime the stream is very an expensive operation.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_return_an_error_if_the_request_has_been_aborted_1141"></a>Return an error if the request has been aborted - <a href="https://github.com/elastic/elasticsearch-js/pull/1141" class="ulink" target="_top">#1141</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>Until now, aborting a request was blocking the HTTP request, but never calling the callback or resolving the promise to notify the user. This is a bug because it could lead to dangerous memory leaks. From now on if the user calls the <code class="literal">request.abort()</code> method, the callback style API will be called with a <code class="literal">RequestAbortedError</code>, the promise will be rejected with <code class="literal">RequestAbortedError</code> as well.</p>
</div>

</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_6_1"></a>7.6.1<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Secure json parsing - <a href="https://github.com/elastic/elasticsearch-js/pull/1110" class="ulink" target="_top">#1110</a>
</li>
<li class="listitem">
ApiKey should take precedence over basic auth - <a href="https://github.com/elastic/elasticsearch-js/pull/1115" class="ulink" target="_top">#1115</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Documentation:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fix typo in api reference - <a href="https://github.com/elastic/elasticsearch-js/pull/1109" class="ulink" target="_top">#1109</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_6_0"></a>7.6.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.6</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_5_1"></a>7.5.1<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Skip compression in case of empty string body - <a href="https://github.com/elastic/elasticsearch-js/pull/1080" class="ulink" target="_top">#1080</a>
</li>
<li class="listitem">
Fix typo in NoLivingConnectionsError - <a href="https://github.com/elastic/elasticsearch-js/pull/1045" class="ulink" target="_top">#1045</a>
</li>
<li class="listitem">
Change TransportRequestOptions.ignore to number[] - <a href="https://github.com/elastic/elasticsearch-js/pull/1053" class="ulink" target="_top">#1053</a>
</li>
<li class="listitem">
ClientOptions["cloud"] should have optional auth fields - <a href="https://github.com/elastic/elasticsearch-js/pull/1032" class="ulink" target="_top">#1032</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Documentation:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Docs: Return super in example Transport subclass - <a href="https://github.com/elastic/elasticsearch-js/pull/980" class="ulink" target="_top">#980</a>
</li>
<li class="listitem">
Add examples to reference - <a href="https://github.com/elastic/elasticsearch-js/pull/1076" class="ulink" target="_top">#1076</a>
</li>
<li class="listitem">
Added new examples - <a href="https://github.com/elastic/elasticsearch-js/pull/1031" class="ulink" target="_top">#1031</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_5_0"></a>7.5.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.5</code>.</p>
<p><span class="strong strong"><strong>Features</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
X-Opaque-Id support <a href="https://github.com/elastic/elasticsearch-js/pull/997" class="ulink" target="_top">#997</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_4_0"></a>7.4.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.4</code>.</p>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fix issue; node roles are defaulting to true when undefined is breaking usage of nodeFilter option - <a href="https://github.com/elastic/elasticsearch-js/pull/967" class="ulink" target="_top">#967</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Documentation:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Updated API reference doc - <a href="https://github.com/elastic/elasticsearch-js/pull/945" class="ulink" target="_top">#945</a> <a href="https://github.com/elastic/elasticsearch-js/pull/969" class="ulink" target="_top">#969</a>
</li>
<li class="listitem">
Fix inaccurate description sniffEndpoint - <a href="https://github.com/elastic/elasticsearch-js/pull/959" class="ulink" target="_top">#959</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Internals:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Update code generation <a href="https://github.com/elastic/elasticsearch-js/pull/969" class="ulink" target="_top">#969</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_3_0"></a>7.3.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.3</code>.</p>
<p><span class="strong strong"><strong>Features:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Added <code class="literal">auth</code> option - <a href="https://github.com/elastic/elasticsearch-js/pull/908" class="ulink" target="_top">#908</a>
</li>
<li class="listitem">
Added support for <code class="literal">ApiKey</code> authentication - <a href="https://github.com/elastic/elasticsearch-js/pull/908" class="ulink" target="_top">#908</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
fix(Typings): sniffInterval can also be boolean - <a href="https://github.com/elastic/elasticsearch-js/pull/914" class="ulink" target="_top">#914</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Internals:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Refactored connection pool - <a href="https://github.com/elastic/elasticsearch-js/pull/913" class="ulink" target="_top">#913</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Documentation:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Better reference code examples - <a href="https://github.com/elastic/elasticsearch-js/pull/920" class="ulink" target="_top">#920</a>
</li>
<li class="listitem">
Improve README - <a href="https://github.com/elastic/elasticsearch-js/pull/909" class="ulink" target="_top">#909</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_2_0"></a>7.2.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.2</code></p>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Remove auth data from inspect and toJSON in connection class - <a href="https://github.com/elastic/elasticsearch-js/pull/887" class="ulink" target="_top">#887</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_1_0"></a>7.1.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.1</code></p>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Support for non-friendly chars in url username and password - <a href="https://github.com/elastic/elasticsearch-js/pull/858" class="ulink" target="_top">#858</a>
</li>
<li class="listitem">
Patch deprecated parameters - <a href="https://github.com/elastic/elasticsearch-js/pull/851" class="ulink" target="_top">#851</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_0_1"></a>7.0.1<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fix TypeScript export <span class="strong strong"><strong>(issue <a href="https://github.com/elastic/elasticsearch-js/pull/841" class="ulink" target="_top">#841</a>)</strong></span> - <a href="https://github.com/elastic/elasticsearch-js/pull/842" class="ulink" target="_top">#842</a>
</li>
<li class="listitem">
Fix http and https port handling <span class="strong strong"><strong>(issue <a href="https://github.com/elastic/elasticsearch-js/pull/843" class="ulink" target="_top">#843</a>)</strong></span> - <a href="https://github.com/elastic/elasticsearch-js/pull/845" class="ulink" target="_top">#845</a>
</li>
<li class="listitem">
Fix TypeScript definiton <span class="strong strong"><strong>(issue <a href="https://github.com/elastic/elasticsearch-js/pull/803" class="ulink" target="_top">#803</a>)</strong></span> - <a href="https://github.com/elastic/elasticsearch-js/pull/846" class="ulink" target="_top">#846</a>
</li>
<li class="listitem">
Added toJSON method to Connection class <span class="strong strong"><strong>(issue <a href="https://github.com/elastic/elasticsearch-js/pull/848" class="ulink" target="_top">#848</a>)</strong></span> - <a href="https://github.com/elastic/elasticsearch-js/pull/849" class="ulink" target="_top">#849</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_0_0"></a>7.0.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.0</code></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Stable release.
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="introduction.html">« Introduction</a>
</span>
<span class="next">
<a href="client-usage.html">Usage »</a>
</span>
</div>
</div>
</body>
</html>
