<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Cross-cluster search
        | Elasticsearch Reference [6.5]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [6.5]" /><link rel="up" href="modules.html" title="Modules" /><link rel="prev" href="modules-remote-clusters.html" title="Remote clusters" /><link rel="next" href="index-modules.html" title="Index Modules" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.5" /><meta xmlns="" name="DC.subject" content="Elasticsearch" /><meta xmlns="" name="DC.identifier" content="6.5" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [6.5]
    </a></span> » <span class="breadcrumb-link"><a href="modules.html">Modules</a></span> » <span class="breadcrumb-node">Cross-cluster search</span></div><div xmlns="" class="navheader"><span class="prev"><a href="modules-remote-clusters.html">
              « 
              Remote clusters</a>
           
        </span><span class="next">
           
          <a href="index-modules.html">Index Modules
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="modules-cross-cluster-search"></a>Cross-cluster search<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/6.5/docs/reference/modules/cross-cluster-search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The <span class="emphasis"><em>cross-cluster search</em></span> feature allows any node to act as a federated client across
multiple clusters. In contrast to the <a class="link" href="modules-tribe.html" title="Tribe node">tribe node</a> feature, a cross-cluster search node won’t
join the remote cluster, instead it connects to a remote cluster in a light fashion in order to execute
federated search requests.</p><h3><a id="_using_cross_cluster_search"></a>Using cross-cluster search<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/6.5/docs/reference/modules/cross-cluster-search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Cross-cluster search requires <a class="link" href="modules-remote-clusters.html" title="Remote clusters">configuring remote clusters</a>.</p><div xmlns="" class="pre_wrapper lang-console"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-console">PUT _cluster/settings
{
  "persistent": {
    "cluster": {
      "remote": {
        "cluster_one": {
          "seeds": [
            "127.0.0.1:9300"
          ]
        },
        "cluster_two": {
          "seeds": [
            "127.0.0.1:9301"
          ]
        },
        "cluster_three": {
          "seeds": [
            "127.0.0.1:9302"
          ]
        }
      }
    }
  }
}</pre></div><div xmlns="" class="console_widget" data-snippet="snippets/1305.console"></div><p>To search the <code class="literal">twitter</code> index on remote cluster <code class="literal">cluster_one</code> the index name
must be prefixed with the cluster alias separated by a <code class="literal">:</code> character:</p><div xmlns="" class="pre_wrapper lang-console"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-console">GET /cluster_one:twitter/_search
{
  "query": {
    "match": {
      "user": "kimchy"
    }
  }
}</pre></div><div xmlns="" class="console_widget" data-snippet="snippets/1306.console"></div><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "took": 150,
  "timed_out": false,
  "_shards": {
    "total": 1,
    "successful": 1,
    "failed": 0,
    "skipped": 0
  },
  "_clusters": {
    "total": 1,
    "successful": 1,
    "skipped": 0
  },
  "hits": {
    "total": 1,
    "max_score": 1,
    "hits": [
      {
        "_index": "cluster_one:twitter",
        "_type": "_doc",
        "_id": "0",
        "_score": 1,
        "_source": {
          "user": "kimchy",
          "date": "2009-11-15T14:12:12",
          "message": "trying out Elasticsearch",
          "likes": 0
        }
      }
    ]
  }
}</pre></div><p>In contrast to the <code class="literal">tribe</code> feature cross cluster search can also search indices with the same name on different
clusters:</p><div xmlns="" class="pre_wrapper lang-console"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-console">GET /cluster_one:twitter,twitter/_search
{
  "query": {
    "match": {
      "user": "kimchy"
    }
  }
}</pre></div><div xmlns="" class="console_widget" data-snippet="snippets/1307.console"></div><p>Search results are disambiguated the same way as the indices are disambiguated in the request. Even if index names are
identical these indices will be treated as different indices when results are merged. All results retrieved from a
remote index
will be prefixed with their remote cluster name:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "took": 150,
  "timed_out": false,
  "_shards": {
    "total": 2,
    "successful": 2,
    "failed": 0,
    "skipped": 0
  },
  "_clusters": {
    "total": 2,
    "successful": 2,
    "skipped": 0
  },
  "hits": {
    "total": 2,
    "max_score": 1,
    "hits": [
      {
        "_index": "cluster_one:twitter",
        "_type": "_doc",
        "_id": "0",
        "_score": 1,
        "_source": {
          "user": "kimchy",
          "date": "2009-11-15T14:12:12",
          "message": "trying out Elasticsearch",
          "likes": 0
        }
      },
      {
        "_index": "twitter",
        "_type": "_doc",
        "_id": "0",
        "_score": 2,
        "_source": {
          "user": "kimchy",
          "date": "2009-11-15T14:12:12",
          "message": "trying out Elasticsearch",
          "likes": 0
        }
      }
    ]
  }
}</pre></div><h3><a id="_skipping_disconnected_clusters"></a>Skipping disconnected clusters<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/6.5/docs/reference/modules/cross-cluster-search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>By default all remote clusters that are searched via cross-cluster search need to be available when
the search request is executed, otherwise the whole request fails and no search results are returned
despite some of the clusters are available. Remote clusters can be made optional through the
boolean <code class="literal">skip_unavailable</code> setting, set to <code class="literal">false</code> by default.</p><div xmlns="" class="pre_wrapper lang-console"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-console">PUT _cluster/settings
{
  "persistent": {
    "cluster.remote.cluster_two.skip_unavailable": true <a id="CO388-1"></a><i xmlns="" class="conum" data-value="1"></i>
  }
}</pre></div><div xmlns="" class="console_widget" data-snippet="snippets/1308.console"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO388-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p><code class="literal">cluster_two</code> is made optional</p></td></tr></table></div><div xmlns="" class="pre_wrapper lang-console"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-console">GET /cluster_one:twitter,cluster_two:twitter,twitter/_search <a id="CO389-1"></a><i xmlns="" class="conum" data-value="1"></i>
{
  "query": {
    "match": {
      "user": "kimchy"
    }
  }
}</pre></div><div xmlns="" class="console_widget" data-snippet="snippets/1309.console"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO389-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>Search against the <code class="literal">twitter</code> index in <code class="literal">cluster_one</code>, <code class="literal">cluster_two</code> and also locally</p></td></tr></table></div><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "took": 150,
  "timed_out": false,
  "_shards": {
    "total": 2,
    "successful": 2,
    "failed": 0,
    "skipped": 0
  },
  "_clusters": { <a id="CO390-1"></a><i xmlns="" class="conum" data-value="1"></i>
    "total": 3,
    "successful": 2,
    "skipped": 1
  },
  "hits": {
    "total": 2,
    "max_score": 1,
    "hits": [
      {
        "_index": "cluster_one:twitter",
        "_type": "_doc",
        "_id": "0",
        "_score": 1,
        "_source": {
          "user": "kimchy",
          "date": "2009-11-15T14:12:12",
          "message": "trying out Elasticsearch",
          "likes": 0
        }
      },
      {
        "_index": "twitter",
        "_type": "_doc",
        "_id": "0",
        "_score": 2,
        "_source": {
          "user": "kimchy",
          "date": "2009-11-15T14:12:12",
          "message": "trying out Elasticsearch",
          "likes": 0
        }
      }
    ]
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO390-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>The <code class="literal">clusters</code> section indicates that one cluster was unavailable and got skipped</p></td></tr></table></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="modules-remote-clusters.html">
              « 
              Remote clusters</a>
           
        </span><span class="next">
           
          <a href="index-modules.html">Index Modules
               »
            </a></span></div></body></html>