<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Installing X-Pack in Elasticsearch
        | Elasticsearch Reference [6.1]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [6.1]" /><link rel="up" href="setup-xpack.html" title="Set up X-Pack" /><link rel="prev" href="setup-xpack.html" title="Set up X-Pack" /><link rel="next" href="configuring-monitoring.html" title="Configuring Monitoring in Elasticsearch" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.1" /><meta xmlns="" name="DC.subject" content="Elasticsearch" /><meta xmlns="" name="DC.identifier" content="6.1" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [6.1]
    </a></span> » <span class="breadcrumb-link"><a href="setup-xpack.html">Set up X-Pack</a></span> » <span class="breadcrumb-node">Installing X-Pack in Elasticsearch</span></div><div xmlns="" class="navheader"><span class="prev"><a href="setup-xpack.html">
              « 
              Set up X-Pack</a>
           
        </span><span class="next">
           
          <a href="configuring-monitoring.html">Configuring Monitoring in Elasticsearch
               »
            </a></span></div><div class="xpack chapter"><div class="titlepage"><div><div><h2 class="title"><a id="installing-xpack-es"></a>Installing X-Pack in Elasticsearch<a xmlns="" class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><p>After you install Elasticsearch, you can optionally obtain and install X-Pack.
For more information about how to obtain X-Pack,
see <a class="ulink" href="https://www.elastic.co/products/x-pack" target="_top">https://www.elastic.co/products/x-pack</a>.</p><p>You must run the version of X-Pack that matches the version of Elasticsearch you are
running. See the
<a class="ulink" href="https://www.elastic.co/support/matrix#matrix_compatibility" target="_top">Elastic Support Matrix</a>
for more information about product compatibility.</p><div xmlns="" class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">If you are installing X-Pack for the first time on an existing
cluster, you must perform a full cluster restart. Installing X-Pack enables
security and security must be enabled on ALL nodes in a cluster for the cluster
to operate correctly. When upgrading you can usually perform
a <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.1/rolling-upgrades.html" target="_top">rolling upgrade</a>.</p></div></div><p>The following diagram provides an overview of the steps that are required to
set up X-Pack on Elasticsearch:</p><div class="informalfigure"><div class="mediaobject"><img src="setup/images/ElasticsearchFlow.jpg" alt="Installation overview on Elasticsearch" /></div></div><p>To install X-Pack in Elasticsearch:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Optional: If you want to install X-Pack on a machine that doesn’t have
internet access:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">Manually download the X-Pack zip file:
<a class="ulink" href="https://artifacts.elastic.co/downloads/packs/x-pack/x-pack-6.1.4.zip" target="_top">
<code class="literal">https://artifacts.elastic.co/downloads/packs/x-pack/x-pack-6.1.4.zip</code></a>
(<a class="ulink" href="https://artifacts.elastic.co/downloads/packs/x-pack/x-pack-6.1.4.zip.sha512" target="_top">sha512</a>)</p><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">The plugins for Elasticsearch, Kibana, and Logstash are included in the same zip
file. If you have already downloaded this file to install X-Pack on one of
those other products, you can reuse the same file.</p></div></div></li><li class="listitem">Transfer the zip file to a temporary directory on the offline machine. (Do
NOT put the file in the Elasticsearch plugins directory.)</li></ol></div></li><li class="listitem"><p class="simpara">Run <code class="literal">bin/elasticsearch-plugin install</code> from <code class="literal">ES_HOME</code> on each node in your
cluster:</p><div xmlns="" class="pre_wrapper lang-shell"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-shell">bin/elasticsearch-plugin install x-pack</pre></div><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">If you are using a <a class="link" href="installing-xpack-es.html#xpack-package-installation" title="Installing X-Pack on a DEB/RPM Package Installation">DEB/RPM distribution</a>
      of Elasticsearch, run the installation with superuser permissions.</p></div></div><p class="simpara">The plugin install scripts require direct internet access to download and
install X-Pack. If your server doesn’t have internet access, specify the
location of the X-Pack zip file that you downloaded to a temporary directory.</p><div xmlns="" class="pre_wrapper lang-sh"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-sh">bin/elasticsearch-plugin install file:///path/to/file/x-pack-6.1.4.zip</pre></div><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">You must specify an absolute path to the zip file after the <code class="literal">file://</code> protocol.</p></div></div></li><li class="listitem"><p class="simpara">Confirm that you want to grant X-Pack additional permissions.</p><div xmlns="" class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">Specify the <code class="literal">--batch</code> option when running the install command to
      automatically grant these permissions and bypass these install prompts.</p></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">X-Pack needs these permissions to set the threat context loader during
install so Watcher can send email notifications.</p><div xmlns="" class="pre_wrapper lang-shell"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-shell">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@     WARNING: plugin requires additional permissions     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
* java.lang.RuntimePermission accessClassInPackage.com.sun.activation.registries
* java.lang.RuntimePermission getClassLoader
* java.lang.RuntimePermission setContextClassLoader
* java.lang.RuntimePermission setFactory
* java.security.SecurityPermission createPolicy.JavaPolicy
* java.security.SecurityPermission getPolicy
* java.security.SecurityPermission putProviderProperty.BC
* java.security.SecurityPermission setPolicy
* java.util.PropertyPermission * read,write
* java.util.PropertyPermission sun.nio.ch.bugLevel write
* javax.net.ssl.SSLPermission setHostnameVerifier
See http://docs.oracle.com/javase/8/docs/technotes/guides/security/permissions.html
for descriptions of what these permissions allow and the associated risks.

Continue with installation? [y/N]y</pre></div></li><li class="listitem"><p class="simpara">X-Pack requires permissions to enable Elasticsearch to launch the machine learning analytical
engine. The native controller ensures that the launched process is a valid
machine learning component. Once launched, communications between the machine learning processes and
Elasticsearch are limited to the operating system user that Elasticsearch runs as.</p><div xmlns="" class="pre_wrapper lang-shell"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-shell">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@        WARNING: plugin forks a native controller        @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
This plugin launches a native controller that is not subject to
the Java security manager nor to system call filters.

Continue with installation? [y/N]y</pre></div></li></ol></div></li><li class="listitem"><p class="simpara">X-Pack will try to automatically create a number of indices within Elasticsearch.
By default, Elasticsearch is configured to allow automatic index creation, and no
additional steps are required. However, if you have disabled automatic index
creation in Elasticsearch, you must configure
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.1/docs-index_.html#index-creation" target="_top"><code class="literal">action.auto_create_index</code></a> in
<code class="literal">elasticsearch.yml</code> to allow X-Pack to create the following indices:</p><div xmlns="" class="pre_wrapper lang-yaml"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">action.auto_create_index: .security,.monitoring*,.watches,.triggered_watches,.watcher-history*,.ml*</pre></div><div xmlns="" class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">If you are using <a class="ulink" href="https://www.elastic.co/products/logstash" target="_top">Logstash</a>
or <a class="ulink" href="https://www.elastic.co/products/beats" target="_top">Beats</a> then you will most likely
require additional index names in your <code class="literal">action.auto_create_index</code> setting, and
the exact value will depend on your local configuration. If you are unsure of
the correct value for your environment, you may consider setting the value to
 <code class="literal">*</code> which will allow automatic creation of all indices.</p></div></div></li><li class="listitem"><p class="simpara">Configure Transport Layer Security (TLS/SSL).</p><p class="simpara">If you have a non-trial license and you want to use X-Pack security, you must
configure TLS for internode-communication.</p><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">This requirement applies to clusters with more than one node and to
clusters with a single node that listens on an external interface. Single-node
clusters that use a loopback interface do not have this requirement.  For more
information, see
<a class="ulink" href="https://www.elastic.co/guide/en/x-pack/6.1/encrypting-communications.html" target="_top">Encrypting Communications</a>.</p></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><a class="link" href="configuring-tls.html#node-certificates" title="Generating Node Certificates">Generate node certificates for each of your Elasticsearch nodes</a>.</li><li class="listitem"><a class="link" href="configuring-tls.html#enable-ssl" title="Enabling TLS on Elasticsearch Nodes">Enable TLS on each Elasticsearch node</a>.</li></ol></div></li><li class="listitem"><p class="simpara">Start Elasticsearch.</p><div xmlns="" class="pre_wrapper lang-shell"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-shell">bin/elasticsearch</pre></div></li><li class="listitem"><p class="simpara">Set the passwords for all built-in users. The <code class="literal">setup-passwords</code> command is
the simplest method to set the built-in users' passwords for the first time.</p><p class="simpara">For example, you can run the command in an "interactive" mode, which prompts you
to enter new passwords for the <code class="literal">elastic</code>, <code class="literal">kibana</code>, and <code class="literal">logstash_system</code> users:</p><div xmlns="" class="pre_wrapper lang-shell"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-shell">bin/x-pack/setup-passwords interactive</pre></div><p class="simpara">For more information about the command options, see <a class="xref" href="setup-passwords.html" title="setup-passwords"><em>setup-passwords</em></a>.</p><div xmlns="" class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">The <code class="literal">setup-passwords</code> command uses a transient bootstrap password
that is no longer valid after the command runs successfully. You cannot run the
<code class="literal">setup-passwords</code> command a second time. Instead, you can update passwords from
the <span class="strong strong"><strong>Management &gt; Users</strong></span> UI in Kibana or use the security user API.</p></div></div><p class="simpara">For more information, see
<a class="ulink" href="https://www.elastic.co/guide/en/x-pack/6.1/setting-up-authentication.html#set-built-in-user-passwords" target="_top">Setting Built-in User Passwords</a>.</p></li><li class="listitem">Optional: <a class="link" href="setup-xpack-client.html" title="Configuring X-Pack Java Clients">Configure the Java Client</a>.</li><li class="listitem"><a class="ulink" href="https://www.elastic.co/guide/en/kibana/6.1/installing-xpack-kb.html" target="_top">Install X-Pack on Kibana</a>.</li><li class="listitem"><a class="ulink" href="http://www.elastic.co/guide/en/logstash/6.1/installing-xpack-log.html" target="_top">Install X-Pack on Logstash</a>.</li></ol></div><h3><a id="xpack-package-installation"></a>Installing X-Pack on a DEB/RPM Package Installation</h3><p>If you use the DEB/RPM packages to install Elasticsearch, by default Elasticsearch is installed
in <code class="literal">/usr/share/elasticsearch</code> and the configuration files are stored
in <code class="literal">/etc/elasticsearch</code>. (For the complete list of default paths, see
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.1/deb.html#deb-layout" target="_top">Debian Directory Layout</a> and
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.1/rpm.html#rpm-layout" target="_top">RPM Directory Layout</a> in the Elasticsearch Reference.)</p><p>To install X-Pack on a DEB/RPM package installation, you need to run
<code class="literal">bin/plugin install</code> from the <code class="literal">/usr/share/elasticsearch</code> directory with superuser
permissions:</p><div xmlns="" class="pre_wrapper lang-shell"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-shell">cd /usr/share/elasticsearch
sudo bin/elasticsearch-plugin install x-pack</pre></div><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">If the configuration files are not in <code class="literal">/etc/elasticsearch</code> you need to
      specify the location of the configuration files by setting the environment
      variable <code class="literal">ES_PATH_CONF</code> via <code class="literal">ES_PATH_CONF=&lt;path&gt;</code>.</p></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="setup-xpack.html">
              « 
              Set up X-Pack</a>
           
        </span><span class="next">
           
          <a href="configuring-monitoring.html">Configuring Monitoring in Elasticsearch
               »
            </a></span></div></body></html>