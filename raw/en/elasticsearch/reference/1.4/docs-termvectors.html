<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Term Vectors
        | Elasticsearch Reference [1.4]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [1.4]" /><link rel="up" href="docs.html" title="Document APIs" /><link rel="prev" href="docs-bulk-udp.html" title="Bulk UDP API" /><link rel="next" href="docs-multi-termvectors.html" title="Multi termvectors API" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Elasticsearch/Reference/1.4" /><meta xmlns="" name="DC.subject" content="Elasticsearch" /><meta xmlns="" name="DC.identifier" content="1.4" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [1.4]
    </a></span> » <span class="breadcrumb-link"><a href="docs.html">Document APIs</a></span> » <span class="breadcrumb-node">Term Vectors</span></div><div xmlns="" class="navheader"><span class="prev"><a href="docs-bulk-udp.html">
              « 
              Bulk UDP API</a>
           
        </span><span class="next">
           
          <a href="docs-multi-termvectors.html">Multi termvectors API
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="docs-termvectors"></a>Term Vectors<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.4/docs/reference/docs/termvectors.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Returns information and statistics on terms in the fields of a particular
document. The document could be stored in the index or artificially provided
by the user <span xmlns="" class="Admonishment">
      [<span class="Admonishment-version u-mono">1.4.0.Beta1</span>]
      <span class="Admonishment-detail">Added in 1.4.0.Beta1. </span></span>
. Note that for documents stored in the index, this
is a near realtime API as the term vectors are not available until the next
refresh.</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">curl -XGET 'http://localhost:9200/twitter/tweet/1/_termvector?pretty=true'</pre></div><p>Optionally, you can specify the fields for which the information is
retrieved either with a parameter in the url</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">curl -XGET 'http://localhost:9200/twitter/tweet/1/_termvector?fields=text,...'</pre></div><p>or by adding the requested fields in the request body (see
example below). Fields can also be specified with wildcards
in similar way to the <a class="link" href="query-dsl-multi-match-query.html" title="Multi Match Query">multi match query</a> <span xmlns="" class="Admonishment">
      [<span class="Admonishment-version u-mono">1.4.0.Beta1</span>]
      <span class="Admonishment-detail">Added in 1.4.0.Beta1. </span></span>
.</p><h3><a id="_return_values_2"></a>Return values<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.4/docs/reference/docs/termvectors.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Three types of values can be requested: <span class="emphasis"><em>term information</em></span>, <span class="emphasis"><em>term statistics</em></span>
and <span class="emphasis"><em>field statistics</em></span>. By default, all term information and field
statistics are returned for all fields but no term statistics.</p><h4><a id="_term_information"></a>Term information<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.4/docs/reference/docs/termvectors.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">term frequency in the field (always returned)</li><li class="listitem">term positions (<code class="literal">positions</code> : true)</li><li class="listitem">start and end offsets (<code class="literal">offsets</code> : true)</li><li class="listitem">term payloads (<code class="literal">payloads</code> : true), as base64 encoded bytes</li></ul></div><p>If the requested information wasn’t stored in the index, it will be
computed on the fly if possible. Additionally, term vectors could be computed
for documents not even existing in the index, but instead provided by the user.</p><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><h3>Added in 1.4.0.Beta1. </h3><p xmlns="http://www.w3.org/1999/xhtml">The ability to computed term vectors on the fly as well as support for artificial documents is only available from 1.4.0 onwards (see below example 2 and 3 respectively)</p></div></div><div xmlns="" class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">Start and end offsets assume UTF-16 encoding is being used. If you want to use
these offsets in order to get the original text that produced this token, you
should make sure that the string you are taking a sub-string of is also encoded
using UTF-16.</p></div></div><h4><a id="_term_statistics"></a>Term statistics<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.4/docs/reference/docs/termvectors.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Setting <code class="literal">term_statistics</code> to <code class="literal">true</code> (default is <code class="literal">false</code>) will
return</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">total term frequency (how often a term occurs in all documents)</li><li class="listitem">document frequency (the number of documents containing the current
term)</li></ul></div><p>By default these values are not returned since term statistics can
have a serious performance impact.</p><h4><a id="_field_statistics"></a>Field statistics<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.4/docs/reference/docs/termvectors.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Setting <code class="literal">field_statistics</code> to <code class="literal">false</code> (default is <code class="literal">true</code>) will
omit :</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">document count (how many documents contain this field)</li><li class="listitem">sum of document frequencies (the sum of document frequencies for all
terms in this field)</li><li class="listitem">sum of total term frequencies (the sum of total term frequencies of
each term in this field)</li></ul></div><h3><a id="_behaviour"></a>Behaviour<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.4/docs/reference/docs/termvectors.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The term and field statistics are not accurate. Deleted documents
are not taken into account. The information is only retrieved for the
shard the requested document resides in. The term and field statistics
are therefore only useful as relative measures whereas the absolute
numbers have no meaning in this context. By default, when requesting
term vectors of artificial documents, a shard to get the statistics from
is randomly selected. Use <code class="literal">routing</code> only to hit a particular shard.</p><div class="example"><a id="id-1.6.11.23"></a><p class="title"><strong>Example 1. Returning stored term vectors</strong></p><div class="example-contents"><p>First, we create an index that stores term vectors, payloads etc. :</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">curl -s -XPUT 'http://localhost:9200/twitter/' -d '{
  "mappings": {
    "tweet": {
      "properties": {
        "text": {
          "type": "string",
          "term_vector": "with_positions_offsets_payloads",
          "store" : true,
          "index_analyzer" : "fulltext_analyzer"
         },
         "fullname": {
          "type": "string",
          "term_vector": "with_positions_offsets_payloads",
          "index_analyzer" : "fulltext_analyzer"
        }
      }
    }
  },
  "settings" : {
    "index" : {
      "number_of_shards" : 1,
      "number_of_replicas" : 0
    },
    "analysis": {
      "analyzer": {
        "fulltext_analyzer": {
          "type": "custom",
          "tokenizer": "whitespace",
          "filter": [
            "lowercase",
            "type_as_payload"
          ]
        }
      }
    }
  }
}'</pre></div><p>Second, we add some documents:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">curl -XPUT 'http://localhost:9200/twitter/tweet/1?pretty=true' -d '{
  "fullname" : "John Doe",
  "text" : "twitter test test test "
}'

curl -XPUT 'http://localhost:9200/twitter/tweet/2?pretty=true' -d '{
  "fullname" : "Jane Doe",
  "text" : "Another twitter test ..."
}'</pre></div><p>The following request returns all information and statistics for field
<code class="literal">text</code> in document <code class="literal">1</code> (John Doe):</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">curl -XGET 'http://localhost:9200/twitter/tweet/1/_termvector?pretty=true' -d '{
  "fields" : ["text"],
  "offsets" : true,
  "payloads" : true,
  "positions" : true,
  "term_statistics" : true,
  "field_statistics" : true
}'</pre></div><p>Response:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
    "_id": "1",
    "_index": "twitter",
    "_type": "tweet",
    "_version": 1,
    "found": true,
    "term_vectors": {
        "text": {
            "field_statistics": {
                "doc_count": 2,
                "sum_doc_freq": 6,
                "sum_ttf": 8
            },
            "terms": {
                "test": {
                    "doc_freq": 2,
                    "term_freq": 3,
                    "tokens": [
                        {
                            "end_offset": 12,
                            "payload": "d29yZA==",
                            "position": 1,
                            "start_offset": 8
                        },
                        {
                            "end_offset": 17,
                            "payload": "d29yZA==",
                            "position": 2,
                            "start_offset": 13
                        },
                        {
                            "end_offset": 22,
                            "payload": "d29yZA==",
                            "position": 3,
                            "start_offset": 18
                        }
                    ],
                    "ttf": 4
                },
                "twitter": {
                    "doc_freq": 2,
                    "term_freq": 1,
                    "tokens": [
                        {
                            "end_offset": 7,
                            "payload": "d29yZA==",
                            "position": 0,
                            "start_offset": 0
                        }
                    ],
                    "ttf": 2
                }
            }
        }
    }
}</pre></div></div></div><div class="example"><a id="id-1.6.11.24"></a><p class="title"><strong>Example 2. Generating term vectors on the fly</strong></p><div class="example-contents"><p>Term vectors which are not explicitly stored in the index are automatically
computed on the fly <span xmlns="" class="Admonishment">
      [<span class="Admonishment-version u-mono">1.4.0.Beta1</span>]
      <span class="Admonishment-detail">Added in 1.4.0.Beta1. </span></span>
. The following request returns all information and statistics for the
fields in document <code class="literal">1</code>, even though the terms haven’t been explicitly stored in the index.
Note that for the field <code class="literal">text</code>, the terms are not re-generated.</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">curl -XGET 'http://localhost:9200/twitter/tweet/1/_termvector?pretty=true' -d '{
  "fields" : ["text", "some_field_without_term_vectors"],
  "offsets" : true,
  "positions" : true,
  "term_statistics" : true,
  "field_statistics" : true
}'</pre></div></div></div><div class="example"><a id="id-1.6.11.25"></a><p class="title"><strong>Example 3. Artificial documents</strong></p><div class="example-contents"><p>Additionally, term vectors can also be generated for artificial documents <span xmlns="" class="Admonishment">
      [<span class="Admonishment-version u-mono">1.4.0.Beta1</span>]
      <span class="Admonishment-detail">Added in 1.4.0.Beta1. </span></span>
,
that is for documents not present in the index. The syntax is similar to the
<a class="link" href="search-percolate.html" title="Percolator">percolator</a> API. For example, the following request would
return the same results as in example 1. The mapping used is determined by the
<code class="literal">index</code> and <code class="literal">type</code>.</p><p><span class="strong strong"><strong>If dynamic mapping is turned on (default), the document fields not in the original
mapping will be dynamically created.</strong></span></p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">curl -XGET 'http://localhost:9200/twitter/tweet/_termvector' -d '{
  "doc" : {
    "fullname" : "John Doe",
    "text" : "twitter test test test"
  }
}'</pre></div></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="docs-bulk-udp.html">
              « 
              Bulk UDP API</a>
           
        </span><span class="next">
           
          <a href="docs-multi-termvectors.html">Multi termvectors API
               »
            </a></span></div></body></html>