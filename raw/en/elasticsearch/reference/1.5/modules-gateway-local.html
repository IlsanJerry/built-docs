<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Local Gateway
        | Elasticsearch Reference [1.5]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [1.5]" /><link rel="up" href="modules-gateway.html" title="Gateway" /><link rel="prev" href="modules-gateway.html" title="Gateway" /><link rel="next" href="modules-http.html" title="HTTP" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Elasticsearch/Reference/1.5" /><meta xmlns="" name="DC.subject" content="Elasticsearch" /><meta xmlns="" name="DC.identifier" content="1.5" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [1.5]
    </a></span> » <span class="breadcrumb-link"><a href="modules.html">Modules</a></span> » <span class="breadcrumb-link"><a href="modules-gateway.html">Gateway</a></span> » <span class="breadcrumb-node">Local Gateway</span></div><div xmlns="" class="navheader"><span class="prev"><a href="modules-gateway.html">
              « 
              Gateway</a>
           
        </span><span class="next">
           
          <a href="modules-http.html">HTTP
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="modules-gateway-local"></a>Local Gateway<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.5/docs/reference/modules/gateway/local.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The local gateway allows for recovery of the full cluster state and
indices from the local storage of each node, and does not require a
common node level shared storage.</p><p>Note, different from shared gateway types, the persistency to the local
gateway is <span class="strong strong"><strong>not</strong></span> done in an async manner. Once an operation is
performed, the data is there for the local gateway to recover it in case
of full cluster failure.</p><p>It is important to configure the <code class="literal">gateway.recover_after_nodes</code> setting
to include most of the expected nodes to be started after a full cluster
restart. This will insure that the latest cluster state is recovered.
For example:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">gateway:
    recover_after_nodes: 3
    expected_nodes: 5</pre></div><h4><a id="_dangling_indices"></a>Dangling indices<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.5/docs/reference/modules/gateway/local.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>When a node joins the cluster, any shards/indices stored in its  local <code class="literal">data/</code>
directory which do not already exist in the cluster will be imported into the
cluster by default.  This functionality has two purposes:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">If a new master node is started which is unaware of the other indices in
the cluster, adding the old nodes will cause the old indices to be
imported, instead of being deleted.</li><li class="listitem">An old index can be added to an existing cluster by copying it to the
<code class="literal">data/</code> directory of a new node, starting the node and letting it join
the cluster. Once the index has been replicated to other nodes in the
cluster, the new node can be shut down and removed.</li></ol></div><p>The import of dangling indices can be controlled with the
<code class="literal">gateway.local.auto_import_dangled</code> which accepts:</p><div class="informaltable"><table cellpadding="4px" border="0"><colgroup><col /><col /></colgroup><tbody valign="top"><tr><td valign="top">
<p><code class="literal">yes</code></p>
</td><td valign="top">
<p>Import dangling indices into the cluster (default).</p>
</td></tr><tr><td valign="top">
<p><code class="literal">closed</code></p>
</td><td valign="top">
<p>Import dangling indices into the cluster state, but leave them closed.</p>
</td></tr><tr><td valign="top">
<p><code class="literal">no</code></p>
</td><td valign="top">
<p>Delete dangling indices after <code class="literal">gateway.local.dangling_timeout</code>, which
defaults to 2 hours.</p>
</td></tr></tbody></table></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="modules-gateway.html">
              « 
              Gateway</a>
           
        </span><span class="next">
           
          <a href="modules-http.html">HTTP
               »
            </a></span></div></body></html>