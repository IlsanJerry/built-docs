<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Global Aggregation
        | Elasticsearch Reference [1.7]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [1.7]" /><link rel="up" href="search-aggregations.html" title="Aggregations" /><link rel="prev" href="search-aggregations-metrics-scripted-metric-aggregation.html" title="Scripted Metric Aggregation" /><link rel="next" href="search-aggregations-bucket-filter-aggregation.html" title="Filter Aggregation" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/1.7" /><meta name="DC.subject" content="Elasticsearch" /><meta name="DC.identifier" content="1.7" /></head><body><div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [1.7]
    </a></span> » <span class="breadcrumb-link"><a href="search.html">Search APIs</a></span> » <span class="breadcrumb-link"><a href="search-aggregations.html">Aggregations</a></span> » <span class="breadcrumb-node">Global Aggregation</span></div><div class="navheader"><span class="prev"><a href="search-aggregations-metrics-scripted-metric-aggregation.html">
              « 
              Scripted Metric Aggregation</a>
           
        </span><span class="next">
           
          <a href="search-aggregations-bucket-filter-aggregation.html">Filter Aggregation
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="search-aggregations-bucket-global-aggregation"></a>Global Aggregation<a href="https://github.com/elastic/elasticsearch/edit/1.7/docs/reference/search/aggregations/bucket/global-aggregation.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Defines a single bucket of all the documents within the search execution context. This context is defined by the indices and the document types you’re searching on, but is <span class="strong strong"><strong>not</strong></span> influenced by the search query itself.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Global aggregators can only be placed as top level aggregators (it makes no sense to embed a global aggregator
        within another bucket aggregator)</p></div></div><p>Example:</p><div class="pre_wrapper lang-js"><pre class="programlisting prettyprint lang-js">{
    "query" : {
        "match" : { "title" : "shirt" }
    },
    "aggs" : {
        "all_products" : {
            "global" : {}, <a id="CO25-1"></a><i class="conum" data-value="1"></i>
            "aggs" : { <a id="CO25-2"></a><i class="conum" data-value="2"></i>
                "avg_price" : { "avg" : { "field" : "price" } }
            }
        }
    }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO25-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>The <code class="literal">global</code> aggregation has an empty body</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO25-2"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>The sub-aggregations that are registered for this <code class="literal">global</code> aggregation</p></td></tr></table></div><p>The above aggregation demonstrates how one would compute aggregations (<code class="literal">avg_price</code> in this example) on all the documents in the search context, regardless of the query (in our example, it will compute the average price over all products in our catalog, not just on the "shirts").</p><p>The response for the above aggregation:</p><div class="pre_wrapper lang-js"><pre class="programlisting prettyprint lang-js">{
    ...

    "aggregations" : {
        "all_products" : {
            "doc_count" : 100, <a id="CO26-1"></a><i class="conum" data-value="1"></i>
            "avg_price" : {
                "value" : 56.3
            }
        }
    }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO26-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>The number of documents that were aggregated (in our case, all documents within the search context)</p></td></tr></table></div></div><div class="navfooter"><span class="prev"><a href="search-aggregations-metrics-scripted-metric-aggregation.html">
              « 
              Scripted Metric Aggregation</a>
           
        </span><span class="next">
           
          <a href="search-aggregations-bucket-filter-aggregation.html">Filter Aggregation
               »
            </a></span></div></body></html>
