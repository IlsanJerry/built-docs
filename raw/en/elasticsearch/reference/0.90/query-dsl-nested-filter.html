<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Nested Filter
        | Reference [0.90]
      | Elastic
    </title><link rel="home" href="index.html" title="Reference [0.90]" /><link rel="up" href="query-dsl-filters.html" title="Filters" /><link rel="prev" href="query-dsl-missing-filter.html" title="Missing Filter" /><link rel="next" href="query-dsl-not-filter.html" title="Not Filter" /><meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/0.90" /><meta name="DC.subject" content="Elasticsearch" /><meta name="DC.identifier" content="0.90" /></head><body><div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Reference
      [0.90]
    </a></span> » <span class="breadcrumb-link"><a href="query-dsl.html">Query DSL</a></span> » <span class="breadcrumb-link"><a href="query-dsl-filters.html">Filters</a></span> » <span class="breadcrumb-node">Nested Filter</span></div><div class="navheader"><span class="prev"><a href="query-dsl-missing-filter.html">
              « 
              Missing Filter</a>
           
        </span><span class="next">
           
          <a href="query-dsl-not-filter.html">Not Filter
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="query-dsl-nested-filter"></a>Nested Filter<a href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/filters/nested-filter.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>A <code class="literal">nested</code> filter works in a similar fashion to the
<a class="link" href="query-dsl-nested-query.html" title="Nested Query">nested</a> query, except it’s
used as a filter. It follows exactly the same structure, but also allows
to cache the results (set <code class="literal">_cache</code> to <code class="literal">true</code>), and have it named (set
the <code class="literal">_name</code> value). For example:</p><div class="pre_wrapper lang-js"><pre class="programlisting prettyprint lang-js">{
    "filtered" : {
        "query" : { "match_all" : {} },
        "filter" : {
            "nested" : {
                "path" : "obj1",
                "filter" : {
                    "bool" : {
                        "must" : [
                            {
                                "term" : {"obj1.name" : "blue"}
                            },
                            {
                                "range" : {"obj1.count" : {"gt" : 5}}
                            }
                        ]
                    }
                },
                "_cache" : true
            }
        }
    }
}</pre></div><h4><a id="_join_option"></a>Join option<a href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/filters/nested-filter.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The nested filter also supports a <code class="literal">join</code> option which controls whether to perform the block join or not.
By default, it’s enabled. But when it’s disabled, it emits the hidden nested documents as hits instead of the joined root document.</p><p>This is useful when a <code class="literal">nested</code> filter is used in a facet where nested is enabled, like you can see in the example below:</p><div class="pre_wrapper lang-js"><pre class="programlisting prettyprint lang-js">{
    "query" : {
		"nested" : {
			"path" : "offers",
			"query" : {
				"match" : {
					"offers.color" : "blue"
				}
			}
		}
	},
	"facets" : {
		"size" : {
			"terms" : {
				"field" : "offers.size"
			},
			"facet_filter" : {
				"nested" : {
					"path" : "offers",
					"query" : {
						"match" : {
							"offers.color" : "blue"
						}
					},
					"join" : false
				}
			},
			"nested" : "offers"
		}
	}
}'</pre></div></div><div class="navfooter"><span class="prev"><a href="query-dsl-missing-filter.html">
              « 
              Missing Filter</a>
           
        </span><span class="next">
           
          <a href="query-dsl-not-filter.html">Not Filter
               »
            </a></span></div></body></html>
