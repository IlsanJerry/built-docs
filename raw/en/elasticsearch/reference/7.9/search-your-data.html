<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Search your data | Elasticsearch Reference [7.9] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [7.9]"/>
<link rel="up" href="index.html" title="Elasticsearch Reference [7.9]"/>
<link rel="prev" href="data-streams-change-mappings-and-settings.html" title="Change mappings and settings for a data stream"/>
<link rel="next" href="collapse-search-results.html" title="Collapse search results"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/7.9"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="7.9"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [7.9]</a></span>
»
<span class="breadcrumb-node">Search your data</span>
</div>
<div class="navheader">
<span class="prev">
<a href="data-streams-change-mappings-and-settings.html">« Change mappings and settings for a data stream</a>
</span>
<span class="next">
<a href="collapse-search-results.html">Collapse search results »</a>
</span>
</div>
<div class="part">
<div class="titlepage"><div><div>
<h1 class="title"><a id="search-your-data"></a>Search your data<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/search/search-your-data.asciidoc">edit</a></h1>
</div></div></div>
<div class="openblock partintro">
<div class="content">
<p><a id="search-query"></a>A <em>search query</em>, or <em>query</em>, is a request for information about data in
Elasticsearch data streams or indices.</p>
<p>You can think of a query as a question, written in a way Elasticsearch understands.
Depending on your data, you can use a query to get answers to questions like:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
What processes on my server take longer than 500 milliseconds to respond?
</li>
<li class="listitem">
What users on my network ran <code class="literal">regsvr32.exe</code> within the last week?
</li>
<li class="listitem">
What pages on my website contain a specific word or phrase?
</li>
</ul>
</div>
<p>A <em>search</em> consists of one or more queries that are combined and sent to Elasticsearch.
Documents that match a search&#8217;s queries are returned in the <em>hits</em>, or
<em>search results</em>, of the response.</p>
<p>A search may also contain additional information used to better process its
queries. For example, a search may be limited to a specific index or only return
a specific number of results.</p>
<h2><a id="run-an-es-search"></a>Run a search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/search/search-your-data.asciidoc">edit</a></h2>
<p>You can use the <a class="xref" href="search-search.html" title="Search API">search API</a> to search data stored in
Elasticsearch data streams or indices.</p>
<p>The API can run two types of searches, depending on how you provide
queries:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="search-your-data.html#run-uri-search" title="Run a URI search">URI searches</a>
</span>
</dt>
<dd>
Queries are provided through a query parameter. URI searches tend to be
simpler and best suited for testing.
</dd>
<dt>
<span class="term">
<a class="xref" href="search-your-data.html#run-request-body-search" title="Run a request body search">Request body searches</a>
</span>
</dt>
<dd>
Queries are provided through the JSON body of the API request. These queries
are written in <a class="xref" href="query-dsl.html" title="Query DSL">Query DSL</a>. We recommend using request body
searches in most production use cases.
</dd>
</dl>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you specify a query in both the URI and request body, the search API request
runs only the URI query.</p>
</div>
</div>
<h3><a id="run-uri-search"></a>Run a URI search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/search/search-your-data.asciidoc">edit</a></h3>
<p>You can use the search API&#8217;s <a class="xref" href="search-search.html#search-api-query-params-q"><code class="literal">q</code> query string
parameter</a> to run a search in the request&#8217;s URI. The <code class="literal">q</code> parameter only accepts
queries written in Lucene&#8217;s <a class="xref" href="query-dsl-query-string-query.html#query-string-syntax" title="Query string syntax">query string syntax</a>.</p>
<p>The following URI search matches documents with a <code class="literal">user.id</code> value of <code class="literal">kimchy</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my-index-000001/_search?q=user.id:kimchy</pre>
</div>
<div class="console_widget" data-snippet="snippets/127.console"></div>
<p>The API returns the following response.</p>
<p>By default, the <code class="literal">hits.hits</code> property returns the top 10 documents matching the
query. To retrieve more documents, see <a class="xref" href="paginate-search-results.html" title="Paginate search results"><em>Paginate search results</em></a>.</p>
<p>The response sorts documents in <code class="literal">hits.hits</code> by <code class="literal">_score</code>, a
<a class="xref" href="query-filter-context.html#relevance-scores" title="Relevance scores">relevance score</a> that measures how well each document
matches the query.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "took": 5,
  "timed_out": false,
  "_shards": {
    "total": 1,
    "successful": 1,
    "skipped": 0,
    "failed": 0
  },
  "hits": {
    "total": {
      "value": 1,
      "relation": "eq"
    },
    "max_score": 1.3862942,
    "hits": [
      {
        "_index": "my-index-000001",
        "_type": "_doc",
        "_id": "kxWFcnMByiguvud1Z8vC",
        "_score": 1.3862942,
        "_source": {
          "@timestamp": "2099-11-15T14:12:12",
          "http": {
            "request": {
              "method": "get"
            },
            "response": {
              "bytes": 1070000,
              "status_code": 200
            },
            "version": "1.1"
          },
          "message": "GET /search HTTP/1.1 200 1070000",
          "source": {
            "ip": "127.0.0.1"
          },
          "user": {
            "id": "kimchy"
          }
        }
      }
    ]
  }
}</pre>
</div>
<h3><a id="run-request-body-search"></a>Run a request body search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/search/search-your-data.asciidoc">edit</a></h3>
<p>You can use the search API&#8217;s <a class="xref" href="search-search.html#request-body-search-query"><code class="literal">query</code> request
body parameter</a> to provide a query as a JSON object, written in
<a class="xref" href="query-dsl.html" title="Query DSL">Query DSL</a>.</p>
<p>The following request body search uses the <a class="xref" href="query-dsl-match-query.html" title="Match query"><code class="literal">match</code></a>
query to match documents with a <code class="literal">user.id</code> value of <code class="literal">kimchy</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my-index-000001/_search
{
  "query": {
    "match": {
      "user.id": "kimchy"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/128.console"></div>
<h3><a id="search-multiple-indices"></a>Search multiple data streams and indices<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/search/search-your-data.asciidoc">edit</a></h3>
<p>To search multiple data streams and indices, add them as comma-separated values
in the search API request path.</p>
<p>The following request searches the <code class="literal">my-index-000001</code> and <code class="literal">my-index-000002</code>
indices.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my-index-000001,my-index-000002/_search
{
  "query": {
    "match": {
      "user.id": "kimchy"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/129.console"></div>
<p>You can also search multiple data streams and indices using a wildcard (<code class="literal">*</code>)
pattern.</p>
<p>The following request targets the wildcard pattern <code class="literal">my-index-*</code>. The request
searches any data streams or indices in the cluster that start with <code class="literal">my-index-</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my-index-*/_search
{
  "query": {
    "match": {
      "user.id": "kimchy"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/130.console"></div>
<p>To search all data streams and indices in a cluster, omit the target from the
request path. Alternatively, you can use <code class="literal">_all</code> or <code class="literal">*</code>.</p>
<p>The following requests are equivalent and search all data streams and indices in the cluster.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_search
{
  "query": {
    "match": {
      "user.id": "kimchy"
    }
  }
}

GET /_all/_search
{
  "query": {
    "match": {
      "user.id": "kimchy"
    }
  }
}

GET /*/_search
{
  "query": {
    "match": {
      "user.id": "kimchy"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/131.console"></div>
<h3><a id="search-fields"></a>Retrieve selected fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/search/search-fields.asciidoc">edit</a></h3>
<p>By default, each hit in the search response includes the document
<a class="xref" href="mapping-source-field.html" title="_source field"><code class="literal">_source</code></a>, which is the entire JSON object that was
provided when indexing the document. If you only need certain source fields in
the search response, you can use the <a class="xref" href="search-your-data.html#source-filtering" title="Source filtering">source filtering</a> to
restrict what parts of the source are returned.</p>
<p>Returning fields using only the document source has some limitations:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">_source</code> field does not include <a class="xref" href="multi-fields.html" title="fields">multi-fields</a> or
<a class="xref" href="alias.html" title="Alias data type">field aliases</a>. Likewise, a field in the source does not contain
values copied using the <a class="xref" href="copy-to.html" title="copy_to"><code class="literal">copy_to</code></a> mapping parameter.
</li>
<li class="listitem">
Since the <code class="literal">_source</code> is stored as a single field in Lucene, the whole source
object must be loaded and parsed, even if only a small number of fields are
needed.
</li>
</ul>
</div>
<p>To avoid these limitations, you can:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use the <a class="xref" href="search-your-data.html#docvalue-fields" title="Doc value fields"><code class="literal">docvalue_fields</code></a>
parameter to get values for selected fields. This can be a good
choice when returning a fairly small number of fields that support doc values,
such as keywords and dates.
</li>
<li class="listitem">
Use the <a class="xref" href="search-request-body.html#request-body-search-stored-fields" title="Stored Fields"><code class="literal">stored_fields</code></a> parameter to get the values for specific  stored fields. (Fields that use the <a class="xref" href="mapping-store.html" title="store"><code class="literal">store</code></a> mapping option.)
</li>
</ul>
</div>
<p>You can find more detailed information on each of these methods in the
following sections:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="search-your-data.html#source-filtering" title="Source filtering">Source filtering</a>
</li>
<li class="listitem">
<a class="xref" href="search-your-data.html#docvalue-fields" title="Doc value fields">Doc value fields</a>
</li>
<li class="listitem">
<a class="xref" href="search-your-data.html#stored-fields" title="Stored fields">Stored fields</a>
</li>
</ul>
</div>
<h3><a id="source-filtering"></a>Source filtering<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/search/search-fields.asciidoc">edit</a></h3>
<p>You can use the <code class="literal">_source</code> parameter to select what fields of the source are
returned. This is called <em>source filtering</em>.</p>
<p>The following search API request sets the <code class="literal">_source</code> request body parameter to
<code class="literal">false</code>. The document source is not included in the response.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_search
{
  "_source": false,
  "query": {
    "match": {
      "user.id": "kimchy"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/132.console"></div>
<p>To return only a subset of source fields, specify a wildcard (<code class="literal">*</code>) pattern in
the <code class="literal">_source</code> parameter. The following search API request returns the source for
only the <code class="literal">obj</code> field and its properties.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_search
{
  "_source": "obj.*",
  "query": {
    "match": {
      "user.id": "kimchy"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/133.console"></div>
<p>You can also specify an array of wildcard patterns in the <code class="literal">_source</code> field. The
following search API request returns the source for only the <code class="literal">obj1</code> and
<code class="literal">obj2</code> fields and their properties.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_search
{
  "_source": [ "obj1.*", "obj2.*" ],
  "query": {
    "match": {
      "user.id": "kimchy"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/134.console"></div>
<p>For finer control, you can specify an object containing arrays of <code class="literal">includes</code> and
<code class="literal">excludes</code> patterns in the <code class="literal">_source</code> parameter.</p>
<p>If the <code class="literal">includes</code> property is specified, only source fields that match one of
its patterns are returned. You can exclude fields from this subset using the
<code class="literal">excludes</code> property.</p>
<p>If the <code class="literal">includes</code> property is not specified, the entire document source is
returned, excluding any fields that match a pattern in the <code class="literal">excludes</code> property.</p>
<p>The following search API request returns the source for only the <code class="literal">obj1</code> and
<code class="literal">obj2</code> fields and their properties, excluding any child <code class="literal">description</code> fields.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_search
{
  "_source": {
    "includes": [ "obj1.*", "obj2.*" ],
    "excludes": [ "*.description" ]
  },
  "query": {
    "term": {
      "user.id": "kimchy"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/135.console"></div>
<h3><a id="docvalue-fields"></a>Doc value fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/search/search-fields.asciidoc">edit</a></h3>
<p>You can use the <a class="xref" href="search-your-data.html#docvalue-fields" title="Doc value fields"><code class="literal">docvalue_fields</code></a> parameter to return
<a class="xref" href="doc-values.html" title="doc_values">doc values</a> for one or more fields in the search response.</p>
<p>Doc values store the same values as the <code class="literal">_source</code> but in an on-disk,
column-based structure that&#8217;s optimized for sorting and aggregations. Since each
field is stored separately, Elasticsearch only reads the field values that were requested
and can avoid loading the whole document <code class="literal">_source</code>.</p>
<p>Doc values are stored for supported fields by default. However, doc values are
not supported for <a class="xref" href="text.html" title="Text data type"><code class="literal">text</code></a> or
<a href="/guide/en/elasticsearch/plugins/7.9/mapper-annotated-text-usage.html" class="ulink" target="_top"><code class="literal">text_annotated</code></a> fields.</p>
<p>The following search request uses the <code class="literal">docvalue_fields</code> parameter to
retrieve doc values for the following fields:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fields with names starting with <code class="literal">my_ip</code>
</li>
<li class="listitem">
<code class="literal">my_keyword_field</code>
</li>
<li class="listitem">
Fields with names ending with <code class="literal">_date_field</code>
</li>
</ul>
</div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_search
{
  "query": {
    "match_all": {}
  },
  "docvalue_fields": [
    "my_ip*",                     <a id="CO26-1"></a><i class="conum" data-value="1"></i>
    {
      "field": "my_keyword_field" <a id="CO26-2"></a><i class="conum" data-value="2"></i>
    },
    {
      "field": "*_date_field",
      "format": "epoch_millis"    <a id="CO26-3"></a><i class="conum" data-value="3"></i>
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/136.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO26-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Wildcard patten used to match field names, specified as a string.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO26-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Wildcard patten used to match field names, specified as an object.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO26-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>With the object notation, you can use the <code class="literal">format</code> parameter to specify a
format for the field&#8217;s returned doc values. <a class="xref" href="date.html" title="Date data type">Date fields</a> support a
<a class="xref" href="mapping-date-format.html" title="format">date <code class="literal">format</code></a>. <a class="xref" href="number.html" title="Numeric data types">Numeric fields</a> support a
<a href="https://docs.oracle.com/javase/8/docs/api/java/text/DecimalFormat.html" class="ulink" target="_top">DecimalFormat
pattern</a>. Other field data types do not support the <code class="literal">format</code> parameter.</p>
</td>
</tr>
</table>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You cannot use the <code class="literal">docvalue_fields</code> parameter to retrieve doc values for
nested objects. If you specify a nested object, the search returns an empty
array (<code class="literal">[ ]</code>) for the field. To access nested fields, use the
<a class="xref" href="search-request-body.html#request-body-search-inner-hits" title="Inner hits"><code class="literal">inner_hits</code></a> parameter&#8217;s <code class="literal">docvalue_fields</code>
property.</p>
</div>
</div>
<h3><a id="stored-fields"></a>Stored fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/search/search-fields.asciidoc">edit</a></h3>
<p>It&#8217;s also possible to store an individual field&#8217;s values by using the
<a class="xref" href="mapping-store.html" title="store"><code class="literal">store</code></a> mapping option. You can use the
<a class="xref" href="search-request-body.html#request-body-search-stored-fields" title="Stored Fields"><code class="literal">stored_fields</code></a> parameter to include
these stored values in the search response.</p>
</div>
</div>







</div>
<div class="navfooter">
<span class="prev">
<a href="data-streams-change-mappings-and-settings.html">« Change mappings and settings for a data stream</a>
</span>
<span class="next">
<a href="collapse-search-results.html">Collapse search results »</a>
</span>
</div>
</div>
</body>
</html>
