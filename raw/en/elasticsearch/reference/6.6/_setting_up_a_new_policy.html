<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Setting up a new policy
        | Elasticsearch Reference [6.6]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [6.6]" /><link rel="up" href="getting-started-index-lifecycle-management.html" title="Getting started with index lifecycle management" /><link rel="prev" href="getting-started-index-lifecycle-management.html" title="Getting started with index lifecycle management" /><link rel="next" href="_applying_a_policy_to_our_index.html" title="Applying a policy to our index" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.6" /><meta name="DC.subject" content="Elasticsearch" /><meta name="DC.identifier" content="6.6" /></head><body><div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [6.6]
    </a></span> » <span class="breadcrumb-link"><a href="index-lifecycle-management.html">Managing the index lifecycle</a></span> » <span class="breadcrumb-link"><a href="getting-started-index-lifecycle-management.html">Getting started with index lifecycle management</a></span> » <span class="breadcrumb-node">Setting up a new policy</span></div><div class="navheader"><span class="prev"><a href="getting-started-index-lifecycle-management.html">
              « 
              Getting started with index lifecycle management</a>
           
        </span><span class="next">
           
          <a href="_applying_a_policy_to_our_index.html">Applying a policy to our index
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_setting_up_a_new_policy"></a>Setting up a new policy<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/ilm/getting-started-ilm.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p></div></div><p>There are many new features introduced by ILM, but we will only focus on
a few that are needed for our example. For starters, we will use the
<a class="link" href="ilm-put-lifecycle.html" title="Create lifecycle policy API">Put Policy</a> API to define our first policy. Lifecycle
policies are defined in JSON and include specific
<a class="link" href="ilm-policy-definition.html" title="Policy phases and actions">phases and actions</a>.</p><div class="pre_wrapper lang-console"><pre class="programlisting prettyprint lang-console">PUT _ilm/policy/datastream_policy   <a id="CO402-1"></a><i class="conum" data-value="1"></i>
{
  "policy": {                       <a id="CO402-2"></a><i class="conum" data-value="2"></i>
    "phases": {
      "hot": {                      <a id="CO402-3"></a><i class="conum" data-value="3"></i>
        "actions": {
          "rollover": {             <a id="CO402-4"></a><i class="conum" data-value="4"></i>
            "max_size": "50GB",
            "max_age": "30d"
          }
        }
      },
      "delete": {
        "min_age": "90d",           <a id="CO402-5"></a><i class="conum" data-value="5"></i>
        "actions": {
          "delete": {}              <a id="CO402-6"></a><i class="conum" data-value="6"></i>
        }
      }
    }
  }
}</pre></div><div class="console_widget" data-snippet="snippets/1377.console"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO402-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>call to the <a class="link" href="ilm-put-lifecycle.html" title="Create lifecycle policy API">put lifecycle API</a> endpoint to create
a new policy named "datastream_policy"</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO402-2"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>policy definition sub-object</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO402-3"><i class="conum" data-value="3"></i></a> </p></td><td valign="top" align="left"><p>the hot phase defined in the "phases" section. Optional <code class="literal">min_age</code> field
not defined — defaults to <code class="literal">0ms</code></p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO402-4"><i class="conum" data-value="4"></i></a> </p></td><td valign="top" align="left"><p>rollover action definition</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO402-5"><i class="conum" data-value="5"></i></a> </p></td><td valign="top" align="left"><p>delete phase begins after 90 days</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO402-6"><i class="conum" data-value="6"></i></a> </p></td><td valign="top" align="left"><p>delete action definition</p></td></tr></table></div><p>Here we created the policy called <code class="literal">datastream_policy</code> which rolls over
the index being written to after it reaches 50 gigabytes, or it is 30
days old. The rollover will occur when either of these conditions is true.
The index will be deleted 90 days after it is rolled over.</p></div><div class="navfooter"><span class="prev"><a href="getting-started-index-lifecycle-management.html">
              « 
              Getting started with index lifecycle management</a>
           
        </span><span class="next">
           
          <a href="_applying_a_policy_to_our_index.html">Applying a policy to our index
               »
            </a></span></div></body></html>
