<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Stop rollup job API
        | Elasticsearch Reference [6.6]
      | Elastic
    </title><link rel="home" href="index.html" title="Elasticsearch Reference [6.6]" /><link rel="up" href="rollup-apis.html" title="Rollup APIs" /><link rel="prev" href="rollup-start-job.html" title="Start rollup job API" /><link rel="next" href="rollup-get-rollup-caps.html" title="Get rollup job capabilities API" /><meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.6" /><meta name="DC.subject" content="Elasticsearch" /><meta name="DC.identifier" content="6.6" /></head><body><div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [6.6]
    </a></span> » <span class="breadcrumb-link"><a href="xpack-api.html">X-Pack APIs</a></span> » <span class="breadcrumb-link"><a href="rollup-apis.html">Rollup APIs</a></span> » <span class="breadcrumb-node">Stop rollup job API</span></div><div class="navheader"><span class="prev"><a href="rollup-start-job.html">
              « 
              Start rollup job API</a>
           
        </span><span class="next">
           
          <a href="rollup-get-rollup-caps.html">Get rollup job capabilities API
               »
            </a></span></div><div class="xpack section"><div class="titlepage"><div><div><h2 class="title"><a id="rollup-stop-job"></a>Stop rollup job API<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/rollup/apis/stop-job.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>This functionality is experimental and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but experimental features are not subject to the support SLA of official GA features.</p></div></div><p>This API stops an existing, started rollup job.  If the job does not exist an exception will be thrown.
Stopping an already stopped job has no action.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_request_77"></a>Request<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/rollup/apis/stop-job.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><code class="literal">POST _xpack/rollup/job/&lt;job_id&gt;/_stop</code></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_path_parameters_60"></a>Path Parameters<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/rollup/apis/stop-job.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">job_id</code> (required)</span></dt><dd>(string) Identifier for the job</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_query_parameters_8"></a>Query Parameters<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/rollup/apis/stop-job.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">wait_for_completion</code> (optional)</span></dt><dd>(boolean) if set to true, causes the API to block until the indexer state completely stops.  If set to false, the
API returns immediately and the indexer will be stopped asynchronously in the background.  Defaults to <code class="literal">false</code>.</dd><dt><span class="term"><code class="literal">timeout</code> (optional)</span></dt><dd>(TimeValue) if <code class="literal">wait_for_completion=true</code>, the API will block for (at maximum)
the specified duration while waiting for the job to stop. If more than <code class="literal">timeout</code> time has passed, the API
will throw a timeout exception.  Note: even if a timeout exception is thrown, the stop request is still processing and
will eventually move the job to <code class="literal">STOPPED</code>.  The timeout simply means the API call itself timed out while waiting
for the status change.  Defaults to <code class="literal">30s</code></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_request_body_35"></a>Request Body<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/rollup/apis/stop-job.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>There is no request body for the Stop Job API.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_authorization_71"></a>Authorization<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/rollup/apis/stop-job.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You must have <code class="literal">manage</code> or <code class="literal">manage_rollup</code> cluster privileges to use this API.
For more information, see
<a class="ulink" href="https://www.elastic.co/guide/en/elastic-stack-overview/6.6/security-privileges.html" target="_top">Security Privileges</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_examples_73"></a>Examples<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/rollup/apis/stop-job.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>If we have an already-started rollup job named <code class="literal">sensor</code>, it can be stopped with:</p><div class="pre_wrapper lang-console"><pre class="programlisting prettyprint lang-console">POST _xpack/rollup/job/sensor/_stop</pre></div><div class="console_widget" data-snippet="snippets/1585.console"></div><p>Which will return the response:</p><div class="pre_wrapper lang-js"><pre class="programlisting prettyprint lang-js">{
  "stopped": true
}</pre></div><p>If however we try to stop a job which doesn’t exist:</p><div class="pre_wrapper lang-console"><pre class="programlisting prettyprint lang-console">POST _xpack/rollup/job/does_not_exist/_stop</pre></div><div class="console_widget" data-snippet="snippets/1586.console"></div><p>A 404 <code class="literal">resource_not_found</code> exception will be thrown:</p><div class="pre_wrapper lang-js"><pre class="programlisting prettyprint lang-js">{
    "error" : {
        "root_cause" : [
            {
                "type" : "resource_not_found_exception",
                "reason" : "Task for Rollup Job [does_not_exist] not found",
                "stack_trace": ...
            }
        ],
        "type" : "resource_not_found_exception",
        "reason" : "Task for Rollup Job [does_not_exist] not found",
        "stack_trace": ...
    },
    "status": 404
}</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_waiting_for_the_job_to_stop"></a>Waiting for the job to stop<a href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/rollup/apis/stop-job.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>Since only a stopped job can be deleted, it can be useful to block the StopJob API until the indexer has fully
stopped.  This is accomplished with the <code class="literal">wait_for_completion</code> query parameter, and optionally a <code class="literal">timeout</code>:</p><div class="pre_wrapper lang-console"><pre class="programlisting prettyprint lang-console">POST _xpack/rollup/job/sensor/_stop?wait_for_completion=true&amp;timeout=10s</pre></div><div class="console_widget" data-snippet="snippets/1587.console"></div><p>The parameter will block the API call from returning until either the job has moved to <code class="literal">STOPPED</code>, or the specified
time has elapsed.  If the specified time elapses without the job moving to <code class="literal">STOPPED</code>, a timeout exception will be thrown.</p><p>If <code class="literal">wait_for_completion=true</code> is specified without a <code class="literal">timeout</code>, a default timeout of 30 seconds is used.</p></div></div></div><div class="navfooter"><span class="prev"><a href="rollup-start-job.html">
              « 
              Start rollup job API</a>
           
        </span><span class="next">
           
          <a href="rollup-get-rollup-caps.html">Get rollup job capabilities API
               »
            </a></span></div></body></html>
