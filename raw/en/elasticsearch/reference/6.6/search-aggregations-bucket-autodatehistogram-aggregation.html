<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Auto-interval Date Histogram Aggregation
        | Elasticsearch Reference [6.6]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [6.6]" /><link rel="up" href="search-aggregations-bucket.html" title="Bucket Aggregations" /><link rel="prev" href="search-aggregations-bucket-adjacency-matrix-aggregation.html" title="Adjacency Matrix Aggregation" /><link rel="next" href="_intervals.html" title="Intervals" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.6" /><meta xmlns="" name="DC.subject" content="Elasticsearch" /><meta xmlns="" name="DC.identifier" content="6.6" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [6.6]
    </a></span> » <span class="breadcrumb-link"><a href="search-aggregations.html">Aggregations</a></span> » <span class="breadcrumb-link"><a href="search-aggregations-bucket.html">Bucket Aggregations</a></span> » <span class="breadcrumb-node">Auto-interval Date Histogram Aggregation</span></div><div xmlns="" class="navheader"><span class="prev"><a href="search-aggregations-bucket-adjacency-matrix-aggregation.html">
              « 
              Adjacency Matrix Aggregation</a>
           
        </span><span class="next">
           
          <a href="_intervals.html">Intervals
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="search-aggregations-bucket-autodatehistogram-aggregation"></a>Auto-interval Date Histogram Aggregation<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/aggregations/bucket/autodatehistogram-aggregation.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>A multi-bucket aggregation similar to the <a class="xref" href="search-aggregations-bucket-datehistogram-aggregation.html" title="Date Histogram Aggregation">Date Histogram Aggregation</a> except
instead of providing an interval to use as the width of each bucket, a target number of buckets is provided
indicating the number of buckets needed and the interval of the buckets is automatically chosen to best achieve
that target. The number of buckets returned will always be less than or equal to this target number.</p><p>The buckets field is optional, and will default to 10 buckets if not specified.</p><p>Requesting a target of 10 buckets.</p><div xmlns="" class="pre_wrapper lang-console"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-console">POST /sales/_search?size=0
{
    "aggs" : {
        "sales_over_time" : {
            "auto_date_histogram" : {
                "field" : "date",
                "buckets" : 10
            }
        }
    }
}</pre></div><div xmlns="" class="console_widget" data-snippet="snippets/446.console"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_keys"></a>Keys<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/aggregations/bucket/autodatehistogram-aggregation.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Internally, a date is represented as a 64 bit number representing a timestamp
in milliseconds-since-the-epoch. These timestamps are returned as the bucket
<code class="literal">key</code>s. The <code class="literal">key_as_string</code> is the same timestamp converted to a formatted
date string using the format specified with the <code class="literal">format</code> parameter:</p><div xmlns="" class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">If no <code class="literal">format</code> is specified, then it will use the first date
<a class="link" href="mapping-date-format.html" title="format">format</a> specified in the field mapping.</p></div></div><div xmlns="" class="pre_wrapper lang-console"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-console">POST /sales/_search?size=0
{
    "aggs" : {
        "sales_over_time" : {
            "auto_date_histogram" : {
                "field" : "date",
                "buckets" : 5,
                "format" : "yyyy-MM-dd" <a id="CO108-1"></a><i xmlns="" class="conum" data-value="1"></i>
            }
        }
    }
}</pre></div><div xmlns="" class="console_widget" data-snippet="snippets/447.console"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO108-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>Supports expressive date <a class="link" href="search-aggregations-bucket-daterange-aggregation.html#date-format-pattern" title="Date Format/Pattern">format pattern</a></p></td></tr></table></div><p>Response:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
    ...
    "aggregations": {
        "sales_over_time": {
            "buckets": [
                {
                    "key_as_string": "2015-01-01",
                    "key": 1420070400000,
                    "doc_count": 3
                },
                {
                    "key_as_string": "2015-02-01",
                    "key": 1422748800000,
                    "doc_count": 2
                },
                {
                    "key_as_string": "2015-03-01",
                    "key": 1425168000000,
                    "doc_count": 2
                }
            ],
            "interval": "1M"
        }
    }
}</pre></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="search-aggregations-bucket-adjacency-matrix-aggregation.html">
              « 
              Adjacency Matrix Aggregation</a>
           
        </span><span class="next">
           
          <a href="_intervals.html">Intervals
               »
            </a></span></div></body></html>