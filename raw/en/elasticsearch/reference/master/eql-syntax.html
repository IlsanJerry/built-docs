<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>EQL syntax reference | Elasticsearch Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [master]"/>
<link rel="up" href="eql.html" title="EQL for event-based search"/>
<link rel="prev" href="eql-search.html" title="Run an EQL search"/>
<link rel="next" href="eql-limitations.html" title="EQL limitations"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="eql.html">EQL for event-based search</a></span>
»
<span class="breadcrumb-node">EQL syntax reference</span>
</div>
<div class="navheader">
<span class="prev">
<a href="eql-search.html">« Run an EQL search</a>
</span>
<span class="next">
<a href="eql-limitations.html">EQL limitations »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="eql-syntax"></a>EQL syntax reference<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is experimental and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but experimental features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Elasticsearch supports a subset of EQL syntax.</p>
</div>
</div>
<h3><a id="eql-basic-syntax"></a>Basic syntax<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>EQL queries require an event type and a matching condition. The <code class="literal">where</code> keyword connects them.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">event.category where condition</pre>
</div>
<p>For example, the following EQL query matches <code class="literal">process</code> events with a <code class="literal">process.name</code>
field value of <code class="literal">svchost.exe</code>:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where process.name == "svchost.exe"</pre>
</div>
<h4><a id="eql-syntax-conditions"></a>Conditions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>A condition consists of one or more criteria an event must match.
You can specify and combine these criteria using the following operators:</p>
<h5><a id="eql-syntax-comparison-operators"></a>Comparison operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">&lt;   &lt;=   ==   !=   &gt;=   &gt;</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Definitions</strong></span></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;</code> (less than)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is less than the value
to the right. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;=</code> (less than or equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is less than or equal to
the value to the right. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">==</code> (equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the values to the left and right of the operator are equal.
Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">!=</code> (not equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the values to the left and right of the operator are not
equal. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&gt;=</code> (greater than or equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is greater than or equal
to the value to the right. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&gt;</code> (greater than)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is greater than the
value to the right. Otherwise returns <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>
</details>
<h5><a id="eql-syntax-logical-operators"></a>Logical operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">and  or  not</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Definitions</strong></span></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">and</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> only if the condition to the left and right <em>both</em> return <code class="literal">true</code>.
Otherwise returns `false.
</dd>
<dt>
<span class="term">
<code class="literal">or</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if one of the conditions to the left or right <code class="literal">true</code>.
Otherwise returns `false.
</dd>
<dt>
<span class="term">
<code class="literal">not</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the condition to the right is <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>
</details>
<h5><a id="eql-syntax-lookup-operators"></a>Lookup operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">user.name in ("Administrator", "SYSTEM", "NETWORK SERVICE")
user.name not in ("Administrator", "SYSTEM", "NETWORK SERVICE")</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Definitions</strong></span></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">in</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value is contained in the provided list.
</dd>
<dt>
<span class="term">
<code class="literal">not in</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value is not contained in the provided list.
</dd>
</dl>
</div>
</div>
</details>
<h5><a id="eql-syntax-math-operators"></a>Math operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">+  -  *  /  %</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Definitions</strong></span></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">+</code> (add)
</span>
</dt>
<dd>
Adds the values to the left and right of the operator.
</dd>
<dt>
<span class="term">
<code class="literal">-</code> (Subtract)
</span>
</dt>
<dd>
Subtracts the value to the right of the operator from the value to the left.
</dd>
<dt>
<span class="term">
<code class="literal">*</code> (Subtract)
</span>
</dt>
<dd>
Multiplies the values to the left and right of the operator.
</dd>
<dt>
<span class="term">
<code class="literal">/</code> (Divide)
</span>
</dt>
<dd>
Divides the value to the left of the operator by the value to the right.
</dd>
<dt>
<span class="term">
<code class="literal">%</code> (modulo)
</span>
</dt>
<dd>
Divides the value to the left of the operator by the value to the right. Returns only the remainder.
</dd>
</dl>
</div>
</div>
</details>
<h4><a id="eql-syntax-strings"></a>Strings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>Strings are enclosed with double quotes (<code class="literal">"</code>) or single quotes (<code class="literal">'</code>).</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">"hello world"
"hello world with 'substring'"</pre>
</div>
<h5><a id="eql-syntax-wildcards"></a>Wildcards<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>You can use the wildcard operator (<code class="literal">*</code>) within a string to match specific
patterns. You can use wildcards with the <code class="literal">==</code> (equal) or <code class="literal">!=</code> (not equal)
operators:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">field == "example*wildcard"
field != "example*wildcard"</pre>
</div>
<h5><a id="eql-syntax-escaped-characters"></a>Escaped characters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>When used within a string, special characters, such as a carriage return or
double quote (<code class="literal">"</code>), must be escaped with a preceding backslash (<code class="literal">\</code>).</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">"example \t of \n escaped \r characters"</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Escape sequences</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Escape sequence</th>
<th align="left" valign="top">Literal character</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">\n</code></p></td>
<td align="left" valign="top"><p>A newline (linefeed) character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\r</code></p></td>
<td align="left" valign="top"><p>A carriage return character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\t</code></p></td>
<td align="left" valign="top"><p>A tab character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\\</code></p></td>
<td align="left" valign="top"><p>A backslash (<code class="literal">\</code>) character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\"</code></p></td>
<td align="left" valign="top"><p>A double quote (<code class="literal">"</code>) character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\'</code></p></td>
<td align="left" valign="top"><p>A single quote (<code class="literal">'</code>) character</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<h5><a id="eql-syntax-raw-strings"></a>Raw strings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>Raw strings are preceded by a question mark (<code class="literal">?</code>) and treat backslashes (<code class="literal">\</code>) as
literal characters.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">?"String with a literal 'blackslash' \ character included"</pre>
</div>
<p>You can escape single quotes (<code class="literal">'</code>) and double quotes (<code class="literal">"</code>) with a backslash, but
the backslash remains in the resulting string.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">?"\""</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Raw strings cannot contain only a single backslash. Additionally, raw strings
cannot end in an odd number of backslashes.</p>
</div>
</div>
<h4><a id="eql-syntax-non-alpha-field-names"></a>Non-alphanumeric field names<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>Field names containing non-alphanumeric characters, such as underscores (<code class="literal">_</code>),
dots (<code class="literal">.</code>), hyphens (<code class="literal">-</code>), or spaces, must be escaped using backticks (`).</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">`my_field`
`my.field`
`my-field`
`my field`</pre>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="eql-search.html">« Run an EQL search</a>
</span>
<span class="next">
<a href="eql-limitations.html">EQL limitations »</a>
</span>
</div>
</div>
</body>
</html>
