<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>EQL syntax reference | Elasticsearch Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [master]"/>
<link rel="up" href="eql.html" title="EQL for event-based search"/>
<link rel="prev" href="eql-search.html" title="Run an EQL search"/>
<link rel="next" href="eql-function-ref.html" title="EQL function reference"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="eql.html">EQL for event-based search</a></span>
»
<span class="breadcrumb-node">EQL syntax reference</span>
</div>
<div class="navheader">
<span class="prev">
<a href="eql-search.html">« Run an EQL search</a>
</span>
<span class="next">
<a href="eql-function-ref.html">EQL function reference »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="eql-syntax"></a>EQL syntax reference<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is experimental and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but experimental features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Elasticsearch supports a subset of EQL syntax.</p>
</div>
</div>
<h3><a id="eql-basic-syntax"></a>Basic syntax<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>EQL queries require an event category and a matching condition. The <code class="literal">where</code>
keyword connects them.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">event_category where condition</pre>
</div>
<p>For example, the following EQL query matches <code class="literal">process</code> events with a
<code class="literal">process.name</code> field value of <code class="literal">svchost.exe</code>:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where process.name == "svchost.exe"</pre>
</div>
<h4><a id="eql-syntax-event-categories"></a>Event categories<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>In Elasticsearch, an event category is a valid, indexed value of the
<a class="xref" href="eql-requirements.html#eql-required-fields" title="Required fields">event category field</a>. You can set the event category
field using the <code class="literal">event_category_field</code> parameter of the EQL search API.</p>
<h5><a id="eql-syntax-match-any-event-category"></a>Match any event category<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>To match events of any category, use the <code class="literal">any</code> keyword. You can also use the
<code class="literal">any</code> keyword to search for documents without a event category field.</p>
<p>For example, the following EQL query matches any documents with a
<code class="literal">network.protocol</code> field value of <code class="literal">http</code>:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">any where network.protocol == "http"</pre>
</div>
<h4><a id="eql-syntax-conditions"></a>Conditions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>A condition consists of one or more criteria an event must match.
You can specify and combine these criteria using the following operators:</p>
<h5><a id="eql-syntax-comparison-operators"></a>Comparison operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">&lt;   &lt;=   ==   !=   &gt;=   &gt;</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Definitions</strong></span></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;</code> (less than)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is less than the value
to the right. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;=</code> (less than or equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is less than or equal to
the value to the right. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">==</code> (equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the values to the left and right of the operator are equal.
Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">!=</code> (not equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the values to the left and right of the operator are not
equal. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&gt;=</code> (greater than or equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is greater than or equal
to the value to the right. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&gt;</code> (greater than)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is greater than the
value to the right. Otherwise returns <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>
</details>
<h5><a id="eql-syntax-logical-operators"></a>Logical operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">and  or  not</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Definitions</strong></span></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">and</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> only if the condition to the left and right <em>both</em> return <code class="literal">true</code>.
Otherwise returns `false.
</dd>
<dt>
<span class="term">
<code class="literal">or</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if one of the conditions to the left or right <code class="literal">true</code>.
Otherwise returns `false.
</dd>
<dt>
<span class="term">
<code class="literal">not</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the condition to the right is <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>
</details>
<h5><a id="eql-syntax-lookup-operators"></a>Lookup operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">user.name in ("Administrator", "SYSTEM", "NETWORK SERVICE")
user.name not in ("Administrator", "SYSTEM", "NETWORK SERVICE")</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Definitions</strong></span></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">in</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value is contained in the provided list.
</dd>
<dt>
<span class="term">
<code class="literal">not in</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value is not contained in the provided list.
</dd>
</dl>
</div>
</div>
</details>
<h5><a id="eql-syntax-math-operators"></a>Math operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">+  -  *  /  %</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Definitions</strong></span></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">+</code> (add)
</span>
</dt>
<dd>
Adds the values to the left and right of the operator.
</dd>
<dt>
<span class="term">
<code class="literal">-</code> (Subtract)
</span>
</dt>
<dd>
Subtracts the value to the right of the operator from the value to the left.
</dd>
<dt>
<span class="term">
<code class="literal">*</code> (Subtract)
</span>
</dt>
<dd>
Multiplies the values to the left and right of the operator.
</dd>
<dt>
<span class="term">
<code class="literal">/</code> (Divide)
</span>
</dt>
<dd>
Divides the value to the left of the operator by the value to the right.
</dd>
<dt>
<span class="term">
<code class="literal">%</code> (modulo)
</span>
</dt>
<dd>
Divides the value to the left of the operator by the value to the right. Returns only the remainder.
</dd>
</dl>
</div>
</div>
</details>
<h4><a id="eql-syntax-strings"></a>Strings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>Strings are enclosed with double quotes (<code class="literal">"</code>) or single quotes (<code class="literal">'</code>).</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">"hello world"
"hello world with 'substring'"</pre>
</div>
<h5><a id="eql-syntax-wildcards"></a>Wildcards<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>You can use the wildcard operator (<code class="literal">*</code>) within a string to match specific
patterns. You can use wildcards with the <code class="literal">==</code> (equal) or <code class="literal">!=</code> (not equal)
operators:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">field == "example*wildcard"
field != "example*wildcard"</pre>
</div>
<h5><a id="eql-syntax-match-any-condition"></a>Match any condition<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>To match events solely on event category, use the <code class="literal">where true</code> condition.</p>
<p>For example, the following EQL query matches any <code class="literal">file</code> events:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">file where true</pre>
</div>
<p>To match any event, you can combine the <code class="literal">any</code> keyword with the <code class="literal">where true</code>
condition:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">any where true</pre>
</div>
<h5><a id="eql-syntax-escaped-characters"></a>Escaped characters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>When used within a string, special characters, such as a carriage return or
double quote (<code class="literal">"</code>), must be escaped with a preceding backslash (<code class="literal">\</code>).</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">"example \t of \n escaped \r characters"</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Escape sequences</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Escape sequence</th>
<th align="left" valign="top">Literal character</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">\n</code></p></td>
<td align="left" valign="top"><p>A newline (linefeed) character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\r</code></p></td>
<td align="left" valign="top"><p>A carriage return character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\t</code></p></td>
<td align="left" valign="top"><p>A tab character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\\</code></p></td>
<td align="left" valign="top"><p>A backslash (<code class="literal">\</code>) character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\"</code></p></td>
<td align="left" valign="top"><p>A double quote (<code class="literal">"</code>) character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\'</code></p></td>
<td align="left" valign="top"><p>A single quote (<code class="literal">'</code>) character</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<h5><a id="eql-syntax-raw-strings"></a>Raw strings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>Raw strings are preceded by a question mark (<code class="literal">?</code>) and treat backslashes (<code class="literal">\</code>) as
literal characters.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">?"String with a literal 'blackslash' \ character included"</pre>
</div>
<p>You can escape single quotes (<code class="literal">'</code>) and double quotes (<code class="literal">"</code>) with a backslash, but
the backslash remains in the resulting string.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">?"\""</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Raw strings cannot contain only a single backslash. Additionally, raw strings
cannot end in an odd number of backslashes.</p>
</div>
</div>
<h4><a id="eql-syntax-non-alpha-field-names"></a>Non-alphanumeric field names<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>Field names containing non-alphanumeric characters, such as underscores (<code class="literal">_</code>),
dots (<code class="literal">.</code>), hyphens (<code class="literal">-</code>), or spaces, must be escaped using backticks (`).</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">`my_field`
`my.field`
`my-field`
`my field`</pre>
</div>
<h3><a id="eql-functions"></a>Functions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>Elasticsearch supports several of EQL&#8217;s built-in functions. You can use these functions
to convert data types, perform math, manipulate strings, and more.</p>
<p>For a list of supported functions, see <a class="xref" href="eql-function-ref.html" title="EQL function reference"><em>Function reference</em></a>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Using functions in EQL queries can result in slower search speeds. If you
often use functions to transform indexed data, you can speed up search by making
these changes during indexing instead. However, that often means slower index
speeds.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An index contains the <code class="literal">file.path</code> field. <code class="literal">file.path</code> contains the full path to a
file, including the file extension.</p>
<p>When running EQL searches, users often use the <code class="literal">endsWith</code> function with the
<code class="literal">file.path</code> field to match file extensions:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">file where endsWith(file.path,".exe") or endsWith(file.path,".dll")</pre>
</div>
<p>While this works, it can be repetitive to write and can slow search speeds. To
speed up search, you can do the following instead:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="indices-put-mapping.html" title="Put mapping API">Add a new field</a>, <code class="literal">file.extension</code>, to the index. The
<code class="literal">file.extension</code> field will contain only the file extension from the
<code class="literal">file.path</code> field.
</li>
<li class="listitem">
Use an <a class="xref" href="ingest.html" title="Ingest node">ingest pipeline</a> containing the <a class="xref" href="grok-processor.html" title="Grok Processor"><code class="literal">grok</code></a>
processor or another preprocessor tool to extract the file extension from the
<code class="literal">file.path</code> field before indexing.
</li>
<li class="listitem">
Index the extracted file extension to the <code class="literal">file.extension</code> field.
</li>
</ol>
</div>
<p>These changes may slow indexing but allow for faster searches. Users
can use the <code class="literal">file.extension</code> field instead of multiple <code class="literal">endsWith</code> function
calls:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">file where file.extension in ("exe", "dll")</pre>
</div>
</div>
</details>
<p>We recommend testing and benchmarking any indexing changes before deploying them
in production. See <a class="xref" href="tune-for-indexing-speed.html" title="Tune for indexing speed"><em>Tune for indexing speed</em></a> and <a class="xref" href="tune-for-search-speed.html" title="Tune for search speed"><em>Tune for search speed</em></a>.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="eql-search.html">« Run an EQL search</a>
</span>
<span class="next">
<a href="eql-function-ref.html">EQL function reference »</a>
</span>
</div>
</div>
</body>
</html>
