<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Estimate anomaly detection jobs model memory API | Elasticsearch Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [master]"/>
<link rel="up" href="ml-apis.html" title="Machine learning anomaly detection APIs"/>
<link rel="prev" href="ml-delete-expired-data.html" title="Delete expired data API"/>
<link rel="next" href="ml-find-file-structure.html" title="Find file structure API"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
»
<span class="breadcrumb-link"><a href="ml-apis.html">Machine learning anomaly detection APIs</a></span>
»
<span class="breadcrumb-node">Estimate anomaly detection jobs model memory API</span>
</div>
<div class="navheader">
<span class="prev">
<a href="ml-delete-expired-data.html">« Delete expired data API</a>
</span>
<span class="next">
<a href="ml-find-file-structure.html">Find file structure API »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ml-estimate-model-memory"></a>Estimate anomaly detection jobs model memory API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/ml/anomaly-detection/apis/estimate-model-memory.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Estimates the model memory an anomaly detection job is likely to need based on analysis
configuration details and cardinality estimates for the fields it references.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-estimate-model-memory-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/ml/anomaly-detection/apis/estimate-model-memory.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST _ml/anomaly_detectors/_estimate_model_memory</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-estimate-model-memory-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/ml/anomaly-detection/apis/estimate-model-memory.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have <code class="literal">manage_ml</code> or
<code class="literal">manage</code> cluster privileges to use this API. See
<a class="xref" href="security-privileges.html" title="Security privileges">Security privileges</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-estimate-model-memory-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/ml/anomaly-detection/apis/estimate-model-memory.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">analysis_config</code>
</span>
</dt>
<dd>
(Required, object) For a list of the properties that you can specify in the
<code class="literal">analysis_config</code> component of the body of this API, see <a class="xref" href="ml-put-job.html#put-analysisconfig">`analysis_config`</a>.
</dd>
<dt>
<span class="term">
<code class="literal">max_bucket_cardinality</code>
</span>
</dt>
<dd>
(Optional, object) Estimates of the highest cardinality in a single bucket
that will be observed for influencer fields over the time period that the job
analyzes data. To produce a good answer, values must be provided for
all influencer fields. It does not matter if values are provided for fields
that are not listed as <code class="literal">influencers</code>. If there are no <code class="literal">influencers</code> then
<code class="literal">max_bucket_cardinality</code> can be omitted from the request.
</dd>
<dt>
<span class="term">
<code class="literal">overall_cardinality</code>
</span>
</dt>
<dd>
(Optional, object) Estimates of the cardinality that will be observed for
fields over the whole time period that the job analyzes data. To produce
a good answer, values must be provided for fields referenced in the
<code class="literal">by_field_name</code>, <code class="literal">over_field_name</code> and <code class="literal">partition_field_name</code> of any
detectors. It does not matter if values are provided for other fields.
If no detectors have a <code class="literal">by_field_name</code>, <code class="literal">over_field_name</code> or
<code class="literal">partition_field_name</code> then <code class="literal">overall_cardinality</code> can be omitted
from the request.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-estimate-model-memory-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/ml/anomaly-detection/apis/estimate-model-memory.asciidoc">edit</a></h3>
</div></div></div>
<a id="c4178795c108b4ed3daec4e69aa2acc6"></a>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/anomaly_detectors/_estimate_model_memory
{
    "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "function": "sum",
            "field_name": "bytes",
            "by_field_name": "status",
            "partition_field_name": "app"
          }
        ],
        "influencers": [ "source_ip", "dest_ip" ]
    },
    "overall_cardinality": {
       "status": 10,
       "app": 50
    },
    "max_bucket_cardinality": {
       "source_ip": 300,
       "dest_ip": 30
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1744.console"></div>
<p>The estimate returns the following result:</p>
<a id="d57122a950b320297447c5d156c0bfc0"></a>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "model_memory_estimate": "45mb"
}</pre>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="ml-delete-expired-data.html">« Delete expired data API</a>
</span>
<span class="next">
<a href="ml-find-file-structure.html">Find file structure API »</a>
</span>
</div>
</div>
</body>
</html>
