<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Migrating to 8.0 | Elasticsearch Guide [master] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="breaking-changes.html" title="Migration guide"/>
<link rel="prev" href="breaking-changes.html" title="Migration guide"/>
<link rel="next" href="breaking_80_monitoring_changes.html" title="Monitoring changes"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
»
<span class="breadcrumb-link"><a href="breaking-changes.html">Migration guide</a></span>
»
<span class="breadcrumb-node">Migrating to 8.0</span>
</div>
<div class="navheader">
<span class="prev">
<a href="breaking-changes.html">« Migration guide</a>
</span>
<span class="next">
<a href="breaking_80_monitoring_changes.html">Monitoring changes »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="migrating-8.0"></a>Migrating to 8.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0.asciidoc">edit</a></h2>
</div></div></div>

<p>This section discusses the changes that you need to be aware of when migrating
your application to Elasticsearch 8.0.</p>
<p>See also <a class="xref" href="release-highlights.html" title="What&#8217;s new in 8.0"><em>What&#8217;s new in 8.0</em></a> and <a class="xref" href="es-release-notes.html" title="Release notes">Release notes</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Coming in 8.0.0.</p>
</div>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_aggregations_changes" title="Aggregations changes">Aggregations changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_allocation_changes" title="Allocation changes">Allocation changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_analysis_changes" title="Analysis changes">Analysis changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_breaker_changes" title="Circuit breaker changes">Circuit breaker changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_cluster_changes" title="Cluster changes">Cluster changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_ccr_changes" title="Cross-cluster replication (CCR) changes">Cross-cluster replication (CCR) changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_discovery_changes" title="Discovery changes">Discovery changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_eql_changes" title="EQL changes">EQL changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_http_changes" title="HTTP changes">HTTP changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_ilm_changes" title="Index lifecycle management (ILM) changes">Index lifecycle management (ILM) changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_indices_changes" title="Indices changes">Indices changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_ingest_changes" title="Ingest pipeline changes">Ingest pipeline changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_java_changes" title="Java API changes">Java API changes</a>
</li>
<li class="listitem">
<a class="xref" href="migrating-8.0.html#breaking_80_mappings_changes" title="Mapping changes">Mapping changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html" title="Monitoring changes">Monitoring changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_network_changes" title="Network changes">Network changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_node_changes" title="Node changes">Node changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_packaging_changes" title="Packaging changes">Packaging changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_reindex_changes" title="Reindex changes">Reindex changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_api_changes" title="REST API changes">REST API changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_rollup_changes" title="Rollup changes">Rollup changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_search_changes" title="Search changes">Search changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_security_changes" title="Security changes">Security changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_settings_changes" title="Settings changes">Settings changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_snapshots_changes" title="Snapshot and restore changes">Snapshot and restore changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_threadpool_changes" title="Thread pool changes">Thread pool changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_transport_changes" title="Transport changes">Transport changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking_80_monitoring_changes.html#breaking_80_watcher_changes" title="Watcher changes">Watcher changes</a>
</li>
</ul>
</div>
<h3><a id="breaking-changes-8.0"></a>Breaking changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0.asciidoc">edit</a></h3>
<p>The following changes in Elasticsearch 8.0 might affect your applications
and prevent them from operating normally.
Before upgrading to 8.0, review these changes and take the described steps
to mitigate the impact.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Breaking changes introduced in minor versions are
normally limited to security and bug fixes.
Significant changes in behavior are deprecated in a minor release and
the old behavior is supported until the next major release.
To find out if you are using any deprecated functionality,
enable <a class="xref" href="logging.html#deprecation-logging" title="Deprecation logging">deprecation logging</a>.</p>
</div>
</div>
<details>
<summary class="title">Indices created in Elasticsearch 6.x and earlier versions are not supported.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Elasticsearch 8.0 can read indices created in version 7.0 or above. An
Elasticsearch 8.0 node will not start in the presence of indices created in a
version of Elasticsearch before 7.0.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Reindex indices created in Elasticsearch 6.x or before with Elasticsearch 7.x if they need to be carried forward to  Elasticsearch 8.x.</p>
</div>
</details>
<details>
<summary class="title">REST API endpoints containing <code class="literal">_xpack</code> have been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In 7.0, we deprecated REST endpoints that contain <code class="literal">_xpack</code> in their path. These
endpoints are now removed in 8.0. Each endpoint that was deprecated and removed
is replaced with a new endpoint that does not contain <code class="literal">_xpack</code>. As an example,
<code class="literal">/{index}/_xpack/graph/_explore</code> is replaced by <code class="literal">/{index}/_graph/explore</code>.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use the replacement REST API endpoints. Requests submitted to the <code class="literal">_xpack</code>
API endpoints will return an error.</p>
</div>
</details>
<details>
<summary class="title">Several EOL operating systems are no longer supported.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The following operating systems have reached their end of life and are no longer
supported by Elasticsearch:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Amazon Linux
</li>
<li class="listitem">
CentOS 6
</li>
<li class="listitem">
Debian 8
</li>
<li class="listitem">
openSUSE Leap 42
</li>
<li class="listitem">
Oracle Enterprise Linux 6
</li>
<li class="listitem">
Ubuntu 16.04
</li>
</ul>
</div>
<p>We&#8217;ve also removed support for <code class="literal">SysV init</code>. No supported operating systems use
the <code class="literal">SysV init</code> process.</p>
<p><span class="strong strong"><strong>Details</strong></span><br>
Ensure your nodes use a
<a href="/support/matrix#matrix_os" class="ulink" target="_top">supported operating system</a>.
Running Elasticsearch on an unsupported operating system can result in unexpected errors
or failures.</p>
</div>
</details>
<h4><a id="breaking_80_aggregations_changes"></a>Aggregations changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/aggregations.asciidoc">edit</a></h4>
<details id="remove-term-order-key">
<summary class="title">The <code class="literal">terms</code> aggregation no longer supports the <code class="literal">_term</code> order key.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The <code class="literal">terms</code> aggregation no longer supports the <code class="literal">_term</code> key in <code class="literal">order</code> values. To
sort buckets by their term, use <code class="literal">_key</code> instead.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Discontinue use of the <code class="literal">_term</code> order key. Requests that include a <code class="literal">_term</code> order
key will return an error.</p>
</div>
</details>
<details id="remove-time-order-key">
<summary class="title">The <code class="literal">date_histogram</code> aggregation no longer supports the <code class="literal">_time</code> order key.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The <code class="literal">date_histogram</code> aggregation no longer supports the <code class="literal">_time</code> key in <code class="literal">order</code>
values. To sort buckets by their key, use <code class="literal">_key</code> instead.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Discontinue use of the <code class="literal">_time</code> order key. Requests that include a <code class="literal">_time</code> order
key will return an error.</p>
</div>
</details>
<details id="remove-moving-avg-agg">
<summary class="title">The <code class="literal">moving_avg</code> aggregation has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The <code class="literal">moving_avg</code> aggregation was deprecated in 6.4 and has been removed. To
calculate moving averages, use the
<a href="/guide/en/elasticsearch/reference/master/search-aggregations-pipeline-movfn-aggregation.html" class="ulink" target="_top"><code class="literal">moving_fn</code>
aggregation</a> instead.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Discontinue use of the <code class="literal">moving_avg</code> aggregation. Requests that include the
<code class="literal">moving_avg</code> aggregation will return an error.</p>
</div>
</details>
<details id="percentile-duplication">
<summary class="title">The <code class="literal">percentiles</code> aggregation&#8217;s <code class="literal">percents</code> parameter no longer supports duplicate values.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
If you specify the <code class="literal">percents</code> parameter with the
<a href="/guide/en/elasticsearch/reference/master/search-aggregations-metrics-percentile-aggregation.html" class="ulink" target="_top"><code class="literal">percentiles</code> aggregation</a>,
its values must be unique. Otherwise, an exception occurs.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use unique values in the <code class="literal">percents</code> parameter of the <code class="literal">percentiles</code> aggregation.
Requests containing duplicate values in the <code class="literal">percents</code> parameter will return
an error.</p>
</div>
</details>
<details id="date-histogram-interval">
<summary class="title">The <code class="literal">date_histogram</code> aggregation&#8217;s <code class="literal">interval</code> parameter is no longer valid.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
It is now an error to specify the <code class="literal">interval</code> parameter to the
<a href="/guide/en/elasticsearch/reference/master/search-aggregations-bucket-datehistogram-aggregation.html" class="ulink" target="_top"><code class="literal">date_histogram</code>
aggregation</a> or the
<a href="/guide/en/elasticsearch/reference/master/search-aggregations-bucket-composite-aggregation.html#_date_histogram" class="ulink" target="_top">https://www.elastic.co/guide/en/elasticsearch/reference/master/search-aggregations-bucket-composite-aggregation.html#_date_histogram</a>[<code class="literal">composite
date_histogram</code> source.  Instead, please use either <code class="literal">calendar_interval</code> or
<code class="literal">fixed_interval</code> as appropriate.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Uses of the <code class="literal">interval</code> parameter in either the <code class="literal">date_histogram</code> aggregation or
the <code class="literal">date_histogram</code> composite source will now generate an error.  Instead
please use the more specific <code class="literal">fixed_interval</code> or <code class="literal">calendar_interval</code>
parameters.</p>
</div>
</details>
<h4><a id="breaking_80_allocation_changes"></a>Allocation changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/allocation.asciidoc">edit</a></h4>
<details id="breaking_80_allocation_change_flood_stage_block_always_removed">
<summary class="title">The automatic removal of flood-stage blocks is no longer optional.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
If a node exceeds the flood-stage disk watermark then we add a block to all of
its indices to prevent further writes as a last-ditch attempt to prevent the
node completely exhausting its disk space. By default, from 7.4 onwards the
block is automatically removed when a node drops below the high watermark
again, but this behaviour could be disabled by setting the system property
<code class="literal">es.disk.auto_release_flood_stage_block</code> to <code class="literal">false</code>. This behaviour is no
longer optional, and this system property must now not be set.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Discontinue use of the <code class="literal">es.disk.auto_release_flood_stage_block</code> system property.
Setting this system property will result in an error on startup.</p>
</div>
</details>
<details id="breaking_80_allocation_change_include_relocations_removed">
<summary class="title">Accounting for the disk usage of relocating shards is no longer optional.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
By default Elasticsearch will account for the sizes of relocating shards when making
allocation decisions based on the disk usage of the nodes in the cluster. In
earlier versions the <code class="literal">cluster.routing.allocation.disk.include_relocations</code>
setting allowed this accounting to be disabled, which would result in poor
allocation decisions that might overshoot watermarks and require significant
extra work to correct. This behaviour is no longer optional, and this setting
has been removed.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Discontinue use of the <code class="literal">cluster.routing.allocation.disk.include_relocations</code>
setting. Specifying this setting in <code class="literal">elasticsearch.yml</code> will result in an error
on startup.</p>
</div>
</details>
<h4><a id="breaking_80_analysis_changes"></a>Analysis changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/analysis.asciidoc">edit</a></h4>
<details id="ngram-edgengram-filter-names-removed">
<summary class="title">The <code class="literal">nGram</code> and <code class="literal">edgeNGram</code> token filter names have been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The <code class="literal">nGram</code> and <code class="literal">edgeNGram</code> token filter names that have been deprecated since
version 6.4 have been removed. Both token filters can only be used by their
alternative names <code class="literal">ngram</code> and <code class="literal">edge_ngram</code> since version 7.0.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use the equivalent <code class="literal">ngram</code> and <code class="literal">edge_ngram</code> token filters. Requests containing
the <code class="literal">nGram</code> and <code class="literal">edgeNGram</code> token filter names will return an error.</p>
</div>
</details>
<details id="nGram-edgeNGram-tokenizer-dreprecation">
<summary class="title">The <code class="literal">nGram</code> and <code class="literal">edgeNGram</code> tokenizer names have been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The <code class="literal">nGram</code> and <code class="literal">edgeNGram</code> tokenizer names haven been deprecated with 7.6 and are no longer
supported on new indices. Mappings for indices created after 7.6 will continue to work but
emit a deprecation warning. The tokenizer name should be changed to the fully equivalent
<code class="literal">ngram</code> or <code class="literal">edge_ngram</code> names for new indices and in index templates.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use the <code class="literal">ngram</code> and <code class="literal">edge_ngram</code> tokenizers. Requests to create new indices
using the <code class="literal">nGram</code> and <code class="literal">edgeNGram</code> tokenizer names will return an error.</p>
</div>
</details>
<h4><a id="breaking_80_breaker_changes"></a>Circuit breaker changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/breaker.asciidoc">edit</a></h4>
<details>
<summary class="title">The <code class="literal">in_flight_requests</code> stat has been renamed <code class="literal">inflight_requests</code> in logs and diagnostic APIs.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The name of the in flight requests circuit breaker in log output and diagnostic APIs (such as the node stats API) changes from <code class="literal">in_flight_requests</code> to <code class="literal">inflight_requests</code> to align it with the name of the corresponding settings.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Update your workflow and applications to use the <code class="literal">inflight_requests</code> stat in
place of <code class="literal">in_flight_requests</code>.</p>
</div>
</details>
<h4><a id="breaking_80_cluster_changes"></a>Cluster changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/cluster.asciidoc">edit</a></h4>
<details>
<summary class="title">The voting configuration exclusions API endpoint has changed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The <code class="literal">POST /_cluster/voting_config_exclusions/{node_filter}</code> API has been
removed in favour of <code class="literal">POST /_cluster/voting_config_exclusions?node_names=...</code>
and <code class="literal">POST /_cluster/voting_config_exclusions?node_ids=...</code> which allow you to
specify the names or IDs of the nodes to exclude.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use <code class="literal">POST /_cluster/voting_config_exclusions?node_ids=...</code> and specify the nodes
to exclude instead of using a node filter. Requests submitted to the
<code class="literal">/_cluster/voting_config_exclusions/{node_filter}</code> endpoint will return an
error.</p>
</div>
</details>
<details>
<summary class="title">The <code class="literal">cluster.join.timeout</code> setting has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The <code class="literal">cluster.join.timeout</code> setting has been removed. Join attempts no longer
time out.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Do not set <code class="literal">cluster.join.timeout</code> in your <code class="literal">elasticsearch.yml</code> file.</p>
</div>
</details>
<h4><a id="breaking_80_ccr_changes"></a>Cross-cluster replication (CCR) changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/ccr.asciidoc">edit</a></h4>
<details>
<summary class="title">Remote system indices are not followed automatically if they match an auto-follow pattern.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Remote system indices matching an <a href="/guide/en/elasticsearch/reference/master/ccr-auto-follow.html" class="ulink" target="_top">auto-follow
pattern</a> won&#8217;t be configured as a follower index automatically.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Explicitly <a href="/guide/en/elasticsearch/reference/master/ccr-put-follow.html" class="ulink" target="_top">create a follower index</a> to follow a remote
system index if that&#8217;s the wanted behaviour.</p>
</div>
</details>
<h4><a id="breaking_80_discovery_changes"></a>Discovery changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/discovery.asciidoc">edit</a></h4>
<details>
<summary class="title"><code class="literal">discovery.zen</code> settings have been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
All settings under the <code class="literal">discovery.zen</code> namespace, which existed only for BWC reasons in 7.x,
are no longer supported. In particular, this includes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">discovery.zen.minimum_master_nodes</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.no_master_block</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.hosts_provider</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.publish_timeout</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.commit_timeout</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.publish_diff.enable</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.ping.unicast.concurrent_connects</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.ping.unicast.hosts.resolve_timeout</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.ping.unicast.hosts</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.ping_timeout</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.unsafe_rolling_upgrades_enabled</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.fd.connect_on_network_disconnect</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.fd.ping_interval</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.fd.ping_timeout</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.fd.ping_retries</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.fd.register_connection_listener</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.join_retry_attempts</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.join_retry_delay</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.join_timeout</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.max_pings_from_another_master</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.send_leave_request</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.master_election.wait_for_joins_timeout</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.master_election.ignore_non_master_pings</code>
</li>
<li class="listitem">
<code class="literal">discovery.zen.publish.max_pending_cluster_states</code>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Discontinue use of the <code class="literal">discovery.zen</code> settings. Specifying these settings in
<code class="literal">elasticsearch.yml</code> will result in an error on startup.</p>
</div>
</details>
<h4><a id="breaking_80_eql_changes"></a>EQL changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/eql.asciidoc">edit</a></h4>
<details>
<summary class="title">The <code class="literal">wildcard</code> function has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The <code class="literal">wildcard</code> function was deprecated in Elasticsearch 7.13.0 and has been removed.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use the <code class="literal">like</code> or <code class="literal">regex</code> <a href="/guide/en/elasticsearch/reference/master/eql-syntax.html#eql-syntax-pattern-comparison-keywords" class="ulink" target="_top">keywords</a> instead.</p>
</div>
</details>
<h4><a id="breaking_80_http_changes"></a>HTTP changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/http.asciidoc">edit</a></h4>
<details>
<summary class="title">The <code class="literal">http.content_type.required</code> setting has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The <code class="literal">http.content_type.required</code> setting was deprecated in Elasticsearch 6.0
and has been removed in Elasticsearch 8.0. The setting was introduced in
Elasticsearch 5.3 to prepare users for Elasticsearch 6.0, where content type
auto detection was removed for HTTP requests.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Discontinue use of the <code class="literal">http.content_type.required</code> setting. Specifying this
setting in <code class="literal">elasticsearch.yml</code> will result in an error on startup.</p>
</div>
</details>
<details>
<summary class="title">The <code class="literal">http.tcp_no_delay</code> setting has been replaced by <code class="literal">http.tcp.no_delay</code>.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The <code class="literal">http.tcp_no_delay</code> setting was deprecated in 7.x and has been removed in 8.0. It has been replaced by
<code class="literal">http.tcp.no_delay</code>.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use the <code class="literal">http.tcp.no_delay</code> setting. Discontinue use of the <code class="literal">http.tcp_no_delay</code>
setting. Specifying the <code class="literal">http.tcp_no_delay</code> setting in <code class="literal">elasticsearch.yml</code> will
result in an error on startup.</p>
</div>
</details>
<details>
<summary class="title">The <code class="literal">es.rest.url_plus_as_space</code> system property has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Starting in version 7.4, a <code class="literal">+</code> in a URL will be encoded as <code class="literal">%2B</code> by all REST API functionality. Prior versions handled a <code class="literal">+</code> as a single space.
In these previous versions, if your application required handling <code class="literal">+</code> as a single space, you could return to the old behaviour by setting the system property
<code class="literal">es.rest.url_plus_as_space</code> to <code class="literal">true</code>. Note that this behaviour is deprecated and setting this system property to <code class="literal">true</code> will cease
to be supported in version 8.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Update your application or workflow to assume <code class="literal">+</code> in a URL is encoded as <code class="literal">%2B</code>.</p>
</div>
</details>
<h4><a id="breaking_80_ilm_changes"></a>Index lifecycle management (ILM) changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/ilm.asciidoc">edit</a></h4>
<details id="ilm-poll-interval-limit">
<summary class="title">The <code class="literal">indices.lifecycle.poll_interval</code> setting must be greater than <code class="literal">1s</code>.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The setting <code class="literal">indices.lifecycle.poll_interval</code>, if set too low, can cause
excessive load on a cluster. This setting must now be set to <code class="literal">1s</code> (one second)
or greater.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Update the <code class="literal">indices.lifecycle.poll_interval</code> setting to a value of <code class="literal">1s</code> or
greater using <code class="literal">elasticsearch.yml</code> or the
<a href="/guide/en/elasticsearch/reference/master/cluster-update-settings.html" class="ulink" target="_top">cluster update settings API</a>.</p>
<p>Setting <code class="literal">indices.lifecycle.poll_interval</code> to less than <code class="literal">1s</code> in
<code class="literal">elasticsearch.yml</code> will result in an error on startup.
<a href="/guide/en/elasticsearch/reference/master/cluster-update-settings.html" class="ulink" target="_top">Cluster update settings API</a> requests that
set <code class="literal">indices.lifecycle.poll_interval</code> to less than <code class="literal">1s</code> will return an error.</p>
</div>
</details>
<details id="ilm-hlrc-rename">
<summary class="title">The <code class="literal">indexlifecycle</code> package has been renamed <code class="literal">ilm</code> in the Java High Level REST Client.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In the high level REST client, the <code class="literal">indexlifecycle</code> package has been
renamed to <code class="literal">ilm</code> to match the package rename inside the Elasticsearch code.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Update your workflow and applications to use the <code class="literal">ilm</code> package in place of
<code class="literal">indexlifecycle</code>.</p>
</div>
</details>
<details id="ilm-freeze-noop">
<summary class="title">The ILM <code class="literal">freeze</code> action is now a no-op.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The ILM freeze action is now a no-op and performs no action on the index, as the freeze API endpoint
has been removed in 8.0.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Update your ILM policies to remove the <code class="literal">freeze</code> action from the <code class="literal">cold</code> phase.</p>
</div>
</details>
<h4><a id="breaking_80_indices_changes"></a>Indices changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/indices.asciidoc">edit</a></h4>
<details>
<summary class="title">The deprecated <code class="literal">_upgrade</code> API has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Previously, the <code class="literal">_upgrade</code> API upgraded indices from the previous major
version to the current version. The <code class="literal">_reindex</code> API should be used
instead for that purpose.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Requests made to the old <code class="literal">_upgrade</code> API will return an error.</p>
</div>
</details>
<details>
<summary class="title">The force merge API&#8217;s <code class="literal">max_num_segments</code> and <code class="literal">only_expunge_deletes</code> parameters cannot both be specified in the same request.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Previously, the force merge API allowed the parameters <code class="literal">only_expunge_deletes</code>
and <code class="literal">max_num_segments</code> to be set to a non default value at the same time. But
the <code class="literal">max_num_segments</code> was silently ignored when <code class="literal">only_expunge_deletes</code> is set
to <code class="literal">true</code>, leaving the false impression that it has been applied.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
When using the <a href="/guide/en/elasticsearch/reference/master/indices-forcemerge.html" class="ulink" target="_top">force merge API</a>, do not specify
values for both the <code class="literal">max_num_segments</code> and <code class="literal">only_expunge_deletes</code> parameters.
Requests that include values for both parameters will return an error.</p>
</div>
</details>
<details>
<summary class="title">The <code class="literal">index.force_memory_term_dictionary</code> setting has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The <code class="literal">index.force_memory_term_dictionary</code> setting was introduced in 7.0 as a
temporary measure to allow users to opt-out of the optimization that leaves the
term dictionary on disk when appropriate. This optimization is now mandatory
and the setting is removed.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Discontinue use of the <code class="literal">index.force_memory_term_dictionary</code> index setting.
Requests that include this setting will return an error.</p>
</div>
</details>
<details>
<summary class="title">The create or update index template API&#8217;s <code class="literal">template</code> parameter has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In 6.0, we deprecated the <code class="literal">template</code> parameter in create or update index
template requests in favor of using <code class="literal">index_patterns</code>. Support for the <code class="literal">template</code>
parameter is now removed in 8.0.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use the <a href="/guide/en/elasticsearch/reference/master/indices-templates-v1.html" class="ulink" target="_top">create or update index template API</a>'s
<code class="literal">index_patterns</code> parameter. Requests that include the <code class="literal">template</code> parameter will
return an error.</p>
</div>
</details>
<details>
<summary class="title">Synced flush has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Synced flush was deprecated in 7.6 and is removed in 8.0. Use a regular flush
instead as it has the same effect as a synced flush in 7.6 and later.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use the <a href="/guide/en/elasticsearch/reference/master/indices-flush.html" class="ulink" target="_top">flush API</a>. Requests to the
<code class="literal">/&lt;index&gt;/flush/synced</code> or <code class="literal">/flush/synced</code> endpoints will return an error.</p>
</div>
</details>
<details>
<summary class="title">The <code class="literal">index.soft_deletes.enabled</code> setting has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Creating indices with soft deletes disabled was deprecated in 7.6 and
is no longer supported in 8.0. The <code class="literal">index.soft_deletes.enabled</code> setting
can no longer be set to <code class="literal">false</code>.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Discontinue use of the <code class="literal">index.soft_deletes.enabled</code> index setting. Requests that
set <code class="literal">index.soft_deletes.enabled</code> to <code class="literal">false</code> will return an error.</p>
</div>
</details>
<details>
<summary class="title">The <code class="literal">index.translog.retention.age</code> and <code class="literal">index.translog.retention.size</code> settings have been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Translog retention settings <code class="literal">index.translog.retention.age</code> and
<code class="literal">index.translog.retention.size</code> were effectively ignored in 7.4, deprecated in
7.7, and removed in 8.0 in favor of
<a href="/guide/en/elasticsearch/reference/master/index-modules-history-retention.html" class="ulink" target="_top">soft deletes</a>.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Discontinue use of the <code class="literal">index.translog.retention.age</code> and
<code class="literal">index.translog.retention.size</code> index settings. Requests that
include these settings will return an error.</p>
</div>
</details>
<details>
<summary class="title">The default for the <code class="literal">?wait_for_active_shards</code> parameter on the close index API has changed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
When closing an index in earlier versions, by default Elasticsearch would not wait for
the shards of the closed index to be properly assigned before returning. From
version 8.0 onwards the default behaviour is to wait for shards to be assigned
according to the
<a href="/guide/en/elasticsearch/reference/master/docs-index_.html#index-wait-for-active-shards" class="ulink" target="_top"><code class="literal">index.write.wait_for_active_shards</code>
index setting</a>.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Accept the new behaviour, or specify <code class="literal">?wait_for_active_shards=0</code> to preserve
the old behaviour if needed.</p>
</div>
</details>
<details>
<summary class="title">The index stats API&#8217;s <code class="literal">types</code> query parameter has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The index stats API&#8217;s <code class="literal">types</code> query parameter has been removed. Previously, you
could combine <code class="literal">types</code> with the <code class="literal">indexing</code> query parameter to return indexing
stats for specific mapping types. Mapping types have been removed in 8.0.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Discontinue use of the <code class="literal">types</code> query parameter. Requests that include the
parameter will return an error.</p>
</div>
</details>
<h4><a id="breaking_80_ingest_changes"></a>Ingest pipeline changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/ingest.asciidoc">edit</a></h4>
<details>
<summary class="title">The <code class="literal">user_agent</code> ingest processor&#8217;s <code class="literal">ecs</code> parameter has no effect.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In 7.2, we deprecated the <code class="literal">ecs</code> parameter for the <code class="literal">user_agent</code> ingest processor.
In 8.x, the <code class="literal">user_agent</code> ingest processor will only return <a href="/guide/en/ecs/master" class="ulink" target="_top">Elastic
Common Schema (ECS)</a> fields, regardless of the <code class="literal">ecs</code> value.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
To avoid deprecation warnings, remove the parameter from your ingest pipelines.
If a pipeline specifies an <code class="literal">ecs</code> value, the value is ignored.</p>
</div>
</details>
<h4><a id="breaking_80_java_changes"></a>Java API changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/java.asciidoc">edit</a></h4>
<details>
<summary class="title">Changes to <code class="literal">Fuzziness</code>.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
To create <code class="literal">Fuzziness</code> instances, use the <code class="literal">fromString</code> and <code class="literal">fromEdits</code> method
instead of the <code class="literal">build</code> method that used to accept both Strings and numeric
values. Several fuzziness setters on query builders (e.g.
MatchQueryBuilder#fuzziness) now accept only a `Fuzziness`instance instead of
an Object.</p>
<p>Fuzziness used to be lenient when it comes to parsing arbitrary numeric values
while silently truncating them to one of the three allowed edit distances 0, 1
or 2. This leniency is now removed and the class will throw errors when trying
to construct an instance with another value (e.g. floats like 1.3 used to get
accepted but truncated to 1).</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use the available constants (e.g. <code class="literal">Fuzziness.ONE</code>, <code class="literal">Fuzziness.AUTO</code>) or build
your own instance using the above mentioned factory methods. Use only allowed
<code class="literal">Fuzziness</code> values.</p>
</div>
</details>
<details>
<summary class="title">Changes to <code class="literal">Repository</code>.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Repository has no dependency on IndexShard anymore. The contract of restoreShard
and snapshotShard has been reduced to Store and MappingService in order to improve
testability.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
No action needed.</p>
</div>
</details>
<h4><a id="breaking_80_mappings_changes"></a>Mapping changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_8_0/mappings.asciidoc">edit</a></h4>
<details>
<summary class="title">The maximum number of completion contexts per field is now 10.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The number of completion contexts within a single completion field
has been limited to 10.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use a maximum of 10 completion contexts in a completion field. Specifying more
than 10 completion contexts will return an error.</p>
</div>
</details>
<details>
<summary class="title">Mapping API endpoints containing mapping types have been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The typed REST endpoints of the update mapping, get mapping and get field mapping
APIs have been removed in favour of their typeless REST endpoints, since indexes
no longer contain types, these typed endpoints are obsolete.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Use the typeless REST endpoints to update and retrieve mappings. Requests
submitted to the typed mapping API endpoints will return an error.</p>
</div>
</details>
<details>
<summary class="title">Multi-fields within multi-fields is no longer supported.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Previously, it was possible to define a multi-field within a multi-field.
Defining chained multi-fields was deprecated in 7.3 and is now no longer
supported.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
To migrate mappings, all instances of <code class="literal">fields</code> that occur within
a <code class="literal">fields</code> block should be removed, either by flattening the chained <code class="literal">fields</code>
blocks into a single level, or by switching to <code class="literal">copy_to</code> if appropriate.</p>
</div>
</details>
<details id="fieldnames-enabling">
<summary class="title">The <code class="literal">_field_names</code> metadata field&#8217;s <code class="literal">enabled</code> parameter has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The setting has been deprecated with 7.5 and is no longer supported on new indices.
Mappings for older indices will continue to work but emit a deprecation warning.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
The <code class="literal">enabled</code> setting for <code class="literal">_field_names</code> should be removed from templates and mappings.
Disabling _field_names is not necessary because it no longer carries a large index overhead.</p>
</div>
</details>
<details id="mapping-boosts">
<summary class="title">The <code class="literal">boost</code> parameter on field mappings has been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Index-time boosts have been deprecated since the 5x line, but it was still possible
to declare field-specific boosts in the mappings. This is now removed completely.
Indexes built in 7x that contain mapping boosts will emit warnings, and the boosts
will have no effect in 8.0. New indexes will not permit boosts to be set in their
mappings at all.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
The <code class="literal">boost</code> setting should be removed from templates and mappings. Use boosts
directly on queries instead.</p>
</div>
</details>
<details>
<summary class="title">Java-time date formats replace joda-time formats.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In 7.0, Elasticsearch switched from joda time to java time for date-related parsing,
formatting, and calculations. Indices created in 7.0 and later versions are
already required to use mappings with java-time date formats. However,
earlier indices using joda-time formats must be reindexed to use
mappings with java-time formats.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
For a detailed migration guide, see the <a href="/guide/en/elasticsearch/reference/master/migrate-to-java-time.html" class="ulink" target="_top">Java
time migration guide</a>.</p>
</div>
</details>
<details id="geo-shape-strategy">
<summary class="title">Several <code class="literal">geo_shape</code> mapping parameters have been removed.</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
The following <code class="literal">geo_shape</code> mapping parameters were deprecated in 6.6:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">tree</code>
</li>
<li class="listitem">
<code class="literal">tree_levels</code>
</li>
<li class="listitem">
<code class="literal">strategy</code>
</li>
<li class="listitem">
<code class="literal">distance_error_pct</code>
</li>
</ul>
</div>
<p>These parameters have been removed in 8.0.0.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
In 8.0, you can no longer create mappings that include these parameters.
However, 7.x indices that use these mapping parameters will continue to work.</p>
</div>
</details>


</div>
<div class="navfooter">
<span class="prev">
<a href="breaking-changes.html">« Migration guide</a>
</span>
<span class="next">
<a href="breaking_80_monitoring_changes.html">Monitoring changes »</a>
</span>
</div>
</div>
</body>
</html>
