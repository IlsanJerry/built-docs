<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Rollups | Elasticsearch Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [master]"/>
<link rel="up" href="data-rollup-transform.html" title="Roll up or transform your data"/>
<link rel="prev" href="data-rollup-transform.html" title="Roll up or transform your data"/>
<link rel="next" href="transforms.html" title="Transforming data"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="data-rollup-transform.html">Roll up or transform your data</a></span>
»
<span class="breadcrumb-node">Rollups</span>
</div>
<div class="navheader">
<span class="prev">
<a href="data-rollup-transform.html">« Roll up or transform your data</a>
</span>
<span class="next">
<a href="transforms.html">Transforming data »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="xpack-rollup"></a>Rollups<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/rollup/index.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<p>A rollup aggregates an index&#8217;s time series data and stores the results in a new
read-only index, called a rollup index. For example, you can roll up hourly
metric data into daily or weekly summaries.</p>
<p>A rollup index only contains aggregated data for the fields you choose. You can
search, visualize, and aggregate a rollup index like a regular index. While its
data is less granular, a rollup index contains fewer fields and documents,
making these operations faster.</p>
<p>Use rollups to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Reduce storage costs by deleting or archiving your original indices
</li>
<li class="listitem">
Speed up searches and visualizations
</li>
<li class="listitem">
Compactly store historical metric data
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/rollups/rollups.gif" alt="Use rollups to reduce the size of your data">
</div>
</div>
<h3><a id="roll-up-your-data"></a>Roll up your data<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/rollup/index.asciidoc">edit</a></h3>
<p>You typically perform rollups using the ILM <a class="xref" href="ilm-rollup.html" title="Rollup"><code class="literal">rollup</code></a>
action. You configure the <code class="literal">rollup</code> action with the aggregations and metrics
you want to store in the rollup index.</p>
<p>The <code class="literal">rollup</code> action also lets you specify an ILM policy for the resulting
rollup index. If you don&#8217;t specify this policy, ILM will not manage the
rollup index.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>In most cases, the ILM policy for a rollup index should differ from the
policy for its source index. To prevent <a class="xref" href="size-your-shards.html" title="How to size your shards">oversharding</a>, we
also recommend using the ILM <a class="xref" href="ilm-shrink.html" title="Shrink"><code class="literal">shrink</code></a> action to reduce the
rollup index&#8217;s primary shard count.</p>
</div>
</div>
<p>You can also manually roll up an index using the <a class="xref" href="rollup-api.html" title="Rollup API">rollup API</a>.</p>
<h3><a id="search-rollups"></a>Rollups and data streams<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/rollup/index.asciidoc">edit</a></h3>
<p>Rollups are designed to work with the backing indices of data streams. If you
roll up a backing index for a data stream, the resulting rollup index is a
backing index for the same stream.</p>
<p>If you search a data stream containing both a rollup index and its source index,
Elasticsearch automatically resolves searches without duplicate results.</p>
<p>If results from the rollup index and the source index would be the same, Elasticsearch
uses the rollup for faster results. If the results differ, Elasticsearch uses the source
index&#8217;s data for better accuracy. If you&#8217;ve replaced the source index with a
searchable snapshot, Elasticsearch uses the searchable snapshot as the source index.</p>
<p>This automatic search resolution lets you use rollups as a caching layer for
your data stream. You can keep rollup indices in a hot or warm <a class="xref" href="data-tiers.html" title="Data tiers">data
tier</a> and archive your original indices in a cold or frozen tier.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only data streams support automatic search resolution for rollups. Searches
directly targeting a rollup index and its source index may return duplicate
results.</p>
</div>
</div>
<h3><a id="legacy-rollups"></a>Legacy rollups<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/rollup/index.asciidoc">edit</a></h3>
<p>Before Elasticsearch 7.x, you could only create rollups using periodic cron jobs. Special
APIs were required to manage these jobs and search the resulting rollup indices.
These rollup APIs are now deprecated and will be removed in a future release.</p>
<p>See <a class="xref" href="rollup-apis.html#legacy-rollup-apis" title="Legacy rollup APIs">Legacy rollup APIs</a>.</p>
<h4><a id="differences-with-legacy-rollups"></a>Differences from legacy rollups<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/rollup/index.asciidoc">edit</a></h4>
<p>The new rollup functionality differs from legacy rollups as follows:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Rollups no longer require a cron job. You can perform rollups using the
ILM <a class="xref" href="ilm-rollup.html" title="Rollup"><code class="literal">rollup</code></a> action or <a class="xref" href="rollup-api.html" title="Rollup API">rollup API</a>.
</li>
<li class="listitem">
Rollup indices are read-only and only contain aggregated data from one source
index. Previously, multiple legacy rollup jobs could index into a single rollup
index.
</li>
<li class="listitem">
You can now search rollup indices like a regular index. Legacy rollup indices
required a special rollup search API, which could only search one rollup index
at a time.
</li>
<li class="listitem">
While still approximate, <code class="literal">terms</code> aggregations for rollups are now more
accurate. Previously, <code class="literal">terms</code> aggregations for legacy rollup jobs could provide
inaccurate document counts due to differences between shards for the source
index.
</li>
</ul>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="data-rollup-transform.html">« Roll up or transform your data</a>
</span>
<span class="next">
<a href="transforms.html">Transforming data »</a>
</span>
</div>
</div>
</body>
</html>
