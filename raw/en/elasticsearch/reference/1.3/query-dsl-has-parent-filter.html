<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Has Parent Filter
        | Elasticsearch Reference [1.3]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [1.3]" /><link rel="up" href="query-dsl-filters.html" title="Filters" /><link rel="prev" href="query-dsl-has-child-filter.html" title="Has Child Filter" /><link rel="next" href="query-dsl-ids-filter.html" title="Ids Filter" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Elasticsearch/Reference/1.3" /><meta xmlns="" name="DC.subject" content="Elasticsearch" /><meta xmlns="" name="DC.identifier" content="1.3" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [1.3]
    </a></span> » <span class="breadcrumb-link"><a href="query-dsl.html">Query DSL</a></span> » <span class="breadcrumb-link"><a href="query-dsl-filters.html">Filters</a></span> » <span class="breadcrumb-node">Has Parent Filter</span></div><div xmlns="" class="navheader"><span class="prev"><a href="query-dsl-has-child-filter.html">
              « 
              Has Child Filter</a>
           
        </span><span class="next">
           
          <a href="query-dsl-ids-filter.html">Ids Filter
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="query-dsl-has-parent-filter"></a>Has Parent Filter<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.3/docs/reference/query-dsl/filters/has-parent-filter.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The <code class="literal">has_parent</code> filter accepts a query and a parent type. The query is
executed in the parent document space, which is specified by the parent
type. This filter returns child documents which associated parents have
matched. For the rest <code class="literal">has_parent</code> filter has the same options and works
in the same manner as the <code class="literal">has_child</code> filter.</p><h4><a id="_filter_example"></a>Filter example<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.3/docs/reference/query-dsl/filters/has-parent-filter.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
    "has_parent" : {
        "parent_type" : "blog",
        "query" : {
            "term" : {
                "tag" : "something"
            }
        }
    }
}</pre></div><p>The <code class="literal">parent_type</code> field name can also be abbreviated to <code class="literal">type</code>.</p><p>The way that the filter is implemented is by first running the parent
query, doing the matching up to the child doc for each document matched.</p><p>The <code class="literal">has_parent</code> filter also accepts a filter instead of a query:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
    "has_parent" : {
        "type" : "blog",
        "filter" : {
            "term" : {
                "text" : "bonsai three"
            }
        }
    }
}</pre></div><h4><a id="_memory_considerations_9"></a>Memory Considerations<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.3/docs/reference/query-dsl/filters/has-parent-filter.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>In order to support parent-child joins, all of the (string) parent IDs
must be resident in memory (in the <a class="link" href="index-modules-fielddata.html" title="Field data">field data cache</a>.
Additionaly, every child document is mapped to its parent using a long
value (approximately). It is advisable to keep the string parent ID short
in order to reduce memory usage.</p><p>You can check how much memory is being used by the ID cache using the
<a class="link" href="indices-stats.html" title="Indices Stats">indices stats</a> or <a class="link" href="cluster-nodes-stats.html" title="Nodes Stats">nodes stats</a>
APIS, eg:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">curl -XGET "http://localhost:9200/_stats/id_cache?pretty&amp;human"</pre></div><h4><a id="_caching_10"></a>Caching<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.3/docs/reference/query-dsl/filters/has-parent-filter.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The <code class="literal">has_parent</code> filter cannot be cached in the filter cache. The <code class="literal">_cache</code>
and <code class="literal">_cache_key</code> options are a no-op in this filter. Also any filter that
wraps the <code class="literal">has_parent</code> filter either directly or indirectly will not be cached.</p></div><div xmlns="" class="navfooter"><span class="prev"><a href="query-dsl-has-child-filter.html">
              « 
              Has Child Filter</a>
           
        </span><span class="next">
           
          <a href="query-dsl-ids-filter.html">Ids Filter
               »
            </a></span></div></body></html>