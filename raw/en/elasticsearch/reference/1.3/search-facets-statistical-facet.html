<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Statistical Facet
        | Elasticsearch Reference [1.3]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [1.3]" /><link rel="up" href="search-facets.html" title="Facets" /><link rel="prev" href="search-facets-query-facet.html" title="Query Facets" /><link rel="next" href="search-facets-terms-stats-facet.html" title="Terms Stats Facet" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Elasticsearch/Reference/1.3" /><meta xmlns="" name="DC.subject" content="Elasticsearch" /><meta xmlns="" name="DC.identifier" content="1.3" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [1.3]
    </a></span> » <span class="breadcrumb-link"><a href="search.html">Search APIs</a></span> » <span class="breadcrumb-link"><a href="search-facets.html">Facets</a></span> » <span class="breadcrumb-node">Statistical Facet</span></div><div xmlns="" class="navheader"><span class="prev"><a href="search-facets-query-facet.html">
              « 
              Query Facets</a>
           
        </span><span class="next">
           
          <a href="search-facets-terms-stats-facet.html">Terms Stats Facet
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="search-facets-statistical-facet"></a>Statistical Facet<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.3/docs/reference/search/facets/statistical-facet.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div xmlns="" class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">Facets are deprecated and will be removed in a future release. You are
encouraged to migrate to <a class="link" href="search-aggregations.html" title="Aggregations">aggregations</a> instead.</p></div></div><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">The equivalent aggregation would be the
<a class="link" href="search-aggregations-metrics-stats-aggregation.html" title="Stats Aggregation"><code class="literal">stats</code></a>
aggregation.</p></div></div><p>Statistical facet allows to compute statistical data on a numeric
fields. The statistical data include count, total, sum of squares, mean
(average), minimum, maximum, variance, and standard deviation. Here is
an example:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
    "query" : {
        "match_all" : {}
    },
    "facets" : {
        "stat1" : {
            "statistical" : {
                "field" : "num1"
            }
        }
    }
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_script_field_2"></a>Script field<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.3/docs/reference/search/facets/statistical-facet.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>When using <code class="literal">field</code>, the numeric value of the field is used to compute
the statistical information. Sometimes, several fields values represent
the statistics we want to compute, or some sort of mathematical
evaluation. The script field allows to define a
<a class="link" href="modules-scripting.html" title="Scripting">script</a> to evaluate, with
its value used to compute the statistical information. For example:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
    "query" : {
        "match_all" : {}
    },
    "facets" : {
        "stat1" : {
            "statistical" : {
                "script" : "doc['num1'].value + doc['num2'].value"
            }
        }
    }
}</pre></div><p>Parameters can also be provided to the different scripts (preferable if
the script is the same, with different values for a specific parameter,
like "factor"):</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
    "query" : {
        "match_all" : {}
    },
    "facets" : {
        "stat1" : {
            "statistical" : {
                "script" : "(doc['num1'].value + doc['num2'].value) * factor",
                "params" : {
                    "factor" : 5
                }
            }
        }
    }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_multi_field"></a>Multi Field<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.3/docs/reference/search/facets/statistical-facet.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The statistical facet can be executed against more than one field,
returning the aggregation result across those fields. For example:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
    "query" : {
        "match_all" : {}
    },
    "facets" : {
        "stat1" : {
            "statistical" : {
                "fields" : ["num1", "num2"]
            }
        }
    }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_memory_considerations_4"></a>Memory Considerations<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/1.3/docs/reference/search/facets/statistical-facet.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>In order to implement the statistical facet, the relevant field values
are loaded into memory from the index. This means that per shard, there
should be enough memory to contain them. Since by default, dynamic
introduced types are <code class="literal">long</code> and <code class="literal">double</code>, one option to reduce the
memory footprint is to explicitly set the types for the relevant fields
to either <code class="literal">short</code>, <code class="literal">integer</code>, or <code class="literal">float</code> when possible.</p></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="search-facets-query-facet.html">
              « 
              Query Facets</a>
           
        </span><span class="next">
           
          <a href="search-facets-terms-stats-facet.html">Terms Stats Facet
               »
            </a></span></div></body></html>