<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Returning Empty Buckets
        | Elasticsearch: The Definitive Guide [2.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide [2.x]" /><link rel="up" href="_looking_at_time.html" title="Looking at Time" /><link rel="prev" href="_looking_at_time.html" title="Looking at Time" /><link rel="next" href="_extended_example.html" title="Extended Example" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Legacy/Elasticsearch/Definitive Guide/2.x" /><meta xmlns="" name="DC.subject" content="Elasticsearch" /><meta xmlns="" name="DC.identifier" content="2.x" /><meta xmlns="" name="robots" content="noindex,nofollow" /></head><body><div xmlns="" class="page_header">This information applies to version 2.x of Elasticsearch. For the
most up to date information, see the current version of the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">
Elasticsearch Reference</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide
      [2.x]
    </a></span> » <span class="breadcrumb-link"><a href="aggregations.html">Aggregations</a></span> » <span class="breadcrumb-link"><a href="_looking_at_time.html">Looking at Time</a></span> » <span class="breadcrumb-node">Returning Empty Buckets</span></div><div xmlns="" class="navheader"><span class="prev"><a href="_looking_at_time.html">
              « 
              Looking at Time</a>
           
        </span><span class="next">
           
          <a href="_extended_example.html">Extended Example
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_returning_empty_buckets"></a>Returning Empty Buckets<a xmlns="" href="https://github.com/elastic/elasticsearch-definitive-guide/edit/2.x/300_Aggregations/35_date_histogram.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Notice something odd about that last response?</p><p>Yep, that’s right.<a id="id-1.7.6.16.3.1" class="indexterm"></a>
<a id="id-1.7.6.16.3.2" class="indexterm"></a><a id="id-1.7.6.16.3.3" class="indexterm"></a>
<a id="id-1.7.6.16.3.4" class="indexterm"></a>  We are missing a few months!  By default, the <code class="literal">date_histogram</code>
(and <code class="literal">histogram</code> too) returns only buckets that have a nonzero
document count.</p><p>This means your histogram will be a minimal response.  Often, this is not the
behavior you want.  For many applications, you would like to dump the
response directly into a graphing library without doing any post-processing.</p><p>Essentially, we want buckets even if they have a count of zero. We can set two
additional parameters that will provide this behavior:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">GET /cars/transactions/_search
{
   "size" : 0,
   "aggs": {
      "sales": {
         "date_histogram": {
            "field": "sold",
            "interval": "month",
            "format": "yyyy-MM-dd",
            "min_doc_count" : 0, <a id="CO195-1"></a><i xmlns="" class="conum" data-value="1"></i>
            "extended_bounds" : { <a id="CO195-2"></a><i xmlns="" class="conum" data-value="2"></i>
                "min" : "2014-01-01",
                "max" : "2014-12-31"
            }
         }
      }
   }
}</pre></div><div xmlns="" class="sense_widget" data-snippet="snippets/300_Aggregations/35_date_histogram.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO195-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
This parameter forces empty buckets to be returned.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO195-2"><i xmlns="" class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>
This parameter forces the entire year to be returned.
</p></td></tr></table></div><p>The two additional parameters will force the response to return all months in the
year, regardless of their doc count.<a id="id-1.7.6.16.9.1" class="indexterm"></a>  The <code class="literal">min_doc_count</code> is very understandable:
it forces buckets to be returned even if they are empty.</p><p>The <code class="literal">extended_bounds</code> parameter requires a little explanation.<a id="id-1.7.6.16.10.2" class="indexterm"></a>  The <code class="literal">min_doc_count</code>
parameter forces empty buckets to be returned, but by default Elasticsearch will return only buckets that are between the minimum and maximum value in your data.</p><p>So if your data falls between April and July, you’ll have buckets
representing only those months (empty or otherwise).  To get the full year, we need
to tell  Elasticsearch that we want buckets even if they fall <span class="emphasis"><em>before</em></span> the
minimum value or <span class="emphasis"><em>after</em></span> the maximum value.</p><p>The <code class="literal">extended_bounds</code> parameter does just that.  Once you add those two settings,
you’ll get a response that is easy to plug straight into your graphing libraries
and give you a graph like <a class="xref" href="_returning_empty_buckets.html#date-histo-ts1" title="Figure 37. Cars sold over time">Figure 37, “Cars sold over time”</a>.</p><div class="figure"><a id="date-histo-ts1"></a><p class="title"><strong>Figure 37. Cars sold over time</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/elas_29in01.png" alt="Cars sold over time" /></div></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="_looking_at_time.html">
              « 
              Looking at Time</a>
           
        </span><span class="next">
           
          <a href="_extended_example.html">Extended Example
               »
            </a></span></div></body></html>