<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Shard Overallocation
        | Elasticsearch: The Definitive Guide [1.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide [1.x]" /><link rel="up" href="scale.html" title="Designing for Scale" /><link rel="prev" href="shard-scale.html" title="The Unit of Scale" /><link rel="next" href="kagillion-shards.html" title="Kagillion Shards" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Legacy/Elasticsearch/Definitive Guide/1.x" /><meta xmlns="" name="DC.subject" content="Elasticsearch" /><meta xmlns="" name="DC.identifier" content="1.x" /><meta xmlns="" name="robots" content="noindex,nofollow" /></head><body><div xmlns="" class="page_header">This information applies to version 1.x of Elasticsearch. For the
most up to date information, see the current version of the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">
Elasticsearch Reference</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide
      [1.x]
    </a></span> » <span class="breadcrumb-link"><a href="modeling-your-data.html">Modeling Your Data</a></span> » <span class="breadcrumb-link"><a href="scale.html">Designing for Scale</a></span> » <span class="breadcrumb-node">Shard Overallocation</span></div><div xmlns="" class="navheader"><span class="prev"><a href="shard-scale.html">
              « 
              The Unit of Scale</a>
           
        </span><span class="next">
           
          <a href="kagillion-shards.html">Kagillion Shards
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="overallocation"></a>Shard Overallocation<a xmlns="" href="https://github.com/elastic/elasticsearch-definitive-guide/edit/1.x/410_Scaling/20_Overallocation.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>A shard lives on a single node,<a id="id-1.9.6.8.2.1" class="indexterm"></a>
<a id="id-1.9.6.8.2.2" class="indexterm"></a><a id="id-1.9.6.8.2.3" class="indexterm"></a>
<a id="id-1.9.6.8.2.4" class="indexterm"></a> but a node can hold multiple shards. Imagine
that we created our index with two primary shards instead of one:</p><div xmlns="" class="pre_wrapper lang-json"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-json">PUT /my_index
{
  "settings": {
    "number_of_shards":   2, <a id="CO293-1"></a><i xmlns="" class="conum" data-value="1"></i>
    "number_of_replicas": 0
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO293-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
Create an index with two primary shards and zero replica shards.
</p></td></tr></table></div><p>With a single node, both shards would be assigned to the same node. From the
point of view of our application, everything functions as it did before.  The
application communicates with the index, not the shards, and there is still
only one index.</p><p>This time, when we add a second node, Elasticsearch will automatically move
one shard from the first node to the second node, as depicted in <a class="xref" href="overallocation.html#img-two-shard" title="Figure 50. An index with two shards can take advantage of a second node">Figure 50, “An index with two shards can take advantage of a second node”</a>. Once the relocation has
finished, each shard will have access to twice the computing power that it had
before.</p><div class="figure"><a id="img-two-shard"></a><p class="title"><strong>Figure 50. An index with two shards can take advantage of a second node</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/elas_4402.png" alt="An index with two shards can take advantage of a second node" /></div></div></div><p>We have been able to double our capacity by simply copying a shard across the
network to the new node. The best part is, we achieved this with zero
downtime.  All indexing and search requests continued to function normally
while the shard was being moved.</p><p>A new index in Elasticsearch is allotted five primary shards by default.  That
means that we can spread that index out over a maximum of five nodes, with one
shard on each node.  That’s a lot of capacity, and it happens without you
having to think about it at all!</p><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Shard Splitting</strong></p></div></div></div><p>Users often ask why Elasticsearch doesn’t support <span class="emphasis"><em>shard-splitting</em></span>—the
ability to split each shard into two or more pieces. <a id="id-1.9.6.8.10.2.2" class="indexterm"></a> The reason is that
shard-splitting is a bad idea:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Splitting a shard is almost equivalent to reindexing your data. It’s a much
  heavier process than just copying a shard from one node to another.
</li><li class="listitem">
Splitting is exponential. You start with one shard, then split into two, and then
  four, eight, sixteen, and so on. Splitting doesn’t allow you to increase capacity
  by just 50%.
</li><li class="listitem">
Shard splitting requires you to have enough capacity to hold a second copy
  of your index. Usually, by the time you realize that you need to scale out,
  you don’t have enough free space left to perform the split.
</li></ul></div><p>In a way, Elasticsearch does support shard splitting.  You can always reindex
your data to a new index with the appropriate number of shards (see
<a class="xref" href="reindex.html" title="Reindexing Your Data">Reindexing Your Data</a>).  It is still a more intensive process than moving shards around,
and still requires enough free space to complete, but at least you can control
the number of shards in the new index.</p></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="shard-scale.html">
              « 
              The Unit of Scale</a>
           
        </span><span class="next">
           
          <a href="kagillion-shards.html">Kagillion Shards
               »
            </a></span></div></body></html>