<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Handling Relationships
        | Elasticsearch: The Definitive Guide [1.x]
      | Elastic
    </title><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide [1.x]" /><link rel="up" href="modeling-your-data.html" title="Modeling Your Data" /><link rel="prev" href="modeling-your-data.html" title="Modeling Your Data" /><link rel="next" href="application-joins.html" title="Application-side Joins" /><meta name="DC.type" content="Learn/Docs/Legacy/Elasticsearch/Definitive Guide/1.x" /><meta name="DC.subject" content="Elasticsearch" /><meta name="DC.identifier" content="1.x" /><meta name="robots" content="noindex,nofollow" /></head><body><div class="page_header">This information applies to version 1.x of Elasticsearch. For the
most up to date information, see the current version of the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">
Elasticsearch Reference</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide
      [1.x]
    </a></span> » <span class="breadcrumb-link"><a href="modeling-your-data.html">Modeling Your Data</a></span> » <span class="breadcrumb-node">Handling Relationships</span></div><div class="navheader"><span class="prev"><a href="modeling-your-data.html">
              « 
              Modeling Your Data</a>
           
        </span><span class="next">
           
          <a href="application-joins.html">Application-side Joins
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="relations"></a>Handling Relationships<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/1.x/400_Relationships/10_Intro.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>In the real world, relationships<a id="id-1.9.3.2.1" class="indexterm"></a> matter: blog posts have comments, bank
accounts have transactions, customers have bank accounts, orders have order
lines, and directories have files and subdirectories.</p><p>Relational databases are specifically designed—and this will not come as a
surprise to you—to manage<a id="id-1.9.3.3.1" class="indexterm"></a>
<a id="id-1.9.3.3.2" class="indexterm"></a> relationships:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Each entity (or <span class="emphasis"><em>row</em></span>, in the relational world) can be uniquely identified
    by a <span class="emphasis"><em>primary key</em></span>.<a id="id-1.9.3.4.1.1.3" class="indexterm"></a>
</li><li class="listitem">
Entities are <span class="emphasis"><em>normalized</em></span>. The data for a unique entity is stored only
    once, and related entities store just its primary key. Changing the data of
    an entity has to happen in only one place.<a id="id-1.9.3.4.2.1.2" class="indexterm"></a>
<a id="id-1.9.3.4.2.1.3" class="indexterm"></a>
</li><li class="listitem">
Entities can be joined at query time, allowing for cross-entity search.
</li><li class="listitem">
Changes to a single entity are <span class="emphasis"><em>atomic</em></span>, <span class="emphasis"><em>consistent</em></span>, <span class="emphasis"><em>isolated</em></span>, and
    <span class="emphasis"><em>durable</em></span>.  (See <a class="ulink" href="http://en.wikipedia.org/wiki/ACID_transactions" target="_top"><span class="emphasis"><em>ACID Transactions</em></span></a>
    for more on this subject.)
</li><li class="listitem">
Most relational databases support ACID transactions across multiple
    entities.
</li></ul></div><p>But relational <a id="id-1.9.3.5.1" class="indexterm"></a>databases do have their limitations, besides their poor support
for full-text search. Joining entities at query time is expensive—more
joins that are required, the more expensive the query.  Performing joins
between entities that live on different hardware is so expensive that it is
just not practical. This places a limit on the amount of data that can be
stored on a single server.</p><p>Elasticsearch, like<a id="id-1.9.3.6.1" class="indexterm"></a> most NoSQL databases, treats the world as though it were
flat. An index is a flat collection of independent documents.<a id="id-1.9.3.6.2" class="indexterm"></a> A single
document should contain all of the information that is required to decide
whether it matches a search request.</p><p>While changing the data of a single document in Elasticsearch is
<a class="ulink" href="http://en.wikipedia.org/wiki/ACID_transactions" target="_top">ACIDic</a>, transactions
involving multiple documents are not.  There is no way to roll back the index
to its previous state if part of a transaction fails.</p><p>This FlatWorld has its advantages:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Indexing is fast and lock-free.
</li><li class="listitem">
Searching is fast and lock-free.
</li><li class="listitem">
Massive amounts of data can be spread across multiple nodes, because each
   document is independent of the others.
</li></ul></div><p>But relationships matter.  Somehow, we need to bridge the gap between
FlatWorld and the real world.<a id="id-1.9.3.10.1" class="indexterm"></a>
<a id="id-1.9.3.10.2" class="indexterm"></a> Four common techniques are used to manage
relational data in Elasticsearch:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<a class="link" href="application-joins.html" title="Application-side Joins">Application-side joins</a>
</li><li class="listitem">
<a class="link" href="denormalization.html" title="Denormalizing Your Data">Data denormalization</a>
</li><li class="listitem">
<a class="link" href="nested-objects.html" title="Nested Objects">Nested objects</a>
</li><li class="listitem">
<a class="link" href="parent-child.html" title="Parent-Child Relationship">Parent/child relationships</a>
</li></ul></div><p>Often the final solution will require a mixture of a few of these techniques.</p></div><div class="navfooter"><span class="prev"><a href="modeling-your-data.html">
              « 
              Modeling Your Data</a>
           
        </span><span class="next">
           
          <a href="application-joins.html">Application-side Joins
               »
            </a></span></div></body></html>
