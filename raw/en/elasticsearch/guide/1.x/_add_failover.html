<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Add Failover
        | Elasticsearch: The Definitive Guide [1.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide [1.x]" /><link rel="up" href="distributed-cluster.html" title="Life Inside a Cluster" /><link rel="prev" href="_add_an_index.html" title="Add an Index" /><link rel="next" href="_scale_horizontally.html" title="Scale Horizontally" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Legacy/Elasticsearch/Definitive Guide/1.x" /><meta xmlns="" name="DC.subject" content="Elasticsearch" /><meta xmlns="" name="DC.identifier" content="1.x" /><meta xmlns="" name="robots" content="noindex,nofollow" /></head><body><div xmlns="" class="page_header">This information applies to version 1.x of Elasticsearch. For the
most up to date information, see the current version of the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">
Elasticsearch Reference</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide
      [1.x]
    </a></span> » <span class="breadcrumb-link"><a href="getting-started.html">Getting Started</a></span> » <span class="breadcrumb-link"><a href="distributed-cluster.html">Life Inside a Cluster</a></span> » <span class="breadcrumb-node">Add Failover</span></div><div xmlns="" class="navheader"><span class="prev"><a href="_add_an_index.html">
              « 
              Add an Index</a>
           
        </span><span class="next">
           
          <a href="_scale_horizontally.html">Scale Horizontally
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_add_failover"></a>Add Failover<a xmlns="" href="https://github.com/elastic/elasticsearch-definitive-guide/edit/1.x/020_Distributed_Cluster/20_Add_failover.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Running a single node means that you have a single point of failure—there
is no redundancy.<a id="id-1.4.4.10.2.1" class="indexterm"></a> Fortunately, all we need to do to protect ourselves from data
loss is to start another node.</p><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Starting a Second Node</strong></p></div></div></div><p>To test what happens when you add a second<a id="id-1.4.4.10.3.2.1" class="indexterm"></a>
<a id="id-1.4.4.10.3.2.2" class="indexterm"></a> node, you can start a new node
in exactly the same way as you started the first one (see
<a class="xref" href="running-elasticsearch.html" title="Running Elasticsearch">Running Elasticsearch</a>), and from the same directory. Multiple nodes can
share the same directory.</p><p>As long as the second node has the same <code class="literal">cluster.name</code> as the first node (see
the <code class="literal">./config/elasticsearch.yml</code> file), it should automatically discover and
join the cluster run by the first node. If it doesn’t, check the logs to find
out what went wrong.  It may be that multicast is disabled on your network, or
that a firewall is preventing your nodes from communicating.</p></div><p>If we start a second node, our cluster would look like <a class="xref" href="_add_failover.html#cluster-two-nodes" title="Figure 3. A two-node cluster—all primary and replica shards are allocated">Figure 3, “A two-node cluster—all primary and replica shards are allocated”</a>.</p><div class="figure"><a id="cluster-two-nodes"></a><p class="title"><strong>Figure 3. A two-node cluster—all primary and replica shards are allocated</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/elas_0203.png" alt="A two-node cluster" /></div></div></div><p>The<a id="id-1.4.4.10.6.1" class="indexterm"></a>
<a id="id-1.4.4.10.6.2" class="indexterm"></a> second node has joined the cluster, and three <span class="emphasis"><em>replica shards</em></span> have <a id="id-1.4.4.10.6.4" class="indexterm"></a>
<a id="id-1.4.4.10.6.5" class="indexterm"></a>been
allocated to it—one for each primary shard.  That means that we can lose
either node, and all of our data will be intact.</p><p>Any newly indexed document will first be stored on a primary shard, and then copied in parallel to the associated replica shard(s). This ensures that our document can be retrieved from a primary shard or from any of its replicas.</p><p>The <code class="literal">cluster-health</code> now <a id="id-1.4.4.10.8.2" class="indexterm"></a>
<a id="id-1.4.4.10.8.3" class="indexterm"></a>shows a status of <code class="literal">green</code>, which means that all six
shards (all three primary shards and all three replica shards) are active:</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
   "cluster_name":          "elasticsearch",
   "status":                "green", <a id="CO7-1"></a><i xmlns="" class="conum" data-value="1"></i>
   "timed_out":             false,
   "number_of_nodes":       2,
   "number_of_data_nodes":  2,
   "active_primary_shards": 3,
   "active_shards":         6,
   "relocating_shards":     0,
   "initializing_shards":   0,
   "unassigned_shards":     0
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO7-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
Cluster <code class="literal">status</code> is <code class="literal">green</code>.
</p></td></tr></table></div><p>Our cluster is not only fully functional, but also <span class="emphasis"><em>always available</em></span>.</p></div><div xmlns="" class="navfooter"><span class="prev"><a href="_add_an_index.html">
              « 
              Add an Index</a>
           
        </span><span class="next">
           
          <a href="_scale_horizontally.html">Scale Horizontally
               »
            </a></span></div></body></html>