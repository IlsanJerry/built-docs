<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Not Quite Not
        | Elasticsearch: The Definitive Guide [1.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide [1.x]" /><link rel="up" href="controlling-relevance.html" title="Controlling Relevance" /><link rel="prev" href="query-scoring.html" title="Manipulating Relevance with Query Structure" /><link rel="next" href="ignoring-tfidf.html" title="Ignoring TF/IDF" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Legacy/Elasticsearch/Definitive Guide/1.x" /><meta xmlns="" name="DC.subject" content="Elasticsearch" /><meta xmlns="" name="DC.identifier" content="1.x" /><meta xmlns="" name="robots" content="noindex,nofollow" /></head><body><div xmlns="" class="page_header">This information applies to version 1.x of Elasticsearch. For the
most up to date information, see the current version of the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">
Elasticsearch Reference</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide
      [1.x]
    </a></span> » <span class="breadcrumb-link"><a href="search-in-depth.html">Search in Depth</a></span> » <span class="breadcrumb-link"><a href="controlling-relevance.html">Controlling Relevance</a></span> » <span class="breadcrumb-node">Not Quite Not</span></div><div xmlns="" class="navheader"><span class="prev"><a href="query-scoring.html">
              « 
              Manipulating Relevance with Query Structure</a>
           
        </span><span class="next">
           
          <a href="ignoring-tfidf.html">Ignoring TF/IDF
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="not-quite-not"></a>Not Quite Not<a xmlns="" href="https://github.com/elastic/elasticsearch-definitive-guide/edit/1.x/170_Relevance/30_Not_quite_not.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>A search on the Internet for “Apple” is likely to return results about the
company, the fruit, <a id="id-1.5.8.12.2.1" class="indexterm"></a>
<a id="id-1.5.8.12.2.2" class="indexterm"></a>
<a id="id-1.5.8.12.2.3" class="indexterm"></a><a id="id-1.5.8.12.2.4" class="indexterm"></a>
<a id="id-1.5.8.12.2.5" class="indexterm"></a>and various recipes.  We could try to narrow it down to
just the company by excluding words like <code class="literal">pie</code>, <code class="literal">tart</code>, <code class="literal">crumble</code>, and <code class="literal">tree</code>,
using a <code class="literal">must_not</code> clause in a <code class="literal">bool</code> query:</p><div xmlns="" class="pre_wrapper lang-json"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-json">GET /_search
{
  "query": {
    "bool": {
      "must": {
        "match": {
          "text": "apple"
        }
      },
      "must_not": {
        "match": {
          "text": "pie tart fruit crumble tree"
        }
      }
    }
  }
}</pre></div><p>But who is to say that we wouldn’t miss a very relevant document about Apple
the company by excluding <code class="literal">tree</code> or <code class="literal">crumble</code>?  Sometimes, <code class="literal">must_not</code> can be
too strict.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="boosting-query"></a>boosting Query<a xmlns="" href="https://github.com/elastic/elasticsearch-definitive-guide/edit/1.x/170_Relevance/30_Not_quite_not.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The  <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/1.7/query-dsl-boosting-query.html" target="_top"><code class="literal">boosting</code> query</a> solves<a id="id-1.5.8.12.5.2.2" class="indexterm"></a><a id="id-1.5.8.12.5.2.3" class="indexterm"></a>
<a id="id-1.5.8.12.5.2.4" class="indexterm"></a>
<a id="id-1.5.8.12.5.2.5" class="indexterm"></a> this problem.
It allows us to still include results that appear to be about the fruit or
the pastries, but to downgrade them—to rank them lower than they would
otherwise be:</p><div xmlns="" class="pre_wrapper lang-json"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-json">GET /_search
{
  "query": {
    "boosting": {
      "positive": {
        "match": {
          "text": "apple"
        }
      },
      "negative": {
        "match": {
          "text": "pie tart fruit crumble tree"
        }
      },
      "negative_boost": 0.5
    }
  }
}</pre></div><p>It accepts a <code class="literal">positive</code> query and a <code class="literal">negative</code> query.<a id="id-1.5.8.12.5.4.3" class="indexterm"></a>  Only documents that
match the <code class="literal">positive</code> query will be included in the results list, but documents
that also match the <code class="literal">negative</code> query will be downgraded by multiplying the
original <code class="literal">_score</code> of<a id="id-1.5.8.12.5.4.7" class="indexterm"></a> the document with the <code class="literal">negative_boost</code>.</p><p>For this to work, the <code class="literal">negative_boost</code> must be less than <code class="literal">1.0</code>.  In this
example, any documents that contain any of the negative terms will have their
<code class="literal">_score</code> cut in half.</p></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="query-scoring.html">
              « 
              Manipulating Relevance with Query Structure</a>
           
        </span><span class="next">
           
          <a href="ignoring-tfidf.html">Ignoring TF/IDF
               »
            </a></span></div></body></html>