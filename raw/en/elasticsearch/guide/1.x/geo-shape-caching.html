<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Geo Shape Filters and Caching
        | Elasticsearch: The Definitive Guide [1.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide [1.x]" /><link rel="up" href="geo-shapes.html" title="Geo Shapes" /><link rel="prev" href="indexed-geo-shapes.html" title="Querying with Indexed Shapes" /><link rel="next" href="modeling-your-data.html" title="Modeling Your Data" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Legacy/Elasticsearch/Definitive Guide/1.x" /><meta xmlns="" name="DC.subject" content="Elasticsearch" /><meta xmlns="" name="DC.identifier" content="1.x" /><meta xmlns="" name="robots" content="noindex,nofollow" /></head><body><div xmlns="" class="page_header">This information applies to version 1.x of Elasticsearch. For the
most up to date information, see the current version of the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">
Elasticsearch Reference</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide
      [1.x]
    </a></span> » <span class="breadcrumb-link"><a href="geoloc.html">Geolocation</a></span> » <span class="breadcrumb-link"><a href="geo-shapes.html">Geo Shapes</a></span> » <span class="breadcrumb-node">Geo Shape Filters and Caching</span></div><div xmlns="" class="navheader"><span class="prev"><a href="indexed-geo-shapes.html">
              « 
              Querying with Indexed Shapes</a>
           
        </span><span class="next">
           
          <a href="modeling-your-data.html">Modeling Your Data
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="geo-shape-caching"></a>Geo Shape Filters and Caching<a xmlns="" href="https://github.com/elastic/elasticsearch-definitive-guide/edit/1.x/340_Geoshapes/80_Caching_geo_shapes.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The <code class="literal">geo_shape</code> query and filter perform the same function.<a id="id-1.8.6.13.2.2" class="indexterm"></a>
<a id="id-1.8.6.13.2.3" class="indexterm"></a><a id="id-1.8.6.13.2.4" class="indexterm"></a>
<a id="id-1.8.6.13.2.5" class="indexterm"></a><a id="id-1.8.6.13.2.6" class="indexterm"></a>
<a id="id-1.8.6.13.2.7" class="indexterm"></a>  The query simply
acts as a filter: any matching documents receive a relevance <code class="literal">_score</code> of
<code class="literal">1</code>. Query results cannot be cached, but filter results can be.</p><p>The results are not cached by default.  Just as with geo-points, any
change in the coordinates in a shape are likely to produce a different set of
geohashes, so there is little point in caching filter results.  That said, if
you filter using the same shapes repeatedly, it can be worth caching the
results, by setting <code class="literal">_cache</code> to <code class="literal">true</code>:</p><div xmlns="" class="pre_wrapper lang-json"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-json">GET /attractions/neighborhood/_search
{
  "query": {
    "filtered": {
      "filter": {
        "geo_shape": {
          "_cache": true, <a id="CO252-1"></a><i xmlns="" class="conum" data-value="1"></i>
          "location": {
            "indexed_shape": {
              "index": "attractions",
              "type":  "landmark",
              "id":    "dam_square",
              "path":  "location"
            }
          }
        }
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO252-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
The results of this <code class="literal">geo_shape</code> filter will be cached.
</p></td></tr></table></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="indexed-geo-shapes.html">
              « 
              Querying with Indexed Shapes</a>
           
        </span><span class="next">
           
          <a href="modeling-your-data.html">Modeling Your Data
               »
            </a></span></div></body></html>