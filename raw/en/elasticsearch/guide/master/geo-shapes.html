<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Geo Shapes
        | Elasticsearch: The Definitive Guide [master]
      | Elastic
    </title><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide [master]" /><link rel="up" href="geoloc.html" title="Geolocation" /><link rel="prev" href="geo-bounds-agg.html" title="Geo Bounds Aggregation" /><link rel="next" href="mapping-geo-shapes.html" title="Mapping Geo Shapes" /><meta name="DC.type" content="Learn/Docs/Legacy/Elasticsearch/Definitive Guide/master" /><meta name="DC.subject" content="Elasticsearch" /><meta name="DC.identifier" content="master" /><meta name="robots" content="noindex,nofollow" /></head><body><div class="page_header">This information may not apply to the latest version of Elasticsearch.
For the most up to date information, see the current version of the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">
Elasticsearch Reference</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide
      [master]
    </a></span> » <span class="breadcrumb-link"><a href="geoloc.html">Geolocation</a></span> » <span class="breadcrumb-node">Geo Shapes</span></div><div class="navheader"><span class="prev"><a href="geo-bounds-agg.html">
              « 
              Geo Bounds Aggregation</a>
           
        </span><span class="next">
           
          <a href="mapping-geo-shapes.html">Mapping Geo Shapes
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="geo-shapes"></a>Geo Shapes<a href="https://github.com/elastic/elasticsearch-definitive-guide/edit/master/340_Geoshapes/70_Geoshapes.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Geo-shapes use a completely different approach than geo-points.<a id="id-1.8.6.2.1" class="indexterm"></a> A circle on a
computer screen does not consist of a perfect continuous line. Instead it is
drawn by coloring adjacent pixels as an approximation of a circle. Geo-shapes
work in much the same way.</p><p>Complex shapes—such as points, lines, polygons, multipolygons, and polygons with
holes,--are “painted” onto a grid of geohash cells, and the shape is
converted into a list of the <a id="id-1.8.6.3.1" class="indexterm"></a>
<a id="id-1.8.6.3.2" class="indexterm"></a>geohashes of all the cells that it touches.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Actually, two types of grids can be used with geo-shapes:
geohashes, which we have already discussed and which are the default encoding,
and <span class="emphasis"><em>quad trees</em></span>.  <a id="id-1.8.6.4.1.2" class="indexterm"></a>Quad trees are similar to geohashes except that there are
only four cells at each level, instead of 32.  The difference comes down to a
choice of encoding.</p></div></div><p>All of the geohashes that compose a shape are indexed as if they were terms.
With this information in the index, it is easy to determine whether one shape
intersects with another, as they will share the same geohash terms.</p><p>That is the extent of what you can do with geo-shapes: determine the
relationship between a query shape and a shape in the index.  The <code class="literal">relation</code>
can be <a id="id-1.8.6.6.2" class="indexterm"></a>one of the following:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">intersects</code>
</span></dt><dd>
    The query shape overlaps with the indexed shape (default).
</dd><dt><span class="term">
<code class="literal">disjoint</code>
</span></dt><dd>
    The query shape does <span class="emphasis"><em>not</em></span> overlap at all with the indexed shape.
</dd><dt><span class="term">
<code class="literal">within</code>
</span></dt><dd>
    The indexed shape is entirely within the query shape.
</dd></dl></div><p>Geo-shapes cannot be used to caculate distance, cannot be used for
sorting or scoring, and cannot be used in aggregations.</p></div><div class="navfooter"><span class="prev"><a href="geo-bounds-agg.html">
              « 
              Geo Bounds Aggregation</a>
           
        </span><span class="next">
           
          <a href="mapping-geo-shapes.html">Mapping Geo Shapes
               »
            </a></span></div></body></html>
