<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Configure a snapshot repository using AWS
        | Elasticsearch Add-On for Heroku Documentation
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Add-On for Heroku Documentation" /><link rel="up" href="ech-custom-repository.html" title="Snapshot and restore with custom repositories" /><link rel="prev" href="ech-custom-repository.html" title="Snapshot and restore with custom repositories" /><link rel="next" href="ech-gcs-snapshotting.html" title="Configure a snapshot repository using GCS" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Cloud-Heroku/Reference" /><meta xmlns="" name="DC.subject" content="Elasticsearch Add-On for Heroku" /><meta xmlns="" name="DC.identifier" content="release-ms-25" /><meta xmlns="" name="robots" content="noindex,nofollow" /></head><body><div xmlns="" class="page_header">The documentation you are looking at is in the process of being revised.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Add-On for Heroku Documentation</a></span> » <span class="breadcrumb-link"><a href="ech-snapshot-restore.html">Snapshot and restore</a></span> » <span class="breadcrumb-link"><a href="ech-custom-repository.html">Snapshot and restore with custom repositories</a></span> » <span class="breadcrumb-node">Configure a snapshot repository using AWS</span></div><div xmlns="" class="navheader"><span class="prev"><a href="ech-custom-repository.html">
              « 
              Snapshot and restore with custom repositories</a>
           
        </span><span class="next">
           
          <a href="ech-gcs-snapshotting.html">Configure a snapshot repository using GCS
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ech-aws-custom-repository"></a>Configure a snapshot repository using AWS</h2></div></div></div><p>Configure a custom snapshot repository using your AWS account.</p><h4><a id="ech-prepare-aws-bucket"></a>Prepare a bucket</h4><p>Create the bucket with your custom AWS account. Make sure the bucket is in the same region as your cluster.</p><p>Then, create an IAM user, copy the access key ID and secret, then configure the following user policy. This is important to make sure the access keys, which you will need to provide to your cluster, can only access the intended bucket.</p><div xmlns="" class="pre_wrapper lang-json"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-json">{
  "Statement": [
    {
      "Action": [
        "s3:*"
      ],
      "Effect": "Allow",
      "Resource": [
        "arn:aws:s3:::bucket-name",
        "arn:aws:s3:::bucket-name/*"
      ]
    }
  ]
}</pre></div><p>For more information on S3 and IAM, see AWS' <a class="ulink" href="http://docs.aws.amazon.com/AmazonS3/latest/dev/Introduction.html" target="_top">S3-documentation</a> and <a class="ulink" href="http://aws.amazon.com/documentation/iam/" target="_top">IAM-documentation</a>.</p><h4><a id="ech-create-aws-repository"></a>Create the repository</h4><p>With the bucket ready, you can create a repository by <code class="literal">PUT</code>-ing the following to <code class="literal">/_snapshot/repository_name</code>:</p><div xmlns="" class="pre_wrapper lang-json"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-json">{
  "type": "s3",
  "settings": {
    "bucket": "name-of-bucket",
    "region": "region-of-bucket-same-as-cluster",
    "access_key": "YOURKEYHERE",
    "secret_key": "secret-key-with-just-permission-to-that-bucket-do-not-use-a-master-key",
    "compress": true
  }
}</pre></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="ech-custom-repository.html">
              « 
              Snapshot and restore with custom repositories</a>
           
        </span><span class="next">
           
          <a href="ech-gcs-snapshotting.html">Configure a snapshot repository using GCS
               »
            </a></span></div></body></html>