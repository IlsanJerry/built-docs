<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Plugin feature registration
        | Kibana User Guide [7.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Kibana User Guide [7.x]" /><link rel="up" href="plugin-development.html" title="Plugin Development" /><link rel="prev" href="development-uiexports.html" title="UI Exports" /><link rel="next" href="development-plugin-functional-tests.html" title="Functional Tests for Plugins" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Kibana/Reference/7.x" /><meta xmlns="" name="DC.subject" content="Kibana" /><meta xmlns="" name="DC.identifier" content="7.x" /></head><body><div xmlns="" class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Kibana User Guide
      [7.x]
    </a></span> » <span class="breadcrumb-link"><a href="development.html">Contributing to Kibana</a></span> » <span class="breadcrumb-link"><a href="plugin-development.html">Plugin Development</a></span> » <span class="breadcrumb-node">Plugin feature registration</span></div><div xmlns="" class="navheader"><span class="prev"><a href="development-uiexports.html">
              « 
              UI Exports</a>
           
        </span><span class="next">
           
          <a href="development-plugin-functional-tests.html">Functional Tests for Plugins
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="development-plugin-feature-registration"></a>Plugin feature registration<a xmlns="" href="https://github.com/elastic/kibana/edit/7.x/docs/development/plugin/development-plugin-feature-registration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>If your plugin will be used with Kibana’s default distribution, then you have the ability to register the features that your plugin provides. Features are typically apps in Kibana; once registered, you can toggle them via Spaces, and secure them via Roles when security is enabled.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_ui_capabilities"></a>UI Capabilities<a xmlns="" href="https://github.com/elastic/kibana/edit/7.x/docs/development/plugin/development-plugin-feature-registration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Registering features also gives your plugin access to “UI Capabilities”. These capabilities are boolean flags that you can use to conditionally render your interface, based on the current user’s permissions. For example, you can  hide or disable a Save button if the current user is not authorized.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_registering_a_feature"></a>Registering a feature<a xmlns="" href="https://github.com/elastic/kibana/edit/7.x/docs/development/plugin/development-plugin-feature-registration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Feature registration is controlled via the built-in <code class="literal">xpack_main</code> plugin. To register a feature, call <code class="literal">xpack_main</code>'s <code class="literal">registerFeature</code> function from your plugin’s <code class="literal">init</code> function, and provide the appropriate details:</p><div xmlns="" class="pre_wrapper lang-javascript"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-javascript">init(server) {
  const xpackMainPlugin = server.plugins.xpack_main;
  xpackMainPlugin.registerFeature({
    // feature details here.
  });
}</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_feature_details"></a>Feature details<a xmlns="" href="https://github.com/elastic/kibana/edit/7.x/docs/development/plugin/development-plugin-feature-registration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>Registering a feature consists of the following fields. For more information, consult the <a class="ulink" href="https://github.com/elastic/kibana/blob/7.x/x-pack/legacy/plugins/xpack_main/server/lib/feature_registry/feature_registry.ts" target="_top">feature registry interface</a>.</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><tbody><tr><td align="left" valign="top"><p>Field name</p></td><td align="left" valign="top"><p>Data type</p></td><td align="left" valign="top"><p>Example</p></td><td align="left" valign="top"><p>Description</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">id</code> (required)</p></td><td align="left" valign="top"><p><code class="literal">string</code></p></td><td align="left" valign="top"><p><code class="literal">"sample_feature"</code></p></td><td align="left" valign="top"><p>A unique identifier for your feature. Usually, the ID of your plugin is sufficient.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">name</code> (required)</p></td><td align="left" valign="top"><p><code class="literal">string</code></p></td><td align="left" valign="top"><p><code class="literal">"Sample Feature"</code></p></td><td align="left" valign="top"><p>A human readable name for your feature.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">app</code> (required)</p></td><td align="left" valign="top"><p><code class="literal">string[]</code></p></td><td align="left" valign="top"><p><code class="literal">["sample_app", "kibana"]</code></p></td><td align="left" valign="top"><p>An array of applications this feature enables. Typically, all of your plugin’s apps (from <code class="literal">uiExports</code>) will be included here.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">privileges</code> (required)</p></td><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p>see examples below</p></td><td align="left" valign="top"><p>The set of privileges this feature requires to function.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">icon</code></p></td><td align="left" valign="top"><p><code class="literal">string</code></p></td><td align="left" valign="top"><p>"discoverApp"</p></td><td align="left" valign="top"><p>An <a class="ulink" href="https://elastic.github.io/eui/#/display/icons" target="_top">EUI Icon</a> to use for this feature.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">navLinkId</code></p></td><td align="left" valign="top"><p><code class="literal">string</code></p></td><td align="left" valign="top"><p>"sample_app"</p></td><td align="left" valign="top"><p>The ID of the navigation link associated with your feature.</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_privilege_definition"></a>Privilege definition<a xmlns="" href="https://github.com/elastic/kibana/edit/7.x/docs/development/plugin/development-plugin-feature-registration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>The <code class="literal">privileges</code> section of feature registration allows plugins to implement read/write and read-only modes for their applications.</p><p>For a full explanation of fields and options, consult the <a class="ulink" href="https://github.com/elastic/kibana/blob/7.x/x-pack/legacy/plugins/xpack_main/server/lib/feature_registry/feature_registry.ts" target="_top">feature registry interface</a>.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_using_ui_capabilities"></a>Using UI Capabilities<a xmlns="" href="https://github.com/elastic/kibana/edit/7.x/docs/development/plugin/development-plugin-feature-registration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>UI Capabilities are available to your public (client) plugin code. These capabilities are read-only, and are used to inform the UI. This object is namespaced by feature id. For example, if your feature id is “foo”, then your UI Capabilities are stored at <code class="literal">uiCapabilities.foo</code>.
To access capabilities, import them from <code class="literal">ui/capabilities</code>:</p><div xmlns="" class="pre_wrapper lang-javascript"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-javascript">import { uiCapabilities } from 'ui/capabilities';

const canUserSave = uiCapabilities.foo.save;
if (canUserSave) {
  // show save button
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_example_1_canvas_application"></a>Example 1: Canvas Application<a xmlns="" href="https://github.com/elastic/kibana/edit/7.x/docs/development/plugin/development-plugin-feature-registration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div xmlns="" class="pre_wrapper lang-javascript"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-javascript">init(server) {
  const xpackMainPlugin = server.plugins.xpack_main;
  xpackMainPlugin.registerFeature({
    id: 'canvas',
    name: 'Canvas',
    icon: 'canvasApp',
    navLinkId: 'canvas',
    app: ['canvas', 'kibana'],
    catalogue: ['canvas'],
    privileges: {
      all: {
        savedObject: {
          all: ['canvas-workpad'],
          read: ['index-pattern'],
        },
        ui: ['save'],
      },
      read: {
        savedObject: {
          all: [],
          read: ['index-pattern', 'canvas-workpad'],
        },
        ui: [],
      },
    },
  });
}</pre></div><p>This shows how the Canvas application might register itself as a Kibana feature.
Note that it specifies different <code class="literal">savedObject</code> access levels for each privilege:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Users with read/write access (<code class="literal">all</code> privilege) need to be able to read/write <code class="literal">canvas-workpad</code> saved objects, and they need read-only access to <code class="literal">index-pattern</code> saved objects.
</li><li class="listitem">
Users with read-only access (<code class="literal">read</code> privilege) do not need to have read/write access to any saved objects, but instead get read-only access to <code class="literal">index-pattern</code> and <code class="literal">canvas-workpad</code> saved objects.
</li></ul></div><p>Additionally, Canvas registers the <code class="literal">canvas</code> UI app and <code class="literal">canvas</code> catalogue entry. This tells Kibana that these entities are available for users with either the <code class="literal">read</code> or <code class="literal">all</code> privilege.</p><p>The <code class="literal">all</code> privilege defines a single “save” UI Capability. To access this in the UI, Canvas could:</p><div xmlns="" class="pre_wrapper lang-javascript"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-javascript">import { uiCapabilities } from 'ui/capabilities';

const canUserSave = uiCapabilities.canvas.save;
if (canUserSave) {
  // show save button
}</pre></div><p>Because the <code class="literal">read</code> privilege does not define the <code class="literal">save</code> capability, users with read-only access will have their <code class="literal">uiCapabilities.canvas.save</code> flag set to <code class="literal">false</code>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_example_2_dev_tools"></a>Example 2: Dev Tools<a xmlns="" href="https://github.com/elastic/kibana/edit/7.x/docs/development/plugin/development-plugin-feature-registration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div xmlns="" class="pre_wrapper lang-javascript"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-javascript">init(server) {
  const xpackMainPlugin = server.plugins.xpack_main;
  xpackMainPlugin.registerFeature({
    id: 'dev_tools',
    name: i18n.translate('xpack.main.featureRegistry.devToolsFeatureName', {
      defaultMessage: 'Dev Tools',
    }),
    icon: 'devToolsApp',
    navLinkId: 'kibana:dev_tools',
    app: ['kibana'],
    catalogue: ['console', 'searchprofiler', 'grokdebugger'],
    privileges: {
      all: {
        api: ['console'],
        savedObject: {
          all: [],
          read: [],
        },
        ui: ['show'],
      },
      read: {
        api: ['console'],
        savedObject: {
          all: [],
          read: [],
        },
        ui: ['show'],
      },
    },
    privilegesTooltip: i18n.translate('xpack.main.featureRegistry.devToolsPrivilegesTooltip', {
     defaultMessage:
       'User should also be granted the appropriate Elasticsearch cluster and index privileges',
   }),
  });
}</pre></div><p>Unlike the Canvas example above, Dev Tools does not require access to any saved objects to function. Dev Tools does specify an API endpoint, however. When this is configured, the Security plugin will automatically authorize access to any server API route that is tagged with <code class="literal">access:console</code>, similar to the following:</p><div xmlns="" class="pre_wrapper lang-javascript"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-javascript">server.route({
 path: '/api/console/proxy',
 method: 'POST',
 config: {
   tags: ['access:console'],
   handler: async (req, h) =&gt; {
     // ...
   }
 }
});</pre></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="development-uiexports.html">
              « 
              UI Exports</a>
           
        </span><span class="next">
           
          <a href="development-plugin-functional-tests.html">Functional Tests for Plugins
               »
            </a></span></div></body></html>