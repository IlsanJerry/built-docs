<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Getting started | APM Real User Monitoring JavaScript Agent Reference [4.x] | Elastic</title>
<link rel="home" href="index.html" title="APM Real User Monitoring JavaScript Agent Reference [4.x]"/>
<link rel="up" href="index.html" title="APM Real User Monitoring JavaScript Agent Reference [4.x]"/>
<link rel="prev" href="intro.html" title="Introduction"/>
<link rel="next" href="supported-technologies.html" title="Supported Technologies"/>
<meta name="DC.type" content="Learn/Docs/APM Real User Monitoring JavaScript Agent/Reference/4.x"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="4.x"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">APM Real User Monitoring JavaScript Agent Reference [4.x]</a></span>
»
<span class="breadcrumb-node">Getting started</span>
</div>
<div class="navheader">
<span class="prev">
<a href="intro.html">« Introduction</a>
</span>
<span class="next">
<a href="supported-technologies.html">Supported Technologies »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h1 class="title"><a id="getting-started"></a>Getting started<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-rum-js/edit/4.x/docs/intro.asciidoc">edit</a></h1>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="getting-started.html#using-package-managers" title="Using Package Managers">Using Package Managers</a>
</li>
<li class="listitem">
<a class="xref" href="getting-started.html#using-script-tags" title="Using Script Tags">Using Script Tags</a>
</li>
<li class="listitem">
<a class="xref" href="getting-started.html#using-production-build" title="Using Production Build">Using Production Build</a>
</li>
<li class="listitem">
<a class="xref" href="getting-started.html#configuring-cors" title="Configuring CORS">Configuring CORS</a>
</li>
</ul>
</div>
<h3><a id="using-package-managers"></a>Using Package Managers<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-rum-js/edit/4.x/docs/intro.asciidoc">edit</a></h3>
<p>Install the APM agent for JavaScript as a dependency to your application:</p>
<div class="pre_wrapper lang-bash">
<pre class="programlisting prettyprint lang-bash">npm install @elastic/apm-rum --save</pre>
</div>
<p>Configure the agent:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">import { init as initApm } from '@elastic/apm-rum'
const apm = initApm({

  // Set required service name (allowed characters: a-z, A-Z, 0-9, -, _, and space)
  serviceName: '',

  // Set custom APM Server URL (default: http://localhost:8200)
  serverUrl: 'http://localhost:8200',

  // Set service version (required for sourcemap feature)
  serviceVersion: ''
})</pre>
</div>
<h3><a id="using-script-tags"></a>Using Script Tags<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-rum-js/edit/4.x/docs/intro.asciidoc">edit</a></h3>
<p>Add a &lt;script&gt; tag to the HTML page and use the <code class="literal">elasticApm</code> global object to load and initialize the agent:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Please download the latest version of JavaScript agent from <a href="https://github.com/elastic/apm-agent-rum-js/releases/latest" class="ulink" target="_top">GitHub</a> or
<a href="https://unpkg.com/@elastic/apm-rum/dist/bundles/elastic-apm-rum.umd.min.js" class="ulink" target="_top">UNPKG</a> and host the file in your Server/CDN before deploying to production.</p>
</div>
</div>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;script src="https://your-cdn-host.com/path/to/elastic-apm-rum.umd.min.js" crossorigin&gt;&lt;/script&gt;
&lt;script&gt;
  elasticApm.init({
    serviceName: '',
    serverUrl: 'http://localhost:8200',
  })
&lt;/script&gt;</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Currently the optimized(minified + gzipped) JavaScript bundle size is about 16KiB.</p>
</div>
</div>
<h3><a id="using-production-build"></a>Using Production Build<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-rum-js/edit/4.x/docs/intro.asciidoc">edit</a></h3>
<p>By default, RUM agent logs all the debug messages to the browser console. These logs are very useful in development. However, they make the RUM agent bundle size larger so you should make sure to use the optimized production version when deploying your application.</p>
<p>You can find instructions for building optimized code below for different bundlers</p>
<h4><a id="_webpack"></a>Webpack<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-rum-js/edit/4.x/docs/intro.asciidoc">edit</a></h4>
<p>For optimized webpack production build, include the Environment/Define plugin in the webpack configuration.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">const { EnvironmentPlugin } = require('webpack')

plugins: [
  new EnvironmentPlugin({
    NODE_ENV: 'production'
  })
]</pre>
</div>
<p>You can learn more about this in <a href="https://webpack.js.org/plugins/environment-plugin" class="ulink" target="_top">Webpack documentation</a>.</p>
<h4><a id="_rollup"></a>Rollup<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-rum-js/edit/4.x/docs/intro.asciidoc">edit</a></h4>
<p>For optimized rollup production build, include the replace plugin which ensures the right build environment is used.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">const replace = require('rollup-plugin-replace')

plugins: [
  replace({
    'process.env.NODE_ENV': 'production'
  })
]</pre>
</div>
<h3><a id="configuring-cors"></a>Configuring CORS<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-rum-js/edit/4.x/docs/intro.asciidoc">edit</a></h3>
<p>If APM Server is deployed in an origin different than the page&#8217;s origin,
you will need to configure Cross-Origin Resource Sharing (CORS).
To configure CORS, simply:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a href="/guide/en/apm/server/current/configuration-rum.html" class="ulink" target="_top">Enable RUM support</a> in APM Server.
</li>
<li class="listitem">
Adjust the <a href="/guide/en/apm/server/current/configuration-rum.html#rum-allow-origins" class="ulink" target="_top"><code class="literal">apm-server.rum.allow_origins</code></a> configuration.
By default, APM Server allows all origins.
</li>
</ol>
</div>
<h4><a id="_how_cors_works"></a>How CORS works<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-rum-js/edit/4.x/docs/intro.asciidoc">edit</a></h4>
<p>When the RUM agent makes it&#8217;s initial <code class="literal">POST</code> request, the browser will check to see if it is a cross-origin request.
If it is, the browser automatically makes a preflight <code class="literal">OPTIONS</code> request to the server to ensure the original <code class="literal">POST</code> request is allowed.
If this <code class="literal">OPTIONS</code> check passes, then the original <code class="literal">POST</code> request is allowed.
This request will fail if RUM support is not configured in the APM Server.</p>
<p>If you use a proxy, the preflight request headers may be necessary for your configuration:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">Access-Control-Request-Headers: Content-Type
Access-Control-Request-Method: POST
Origin: [request-origin]</pre>
</div>
<p>The response should include these headers:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">Access-Control-Allow-Headers: Content-Type
Access-Control-Allow-Methods: POST, OPTIONS
Access-Control-Allow-Origin: [request-origin]</pre>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>To learn more about CORS, see the MDN page on
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS" class="ulink" target="_top">Cross-Origin Resource Sharing</a>.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="intro.html">« Introduction</a>
</span>
<span class="next">
<a href="supported-technologies.html">Supported Technologies »</a>
</span>
</div>
</div>
</body>
</html>
