<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Python Agent version 5.x
        | APM Python Agent Reference [master]
      | Elastic
    </title><link rel="home" href="index.html" title="APM Python Agent Reference [master]" /><link rel="up" href="release-notes.html" title="Release notes" /><link rel="prev" href="_unreleased.html" title="Unreleased" /><link rel="next" href="release-notes-4.x.html" title="Python Agent version 4.x" /><meta name="DC.type" content="Learn/Docs/APM Python Agent/Reference/master" /><meta name="DC.subject" content="APM" /><meta name="DC.identifier" content="master" /></head><body><div class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">APM Python Agent Reference
      [master]
    </a></span> » <span class="breadcrumb-link"><a href="release-notes.html">Release notes</a></span> » <span class="breadcrumb-node">Python Agent version 5.x</span></div><div class="navheader"><span class="prev"><a href="_unreleased.html">
              « 
              Unreleased</a>
           
        </span><span class="next">
           
          <a href="release-notes-4.x.html">Python Agent version 4.x
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="release-notes-5.x"></a>Python Agent version 5.x<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="release-notes-5.3.2"></a>v5.3.2<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><a class="ulink" href="https://github.com/elastic/apm-agent-python/compare/v5.3.1...v5.3.2" target="_top">Check the diff</a></p><h5><a id="_bug_fixes"></a>Bug fixes<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Added support for IPv6 address format when parsing urls <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/649" target="_top">#649</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="release-notes-5.3.1"></a>v5.3.1<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><a class="ulink" href="https://github.com/elastic/apm-agent-python/compare/v5.3.0...v5.3.1" target="_top">Check the diff</a></p><h5><a id="_new_features"></a>New Features<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Added support for shortening dicts in local variables <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/638" target="_top">#638</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="release-notes-5.3.0"></a>v5.3.0<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><a class="ulink" href="https://github.com/elastic/apm-agent-python/compare/v5.2.3...v5.3.0" target="_top">Check the diff</a></p><h5><a id="_new_features_2"></a>New Features<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Added instrumentation for mysql-connector and pymysql <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/603" target="_top">#603</a></li><li class="listitem">Implemented stack_trace_limit configuration option <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/623" target="_top">#623</a></li><li class="listitem">Autoinsert tracing middleware in django settings <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/625" target="_top">#625</a></li></ul></div><h5><a id="_bug_fixes_2"></a>Bug fixes<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Fixed issue with transactions not being captured when errors occur in Flask <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/635" target="_top">#635</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="release-notes-5.2.3"></a>v5.2.3<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><a class="ulink" href="https://github.com/elastic/apm-agent-python/compare/v5.2.2...v5.2.3" target="_top">Check the diff</a></p><h5><a id="_bug_fixes_3"></a>Bug fixes<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Ensure that metrics with value 0 are not collected if they have the <code class="literal">reset_on_collect</code> flag set <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/615" target="_top">#615</a></li><li class="listitem">Unwrap postgres cursor for newly introduced psycopg2 extensions <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/621" target="_top">#621</a></li><li class="listitem">Fix pod ID for kubernetes when using the systemd cgroup driver <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/631" target="_top">#631</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="release-notes-5.2.2"></a>v5.2.2<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><a class="ulink" href="https://github.com/elastic/apm-agent-python/compare/v5.2.1...v5.2.2" target="_top">Check the diff</a></p><h5><a id="_bug_fixes_4"></a>Bug fixes<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Fixed an issue where a <code class="literal">cpu_total</code> of <code class="literal">0</code> could cause an exception <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/610" target="_top">#610</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/611" target="_top">#611</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="release-notes-5.2.1"></a>v5.2.1<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><a class="ulink" href="https://github.com/elastic/apm-agent-python/compare/v5.2.0...v5.2.1" target="_top">Check the diff</a></p><h5><a id="_bug_fixes_5"></a>Bug fixes<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Fixed an issue with DroppedSpans and logging integration <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/602" target="_top">#602</a></li><li class="listitem">Fixed an issue with processors not being applied to chained exceptions <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/604" target="_top">#604</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="release-notes-5.2.0"></a>v5.2.0<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><a class="ulink" href="https://github.com/elastic/apm-agent-python/compare/v5.1.2...v5.2.0" target="_top">Check the diff</a></p><h5><a id="_new_features_3"></a>New Features<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Added automatic tagging of LogRecord objects with transaction, trace, and span IDs via a LogRecordFactory (Python 3.2+) <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/520" target="_top">#520</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/586" target="_top">#586</a></li><li class="listitem">Added <code class="literal">logging</code> filter and record factory for adding transaction, trace, and span IDs <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/520" target="_top">#520</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/586" target="_top">#586</a></li><li class="listitem">Added <code class="literal">structlog</code> processor for adding transaction, trace, and span IDs <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/520" target="_top">#520</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/586" target="_top">#586</a></li><li class="listitem">Added new public API calls for getting transaction, trace, and span IDs <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/520" target="_top">#520</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/586" target="_top">#586</a></li><li class="listitem">Added support for chained exceptions in Python 3 <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/596" target="_top">#596</a>.
Note that chained exceptions will be captured and stored in Elasticsearch, but not yet
visualized in the APM UI. The UI component will be released in an upcoming Kibana release (7.5 or later).</li><li class="listitem">Added support for using <code class="literal">structlog</code> for agent logging <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/591" target="_top">#591</a></li></ul></div><h5><a id="_bug_fixes_6"></a>Bug fixes<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Drop events immediately if a processor returns a falsy value <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/585" target="_top">#585</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="release-notes-5.1.2"></a>v5.1.2<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><a class="ulink" href="https://github.com/elastic/apm-agent-python/compare/v5.1.1...v5.1.2" target="_top">Check the diff</a></p><h5><a id="_bugfixes"></a>Bugfixes<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Fixed an issue with http server_url and <code class="literal">'VERIFY_SERVER_CERT': False</code> <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/570" target="_top">#570</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/578" target="_top">#578</a></li><li class="listitem">Fixed instrumenting of psycopg2 when using their context manager interface <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/577" target="_top">#577</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/580" target="_top">#580</a></li><li class="listitem">Fixed zerorpc tests <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/581" target="_top">#581</a></li><li class="listitem">Fixed to correctly check if gevent has patched threading.local <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/579" target="_top">#579</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="release-notes-5.1.1"></a>v5.1.1<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><a class="ulink" href="https://github.com/elastic/apm-agent-python/compare/v5.1.0...v5.1.1" target="_top">Check the diff</a></p><h5><a id="_bug_fixes_7"></a>Bug fixes<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Fixed an issue with empty responses from APM Server’s config endpoint <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/562" target="_top">#562</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/563" target="_top">#563</a></li><li class="listitem">Fixed Windows tests by avoiding time.sleep in breakdown metrics tests <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/537" target="_top">#537</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/550" target="_top">#550</a></li><li class="listitem">Fixed container ID matching to match CloudFoundry Garden container IDs <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/523" target="_top">#523</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/564" target="_top">#564</a></li><li class="listitem">Fixed an issue in the urllib instrumentation if no port is set <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/567" target="_top">#567</a></li></ul></div><h5><a id="_other"></a>Other<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Added Python 3.8 RC to the test matrix <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/565" target="_top">#565</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="release-notes-5.1.0"></a>v5.1.0<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><a class="ulink" href="https://github.com/elastic/apm-agent-python/compare/v5.0.0...v5.1.0" target="_top">Check the diff</a></p><h5><a id="_security_issues"></a>Security issues<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">This release fixes CVE-2019-7617</li></ul></div><h5><a id="_new_features_4"></a>New Features<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Added support for global labels which will be applied to every transaction/error/metric <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/549" target="_top">#549</a></li><li class="listitem">Added support for <code class="literal">NO_PROXY</code> environment variable <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/458" target="_top">#458</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/551" target="_top">#551</a></li></ul></div><h5><a id="_bugfixes_2"></a>Bugfixes<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Fixed an issue with using callables in set_context with unsampled transactions <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/541" target="_top">#541</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/542" target="_top">#542</a></li><li class="listitem">Limited the length of error.culprit to 1024 characters <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/491" target="_top">#491</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/543" target="_top">#543</a></li><li class="listitem">Fixed an issue with the <code class="literal">instrument</code> config option <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/546" target="_top">#546</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/547" target="_top">#547</a></li><li class="listitem">Limited the amount of distinct metrics to 1000 <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/540" target="_top">#540</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/544" target="_top">#544</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="release-notes-5.0.0"></a>v5.0.0<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p><a class="ulink" href="https://github.com/elastic/apm-agent-python/compare/v4.2.2...v5.0.0" target="_top">Check the diff</a></p><h5><a id="_breaking_changes"></a>Breaking changes<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Implemented type/subtype/action hierachy for spans. Ensure that you run at least APM Server 6.6 <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/377" target="_top">#377</a></li><li class="listitem">renamed tags to labels and changed API. The old API remains for backwards compatibility until 6.0 of the agent <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/538" target="_top">#538</a></li></ul></div><h5><a id="_other_changes"></a>Other changes<a href="https://github.com/elastic/apm-agent-python/edit/master/CHANGELOG.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Added support for recording breakdown metrics <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/535" target="_top">#535</a></li><li class="listitem">Added support for central config management <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/511" target="_top">#511</a></li><li class="listitem">Added instrumentation for <code class="literal">urllib2</code> (Python 2) / <code class="literal">urllib.request</code> (Python 3) <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/464" target="_top">#464</a></li><li class="listitem">Added <code class="literal">disable_metrics</code> setting <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/399" target="_top">#399</a></li><li class="listitem">Updated elasticsearch instrumentation for 7.x <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/482" target="_top">#482</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/483" target="_top">#483</a></li><li class="listitem">Fixed an issue with opentracing-python 2.1 <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/471" target="_top">#471</a></li><li class="listitem">Fixed an issue with certificate pinning <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/497" target="_top">#497</a></li><li class="listitem">Lowered log level of transport success messages <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/527" target="_top">#527</a>, <a class="ulink" href="https://github.com/elastic/apm-agent-python/pull/531" target="_top">#531</a></li></ul></div></div></div><div class="navfooter"><span class="prev"><a href="_unreleased.html">
              « 
              Unreleased</a>
           
        </span><span class="next">
           
          <a href="release-notes-4.x.html">Python Agent version 4.x
               »
            </a></span></div></body></html>
