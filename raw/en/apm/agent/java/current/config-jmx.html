<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>JMX configuration options
        | APM Java Agent Reference [1.x]
      | Elastic
    </title><link rel="home" href="index.html" title="APM Java Agent Reference [1.x]" /><link rel="up" href="configuration.html" title="Configuration" /><link rel="prev" href="config-jax-rs.html" title="JAX-RS configuration options" /><link rel="next" href="config-logging.html" title="Logging configuration options" /><meta name="DC.type" content="Learn/Docs/APM Java Agent/Reference/1.x" /><meta name="DC.subject" content="APM" /><meta name="DC.identifier" content="1.x" /></head><body><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">APM Java Agent Reference
      [1.x]
    </a></span> » <span class="breadcrumb-link"><a href="configuration.html">Configuration</a></span> » <span class="breadcrumb-node">JMX configuration options</span></div><div class="navheader"><span class="prev"><a href="config-jax-rs.html">
              « 
              JAX-RS configuration options</a>
           
        </span><span class="next">
           
          <a href="config-logging.html">Logging configuration options
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="config-jmx"></a>JMX configuration options<a href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><h4><a id="config-capture-jmx-metrics"></a><code class="literal">capture_jmx_metrics</code> (<span class="Admonishment">
      [<span class="Admonishment-version u-mono">1.10.0</span>]
      <span class="Admonishment-detail">Added in 1.10.0. </span></span>
)<a href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Report metrics from JMX to the APM Server</p><p>Can contain multiple comma separated JMX metric definitions:</p><pre class="screen">object_name[&lt;JMX object name pattern&gt;] attribute[&lt;JMX attribute&gt;:metric_name=&lt;optional metric name&gt;]</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara"><code class="literal">object_name</code>:</p><p class="simpara">For more information about the JMX object name pattern syntax,
see the <a class="ulink" href="https://docs.oracle.com/javase/7/docs/api/javax/management/ObjectName.html" target="_top"><code class="literal">ObjectName</code> Javadocs</a>.</p></li><li class="listitem"><p class="simpara"><code class="literal">attribute</code>:</p><p class="simpara">The name of the JMX attribute.
The JMX value has to be either a <code class="literal">Number</code> or a composite where the composite items are numbers.
This element can be defined multiple times.
An attribute can contain optional properties.
The syntax for that is the same as for <a class="ulink" href="https://docs.oracle.com/javase/7/docs/api/javax/management/ObjectName.html" target="_top"><code class="literal">ObjectName</code></a>.</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara"><code class="literal">metric_name</code>:</p><p class="simpara">A property within <code class="literal">attribute</code>.
This is the name under which the metric will be stored.
Setting this is optional and will be the same as the <code class="literal">attribute</code> if not set.
Note that all JMX metric names will be prefixed with <code class="literal">jvm.jmx.</code> by the agent.</p></li></ul></div></li></ul></div><p>The agent creates <code class="literal">labels</code> for each <a class="ulink" href="https://docs.oracle.com/javase/7/docs/api/javax/management/ObjectName.html#getKeyPropertyList()" target="_top">JMX key property</a> such as <code class="literal">type</code> and <code class="literal">name</code>.</p><p>The <a class="ulink" href="https://docs.oracle.com/javase/7/docs/api/javax/management/ObjectName.html" target="_top">JMX object name pattern</a> supports wildcards.
In this example, the agent will create a metricset for each memory pool <code class="literal">name</code> (such as <code class="literal">G1 Old Generation</code> and <code class="literal">G1 Young Generation</code>)</p><pre class="screen">object_name[java.lang:type=GarbageCollector,name=*] attribute[CollectionCount:metric_name=collection_count] attribute[CollectionTime]</pre><p>The resulting documents in Elasticsearch look similar to these (metadata omitted for brevity):</p><div class="pre_wrapper lang-json"><pre class="programlisting prettyprint lang-json">{
  "@timestamp": "2019-08-20T16:51:07.512Z",
  "jvm": {
    "jmx": {
      "collection_count": 0,
      "CollectionTime":   0
    }
  },
  "labels": {
    "type": "GarbageCollector",
    "name": "G1 Old Generation"
  }
}</pre></div><div class="pre_wrapper lang-json"><pre class="programlisting prettyprint lang-json">{
  "@timestamp": "2019-08-20T16:51:07.512Z",
  "jvm": {
    "jmx": {
      "collection_count": 2,
      "CollectionTime":  11
    }
  },
  "labels": {
    "type": "GarbageCollector",
    "name": "G1 Young Generation"
  }
}</pre></div><p>The agent also supports composite values for the attribute value.
In this example, <code class="literal">HeapMemoryUsage</code> is a composite value, consisting of <code class="literal">committed</code>, <code class="literal">init</code>, <code class="literal">used</code> and <code class="literal">max</code>.</p><pre class="screen">object_name[java.lang:type=Memory] attribute[HeapMemoryUsage:metric_name=heap]</pre><p>The resulting documents in Elasticsearch look similar to this:</p><div class="pre_wrapper lang-json"><pre class="programlisting prettyprint lang-json">{
  "@timestamp": "2019-08-20T16:51:07.512Z",
  "jvm": {
    "jmx": {
      "heap": {
        "max":      4294967296,
        "init":      268435456,
        "committed": 268435456,
        "used":       22404496
      }
    }
  },
  "labels": {
    "type": "Memory"
  }
}</pre></div><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top">Default</th><th align="left" valign="top">Type</th><th align="left" valign="top">Dynamic</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td><td align="left" valign="top"><p>List</p></td><td align="left" valign="top"><p>true</p></td></tr></tbody></table></div><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top">Java System Properties</th><th align="left" valign="top">Property file</th><th align="left" valign="top">Environment</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">elastic.apm.capture_jmx_metrics</code></p></td><td align="left" valign="top"><p><code class="literal">capture_jmx_metrics</code></p></td><td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CAPTURE_JMX_METRICS</code></p></td></tr></tbody></table></div></div><div class="navfooter"><span class="prev"><a href="config-jax-rs.html">
              « 
              JAX-RS configuration options</a>
           
        </span><span class="next">
           
          <a href="config-logging.html">Logging configuration options
               »
            </a></span></div></body></html>
