<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Unreleased | APM Java Agent Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="APM Java Agent Reference [master]"/>
<link rel="up" href="release-notes.html" title="Release notes"/>
<link rel="prev" href="release-notes.html" title="Release notes"/>
<link rel="next" href="release-notes-1.x.html" title="Java Agent version 1.x"/>
<meta name="DC.type" content="Learn/Docs/APM Java Agent/Reference/master"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">APM Java Agent Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="release-notes.html">Release notes</a></span>
»
<span class="breadcrumb-node">Unreleased</span>
</div>
<div class="navheader">
<span class="prev">
<a href="release-notes.html">« Release notes</a>
</span>
<span class="next">
<a href="release-notes-1.x.html">Java Agent version 1.x »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_unreleased"></a>Unreleased<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/main/CHANGELOG.asciidoc">edit</a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="release-notes-1.31.0"></a>1.31.0 - YYYY/MM/DD<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/main/CHANGELOG.asciidoc">edit</a></h3>
</div></div></div>
<h5><a id="_potentially_breaking_changes"></a>Potentially breaking changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/main/CHANGELOG.asciidoc">edit</a></h5>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Starting this version, when using <a class="xref" href="config-logging.html#config-log-ecs-reformatting" title="log_ecs_reformatting ( experimental)"><code class="literal">log_ecs_reformatting</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.22.0</span>]
<span class="Admonishment-detail">
Added in 1.22.0.
</span>
</span> experimental)</a>, the agent will automatically set the <code class="literal">service.version</code> field.
If you are using ECS-logging and set the <code class="literal">service.version</code> through a custom field, the behaviour is not strictly defined. Remove the
custom <code class="literal">service.name</code> field setting and either allow the agent to automatically discover and set it, or use the
<a class="xref" href="config-core.html#config-service-version" title="service_version"><code class="literal">service_version</code></a> config option to set it manually.
</li>
</ul>
</div>
<h5><a id="_refactorings"></a>Refactorings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/main/CHANGELOG.asciidoc">edit</a></h5>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Vert.x 3.x instrumentation was refactored to remove constructor instrumentation as well as wrapping of response handler. In addition,
Vert.x 3.x transactions are now ended when the request end event occurs, instead of the response end event. In HTTP 2 request handling,
the transaction is still kept alive after request (and transaction) end, until response end, when it is then allowed to recycle. This
allows for spans representing asynchronous handling of requests for which the corresponding transaction has ended - <a href="https://github.com/elastic/apm-agent-java/pull/2564" class="ulink" target="_top">#2564</a>
</li>
</ul>
</div>
<h5><a id="_features"></a>Features<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/main/CHANGELOG.asciidoc">edit</a></h5>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Set the service version when using the ECS reformatting of the application logs: <a href="https://github.com/elastic/apm-agent-java/pull/2603" class="ulink" target="_top">#2603</a>
</li>
<li class="listitem">
Add ECS-reformatting support for <code class="literal">java.util.logging</code> - <a href="https://github.com/elastic/apm-agent-java/pull/2591" class="ulink" target="_top">#2591</a>
</li>
<li class="listitem">
Added support for setting the service version on Log4j2&#8217;s EcsLayout - <a href="https://github.com/elastic/apm-agent-java/pull/2604" class="ulink" target="_top">#2604</a>
</li>
<li class="listitem">
Added support for AWS S3 and DynamoDB - <a href="https://github.com/elastic/apm-agent-java/pull/2606" class="ulink" target="_top">#2606</a>
</li>
</ul>
</div>
<h5><a id="_bug_fixes"></a>Bug fixes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/main/CHANGELOG.asciidoc">edit</a></h5>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fixed multiple dropped stats types in a transaction producing invalid JSON: <a href="https://github.com/elastic/apm-agent-java/pull/2589" class="ulink" target="_top">#2589</a>
</li>
<li class="listitem">
Fixed NoClassDefFoundError when using OTel bridge and span.*current() : <a href="https://github.com/elastic/apm-agent-java/pull/2596" class="ulink" target="_top">#2596</a>
</li>
<li class="listitem">
Fallback to standard output when Security Manager prevents writing to log file - <a href="https://github.com/elastic/apm-agent-java/pull/2581" class="ulink" target="_top">#2581</a>
</li>
<li class="listitem">
Fix missing transactions when using Vert.x 3.x with HTTP 1 - <a href="https://github.com/elastic/apm-agent-java/pull/2564" class="ulink" target="_top">#2564</a>
</li>
<li class="listitem">
Fix Vert.x <code class="literal">GET null</code> transactions to be named <code class="literal">GET unknown route</code>, according to spec - <a href="https://github.com/elastic/apm-agent-java/pull/2564" class="ulink" target="_top">#2564</a>
</li>
<li class="listitem">
Fix OpenTelemetry bridge span end with explicit timestamp - <a href="https://github.com/elastic/apm-agent-java/pull/2615" class="ulink" target="_top">#2615</a>
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="release-notes.html">« Release notes</a>
</span>
<span class="next">
<a href="release-notes-1.x.html">Java Agent version 1.x »</a>
</span>
</div>
</div>
</body>
</html>
