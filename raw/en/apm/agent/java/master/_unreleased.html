<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Unreleased | APM Java Agent Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="APM Java Agent Reference [master]"/>
<link rel="up" href="release-notes.html" title="Release notes"/>
<link rel="prev" href="release-notes.html" title="Release notes"/>
<link rel="next" href="release-notes-1.x.html" title="Java Agent version 1.x"/>
<meta name="DC.type" content="Learn/Docs/APM Java Agent/Reference/master"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">APM Java Agent Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="release-notes.html">Release notes</a></span>
»
<span class="breadcrumb-node">Unreleased</span>
</div>
<div class="navheader">
<span class="prev">
<a href="release-notes.html">« Release notes</a>
</span>
<span class="next">
<a href="release-notes-1.x.html">Java Agent version 1.x »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_unreleased"></a>Unreleased<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/CHANGELOG.asciidoc">edit</a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="release-notes-1.22.0"></a>1.22.0 - 2021/MM/DD<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/CHANGELOG.asciidoc">edit</a></h3>
</div></div></div>
<h5><a id="_breaking_changes"></a>Breaking changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/CHANGELOG.asciidoc">edit</a></h5>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Dots in metric names of Micrometer metrics get replaced with underscores to avoid mapping conflicts. De-dotting be disabled via <a class="xref" href="config-metrics.html#config-dedot-custom-metrics" title="dedot_custom_metrics ()"><code class="literal">dedot_custom_metrics</code></a>. - <a href="https://github.com/elastic/apm-agent-java/pull/1700" class="ulink" target="_top">#1700</a>
</li>
</ul>
</div>
<h5><a id="_features"></a>Features<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/CHANGELOG.asciidoc">edit</a></h5>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Introducing a new mechanism to ease the development of community instrumentation plugins. See <a class="xref" href="config-core.html#config-plugins-dir" title="plugins_dir (experimental)"><code class="literal">plugins_dir</code> (experimental)</a> for
more details. This configuration was already added in 1.18.0, but more extensive and continuous integration testing
allows us to expose it now. It is still marked as "experimental" though, meaning that future changes in the mechanism
may break early contributed plugins. However, we highly encourage our community to try it out and we will do our best
to assist with such efforts.
</li>
<li class="listitem">
Deprecating <code class="literal">ignore_user_agents</code> in favour of <code class="literal">transaction_ignore_user_agents</code>, maintaining the same functionality -
<a href="https://github.com/elastic/apm-agent-java/pull/1644" class="ulink" target="_top">#1644</a>
</li>
<li class="listitem">
Update existing Hibernate Search 6 instrumentation to the final relase
</li>
<li class="listitem">
The <a class="xref" href="config-http.html#config-use-path-as-transaction-name" title="use_path_as_transaction_name (experimental )"><code class="literal">use_path_as_transaction_name</code></a> option is now dynamic
</li>
<li class="listitem">
Flushing internal and micrometer metrics before the agent shuts down - <a href="https://github.com/elastic/apm-agent-java/pull/1658" class="ulink" target="_top">#1658</a>
</li>
<li class="listitem">
Support for OkHttp 4.4+ -  <a href="https://github.com/elastic/apm-agent-java/pull/1672" class="ulink" target="_top">#1672</a>
</li>
<li class="listitem">
Adding capability to automatically create ECS-JSON-formatted version of the original application log files, through
the <a class="xref" href="config-logging.html#config-log-ecs-reformatting" title="log_ecs_reformatting ( experimental)"><code class="literal">log_ecs_reformatting</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.22.0</span>]
<span class="Admonishment-detail">
Added in 1.22.0.
</span>
</span> experimental)</a> config option. This allows effortless ingestion of logs to Elasticsearch without
any further configuration. Supports log4j1, log4j2 and Logback. <a href="https://github.com/elastic/apm-agent-java/pull/1261" class="ulink" target="_top">#1261</a>
</li>
<li class="listitem">
Add support to Spring AMQP - <a href="https://github.com/elastic/apm-agent-java/pull/1657" class="ulink" target="_top">#1657</a>
</li>
<li class="listitem">
Adds the ability to automatically configure usage of the OpenTracing bridge in systems using ServiceLoader - <a href="https://github.com/elastic/apm-agent-java/pull/1708" class="ulink" target="_top">#1708</a>
</li>
<li class="listitem">
Update to async-profiler 1.8.5
</li>
</ul>
</div>
<h5><a id="_bug_fixes"></a>Bug fixes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/CHANGELOG.asciidoc">edit</a></h5>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
fix sample rate rounded to zero when lower than precision - <a href="https://github.com/elastic/apm-agent-java/pull/1655" class="ulink" target="_top">#1655</a>
</li>
<li class="listitem">
fixed a couple of bugs with the external plugin mechanism (not documented until now) - <a href="https://github.com/elastic/apm-agent-java/pull/1660" class="ulink" target="_top">#1660</a>
</li>
<li class="listitem">
Update to async-profiler 1.8.4 to prevent crashes on Java 7 - <a href="https://github.com/elastic/apm-agent-java/pull/1678" class="ulink" target="_top">#1678</a>
</li>
<li class="listitem">
Fix runtime attach conflict with multiple users - <a href="https://github.com/elastic/apm-agent-java/pull/1704" class="ulink" target="_top">#1704</a>
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="release-notes.html">« Release notes</a>
</span>
<span class="next">
<a href="release-notes-1.x.html">Java Agent version 1.x »</a>
</span>
</div>
</div>
</body>
</html>
