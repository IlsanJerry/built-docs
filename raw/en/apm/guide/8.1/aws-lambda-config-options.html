<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Configuration Options for APM on AWS Lambda | APM User Guide [8.1] | Elastic</title>
<link rel="home" href="index.html" title="APM User Guide [8.1]"/>
<link rel="up" href="aws-lambda-extension.html" title="AWS Lambda Extension (Experimental)"/>
<link rel="prev" href="aws-lambda-extension.html" title="AWS Lambda Extension (Experimental)"/>
<link rel="next" href="aws-lambda-arch.html" title="AWS Lambda architecture"/>
<meta name="DC.type" content="Learn/Docs/APM Guide/8.1"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="8.1"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">APM User Guide [8.1]</a></span>
»
<span class="breadcrumb-link"><a href="features.html">Elastic APM features</a></span>
»
<span class="breadcrumb-link"><a href="aws-lambda-extension.html">AWS Lambda Extension (Experimental)</a></span>
»
<span class="breadcrumb-node">Configuration Options for APM on AWS Lambda</span>
</div>
<div class="navheader">
<span class="prev">
<a href="aws-lambda-extension.html">« AWS Lambda Extension (Experimental)</a>
</span>
<span class="next">
<a href="aws-lambda-arch.html">AWS Lambda architecture »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="aws-lambda-config-options"></a>Configuration Options for APM on AWS Lambda<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-aws-lambda/edit/8.1/docs/monitoring-aws-lambda.asciidoc">edit</a></h3>
</div></div></div>
<p>The recommended way of configuring the APM Lambda Extension and the APM Agents on AWS Lambda is through the Lambda function&#8217;s environment variables.</p>
<h5><a id="_elastic_apm_lambda_apm_server"></a><code class="literal">ELASTIC_APM_LAMBDA_APM_SERVER</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-aws-lambda/edit/8.1/docs/monitoring-aws-lambda.asciidoc">edit</a></h5>
<p>This required config option controls where the Lambda extension will ship data. This should be the URL of the final APM Server destination for your telemetry.</p>
<h5><a id="_elastic_apm_secret_token_or_elastic_apm_api_key"></a><code class="literal">ELASTIC_APM_SECRET_TOKEN</code> or <code class="literal">ELASTIC_APM_API_KEY</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-aws-lambda/edit/8.1/docs/monitoring-aws-lambda.asciidoc">edit</a></h5>
<p>One of these needs to be set as the authentication method that the extension uses when sending data to the URL configured via <code class="literal">ELASTIC_APM_LAMBDA_APM_SERVER</code>.</p>
<h5><a id="_elastic_apm_service_name"></a><code class="literal">ELASTIC_APM_SERVICE_NAME</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-aws-lambda/edit/8.1/docs/monitoring-aws-lambda.asciidoc">edit</a></h5>
<p>The configured name of your application or service.  The APM Agent will use this value when reporting data to the APM Server. If unset, the APM Agent will automatically set the value based on the Lambda function name. Use this config option if you want to group multiple Lambda functions under a single service entity in APM.</p>
<h5><a id="_elastic_apm_data_receiver_timeout_seconds"></a><code class="literal">ELASTIC_APM_DATA_RECEIVER_TIMEOUT_SECONDS</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-aws-lambda/edit/8.1/docs/monitoring-aws-lambda.asciidoc">edit</a></h5>
<p>The timeout value, in seconds, for the Lambda Extension&#8217;s server receiving data from the agent. The <em>default</em> is <code class="literal">15</code>.</p>
<h5><a id="_elastic_apm_send_strategy"></a><code class="literal">ELASTIC_APM_SEND_STRATEGY</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-aws-lambda/edit/8.1/docs/monitoring-aws-lambda.asciidoc">edit</a></h5>
<p>Whether to synchronously flush APM agent data from the extension to the APM server at the end of the function invocation.
The two accepted values are <code class="literal">background</code> and <code class="literal">syncflush</code>. The <em>default</em> is <code class="literal">syncflush</code>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">background</code> strategy indicates that the extension will not flush when it receives a signal that the function invocation
has completed. It will instead send any remaining buffered data on the next function invocation. The result is that, if the
function is not subsequently invoked for that Lambda environment, the buffered data will be lost. However, for lambda functions
that have a steadily frequent load pattern the extension could delay sending the data to the APM server to the next lambda
request and do the sending in parallel to the processing of that next request. This potentially would improve both the lambda
function response time and its throughput.
</li>
<li class="listitem">
The other value, <code class="literal">syncflush</code> will synchronously flush all remaining buffered APM agent data to the APM server when the
extension receives a signal that the function invocation has completed. This strategy blocks the lambda function from receiving
the next request until the extension has flushed all the data. This has a negative effect on the throughput of the function,
though it ensures that all APM data is sent to the APM server.
</li>
</ul>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="aws-lambda-extension.html">« AWS Lambda Extension (Experimental)</a>
</span>
<span class="next">
<a href="aws-lambda-arch.html">AWS Lambda architecture »</a>
</span>
</div>
</div>
</body>
</html>
