<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create an infrastructure anomaly alert | Observability Guide [master] | Elastic</title>
<link rel="home" href="index.html" title="Observability Guide [master]"/>
<link rel="up" href="create-alerts.html" title="Alerting"/>
<link rel="prev" href="infrastructure-threshold-alert.html" title="Create an infrastructure threshold alert"/>
<link rel="next" href="metrics-threshold-alert.html" title="Create a metrics threshold alert"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/master"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Observability Guide [master]</a></span>
»
<span class="breadcrumb-link"><a href="create-alerts.html">Alerting</a></span>
»
<span class="breadcrumb-node">Create an infrastructure anomaly alert</span>
</div>
<div class="navheader">
<span class="prev">
<a href="infrastructure-threshold-alert.html">« Create an infrastructure threshold alert</a>
</span>
<span class="next">
<a href="metrics-threshold-alert.html">Create a metrics threshold alert »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="infrastructure-anomaly-alert"></a>Create an infrastructure anomaly alert<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/master/docs/en/observability/infrastructure-anomaly-alert.asciidoc">edit</a></h2>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Make sure to enable anomaly detection for hosts and Kubernetes. For more information,
see <a class="xref" href="inspect-metric-anomalies.html" title="Inspect metric anomalies">Inspect metric anomalies</a>.</p>
</div>
</div>
<p>Within the Metrics app, create an infrastructure anomaly alert to receive
notifications based on the memory usage and network traffic anomalies for hosts
and Kubernetes pods.</p>
<p>You can receive notifications when an anomaly severity score exceeds a defined threshold
for increases in memory usage and unusually high inbound or outbound traffic across hosts or pods.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
To access this page, go to <span class="strong strong"><strong>Observability &gt; Metrics</strong></span>.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Inventory</strong></span> page or the <span class="strong strong"><strong>Metrics Explorer</strong></span> page, click <span class="strong strong"><strong>Alerts &gt; Infrastructure</strong></span>.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Create anomaly alert</strong></span>.
</li>
</ol>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="anomaly-conditions"></a>Anomaly conditions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/master/docs/en/observability/infrastructure-anomaly-alert.asciidoc">edit</a></h3>
</div></div></div>
<p>Conditions for each alert can be applied to specific metrics relating to the hosts or
Kubernetes pods you select: memory usage, network in, and network out.</p>
<p>For each alert, you can configure which severity score triggers the alert. The default
level is <code class="literal">major</code>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>warning</strong></span></p></td>
<td align="left" valign="top"><p>Score <code class="literal">3</code> and above.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>minor</strong></span></p></td>
<td align="left" valign="top"><p>Score <code class="literal">25</code> and above.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>major</strong></span></p></td>
<td align="left" valign="top"><p>Score <code class="literal">50</code> and above.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>critical</strong></span></p></td>
<td align="left" valign="top"><p>Score <code class="literal">75</code> and above.</p></td>
</tr>
</tbody>
</table>
</div>
<p>In this example, Kubernetes Pods is selected. The conditions state that
an alert is triggered if memory usage has a severity score of <code class="literal">major</code> for any pods within the <code class="literal">ingress-nginx</code>
namespace.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/infra-anomaly-conditions.png" alt="Alert conditions">
</div>
</div>
<p>Before creating an alert, you can preview whether the conditions would have triggered the alert in
the last hour, day, week, or month.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="action-types-infra-anomaly"></a>Action types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/master/docs/en/observability/infrastructure-anomaly-alert.asciidoc">edit</a></h3>
</div></div></div>
<p>You can extend your alerts by connecting them to actions that use the following supported
built-in integrations.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/alert-action-types.png" alt="Action types">
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="action-variables-infra-anomaly"></a>Action variables<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/master/docs/en/observability/infrastructure-anomaly-alert.asciidoc">edit</a></h3>
</div></div></div>
<p>This section details the variables that infrastructure threshold alerts will send to your
actions.</p>
<h5><a id="_default_variables"></a>Default variables<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/master/docs/en/observability/infrastructure-anomaly-alert.asciidoc">edit</a></h5>
<div class="imageblock screenshot">
<div class="content">
<img src="images/anomaly-variables.png" alt="The default infrastructure anomaly alert message detailing basic variables">
</div>
</div>
<p>The notification message for an infrastructure anomaly alert contains the following default variables.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">context.alertState</code>: Depending on why the action is triggered, this variable resolves to <code class="literal">ALERT</code>
(the alert condition is detected), <code class="literal">NO DATA</code> (no data was returned for the time period that was queried),
or <code class="literal">ERROR</code> (indicates an error when querying the data).
</li>
<li class="listitem">
<code class="literal">context.metric</code>: The metric name defined in the condition.
</li>
<li class="listitem">
<code class="literal">context.summary</code>: A description of the anomaly.
</li>
<li class="listitem">
<code class="literal">context.timestamp</code>: The timestamp of when the anomaly was detected.
</li>
<li class="listitem">
<code class="literal">context.typical</code>: The typical value of the metric at the time of the anomaly.
</li>
<li class="listitem">
<code class="literal">context.actual</code>: The actual value of the metric at the time of the anomaly.
</li>
</ul>
</div>
<h5><a id="_additional_variables"></a>Additional variables<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/master/docs/en/observability/infrastructure-anomaly-alert.asciidoc">edit</a></h5>
<p>You can customize the default notification message by including the following additional variables.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">context.anomalyScore</code>: The severity score of the detected anomaly.
</li>
<li class="listitem">
<code class="literal">context.influencers</code>: A list of nodes that influenced the anomaly.
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="infrastructure-threshold-alert.html">« Create an infrastructure threshold alert</a>
</span>
<span class="next">
<a href="metrics-threshold-alert.html">Create a metrics threshold alert »</a>
</span>
</div>
</div>
</body>
</html>
