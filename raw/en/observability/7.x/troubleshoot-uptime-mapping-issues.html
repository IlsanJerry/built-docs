<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Troubleshoot mapping issues | Observability Guide [7.x] | Elastic</title>
<link rel="home" href="index.html" title="Observability Guide [7.x]"/>
<link rel="up" href="monitor-uptime.html" title="Uptime monitoring"/>
<link rel="prev" href="configure-uptime-settings.html" title="Configure settings"/>
<link rel="next" href="synthetic-monitoring.html" title="Synthetic monitoring"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/7.x"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="7.x"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Observability Guide [7.x]</a></span>
»
<span class="breadcrumb-link"><a href="monitor-uptime.html">Uptime monitoring</a></span>
»
<span class="breadcrumb-node">Troubleshoot mapping issues</span>
</div>
<div class="navheader">
<span class="prev">
<a href="configure-uptime-settings.html">« Configure settings</a>
</span>
<span class="next">
<a href="synthetic-monitoring.html">Synthetic monitoring »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="troubleshoot-uptime-mapping-issues"></a>Troubleshoot mapping issues<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/7.x/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_mapping_issues"></a>Mapping issues<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/7.x/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></h3>
</div></div></div>
<p>There are situations in which Heartbeat data can be indexed without the correct mappings applied.
These situations cannot occur with the Elastic Agent configured via Fleet, only with standalone Heartbeat.
This can occur when the underlying <code class="literal">heartbeat-VERSION</code> ILM alias is deleted manually or when Heartbeat writes data
through an intermediary such as Logstash without the <code class="literal">setup</code> command being run.</p>
<p>To fix this problem, you typically need to remove your Heartbeat indices and create
new ones with the appropriate mappings installed. To achieve this, follow the steps below.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_step_1_stop_your_heartbeat_instances"></a>Step 1: Stop your Heartbeat instances<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/7.x/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></h4>
</div></div></div>
<p>It is necessary to stop all Heartbeat instances that are targeting the cluster, so they will not write to or re-create indices prematurely.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_step_2_delete_your_heartbeat_indices"></a>Step 2: Delete your Heartbeat indices<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/7.x/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></h4>
</div></div></div>
<p>To ensure the mapping is applied to all Heartbeat data going forward,
delete all the Heartbeat indicies that match the pattern the Uptime app will use.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_step_3_run_the_heartbeat_setup_command"></a>Step 3: Run the Heartbeat setup command<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/7.x/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></h4>
</div></div></div>
<p>There are multiple ways to achieve this.
You can read about performing this using the <a href="/guide/en/elasticsearch/reference/7.x/index-mgmt.html" class="ulink" target="_top">Index Management UI</a> or with the <a href="/guide/en/elasticsearch/reference/7.x/indices-delete-index.html" class="ulink" target="_top">Delete index API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_step_4_perform_heartbeat_setup"></a>Step 4: Perform Heartbeat setup<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/7.x/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></h4>
</div></div></div>
<p>The below command will cause Heartbeat to perform its setup processes.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For more information on how to use this command, you can reference the
<a href="/guide/en/beats/heartbeat/7.x/heartbeat-installation-configuration.html" class="ulink" target="_top">Heartbeat quickstart guide</a>.</p>
</div>
</div>
<div class="tabs" data-tab-group="os">
  <div role="tablist" aria-label="Set up">
    <button role="tab"
            aria-selected="true"
            aria-controls="deb-tab-setup"
            id="deb-setup">
      DEB
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="rpm-tab-setup"
            id="rpm-setup"
            tabindex="-1">
      RPM
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="mac-tab-setup"
            id="mac-setup"
            tabindex="-1">
      MacOS
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="brew-tab-setup"
            id="brew-setup"
            tabindex="-1">
      Brew
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="linux-tab-setup"
            id="linux-setup"
            tabindex="-1">
      Linux
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="win-tab-setup"
            id="win-setup"
            tabindex="-1">
      Windows
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="deb-tab-setup"
       aria-labelledby="deb-setup">
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">heartbeat setup -e</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="rpm-tab-setup"
       aria-labelledby="rpm-setup"
       hidden="">
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">heartbeat setup -e</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="mac-tab-setup"
       aria-labelledby="mac-setup"
       hidden="">
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">./heartbeat setup -e</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="brew-tab-setup"
       aria-labelledby="brew-setup"
       hidden="">
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">heartbeat setup -e</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="linux-tab-setup"
       aria-labelledby="linux-setup"
       hidden="">
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">./heartbeat setup -e</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="win-tab-setup"
       aria-labelledby="win-setup"
       hidden="">
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">PS &gt; .\heartbeat.exe setup -e</pre>
</div>
  </div>
</div>
<p>This command performs the necessary startup tasks and ensures that your indicies have the appropriate mapping going forward.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_step_5_run_heartbeat_again"></a>Step 5: Run Heartbeat again<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/7.x/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></h4>
</div></div></div>
<p>Now, when you run Heartbeat, your data will be indexed with the appropriate mappings. When
the Uptime app attempts to fetch your data, it should be able to render without issues.</p>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="configure-uptime-settings.html">« Configure settings</a>
</span>
<span class="next">
<a href="synthetic-monitoring.html">Synthetic monitoring »</a>
</span>
</div>
</div>
</body>
</html>
