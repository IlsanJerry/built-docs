<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Transform limitations
        | Elastic Stack Overview [7.4]
      | Elastic
    </title><link rel="home" href="index.html" title="Elastic Stack Overview [7.4]" /><link rel="up" href="ml-dataframes.html" title="Transforming data" /><link rel="prev" href="dataframe-troubleshooting.html" title="Troubleshooting transforms" /><link rel="next" href="xpack-ml.html" title="Machine learning anomaly detection" /><meta name="DC.type" content="Learn/Docs/Elastic Stack/Overview/7.4" /><meta name="DC.subject" content="Elastic Stack" /><meta name="DC.identifier" content="7.4" /></head><body><div class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elastic Stack Overview
      [7.4]
    </a></span> » <span class="breadcrumb-link"><a href="ml-dataframes.html">Transforming data</a></span> » <span class="breadcrumb-node">Transform limitations</span></div><div class="navheader"><span class="prev"><a href="dataframe-troubleshooting.html">
              « 
              Troubleshooting transforms</a>
           
        </span><span class="next">
           
          <a href="xpack-ml.html">Machine learning anomaly detection
               »
            </a></span></div><div class="xpack chapter"><div class="titlepage"><div><div><h2 class="title"><a id="dataframe-limitations"></a>Transform limitations<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p></div></div><p>The following limitations and known problems apply to the 7.4 release of
the Elastic data frame feature:</p><h3><a id="df-compatibility-limitations"></a>Beta transforms do not have guaranteed backwards or forwards compatibility<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Whilst transforms are beta, it is not guaranteed that a
transform created in a previous version of the Elastic Stack will be able
to start and operate in a future version. Neither can support be provided for
transform tasks to be able to operate in a cluster with mixed node
versions.
Please note that the output of a transform is persisted to a
destination index. This is a normal Elasticsearch index and is not affected by the beta
status.</p><h3><a id="df-ui-limitation"></a>Data frame UI will not work during a rolling upgrade from 7.2<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>If your cluster contains mixed version nodes, for example during a rolling
upgrade from 7.2 to a newer version, and transforms have been
created in 7.2, the data frame UI will not work. Please wait until all nodes
have been upgraded to the newer version before using the data frame UI.</p><h3><a id="df-datatype-limitations"></a>Data frame data type limitation<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Data frames do not (yet) support fields containing arrays – in the UI or
the API. If you try to create one, the UI will fail to show the source index
table.</p><h3><a id="df-ccs-limitations"></a>Cross-cluster search is not supported<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Cross-cluster search is not supported for transforms.</p><h3><a id="df-kibana-limitations"></a>Up to 1,000 transforms are supported<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>A single cluster will support up to 1,000 transforms.
When using the
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.4/get-transform.html" target="_top">GET transforms API</a> a total
<code class="literal">count</code> of transforms is returned. Use the <code class="literal">size</code> and <code class="literal">from</code> parameters to
enumerate through the full list.</p><h3><a id="df-aggresponse-limitations"></a>Aggregation responses may be incompatible with destination index mappings<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>When a transform is first started, it will deduce the mappings
required for the destination index. This process is based on the field types of
the source index and the aggregations used. If the fields are derived from
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.4/search-aggregations-metrics-scripted-metric-aggregation.html" target="_top"><code class="literal">scripted_metrics</code></a>
or <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.4/search-aggregations-pipeline-bucket-script-aggregation.html" target="_top"><code class="literal">bucket_scripts</code></a>,
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.4/dynamic-mapping.html" target="_top">dynamic mappings</a> will be used. In some instances the
deduced mappings may be incompatible with the actual data. For example, numeric
overflows might occur or dynamically mapped fields might contain both numbers
and strings. Please check Elasticsearch logs if you think this may have occurred. As a
workaround, you may define custom mappings prior to starting the
transform. For example,
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.4/indices-create-index.html" target="_top">create a custom destination index</a> or
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.4/indices-templates.html" target="_top">define an index template</a>.</p><h3><a id="df-batch-limitations"></a>Batch transforms may not account for changed documents<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>A batch transform uses a
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.4/search-aggregations-bucket-composite-aggregation.html" target="_top">composite aggregation</a>
which allows efficient pagination through all buckets. Composite aggregations
do not yet support a search context, therefore if the source data is changed
(deleted, updated, added) while the batch data frame is in progress, then the
results may not include these changes.</p><h3><a id="df-consistency-limitations"></a>Continuous data frame consistency does not account for deleted or updated documents<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>While the process for transforms allows the continual recalculation
of the transform as new data is being ingested, it does also have
some limitations.</p><p>Changed entities will only be identified if their time field
has also been updated and falls within the range of the action to check for
changes. This has been designed in principle for, and is suited to, the use case
where new data is given a timestamp for the time of ingest.</p><p>If the indices that fall within the scope of the source index pattern are
removed, for example when deleting historical time-based indices, then the
composite aggregation performed in consecutive checkpoint processing will search
over different source data, and entities that only existed in the deleted index
will not be removed from the data frame destination index.</p><p>Depending on your use case, you may wish to recreate the transform
entirely after deletions. Alternatively, if your use case is tolerant to
historical archiving, you may wish to include a max ingest timestamp in your
aggregation. This will allow you to exclude results that have not been recently
updated when viewing the data frame destination index.</p><h3><a id="df-deletion-limitations"></a>Deleting a transform does not delete the data frame destination index or Kibana index pattern<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>When deleting a transform using <code class="literal">DELETE _data_frame/transforms/index</code>
neither the data frame destination index nor the Kibana index pattern, should
one have been created, are deleted. These objects must be deleted separately.</p><h3><a id="df-aggregation-page-limitations"></a>Handling dynamic adjustment of aggregation page size<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>During the development of transforms, control was favoured over
performance. In the design considerations, it is preferred for the
transform to take longer to complete quietly in the background
rather than to finish quickly and take precedence in resource consumption.</p><p>Composite aggregations are well suited for high cardinality data enabling
pagination through results. If a <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.4/circuit-breaker.html" target="_top">circuit breaker</a>
memory exception occurs when performing the composite aggregated search then we
try again reducing the number of buckets requested. This circuit breaker is
calculated based upon all activity within the cluster, not just activity from
transforms, so it therefore may only be a temporary resource
availability issue.</p><p>For a batch transform, the number of buckets requested is only ever
adjusted downwards. The lowering of value may result in a longer duration for the
transform checkpoint to complete. For continuous data frames, the number of
buckets requested is reset back to its default at the start of every checkpoint
and it is possible for circuit breaker exceptions to occur repeatedly in the
Elasticsearch logs.</p><p>The transform retrieves data in batches which means it calculates
several buckets at once. Per default this is 500 buckets per search/index
operation. The default can be changed using <code class="literal">max_page_search_size</code> and the
minimum value is 10. If failures still occur once the number of buckets
requested has been reduced to its minimum, then the transform will
be set to a failed state.</p><h3><a id="df-dynamic-adjustments-limitations"></a>Handling dynamic adjustments for many terms<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>For each checkpoint, entities are identified that have changed since the last
time the check was performed. This list of changed entities is supplied as a
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.4/query-dsl-terms-query.html" target="_top">terms query</a> to the transform
composite aggregation, one page at a time. Then updates are applied to the
destination index for each page of entities.</p><p>The page <code class="literal">size</code> is defined by <code class="literal">max_page_search_size</code> which is also used to
define the number of buckets returned by the composite aggregation search. The
default value is 500, the minimum is 10.</p><p>The index setting
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.4/index-modules.html#dynamic-index-settings" target="_top"><code class="literal">index.max_terms_count</code></a> defines
the maximum number of terms that can be used in a terms query. The default value
is 65536. If <code class="literal">max_page_search_size</code> exceeds <code class="literal">index.max_terms_count</code> the
transform will fail.</p><p>Using smaller values for <code class="literal">max_page_search_size</code> may result in a longer duration
for the transform checkpoint to complete.</p><h3><a id="df-scheduling-limitations"></a>Continuous data frame scheduling limitations<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>A continuous data frame periodically checks for changes to source data. The functionality
of the scheduler is currently limited to a basic periodic timer which can be
within the <code class="literal">frequency</code> range from 1s to 1h. The default is 1m. This is designed
to run little and often. When choosing a <code class="literal">frequency</code> for this timer consider
your ingest rate along with the impact that the transform
search/index operations has other users in your cluster. Also note that retries
occur at <code class="literal">frequency</code> interval.</p><h3><a id="df-failed-limitations"></a>Handling of failed transforms<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Failed transforms remain as a persistent task and should be handled
appropriately, either by deleting it or by resolving the root cause of the
failure and re-starting.</p><p>When using the API to delete a failed transform, first stop it using
<code class="literal">_stop?force=true</code>, then delete it.</p><h3><a id="df-availability-limitations"></a>Continuous data frames may give incorrect results if documents are not yet available to search<a href="https://github.com/elastic/elasticsearch/edit/7.4/docs/reference/transform/limitations.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>After a document is indexed, there is a very small delay until it is available
to search.</p><p>A continuous transform periodically checks for changed entities between the
time since it last checked and <code class="literal">now</code> minus <code class="literal">sync.time.delay</code>. This time window
moves without overlapping. If the timestamp of a recently indexed document falls
within this time window but this document is not yet available to search then
this entity will not be updated.</p><p>If using a <code class="literal">sync.time.field</code> that represents the data ingest time and using a
zero second or very small <code class="literal">sync.time.delay</code>, then it is more likely that this
issue will occur.</p></div><div class="navfooter"><span class="prev"><a href="dataframe-troubleshooting.html">
              « 
              Troubleshooting transforms</a>
           
        </span><span class="next">
           
          <a href="xpack-ml.html">Machine learning anomaly detection
               »
            </a></span></div></body></html>
