<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Custom configuration files and plugins
        | Elastic Cloud on Kubernetes [1.0]
      | Elastic
    </title><link rel="home" href="index.html" title="Elastic Cloud on Kubernetes [1.0]" /><link rel="up" href="k8s-elasticsearch-specification.html" title="Running Elasticsearch on ECK" /><link rel="prev" href="k8s-es-secure-settings.html" title="Secure settings" /><link rel="next" href="k8s-init-containers-plugin-downloads.html" title="Init containers for plugin downloads" /><meta name="DC.type" content="Learn/Docs/Kubernetes/Reference/1.0" /><meta name="DC.subject" content="ECK" /><meta name="DC.identifier" content="1.0" /></head><body><div class="page_header">You are looking at the documentation for a beta release.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elastic Cloud on Kubernetes
      [1.0]
    </a></span> » <span class="breadcrumb-link"><a href="k8s-elasticsearch-specification.html">Running Elasticsearch on ECK</a></span> » <span class="breadcrumb-node">Custom configuration files and plugins</span></div><div class="navheader"><span class="prev"><a href="k8s-es-secure-settings.html">
              « 
              Secure settings</a>
           
        </span><span class="next">
           
          <a href="k8s-init-containers-plugin-downloads.html">Init containers for plugin downloads
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="k8s-bundles-plugins"></a>Custom configuration files and plugins<a href="https://github.com/elastic/cloud-on-k8s/edit/1.0/docs/elasticsearch-specification.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>To run Elasticsearch with specific plugins or configuration files installed on ECK you have two options:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Create a custom Docker image with the plugins or files pre-installed.</li><li class="listitem">Install the plugins or configuration files at Pod startup time.</li></ol></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The first option has the advantage that you can verify the correctness of the image before rolling it out to your ECK installation, while the second option gives you
maximum flexibility. But the second option also means you might catch any errors only at runtime. Plugin installation at runtime has another drawback in that it needs access to the Internet from your cluster
and downloads each plugin multiple times, once for each Elasticsearch node.</p></div></div><p>Building your custom Docker images is outside the scope of this documentation despite being the better solution for most users.</p><p>The following example describes option 2, using a repository plugin. To install the plugin before the Elasticsearch
nodes start, use an init container to run the <a class="ulink" href="/guide/en/elasticsearch/plugins/current/installation.html" target="_top">plugin installation tool</a>.</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">spec:
  nodeSets:
  - name: default
    count: 3
    podTemplate:
      spec:
        initContainers:
        - name: install-plugins
          command:
          - sh
          - -c
          - |
            bin/elasticsearch-plugin install --batch repository-azure</pre></div><p>To install custom configuration files you can use volumes and volume mounts.</p><p>The next example shows how to add a synonyms file for the
<a class="ulink" href="/guide/en/elasticsearch/reference/current/analysis-synonym-tokenfilter.html" target="_top">synonym token filter</a> in Elasticsearch.
But you can use the same approach for any kind of file you want to mount into the configuration directory of Elasticsearch.</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">spec:
  nodeSets:
  - name: default
    count: 3
    podTemplate:
      spec:
        containers:
        - name: elasticsearch <a id="CO2-1"></a><i class="conum" data-value="1"></i>
          volumeMounts:
          - name: synonyms
            mountPath: /usr/share/elasticsearch/config/dictionaries
        volumes:
        - name: synonyms
          configMap:
            name: synonyms <a id="CO2-2"></a><i class="conum" data-value="2"></i></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>Elasticsearch runs by convention in a container called <span class="emphasis"><em>elasticsearch</em></span></p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-2"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>Assuming you have created a config map in the same namespace as Elasticsearch with the name <span class="emphasis"><em>synonyms</em></span> containing the synonyms file(s)</p></td></tr></table></div></div><div class="navfooter"><span class="prev"><a href="k8s-es-secure-settings.html">
              « 
              Secure settings</a>
           
        </span><span class="next">
           
          <a href="k8s-init-containers-plugin-downloads.html">Init containers for plugin downloads
               »
            </a></span></div></body></html>
