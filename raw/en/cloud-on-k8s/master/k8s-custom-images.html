<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create custom images | Elastic Cloud on Kubernetes [master] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Cloud on Kubernetes [master]"/>
<link rel="up" href="k8s-advanced-topics.html" title="Advanced topics"/>
<link rel="prev" href="k8s-openshift-es-plugins.html" title="Elasticsearch plugins"/>
<link rel="next" href="k8s-references.html" title="References"/>
<meta name="DC.type" content="Learn/Docs/Kubernetes/Reference/master"/>
<meta name="DC.subject" content="ECK"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Cloud on Kubernetes [master]</a></span>
»
<span class="breadcrumb-link"><a href="k8s-advanced-topics.html">Advanced topics</a></span>
»
<span class="breadcrumb-node">Create custom images</span>
</div>
<div class="navheader">
<span class="prev">
<a href="k8s-openshift-es-plugins.html">« Elasticsearch plugins</a>
</span>
<span class="next">
<a href="k8s-references.html">References »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="k8s-custom-images"></a>Create custom images<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/master/docs/advanced-topics/custom-images.asciidoc">edit</a></h2>
</div></div></div>
<p>You can create your own custom Elasticsearch or Kibana image instead of using the base image provided by Elastic. You might want to do this to preload plugins in the image rather than having to <a href="k8s-init-containers-plugin-downloads.html" class="ulink" target="_top">install them via init container</a> each time a pod starts. To do this, you must use the official image as the base for it to function properly. For example, if you want to create an Elasticsearch 7.6.0 image with the <a href="/guide/en/elasticsearch/plugins/master/repository-gcs.html" class="ulink" target="_top">Google Cloud Storage Repository Plugin</a>, you can do the following:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Create a <code class="literal">Dockerfile</code> containing:</p>
<pre class="screen">FROM docker.elastic.co/elasticsearch/elasticsearch:7.6.0
RUN bin/elasticsearch-plugin install --batch repository-gcs</pre>
</li>
<li class="listitem">
<p>Build the image with:</p>
<pre class="screen">docker build --tag elasticsearch-gcs:7.6.0</pre>
</li>
</ol>
</div>
<p>There are various hosting options for your images. If you use Google Kubernetes Engine, it is automatically configured to use the Google Container Registry (see <a href="https://cloud.google.com/container-registry/docs/using-with-google-cloud-platform#google-kubernetes-engine" class="ulink" target="_top">here</a> for more information). To use the image, you can then <a href="https://cloud.google.com/container-registry/docs/pushing-and-pulling#pushing_an_image_to_a_registry" class="ulink" target="_top">push to the registry</a> with:</p>
<pre class="screen">docker tag elasticsearch-gcs:7.6.0 gcr.io/$PROJECT-ID/elasticsearch-gcs:7.6.0
docker push gcr.io/$PROJECT-ID/elasticsearch-gcs:7.6.0</pre>
<p>Configure your Elasticsearch specification to use the newly pushed image, for example:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">spec:
  version: 7.6.0
  image: gcr.io/$PROJECT-ID/elasticsearch-gcs:7.6.0</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Providing the correct version is always required as ECK reasons about APIs and capabilities available to it based on the version field.</p>
</div>
</div>
<p>The steps are similar for <a href="https://docs.microsoft.com/en-us/azure/aks/tutorial-kubernetes-prepare-acr" class="ulink" target="_top">Azure Kubernetes Service</a> and <a href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/docker-basics.html#use-ecr" class="ulink" target="_top">AWS Elastic Container Registry</a>.</p>
<p>For more information, you can check the following references:</p>


</div>
<div class="navfooter">
<span class="prev">
<a href="k8s-openshift-es-plugins.html">« Elasticsearch plugins</a>
</span>
<span class="next">
<a href="k8s-references.html">References »</a>
</span>
</div>
</div>
</body>
</html>
