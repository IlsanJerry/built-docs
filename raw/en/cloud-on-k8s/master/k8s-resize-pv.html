<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Resizing persistent volumes | Elastic Cloud on Kubernetes [master] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Cloud on Kubernetes [master]"/>
<link rel="up" href="k8s-troubleshooting.html" title="Troubleshoot ECK"/>
<link rel="prev" href="k8s-get-k8s-events.html" title="Get Kubernetes events"/>
<link rel="next" href="k8s-exec-into-containers.html" title="Exec into containers"/>
<meta name="DC.type" content="Learn/Docs/Kubernetes/Reference/master"/>
<meta name="DC.subject" content="ECK"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Cloud on Kubernetes [master]</a></span>
»
<span class="breadcrumb-link"><a href="k8s-operating-eck.html">Operating ECK</a></span>
»
<span class="breadcrumb-link"><a href="k8s-troubleshooting.html">Troubleshoot ECK</a></span>
»
<span class="breadcrumb-node">Resizing persistent volumes</span>
</div>
<div class="navheader">
<span class="prev">
<a href="k8s-get-k8s-events.html">« Get Kubernetes events</a>
</span>
<span class="next">
<a href="k8s-exec-into-containers.html">Exec into containers »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="k8s-resize-pv"></a>Resizing persistent volumes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/master/docs/operating-eck/troubleshooting.asciidoc">edit</a></h2>
</div></div></div>
<p>To increase or decrease the size of a disk, you cannot change the size of the volumeClaimTemplate directly. This is because StatefulSets do not allow modifications to volumeClaimTemplates. To work around this, you can create a new nodeSet with the new size, and remove the old nodeSet from your Elasticsearch spec. For instance, just changing the name of nodeSet and the size in the existing Elasticsearch spec. ECK will automatically begin to migrate data to the new nodeSet and remove the old one when it is fully drained. Please see the <a class="xref" href="k8s-orchestration.html#k8s-statefulsets" title="StatefulSets orchestration">StatefulSets orchestration</a> documentation for more detail.</p>
<p>For a concrete example, imagine you started with this:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">apiVersion: elasticsearch.k8s.elastic.co/v1
kind: Elasticsearch
metadata:
  name: quickstart
spec:
  version: 7.7.0
  nodeSets:
  - name: default
    count: 3
    config:
      node.master: true
      node.data: true
      node.ingest: true
      node.store.allow_mmap: false
    volumeClaimTemplates:
    - metadata:
        name: elasticsearch-data
      spec:
        accessModes:
        - ReadWriteOnce
        resources:
          requests:
            storage: 5Gi
        storageClassName: standard</pre>
</div>
<p>and want to increase it to 10Gi of storage. You can change the nodeSet name and the volume size like so:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">apiVersion: elasticsearch.k8s.elastic.co/v1
kind: Elasticsearch
metadata:
  name: quickstart
spec:
  version: 7.7.0
  nodeSets:
  - name: default-10Gi
    count: 3
    config:
      node.master: true
      node.data: true
      node.ingest: true
      node.store.allow_mmap: false
    volumeClaimTemplates:
    - metadata:
        name: elasticsearch-data
      spec:
        accessModes:
        - ReadWriteOnce
        resources:
          requests:
            storage: 10Gi
        storageClassName: standard</pre>
</div>
<p>and ECK will automatically create a new StatefulSet and begin migrating data into it.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="k8s-get-k8s-events.html">« Get Kubernetes events</a>
</span>
<span class="next">
<a href="k8s-exec-into-containers.html">Exec into containers »</a>
</span>
</div>
</div>
</body>
</html>
