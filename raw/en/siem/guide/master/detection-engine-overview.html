<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Detections (Beta) | SIEM Guide [master] | Elastic</title>
<link rel="home" href="index.html" title="SIEM Guide [master]"/>
<link rel="up" href="index.html" title="SIEM Guide [master]"/>
<link rel="prev" href="tuning-anomaly-results.html" title="Optimizing anomaly results"/>
<link rel="next" href="rules-ui-create.html" title="Managing signal detection rules"/>
<meta name="DC.type" content="Learn/Docs/SIEM/Guide/master"/>
<meta name="DC.subject" content="SIEM"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">SIEM Guide [master]</a></span>
»
<span class="breadcrumb-node">Detections (Beta)</span>
</div>
<div class="navheader">
<span class="prev">
<a href="tuning-anomaly-results.html">« Optimizing anomaly results</a>
</span>
<span class="next">
<a href="rules-ui-create.html">Managing signal detection rules »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h1 class="title"><a id="detection-engine-overview"></a>Detections (Beta)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/siem/detection-engine-intro.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h1>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>The SIEM Detections feature automatically searches for threats and creates
signals when they are detected. Signal detection rules define the conditions
for creating signals. The SIEM app comes with
<a class="xref" href="prebuilt-rules.html" title="Prebuilt rule reference">prebuilt rules</a> that search for suspicious
activity on your network and hosts. Additionally, you can
<a class="xref" href="rules-ui-create.html" title="Managing signal detection rules">create your own rules</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>See <a class="xref" href="detection-engine-overview.html#detections-permissions" title="Kibana and index privileges required for Detections">Kibana and index privileges</a> required for viewing
signals and creating rules.</p>
</div>
</div>
<h3><a id="det-engine-terminology"></a>Terminology<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/siem/detection-engine-intro.asciidoc">edit</a></h3>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Signals
</span>
</dt>
<dd>
Always refer to SIEM produced detections. Signals are never
received from third-party systems. When a rule&#8217;s conditions are met, the
SIEM app writes one or more signals to an Elasticsearch <code class="literal">signals</code> index.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Signal indices are created for each Kibana space. The naming convention is:
<code class="literal">.siem-signals-&lt;space name&gt;</code>. For the default space, the signals index is named
<code class="literal">.siem-signals-default</code>.</p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Alerts and events
</span>
</dt>
<dd>
Always refer to data the SIEM app receives from data shippers and external
tools, such as Suricata and Elastic Endpoint Security.
</dd>
</dl>
</div>
<h3><a id="_signals_and_external_alerts"></a>Signals and external alerts<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/siem/detection-engine-intro.asciidoc">edit</a></h3>
<p>The Detections page displays all signals and alerts. To view signals created
by a rule, you can:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Filter for a specific rule in the KQL bar (for example,
<code class="literal">signal.rule.name :"SSH (Secure Shell) from the Internet"</code>).
</li>
<li class="listitem">
View signals in the <span class="strong strong"><strong>Rule details</strong></span> page (click
<span class="strong strong"><strong>Manage signal detection rules</strong></span> &#8594; rule name in the <span class="strong strong"><strong>All rules</strong></span> table).
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>KQL autocomplete for <code class="literal">.siem-signals-*</code> indices is available on the
<span class="strong strong"><strong>Detections</strong></span> and <span class="strong strong"><strong>Rule details</strong></span> pages, and in timelines where <code class="literal">All events</code> or
<code class="literal">Signal events</code> are selected.</p>
</div>
</div>
<p>To view alerts from external data shippers, click <span class="strong strong"><strong>External alerts</strong></span>.</p>
<h4><a id="_open_and_close_signals"></a>Open and close signals<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/siem/detection-engine-intro.asciidoc">edit</a></h4>
<p>You can close signals to indicate they do not need any further investigation.
By default, the All signals table displays open signals. To view closed
signals, click <span class="strong strong"><strong>Closed signals</strong></span>.</p>
<p>To open and close signals, either:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Click the <span class="strong strong"><strong>Close/Open signal</strong></span> icon.
</li>
<li class="listitem">
Select the signals you want to open or close and then click
<span class="strong strong"><strong>Close/Open selected</strong></span>.
</li>
</ul>
</div>
<h4><a id="_send_signals_to_the_timeline"></a>Send signals to the Timeline<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/siem/detection-engine-intro.asciidoc">edit</a></h4>
<p>To investigate a signal in the Timeline, click the <span class="strong strong"><strong>View in timeline</strong></span> icon.</p>
<h3><a id="detections-permissions"></a>Kibana and index privileges required for Detections<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/siem/detection-engine-intro.asciidoc">edit</a></h3>
<p>Depending on your privileges and whether a <code class="literal">.siem-signals-&lt;space name&gt;</code> index
has been created for the Kibana space, you might see an error message when you
try to open the <span class="strong strong"><strong>Detections</strong></span> page.</p>
<h4><a id="_lets_set_up_your_detection_engine_message"></a><code class="literal">Let’s set up your detection engine</code> message<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/siem/detection-engine-intro.asciidoc">edit</a></h4>
<p>If you see this message, a user with these privileges must open the <span class="strong strong"><strong>Detections</strong></span>
page before you can view signals and rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">manage_api_key</code> cluster privilege (see
<a href="/guide/en/elasticsearch/reference/master/security-privileges.html" class="ulink" target="_top">Security privileges</a>).
</li>
<li class="listitem">
The <code class="literal">create_index</code> privilege for the Kibana space (see <a href="/guide/en/elasticsearch/reference/master/security-privileges.html#privileges-list-indices" class="ulink" target="_top">Indices privileges</a>).
</li>
<li class="listitem">
Kibana space <code class="literal">All</code> privileges for the <code class="literal">SIEM</code> feature (see
<a href="/guide/en/kibana/master/xpack-spaces.html#spaces-control-user-access" class="ulink" target="_top">Feature access based on user privileges</a>).
</li>
</ul>
</div>
<h4><a id="_detection_engine_permissions_required_message"></a><code class="literal">Detection engine permissions required</code> message<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/siem/detection-engine-intro.asciidoc">edit</a></h4>
<p>If you see this message, you do not have the required privileges to view the
<span class="strong strong"><strong>Detections</strong></span> page and you should contact your Kibana administrator.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you are using a local Elasticsearch deployment, make sure the
<code class="literal">xpack.security.enabled</code> setting in the <code class="literal">elasticsearch.yml</code>
configuration file is set to <code class="literal">true</code>. For more information, see
<a href="/guide/en/elasticsearch/reference/master/settings.html" class="ulink" target="_top">Configuring Elasticsearch</a> and
<a href="/guide/en/elasticsearch/reference/master/security-settings.html" class="ulink" target="_top">Security settings in Elasticsearch</a>.</p>
</div>
</div>
<p>To view signals and detection rules, you must have at least:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">read</code> permissions for the <code class="literal">.siem-signals-&lt;space name&gt;</code> index, where
<code class="literal">&lt;space name&gt;</code> is the name of the Kibana space you are using to view Detections
(see <a href="/guide/en/elasticsearch/reference/master/security-privileges.html#privileges-list-indices" class="ulink" target="_top">Indices privileges</a>).
</li>
<li class="listitem">
Kibana space <code class="literal">Read</code> privileges for the <code class="literal">SIEM</code> feature (see
<a href="/guide/en/kibana/master/xpack-spaces.html#spaces-control-user-access" class="ulink" target="_top">Feature access based on user privileges</a>).
</li>
</ul>
</div>
<p>To create and modify detection rules, you must have:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">manage_api_key</code> cluster privilege (see <a href="/guide/en/elasticsearch/reference/master/security-privileges.html" class="ulink" target="_top">Security privileges</a>).
</li>
<li class="listitem">
Kibana space <code class="literal">All</code> privileges for the <code class="literal">SIEM</code> feature (see
<a href="/guide/en/kibana/master/xpack-spaces.html#spaces-control-user-access" class="ulink" target="_top">Feature access based on user privileges</a>).
</li>
<li class="listitem">
Write permissions for the <code class="literal">.siem-signals-&lt;space name&gt;</code> index, such as
<code class="literal">create</code> <code class="literal">create_doc</code>, <code class="literal">write</code>, <code class="literal">index</code>, and <code class="literal">all</code>
(see <a href="/guide/en/elasticsearch/reference/master/security-privileges.html#privileges-list-indices" class="ulink" target="_top">Indices privileges</a>).
</li>
</ul>
</div>


</div>
<div class="navfooter">
<span class="prev">
<a href="tuning-anomaly-results.html">« Optimizing anomaly results</a>
</span>
<span class="next">
<a href="rules-ui-create.html">Managing signal detection rules »</a>
</span>
</div>
</div>
</body>
</html>
