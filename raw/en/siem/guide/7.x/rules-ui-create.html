<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Managing signal detection rules | SIEM Guide [7.x] | Elastic</title>
<link rel="home" href="index.html" title="SIEM Guide [7.x]"/>
<link rel="up" href="detection-engine-overview.html" title="Detections (Beta)"/>
<link rel="prev" href="detection-engine-overview.html" title="Detections (Beta)"/>
<link rel="next" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<meta name="DC.type" content="Learn/Docs/SIEM/Guide/7.x"/>
<meta name="DC.subject" content="SIEM"/>
<meta name="DC.identifier" content="7.x"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">SIEM Guide [7.x]</a></span>
»
<span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections (Beta)</a></span>
»
<span class="breadcrumb-node">Managing signal detection rules</span>
</div>
<div class="navheader">
<span class="prev">
<a href="detection-engine-overview.html">« Detections (Beta)</a>
</span>
<span class="next">
<a href="prebuilt-rules.html">Prebuilt rule reference »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rules-ui-create"></a>Managing signal detection rules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.x/docs/en/siem/rules-ui-create.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Rules run periodically and search the specified indices for
documents that meet their criteria.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If a rule fails to run, the SIEM app tries to
rerun it at its next scheduled run time and an error is displayed in the
<span class="strong strong"><strong>Failure History</strong></span> table on the <span class="strong strong"><strong>Rule details</strong></span> page (<span class="strong strong"><strong>SIEM</strong></span> &#8594; <span class="strong strong"><strong>Detections</strong></span> &#8594;
<span class="strong strong"><strong>Manage signal detection rules</strong></span> &#8594; &lt;rule name&gt;).</p>
</div>
</div>
<p>On the Rules page, you can:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="rules-ui-create.html#load-prebuilt-rules" title="Load prebuilt Elastic rules">Load prebuilt Elastic rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#select-all-prebuilt-rules" title="Select and duplicate all prebuilt rules">Select and duplicate all prebuilt rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-rule-ui" title="Create a new rule">Create your own rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#manage-rules-ui" title="Modify existing rules">Clone, delete, activate, and deactivate rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#import-export-rules-ui" title="Import and export rules">Import and export rules</a>
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="all-rules.png" alt="all rules">
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="load-prebuilt-rules"></a>Load prebuilt Elastic rules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.x/docs/en/siem/rules-ui-create.asciidoc">edit</a></h3>
</div></div></div>
<p>To load the SIEM app&#8217;s <a class="xref" href="prebuilt-rules.html" title="Prebuilt rule reference">prebuilt rules</a>, click
<span class="strong strong"><strong>Load Elastic prebuilt rules</strong></span> on the <span class="strong strong"><strong>Signal detection rules</strong></span> page (<span class="strong strong"><strong>SIEM</strong></span> &#8594;
<span class="strong strong"><strong>Detections</strong></span> &#8594; <span class="strong strong"><strong>Manage signal detection rules</strong></span>).</p>
<p>If you delete any of the prebuilt rules, a button appears that enables
reloading all the deleted prebuilt rules.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>By default, prebuilt rules are not activated. If you want to modify a prebuilt
rule, you must first duplicate it and then make your changes to the duplicated
rule.</p>
<p>All Elastic prebuilt rules are tagged with the word <code class="literal">Elastic</code>.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="select-all-prebuilt-rules"></a>Select and duplicate all prebuilt rules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.x/docs/en/siem/rules-ui-create.asciidoc">edit</a></h3>
</div></div></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Select the <span class="strong strong"><strong>Elastic rules</strong></span> tab.
</li>
<li class="listitem">
Scroll to the bottom of the page.
</li>
<li class="listitem">
Click the <code class="literal">Rows per page</code> menu, and then select <em>200 rows</em>.
</li>
<li class="listitem">
When the page reloads, select all the rules.
</li>
<li class="listitem">
Click <em>Bulk actions</em> &#8594; <em>Duplicate selected</em>.
</li>
<li class="listitem">
Select the <span class="strong strong"><strong>Custom rules</strong></span> tab.
</li>
</ol>
</div>
<p>You can then modify the duplicated rules and, if required, delete the prebuilt
ones.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-rule-ui"></a>Create a new rule<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.x/docs/en/siem/rules-ui-create.asciidoc">edit</a></h3>
</div></div></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>SIEM</strong></span> &#8594; <span class="strong strong"><strong>Detections</strong></span> &#8594; <span class="strong strong"><strong>Manage signal detection rules</strong></span>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Create new rule</strong></span>.</p>
<p>The <span class="strong strong"><strong>Create new rule</strong></span> page is displayed.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="create-new-rule.png" alt="create new rule">
</div>
</div>
</li>
<li class="listitem">
Define which Elasticsearch indices the rule analyzes for signals.
</li>
<li class="listitem">
<p>Use the filter and query fields to create the criteria used for detecting
signals.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can use Kibana saved queries (save icon) and queries from saved timelines (<code class="literal">Import query from saved timeline</code>) as rule conditions.</p>
</div>
</div>
<p>For example, the following rule detects when the <code class="literal">vssadmin delete shadows</code>
Windows command is executed:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><em>Index patterns</em>: <code class="literal">winlogbeat-*</code></p>
<p>Winlogbeat ships Windows event logs to the SIEM app.</p>
</li>
<li class="listitem">
<p><em>Custom query</em>: <code class="literal">event.action:"Process Create (rule: ProcessCreate)" and process.name:"vssadmin.exe" and process.args:("delete" and "shadows")</code></p>
<p>Searches the <code class="literal">winlogbeat-*</code> indices for <code class="literal">vssadmin.exe</code> executions with
the <code class="literal">delete</code> and <code class="literal">shadow</code> arguments, used to delete a volume&#8217;s shadow copies.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="rule-query-example.png" alt="rule query example">
</div>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Continue</strong></span>.</p>
<p>The <span class="strong strong"><strong>About rule</strong></span> pane is displayed.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="about-rule-pane.png" alt="about rule pane">
</div>
</div>
</li>
<li class="listitem">
<p>Fill in the following fields:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<em>Name</em>: The rule&#8217;s name.
</li>
<li class="listitem">
<em>Description</em>: A description of what the rule does.
</li>
<li class="listitem">
<p><em>Severity</em>: Select the severity levels of signals created by the rule:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Low</code>: Signals that are of interest but generally not considered to be
security incidents. Sometimes, a combination of low severity events can
indicate suspicious activity.
</li>
<li class="listitem">
<code class="literal">Medium</code>: Signals that require investigation.
</li>
<li class="listitem">
<code class="literal">High</code>: Signals that require an immediate investigation.
</li>
<li class="listitem">
<code class="literal">Critical</code>: Signals that indicate it is highly likely a security incident has
occurred.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><em>Risk score</em>: A numerical value between 0 and 100 that correlates with the <em>Severity</em> level. General guidelines are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">0</code> - <code class="literal">21</code> represents low severity.
</li>
<li class="listitem">
<code class="literal">22</code> - <code class="literal">47</code> represents medium severity.
</li>
<li class="listitem">
<code class="literal">48</code> - <code class="literal">73</code> represents high severity.
</li>
<li class="listitem">
<code class="literal">74</code> - <code class="literal">100</code> represents critical severity.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>For additional options, click <span class="strong strong"><strong>Advanced settings</strong></span> and fill in any of
these fields:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li class="listitem">
<p><em>Timeline template</em> (optional): Select a timeline template used when you
send a signal created by the rule to the timeline.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Before you create rules, create and save relevant
<a class="xref" href="siem-ui-overview.html#timelines-ui" title="Timelines">timelines</a> so they can be selected here.</p>
</div>
</div>
</li>
<li class="listitem">
<em>Reference URLs</em> (optional): References to information that is relevant to
the rule. For example, links to relevant background information.
</li>
<li class="listitem">
<em>False positives</em> (optional): List of common scenarios that may produce
false-positive signals.
</li>
<li class="listitem">
<em>MITRE ATT&amp;CK<sup>TM</sup></em> (optional): Relevant MITRE framework tactics and techniques.
</li>
<li class="listitem">
<em>Tags</em> (optional): Words and phrases used to categorize, filter, and search
the rule.
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Continue</strong></span>.</p>
<p>The <span class="strong strong"><strong>Schedule rule</strong></span> pane is displayed.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="schedule-rule.png" alt="schedule rule">
</div>
</div>
</li>
<li class="listitem">
Select how often the rule runs.
</li>
<li class="listitem">
<p>Optionally, add <code class="literal">Additional look-back time</code> to the rule. When defined, the
rule searches indices with the additional time.</p>
<p>For example, if you set a rule to run every 5 minutes with an additional
look-back time of 1 minute, the rule runs every 5 minutes but analyses the
documents added to indices during the last 6 minutes.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>It is recommended to set the <code class="literal">Additional look-back time</code> to at
least 1 minute. This ensures there are no missing signals when a rule does not
run exactly at its scheduled time.</p>
<p>The SIEM app performs deduplication. Duplicate signals discovered during the
<code class="literal">Additional look-back time</code> are <span class="strong strong"><strong>not</strong></span> created.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Save the rule with or without activation.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When you activate a rule, it is queued and its schedule is determined by
its initial run time. For example, if you activate a rule that runs every 5
minutes at 14:03 but it does not run until 14:04, it will run again at 14:09.</p>
</div>
</div>
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="manage-rules-ui"></a>Modify existing rules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.x/docs/en/siem/rules-ui-create.asciidoc">edit</a></h3>
</div></div></div>
<p>You can clone, edit, activate, deactivate, and delete rules:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>SIEM</strong></span> &#8594; <span class="strong strong"><strong>Detections</strong></span> &#8594; <span class="strong strong"><strong>Manage signal detection rules</strong></span>.
</li>
<li class="listitem">
<p>Do one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Click the actions icon (three dots) and then select the required action.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>Rule</strong></span> column, select all the rules you want to act on, and then the
required action from the <code class="literal">Batch actions</code> menu.
</li>
</ul>
</div>
</li>
<li class="listitem">
To activate or deactivate a rule, click the Activate toggle button.
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="import-export-rules-ui"></a>Import and export rules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.x/docs/en/siem/rules-ui-create.asciidoc">edit</a></h3>
</div></div></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>SIEM</strong></span> &#8594; <span class="strong strong"><strong>Detections</strong></span> &#8594; <span class="strong strong"><strong>Manage signal detection rules</strong></span>.
</li>
<li class="listitem">
<p>To import rules:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Import rule</strong></span>.
</li>
<li class="listitem">
<p>Drag-and-drop files containing the signal detection rules.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Imported rules must be in a <code class="literal">ndjson</code> file.</p>
</div>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>To export rules:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the <span class="strong strong"><strong>All rules</strong></span> table, select the rules you want to export.
</li>
<li class="listitem">
<p>Select <span class="strong strong"><strong>Batch actions</strong></span> &#8594; <span class="strong strong"><strong>Export selected</strong></span>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You cannot export prebuilt rules.</p>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="detection-engine-overview.html">« Detections (Beta)</a>
</span>
<span class="next">
<a href="prebuilt-rules.html">Prebuilt rule reference »</a>
</span>
</div>
</div>
</body>
</html>
